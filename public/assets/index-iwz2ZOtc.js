const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-eJMS0QKT.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-DointVU-.js","assets/vendor-data-D87QteYC.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-BSTVbAd0.js","assets/AfterService-CzhePchp.js","assets/AdditionalWork-FWCBaPCF.js","assets/additionalWorkService-CrncnBGx.js","assets/ConstructionPayment-C6X4Mq8M.js","assets/WorkRequest-DXydq7wd.js","assets/Specbook-CISeN5Fb.js","assets/EstimatePreview-CAFPx8sq.js","assets/ExecutionHistory-HDxWj51C.js"])))=>i.map(i=>d[i]);
import{r as D,b as _b,u as mp,d as Db,N as up,e as uc,O as kb,R as at,f as sa,B as Ab,h as Eb,i as Es}from"./vendor-react-DN7YJcfR.js";import{c as Nm,a as Cb,Q as Vb,b as wb}from"./vendor-data-D87QteYC.js";import{B as dc,X as us,C as dp,T as si,a as Sb,b as fp,W as Ib,c as Lb,D as Tc,d as Pb,A as jb,L as fc,e as Xu,U as el,f as vn,P as Mi,R as Tb,g as Bb,S as pp,h as Rb,i as Ub,j as hp,k as Hb,I as Co,l as Bc,m as Ju,n as Zu,o as ed,p as Mb,M as Fb,q as Ob,r as qb,s as $b}from"./vendor-ui-DointVU-.js";import{k as pc,l as uo,m as fo,n as Wb,o as zb,p as Mt,q as Kb,r as td,s as Qb,t as nt}from"./vendor-date-DbWJ9m7c.js";import{c as Yb,p as gp,l as Dl,s as _n,i as Gb,h as Xb,q as xm,a as vm,m as _m,b as Jb,d as kl,o as tl,e as Zb,f as sl,r as Dm,g as km,j as Am,k as Em,n as Cm,t as yp,u as bp,v as Np,w as xp,x as vp,y as _p,z as Dp,A as kp,B as Ap,C as Ep,D as Cp,E as Vp,F as eN,G as tN,H as sN,I as nN,J as rN,K as iN,L as oN}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var wp={exports:{}},Rc={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var t=D,e=Symbol.for("react.element"),s=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),w=Symbol.iterator,v="@@iterator";function C(g){if(g===null||typeof g!="object")return null;var B=w&&g[w]||g[v];return typeof B=="function"?B:null}var R=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function I(g){{for(var B=arguments.length,S=new Array(B>1?B-1:0),M=1;M<B;M++)S[M-1]=arguments[M];z("error",g,S)}}function z(g,B,S){{var M=R.ReactDebugCurrentFrame,H=M.getStackAddendum();H!==""&&(B+="%s",S=S.concat([H]));var G=S.map(function(q){return String(q)});G.unshift("Warning: "+B),Function.prototype.apply.call(console[g],console,G)}}var ie=!1,te=!1,O=!1,A=!1,x=!1,E;E=Symbol.for("react.module.reference");function T(g){return!!(typeof g=="string"||typeof g=="function"||g===n||g===i||x||g===r||g===u||g===d||A||g===b||ie||te||O||typeof g=="object"&&g!==null&&(g.$$typeof===p||g.$$typeof===h||g.$$typeof===a||g.$$typeof===c||g.$$typeof===m||g.$$typeof===E||g.getModuleId!==void 0))}function L(g,B,S){var M=g.displayName;if(M)return M;var H=B.displayName||B.name||"";return H!==""?S+"("+H+")":S}function P(g){return g.displayName||"Context"}function k(g){if(g==null)return null;if(typeof g.tag=="number"&&I("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case n:return"Fragment";case s:return"Portal";case i:return"Profiler";case r:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case c:var B=g;return P(B)+".Consumer";case a:var S=g;return P(S._context)+".Provider";case m:return L(g,g.render,"ForwardRef");case h:var M=g.displayName||null;return M!==null?M:k(g.type)||"Memo";case p:{var H=g,G=H._payload,q=H._init;try{return k(q(G))}catch{return null}}}return null}var ke=Object.assign,Re=0,ye,Ie,rt,Lt,Ht,me,He;function Ge(){}Ge.__reactDisabledLog=!0;function xt(){{if(Re===0){ye=console.log,Ie=console.info,rt=console.warn,Lt=console.error,Ht=console.group,me=console.groupCollapsed,He=console.groupEnd;var g={configurable:!0,enumerable:!0,value:Ge,writable:!0};Object.defineProperties(console,{info:g,log:g,warn:g,error:g,group:g,groupCollapsed:g,groupEnd:g})}Re++}}function fe(){{if(Re--,Re===0){var g={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:ke({},g,{value:ye}),info:ke({},g,{value:Ie}),warn:ke({},g,{value:rt}),error:ke({},g,{value:Lt}),group:ke({},g,{value:Ht}),groupCollapsed:ke({},g,{value:me}),groupEnd:ke({},g,{value:He})})}Re<0&&I("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var qe=R.ReactCurrentDispatcher,ze;function ft(g,B,S){{if(ze===void 0)try{throw Error()}catch(H){var M=H.stack.trim().match(/\n( *(at )?)/);ze=M&&M[1]||""}return`
`+ze+g}}var tt=!1,Bt;{var ds=typeof WeakMap=="function"?WeakMap:Map;Bt=new ds}function W(g,B){if(!g||tt)return"";{var S=Bt.get(g);if(S!==void 0)return S}var M;tt=!0;var H=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var G;G=qe.current,qe.current=null,xt();try{if(B){var q=function(){throw Error()};if(Object.defineProperty(q.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(q,[])}catch(Ue){M=Ue}Reflect.construct(g,[],q)}else{try{q.call()}catch(Ue){M=Ue}g.call(q.prototype)}}else{try{throw Error()}catch(Ue){M=Ue}g()}}catch(Ue){if(Ue&&M&&typeof Ue.stack=="string"){for(var F=Ue.stack.split(`
`),Z=M.stack.split(`
`),re=F.length-1,Se=Z.length-1;re>=1&&Se>=0&&F[re]!==Z[Se];)Se--;for(;re>=1&&Se>=0;re--,Se--)if(F[re]!==Z[Se]){if(re!==1||Se!==1)do if(re--,Se--,Se<0||F[re]!==Z[Se]){var Xe=`
`+F[re].replace(" at new "," at ");return g.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",g.displayName)),typeof g=="function"&&Bt.set(g,Xe),Xe}while(re>=1&&Se>=0);break}}}finally{tt=!1,qe.current=G,fe(),Error.prepareStackTrace=H}var lt=g?g.displayName||g.name:"",xe=lt?ft(lt):"";return typeof g=="function"&&Bt.set(g,xe),xe}function Ce(g,B,S){return W(g,!1)}function Me(g){var B=g.prototype;return!!(B&&B.isReactComponent)}function Le(g,B,S){if(g==null)return"";if(typeof g=="function")return W(g,Me(g));if(typeof g=="string")return ft(g);switch(g){case u:return ft("Suspense");case d:return ft("SuspenseList")}if(typeof g=="object")switch(g.$$typeof){case m:return Ce(g.render);case h:return Le(g.type,B,S);case p:{var M=g,H=M._payload,G=M._init;try{return Le(G(H),B,S)}catch{}}}return""}var $e=Object.prototype.hasOwnProperty,bt={},Ot=R.ReactDebugCurrentFrame;function mt(g){if(g){var B=g._owner,S=Le(g.type,g._source,B?B.type:null);Ot.setExtraStackFrame(S)}else Ot.setExtraStackFrame(null)}function j(g,B,S,M,H){{var G=Function.call.bind($e);for(var q in g)if(G(g,q)){var F=void 0;try{if(typeof g[q]!="function"){var Z=Error((M||"React class")+": "+S+" type `"+q+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof g[q]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Z.name="Invariant Violation",Z}F=g[q](B,q,M,S,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(re){F=re}F&&!(F instanceof Error)&&(mt(H),I("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",M||"React class",S,q,typeof F),mt(null)),F instanceof Error&&!(F.message in bt)&&(bt[F.message]=!0,mt(H),I("Failed %s type: %s",S,F.message),mt(null))}}}var $=Array.isArray;function X(g){return $(g)}function ge(g){{var B=typeof Symbol=="function"&&Symbol.toStringTag,S=B&&g[Symbol.toStringTag]||g.constructor.name||"Object";return S}}function ae(g){try{return de(g),!1}catch{return!0}}function de(g){return""+g}function Ee(g){if(ae(g))return I("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ge(g)),de(g)}var Ke=R.ReactCurrentOwner,st={key:!0,ref:!0,__self:!0,__source:!0},Ne,fs,Pt;Pt={};function it(g){if($e.call(g,"ref")){var B=Object.getOwnPropertyDescriptor(g,"ref").get;if(B&&B.isReactWarning)return!1}return g.ref!==void 0}function ss(g){if($e.call(g,"key")){var B=Object.getOwnPropertyDescriptor(g,"key").get;if(B&&B.isReactWarning)return!1}return g.key!==void 0}function V(g,B){if(typeof g.ref=="string"&&Ke.current&&B&&Ke.current.stateNode!==B){var S=k(Ke.current.type);Pt[S]||(I('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(Ke.current.type),g.ref),Pt[S]=!0)}}function oe(g,B){{var S=function(){Ne||(Ne=!0,I("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",B))};S.isReactWarning=!0,Object.defineProperty(g,"key",{get:S,configurable:!0})}}function De(g,B){{var S=function(){fs||(fs=!0,I("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",B))};S.isReactWarning=!0,Object.defineProperty(g,"ref",{get:S,configurable:!0})}}var Be=function(g,B,S,M,H,G,q){var F={$$typeof:e,type:g,key:B,ref:S,props:q,_owner:G};return F._store={},Object.defineProperty(F._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(F,"_self",{configurable:!1,enumerable:!1,writable:!1,value:M}),Object.defineProperty(F,"_source",{configurable:!1,enumerable:!1,writable:!1,value:H}),Object.freeze&&(Object.freeze(F.props),Object.freeze(F)),F};function ue(g,B,S,M,H){{var G,q={},F=null,Z=null;S!==void 0&&(Ee(S),F=""+S),ss(B)&&(Ee(B.key),F=""+B.key),it(B)&&(Z=B.ref,V(B,H));for(G in B)$e.call(B,G)&&!st.hasOwnProperty(G)&&(q[G]=B[G]);if(g&&g.defaultProps){var re=g.defaultProps;for(G in re)q[G]===void 0&&(q[G]=re[G])}if(F||Z){var Se=typeof g=="function"?g.displayName||g.name||"Unknown":g;F&&oe(q,Se),Z&&De(q,Se)}return Be(g,F,Z,H,M,Ke.current,q)}}var jt=R.ReactCurrentOwner,Nt=R.ReactDebugCurrentFrame;function zt(g){if(g){var B=g._owner,S=Le(g.type,g._source,B?B.type:null);Nt.setExtraStackFrame(S)}else Nt.setExtraStackFrame(null)}var pt;pt=!1;function Xt(g){return typeof g=="object"&&g!==null&&g.$$typeof===e}function Jt(){{if(jt.current){var g=k(jt.current.type);if(g)return`

Check the render method of \``+g+"`."}return""}}function Ss(g){{if(g!==void 0){var B=g.fileName.replace(/^.*[\\\/]/,""),S=g.lineNumber;return`

Check your code at `+B+":"+S+"."}return""}}var fn={};function Ks(g){{var B=Jt();if(!B){var S=typeof g=="string"?g:g.displayName||g.name;S&&(B=`

Check the top-level render call using <`+S+">.")}return B}}function pn(g,B){{if(!g._store||g._store.validated||g.key!=null)return;g._store.validated=!0;var S=Ks(B);if(fn[S])return;fn[S]=!0;var M="";g&&g._owner&&g._owner!==jt.current&&(M=" It was passed a child from "+k(g._owner.type)+"."),zt(g),I('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',S,M),zt(null)}}function $r(g,B){{if(typeof g!="object")return;if(X(g))for(var S=0;S<g.length;S++){var M=g[S];Xt(M)&&pn(M,B)}else if(Xt(g))g._store&&(g._store.validated=!0);else if(g){var H=C(g);if(typeof H=="function"&&H!==g.entries)for(var G=H.call(g),q;!(q=G.next()).done;)Xt(q.value)&&pn(q.value,B)}}}function wn(g){{var B=g.type;if(B==null||typeof B=="string")return;var S;if(typeof B=="function")S=B.propTypes;else if(typeof B=="object"&&(B.$$typeof===m||B.$$typeof===h))S=B.propTypes;else return;if(S){var M=k(B);j(S,g.props,"prop",M,g)}else if(B.PropTypes!==void 0&&!pt){pt=!0;var H=k(B);I("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",H||"Unknown")}typeof B.getDefaultProps=="function"&&!B.getDefaultProps.isReactClassApproved&&I("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function en(g){{for(var B=Object.keys(g.props),S=0;S<B.length;S++){var M=B[S];if(M!=="children"&&M!=="key"){zt(g),I("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",M),zt(null);break}}g.ref!==null&&(zt(g),I("Invalid attribute `ref` supplied to `React.Fragment`."),zt(null))}}var Sn={};function Bs(g,B,S,M,H,G){{var q=T(g);if(!q){var F="";(g===void 0||typeof g=="object"&&g!==null&&Object.keys(g).length===0)&&(F+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Z=Ss(H);Z?F+=Z:F+=Jt();var re;g===null?re="null":X(g)?re="array":g!==void 0&&g.$$typeof===e?(re="<"+(k(g.type)||"Unknown")+" />",F=" Did you accidentally export a JSX literal instead of a component?"):re=typeof g,I("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",re,F)}var Se=ue(g,B,S,H,G);if(Se==null)return Se;if(q){var Xe=B.children;if(Xe!==void 0)if(M)if(X(Xe)){for(var lt=0;lt<Xe.length;lt++)$r(Xe[lt],g);Object.freeze&&Object.freeze(Xe)}else I("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else $r(Xe,g)}if($e.call(B,"key")){var xe=k(g),Ue=Object.keys(B).filter(function(tn){return tn!=="key"}),Qt=Ue.length>0?"{key: someKey, "+Ue.join(": ..., ")+": ...}":"{key: someKey}";if(!Sn[xe+Qt]){var ls=Ue.length>0?"{"+Ue.join(": ..., ")+": ...}":"{}";I(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Qt,xe,ls,xe),Sn[xe+Qt]=!0}}return g===n?en(Se):wn(Se),Se}}var Is=Bs;Rc.Fragment=n,Rc.jsxDEV=Is})();wp.exports=Rc;var o=wp.exports,Sp,sd=_b;{var nd=sd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Sp=function(t,e){nd.usingClientEntryPoint=!0;try{return sd.createRoot(t,e)}finally{nd.usingClientEntryPoint=!1}}}const aN="modulepreload",lN=function(t){return"/"+t},rd={},$n=function(e,s,n){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(s.map(m=>{if(m=lN(m),m in rd)return;rd[m]=!0;const u=m.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":aN,u||(h.as="script"),h.crossOrigin="",h.href=m,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((p,b)=>{h.addEventListener("load",p),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return r.then(a=>{for(const c of a||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};let cN={data:""},mN=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||cN},uN=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,dN=/\/\*[^]*?\*\/|  +/g,id=/\n+/g,hr=(t,e)=>{let s="",n="",r="";for(let i in t){let a=t[i];i[0]=="@"?i[1]=="i"?s=i+" "+a+";":n+=i[1]=="f"?hr(a,i):i+"{"+hr(a,i[1]=="k"?"":e)+"}":typeof a=="object"?n+=hr(a,e?e.replace(/([^,])+/g,c=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,c):c?c+" "+m:m)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=hr.p?hr.p(i,a):i+":"+a+";")}return s+(e&&r?e+"{"+r+"}":r)+n},Wn={},Ip=t=>{if(typeof t=="object"){let e="";for(let s in t)e+=s+Ip(t[s]);return e}return t},fN=(t,e,s,n,r)=>{let i=Ip(t),a=Wn[i]||(Wn[i]=(m=>{let u=0,d=11;for(;u<m.length;)d=101*d+m.charCodeAt(u++)>>>0;return"go"+d})(i));if(!Wn[a]){let m=i!==t?t:(u=>{let d,h,p=[{}];for(;d=uN.exec(u.replace(dN,""));)d[4]?p.shift():d[3]?(h=d[3].replace(id," ").trim(),p.unshift(p[0][h]=p[0][h]||{})):p[0][d[1]]=d[2].replace(id," ").trim();return p[0]})(t);Wn[a]=hr(r?{["@keyframes "+a]:m}:m,s?"":"."+a)}let c=s&&Wn.g?Wn.g:null;return s&&(Wn.g=Wn[a]),((m,u,d,h)=>{h?u.data=u.data.replace(h,m):u.data.indexOf(m)===-1&&(u.data=d?m+u.data:u.data+m)})(Wn[a],e,n,c),a},pN=(t,e,s)=>t.reduce((n,r,i)=>{let a=e[i];if(a&&a.call){let c=a(s),m=c&&c.props&&c.props.className||/^go/.test(c)&&c;a=m?"."+m:c&&typeof c=="object"?c.props?"":hr(c,""):c===!1?"":c}return n+r+(a??"")},"");function Al(t){let e=this||{},s=t.call?t(e.p):t;return fN(s.unshift?s.raw?pN(s,[].slice.call(arguments,1),e.p):s.reduce((n,r)=>Object.assign(n,r&&r.call?r(e.p):r),{}):s,mN(e.target),e.g,e.o,e.k)}let Lp,Uc,Hc;Al.bind({g:1});let Xn=Al.bind({k:1});function hN(t,e,s,n){hr.p=e,Lp=t,Uc=s,Hc=n}function Pr(t,e){let s=this||{};return function(){let n=arguments;function r(i,a){let c=Object.assign({},i),m=c.className||r.className;s.p=Object.assign({theme:Uc&&Uc()},c),s.o=/ *go\d+/.test(m),c.className=Al.apply(s,n)+(m?" "+m:"");let u=t;return t[0]&&(u=c.as||t,delete c.as),Hc&&u[0]&&Hc(c),Lp(u,c)}return r}}var gN=t=>typeof t=="function",nl=(t,e)=>gN(t)?t(e):t,yN=(()=>{let t=0;return()=>(++t).toString()})(),Pp=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),bN=20,Vm="default",jp=(t,e)=>{let{toastLimit:s}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,s)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:n}=e;return jp(t,{type:t.toasts.find(a=>a.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=e;return{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+i}))}}},$a=[],Tp={toasts:[],pausedAt:void 0,settings:{toastLimit:bN}},Bn={},Bp=(t,e=Vm)=>{Bn[e]=jp(Bn[e]||Tp,t),$a.forEach(([s,n])=>{s===e&&n(Bn[e])})},Rp=t=>Object.keys(Bn).forEach(e=>Bp(t,e)),NN=t=>Object.keys(Bn).find(e=>Bn[e].toasts.some(s=>s.id===t)),El=(t=Vm)=>e=>{Bp(e,t)},xN={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},vN=(t={},e=Vm)=>{let[s,n]=D.useState(Bn[e]||Tp),r=D.useRef(Bn[e]);D.useEffect(()=>(r.current!==Bn[e]&&n(Bn[e]),$a.push([e,n]),()=>{let a=$a.findIndex(([c])=>c===e);a>-1&&$a.splice(a,1)}),[e]);let i=s.toasts.map(a=>{var c,m,u;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((c=t[a.type])==null?void 0:c.removeDelay)||(t==null?void 0:t.removeDelay),duration:a.duration||((m=t[a.type])==null?void 0:m.duration)||(t==null?void 0:t.duration)||xN[a.type],style:{...t.style,...(u=t[a.type])==null?void 0:u.style,...a.style}}});return{...s,toasts:i}},_N=(t,e="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...s,id:(s==null?void 0:s.id)||yN()}),na=t=>(e,s)=>{let n=_N(e,t,s);return El(n.toasterId||NN(n.id))({type:2,toast:n}),n.id},Cs=(t,e)=>na("blank")(t,e);Cs.error=na("error");Cs.success=na("success");Cs.loading=na("loading");Cs.custom=na("custom");Cs.dismiss=(t,e)=>{let s={type:3,toastId:t};e?El(e)(s):Rp(s)};Cs.dismissAll=t=>Cs.dismiss(void 0,t);Cs.remove=(t,e)=>{let s={type:4,toastId:t};e?El(e)(s):Rp(s)};Cs.removeAll=t=>Cs.remove(void 0,t);Cs.promise=(t,e,s)=>{let n=Cs.loading(e.loading,{...s,...s==null?void 0:s.loading});return typeof t=="function"&&(t=t()),t.then(r=>{let i=e.success?nl(e.success,r):void 0;return i?Cs.success(i,{id:n,...s,...s==null?void 0:s.success}):Cs.dismiss(n),r}).catch(r=>{let i=e.error?nl(e.error,r):void 0;i?Cs.error(i,{id:n,...s,...s==null?void 0:s.error}):Cs.dismiss(n)}),t};var DN=1e3,kN=(t,e="default")=>{let{toasts:s,pausedAt:n}=vN(t,e),r=D.useRef(new Map).current,i=D.useCallback((h,p=DN)=>{if(r.has(h))return;let b=setTimeout(()=>{r.delete(h),a({type:4,toastId:h})},p);r.set(h,b)},[]);D.useEffect(()=>{if(n)return;let h=Date.now(),p=s.map(b=>{if(b.duration===1/0)return;let w=(b.duration||0)+b.pauseDuration-(h-b.createdAt);if(w<0){b.visible&&Cs.dismiss(b.id);return}return setTimeout(()=>Cs.dismiss(b.id,e),w)});return()=>{p.forEach(b=>b&&clearTimeout(b))}},[s,n,e]);let a=D.useCallback(El(e),[e]),c=D.useCallback(()=>{a({type:5,time:Date.now()})},[a]),m=D.useCallback((h,p)=>{a({type:1,toast:{id:h,height:p}})},[a]),u=D.useCallback(()=>{n&&a({type:6,time:Date.now()})},[n,a]),d=D.useCallback((h,p)=>{let{reverseOrder:b=!1,gutter:w=8,defaultPosition:v}=p||{},C=s.filter(z=>(z.position||v)===(h.position||v)&&z.height),R=C.findIndex(z=>z.id===h.id),I=C.filter((z,ie)=>ie<R&&z.visible).length;return C.filter(z=>z.visible).slice(...b?[I+1]:[0,I]).reduce((z,ie)=>z+(ie.height||0)+w,0)},[s]);return D.useEffect(()=>{s.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let p=r.get(h.id);p&&(clearTimeout(p),r.delete(h.id))}})},[s,i]),{toasts:s,handlers:{updateHeight:m,startPause:c,endPause:u,calculateOffset:d}}},AN=Xn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,EN=Xn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,CN=Xn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,VN=Pr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${AN} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${EN} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${CN} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,wN=Xn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,SN=Pr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${wN} 1s linear infinite;
`,IN=Xn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,LN=Xn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,PN=Pr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${IN} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${LN} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,jN=Pr("div")`
  position: absolute;
`,TN=Pr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,BN=Xn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,RN=Pr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${BN} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,UN=({toast:t})=>{let{icon:e,type:s,iconTheme:n}=t;return e!==void 0?typeof e=="string"?D.createElement(RN,null,e):e:s==="blank"?null:D.createElement(TN,null,D.createElement(SN,{...n}),s!=="loading"&&D.createElement(jN,null,s==="error"?D.createElement(VN,{...n}):D.createElement(PN,{...n})))},HN=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,MN=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,FN="0%{opacity:0;} 100%{opacity:1;}",ON="0%{opacity:1;} 100%{opacity:0;}",qN=Pr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,$N=Pr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,WN=(t,e)=>{let s=t.includes("top")?1:-1,[n,r]=Pp()?[FN,ON]:[HN(s),MN(s)];return{animation:e?`${Xn(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Xn(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},zN=D.memo(({toast:t,position:e,style:s,children:n})=>{let r=t.height?WN(t.position||e||"top-center",t.visible):{opacity:0},i=D.createElement(UN,{toast:t}),a=D.createElement($N,{...t.ariaProps},nl(t.message,t));return D.createElement(qN,{className:t.className,style:{...r,...s,...t.style}},typeof n=="function"?n({icon:i,message:a}):D.createElement(D.Fragment,null,i,a))});hN(D.createElement);var KN=({id:t,className:e,style:s,onHeightUpdate:n,children:r})=>{let i=D.useCallback(a=>{if(a){let c=()=>{let m=a.getBoundingClientRect().height;n(t,m)};c(),new MutationObserver(c).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[t,n]);return D.createElement("div",{ref:i,className:e,style:s},r)},QN=(t,e)=>{let s=t.includes("top"),n=s?{top:0}:{bottom:0},r=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Pp()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(s?1:-1)}px)`,...n,...r}},YN=Al`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Da=16,GN=({reverseOrder:t,position:e="top-center",toastOptions:s,gutter:n,children:r,toasterId:i,containerStyle:a,containerClassName:c})=>{let{toasts:m,handlers:u}=kN(s,i);return D.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Da,left:Da,right:Da,bottom:Da,pointerEvents:"none",...a},className:c,onMouseEnter:u.startPause,onMouseLeave:u.endPause},m.map(d=>{let h=d.position||e,p=u.calculateOffset(d,{reverseOrder:t,gutter:n,defaultPosition:e}),b=QN(h,p);return D.createElement(KN,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?YN:"",style:b},d.type==="custom"?nl(d.message,d):r?r(d):D.createElement(zN,{toast:d,position:h}))}))},ee=Cs;function XN(t={}){const{immediate:e=!1,onNeedRefresh:s,onOfflineReady:n,onRegistered:r,onRegisteredSW:i,onRegisterError:a}=t;let c,m,u;const d=async(p=!0)=>{await m,await(u==null?void 0:u())};async function h(){if("serviceWorker"in navigator){if(c=await $n(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/sw.js",{scope:"/",type:"classic"})).catch(p=>{a==null||a(p)}),!c)return;u=async()=>{await(c==null?void 0:c.messageSkipWaiting())};{let p=!1;const b=()=>{p=!0,c==null||c.addEventListener("controlling",w=>{w.isUpdate&&window.location.reload()}),s==null||s()};c.addEventListener("installed",w=>{typeof w.isUpdate>"u"?typeof w.isExternal<"u"?w.isExternal?b():!p&&(n==null||n()):w.isExternal?window.location.reload():!p&&(n==null||n()):w.isUpdate||n==null||n()}),c.addEventListener("waiting",b),c.addEventListener("externalwaiting",b)}c.register({immediate:e}).then(p=>{i?i("/sw.js",p):r==null||r(p)}).catch(p=>{a==null||a(p)})}}return m=h(),d}const JN=()=>{};var od={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=function(t){const e=[];let s=0;for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<128?e[s++]=r:r<2048?(e[s++]=r>>6|192,e[s++]=r&63|128):(r&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++n)&1023),e[s++]=r>>18|240,e[s++]=r>>12&63|128,e[s++]=r>>6&63|128,e[s++]=r&63|128):(e[s++]=r>>12|224,e[s++]=r>>6&63|128,e[s++]=r&63|128)}return e},ZN=function(t){const e=[];let s=0,n=0;for(;s<t.length;){const r=t[s++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[s++];e[n++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[s++],a=t[s++],c=t[s++],m=((r&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(m>>10)),e[n++]=String.fromCharCode(56320+(m&1023))}else{const i=t[s++],a=t[s++];e[n++]=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Hp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<t.length;r+=3){const i=t[r],a=r+1<t.length,c=a?t[r+1]:0,m=r+2<t.length,u=m?t[r+2]:0,d=i>>2,h=(i&3)<<4|c>>4;let p=(c&15)<<2|u>>6,b=u&63;m||(b=64,a||(p=64)),n.push(s[d],s[h],s[p],s[b])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Up(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ZN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<t.length;){const i=s[t.charAt(r++)],c=r<t.length?s[t.charAt(r)]:0;++r;const u=r<t.length?s[t.charAt(r)]:64;++r;const h=r<t.length?s[t.charAt(r)]:64;if(++r,i==null||c==null||u==null||h==null)throw new e0;const p=i<<2|c>>4;if(n.push(p),u!==64){const b=c<<4&240|u>>2;if(n.push(b),h!==64){const w=u<<6&192|h;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class e0 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const t0=function(t){const e=Up(t);return Hp.encodeByteArray(e,!0)},rl=function(t){return t0(t).replace(/\./g,"")},s0=function(t){try{return Hp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0=()=>n0().__FIREBASE_DEFAULTS__,i0=()=>{if(typeof process>"u"||typeof od>"u")return;const t=od.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},o0=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&s0(t[1]);return e&&JSON.parse(e)},wm=()=>{try{return JN()||r0()||i0()||o0()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},a0=t=>{var e,s;return(s=(e=wm())==null?void 0:e.emulatorHosts)==null?void 0:s[t]},Mp=t=>{const e=a0(t);if(!e)return;const s=e.lastIndexOf(":");if(s<=0||s+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(s+1),10);return e[0]==="["?[e.substring(1,s-1),n]:[e.substring(0,s),n]},Fp=()=>{var t;return(t=wm())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,n)=>{s?this.reject(s):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Op(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[rl(JSON.stringify(s)),rl(JSON.stringify(a)),""].join(".")}const Po={};function c0(){const t={prod:[],emulator:[]};for(const e of Object.keys(Po))Po[e]?t.emulator.push(e):t.prod.push(e);return t}function m0(t){let e=document.getElementById(t),s=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),s=!0),{created:s,element:e}}let ad=!1;function $p(t,e){if(typeof window>"u"||typeof document>"u"||!ra(window.location.host)||Po[t]===e||Po[t]||ad)return;Po[t]=e;function s(p){return`__firebase__banner__${p}`}const n="__firebase__banner",i=c0().prod.length>0;function a(){const p=document.getElementById(n);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function m(p,b){p.setAttribute("width","24"),p.setAttribute("id",b),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{ad=!0,a()},p}function d(p,b){p.setAttribute("id",b),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function h(){const p=m0(n),b=s("text"),w=document.getElementById(b)||document.createElement("span"),v=s("learnmore"),C=document.getElementById(v)||document.createElement("a"),R=s("preprendIcon"),I=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const z=p.element;c(z),d(C,v);const ie=u();m(I,R),z.append(I,w,C,ie),document.body.appendChild(z)}i?(w.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u0(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function d0(){var e;const t=(e=wm())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function f0(){return!d0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function p0(){try{return typeof indexedDB=="object"}catch{return!1}}function h0(){return new Promise((t,e)=>{try{let s=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),s||self.indexedDB.deleteDatabase(n),t(!0)},r.onupgradeneeded=()=>{s=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0="FirebaseError";class ai extends Error{constructor(e,s,n){super(s),this.code=e,this.customData=n,this.name=g0,Object.setPrototypeOf(this,ai.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wp.prototype.create)}}class Wp{constructor(e,s,n){this.service=e,this.serviceName=s,this.errors=n}create(e,...s){const n=s[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?y0(i,n):"Error",c=`${this.serviceName}: ${a} (${r}).`;return new ai(r,c,n)}}function y0(t,e){return t.replace(b0,(s,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const b0=/\{\$([^}]+)}/g;function il(t,e){if(t===e)return!0;const s=Object.keys(t),n=Object.keys(e);for(const r of s){if(!n.includes(r))return!1;const i=t[r],a=e[r];if(ld(i)&&ld(a)){if(!il(i,a))return!1}else if(i!==a)return!1}for(const r of n)if(!s.includes(r))return!1;return!0}function ld(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(t){return t&&t._delegate?t._delegate:t}class Oi{constructor(e,s,n){this.name=e,this.instanceFactory=s,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const n=new l0;if(this.instancesDeferred.set(s,n),this.isInitialized(s)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:s});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(e){const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(v0(e))try{this.getOrInitializeService({instanceIdentifier:Gr})}catch{}for(const[s,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(s);try{const i=this.getOrInitializeService({instanceIdentifier:r});n.resolve(i)}catch{}}}}clearInstance(e=Gr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gr){return this.instances.has(e)}getOptions(e=Gr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:s});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&a.resolve(r)}return r}onInit(e,s){const n=this.normalizeInstanceIdentifier(s),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,s){const n=this.onInitCallbacks.get(s);if(n)for(const r of n)try{r(e,s)}catch{}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:x0(e),options:s}),this.instances.set(e,n),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Gr){return this.component?this.component.multipleInstances?e:Gr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function x0(t){return t===Gr?void 0:t}function v0(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new N0(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Vt||(Vt={}));const D0={debug:Vt.DEBUG,verbose:Vt.VERBOSE,info:Vt.INFO,warn:Vt.WARN,error:Vt.ERROR,silent:Vt.SILENT},k0=Vt.INFO,A0={[Vt.DEBUG]:"log",[Vt.VERBOSE]:"log",[Vt.INFO]:"info",[Vt.WARN]:"warn",[Vt.ERROR]:"error"},E0=(t,e,...s)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),r=A0[e];if(r)console[r](`[${n}]  ${t.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zp{constructor(e){this.name=e,this._logLevel=k0,this._logHandler=E0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vt.DEBUG,...e),this._logHandler(this,Vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vt.VERBOSE,...e),this._logHandler(this,Vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vt.INFO,...e),this._logHandler(this,Vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vt.WARN,...e),this._logHandler(this,Vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vt.ERROR,...e),this._logHandler(this,Vt.ERROR,...e)}}const C0=(t,e)=>e.some(s=>t instanceof s);let cd,md;function V0(){return cd||(cd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function w0(){return md||(md=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Kp=new WeakMap,Mc=new WeakMap,Qp=new WeakMap,hc=new WeakMap,Sm=new WeakMap;function S0(t){const e=new Promise((s,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{s(Nr(t.result)),r()},a=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(s=>{s instanceof IDBCursor&&Kp.set(s,t)}).catch(()=>{}),Sm.set(e,t),e}function I0(t){if(Mc.has(t))return;const e=new Promise((s,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{s(),r()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Mc.set(t,e)}let Fc={get(t,e,s){if(t instanceof IDBTransaction){if(e==="done")return Mc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Qp.get(t);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return Nr(t[e])},set(t,e,s){return t[e]=s,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function L0(t){Fc=t(Fc)}function P0(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const n=t.call(gc(this),e,...s);return Qp.set(n,e.sort?e.sort():[e]),Nr(n)}:w0().includes(t)?function(...e){return t.apply(gc(this),e),Nr(Kp.get(this))}:function(...e){return Nr(t.apply(gc(this),e))}}function j0(t){return typeof t=="function"?P0(t):(t instanceof IDBTransaction&&I0(t),C0(t,V0())?new Proxy(t,Fc):t)}function Nr(t){if(t instanceof IDBRequest)return S0(t);if(hc.has(t))return hc.get(t);const e=j0(t);return e!==t&&(hc.set(t,e),Sm.set(e,t)),e}const gc=t=>Sm.get(t);function T0(t,e,{blocked:s,upgrade:n,blocking:r,terminated:i}={}){const a=indexedDB.open(t,e),c=Nr(a);return n&&a.addEventListener("upgradeneeded",m=>{n(Nr(a.result),m.oldVersion,m.newVersion,Nr(a.transaction),m)}),s&&a.addEventListener("blocked",m=>s(m.oldVersion,m.newVersion,m)),c.then(m=>{i&&m.addEventListener("close",()=>i()),r&&m.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}const B0=["get","getKey","getAll","getAllKeys","count"],R0=["put","add","delete","clear"],yc=new Map;function ud(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yc.get(e))return yc.get(e);const s=e.replace(/FromIndex$/,""),n=e!==s,r=R0.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(r||B0.includes(s)))return;const i=async function(a,...c){const m=this.transaction(a,r?"readwrite":"readonly");let u=m.store;return n&&(u=u.index(c.shift())),(await Promise.all([u[s](...c),r&&m.done]))[0]};return yc.set(e,i),i}L0(t=>({...t,get:(e,s,n)=>ud(e,s)||t.get(e,s,n),has:(e,s)=>!!ud(e,s)||t.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(H0(s)){const n=s.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(s=>s).join(" ")}}function H0(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Oc="@firebase/app",dd="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn=new zp("@firebase/app"),M0="@firebase/app-compat",F0="@firebase/analytics-compat",O0="@firebase/analytics",q0="@firebase/app-check-compat",$0="@firebase/app-check",W0="@firebase/auth",z0="@firebase/auth-compat",K0="@firebase/database",Q0="@firebase/data-connect",Y0="@firebase/database-compat",G0="@firebase/functions",X0="@firebase/functions-compat",J0="@firebase/installations",Z0="@firebase/installations-compat",ex="@firebase/messaging",tx="@firebase/messaging-compat",sx="@firebase/performance",nx="@firebase/performance-compat",rx="@firebase/remote-config",ix="@firebase/remote-config-compat",ox="@firebase/storage",ax="@firebase/storage-compat",lx="@firebase/firestore",cx="@firebase/ai",mx="@firebase/firestore-compat",ux="firebase",dx="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc="[DEFAULT]",fx={[Oc]:"fire-core",[M0]:"fire-core-compat",[O0]:"fire-analytics",[F0]:"fire-analytics-compat",[$0]:"fire-app-check",[q0]:"fire-app-check-compat",[W0]:"fire-auth",[z0]:"fire-auth-compat",[K0]:"fire-rtdb",[Q0]:"fire-data-connect",[Y0]:"fire-rtdb-compat",[G0]:"fire-fn",[X0]:"fire-fn-compat",[J0]:"fire-iid",[Z0]:"fire-iid-compat",[ex]:"fire-fcm",[tx]:"fire-fcm-compat",[sx]:"fire-perf",[nx]:"fire-perf-compat",[rx]:"fire-rc",[ix]:"fire-rc-compat",[ox]:"fire-gcs",[ax]:"fire-gcs-compat",[lx]:"fire-fst",[mx]:"fire-fst-compat",[cx]:"fire-vertex","fire-js":"fire-js",[ux]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=new Map,px=new Map,$c=new Map;function fd(t,e){try{t.container.addComponent(e)}catch(s){Jn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,s)}}function $o(t){const e=t.name;if($c.has(e))return Jn.debug(`There were multiple attempts to register component ${e}.`),!1;$c.set(e,t);for(const s of qo.values())fd(s,t);for(const s of px.values())fd(s,t);return!0}function Yp(t,e){const s=t.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),t.container.getProvider(e)}function Gp(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xr=new Wp("app","Firebase",hx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,s,n){this._isDeleted=!1,this._options={...e},this._config={...s},this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Oi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp=dx;function Jp(t,e={}){let s=t;typeof e!="object"&&(e={name:e});const n={name:qc,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw xr.create("bad-app-name",{appName:String(r)});if(s||(s=Fp()),!s)throw xr.create("no-options");const i=qo.get(r);if(i){if(il(s,i.options)&&il(n,i.config))return i;throw xr.create("duplicate-app",{appName:r})}const a=new _0(r);for(const m of $c.values())a.addComponent(m);const c=new gx(s,n,a);return qo.set(r,c),c}function Zp(t=qc){const e=qo.get(t);if(!e&&t===qc&&Fp())return Jp();if(!e)throw xr.create("no-app",{appName:t});return e}function pd(){return Array.from(qo.values())}function vr(t,e,s){let n=fx[t]??t;s&&(n+=`-${s}`);const r=n.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const a=[`Unable to register library "${n}" with version "${e}":`];r&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jn.warn(a.join(" "));return}$o(new Oi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx="firebase-heartbeat-database",bx=1,Wo="firebase-heartbeat-store";let bc=null;function eh(){return bc||(bc=T0(yx,bx,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wo)}catch(s){console.warn(s)}}}}).catch(t=>{throw xr.create("idb-open",{originalErrorMessage:t.message})})),bc}async function Nx(t){try{const s=(await eh()).transaction(Wo),n=await s.objectStore(Wo).get(th(t));return await s.done,n}catch(e){if(e instanceof ai)Jn.warn(e.message);else{const s=xr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Jn.warn(s.message)}}}async function hd(t,e){try{const n=(await eh()).transaction(Wo,"readwrite");await n.objectStore(Wo).put(e,th(t)),await n.done}catch(s){if(s instanceof ai)Jn.warn(s.message);else{const n=xr.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});Jn.warn(n.message)}}}function th(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx=1024,vx=30;class _x{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new kx(s),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,s;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=gd();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)==null?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>vx){const a=Ax(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Jn.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=gd(),{heartbeatsToSend:n,unsentEntries:r}=Dx(this._heartbeatsCache.heartbeats),i=rl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=s,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(s){return Jn.warn(s),""}}}function gd(){return new Date().toISOString().substring(0,10)}function Dx(t,e=xx){const s=[];let n=t.slice();for(const r of t){const i=s.find(a=>a.agent===r.agent);if(i){if(i.dates.push(r.date),yd(s)>e){i.dates.pop();break}}else if(s.push({agent:r.agent,dates:[r.date]}),yd(s)>e){s.pop();break}n=n.slice(1)}return{heartbeatsToSend:s,unsentEntries:n}}class kx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return p0()?h0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await Nx(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return hd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return hd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function yd(t){return rl(JSON.stringify({version:2,heartbeats:t})).length}function Ax(t){if(t.length===0)return-1;let e=0,s=t[0].date;for(let n=1;n<t.length;n++)t[n].date<s&&(s=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(t){$o(new Oi("platform-logger",e=>new U0(e),"PRIVATE")),$o(new Oi("heartbeat",e=>new _x(e),"PRIVATE")),vr(Oc,dd,t),vr(Oc,dd,"esm2020"),vr("fire-js","")}Ex("");var Cx="firebase",Vx="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vr(Cx,Vx,"app");var bd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _r,sh;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,x){function E(){}E.prototype=x.prototype,A.F=x.prototype,A.prototype=new E,A.prototype.constructor=A,A.D=function(T,L,P){for(var k=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)k[ke-2]=arguments[ke];return x.prototype[L].apply(T,k)}}function s(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,s),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(A,x,E){E||(E=0);const T=Array(16);if(typeof x=="string")for(var L=0;L<16;++L)T[L]=x.charCodeAt(E++)|x.charCodeAt(E++)<<8|x.charCodeAt(E++)<<16|x.charCodeAt(E++)<<24;else for(L=0;L<16;++L)T[L]=x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24;x=A.g[0],E=A.g[1],L=A.g[2];let P=A.g[3],k;k=x+(P^E&(L^P))+T[0]+3614090360&4294967295,x=E+(k<<7&4294967295|k>>>25),k=P+(L^x&(E^L))+T[1]+3905402710&4294967295,P=x+(k<<12&4294967295|k>>>20),k=L+(E^P&(x^E))+T[2]+606105819&4294967295,L=P+(k<<17&4294967295|k>>>15),k=E+(x^L&(P^x))+T[3]+3250441966&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(P^E&(L^P))+T[4]+4118548399&4294967295,x=E+(k<<7&4294967295|k>>>25),k=P+(L^x&(E^L))+T[5]+1200080426&4294967295,P=x+(k<<12&4294967295|k>>>20),k=L+(E^P&(x^E))+T[6]+2821735955&4294967295,L=P+(k<<17&4294967295|k>>>15),k=E+(x^L&(P^x))+T[7]+4249261313&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(P^E&(L^P))+T[8]+1770035416&4294967295,x=E+(k<<7&4294967295|k>>>25),k=P+(L^x&(E^L))+T[9]+2336552879&4294967295,P=x+(k<<12&4294967295|k>>>20),k=L+(E^P&(x^E))+T[10]+4294925233&4294967295,L=P+(k<<17&4294967295|k>>>15),k=E+(x^L&(P^x))+T[11]+2304563134&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(P^E&(L^P))+T[12]+1804603682&4294967295,x=E+(k<<7&4294967295|k>>>25),k=P+(L^x&(E^L))+T[13]+4254626195&4294967295,P=x+(k<<12&4294967295|k>>>20),k=L+(E^P&(x^E))+T[14]+2792965006&4294967295,L=P+(k<<17&4294967295|k>>>15),k=E+(x^L&(P^x))+T[15]+1236535329&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(L^P&(E^L))+T[1]+4129170786&4294967295,x=E+(k<<5&4294967295|k>>>27),k=P+(E^L&(x^E))+T[6]+3225465664&4294967295,P=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(P^x))+T[11]+643717713&4294967295,L=P+(k<<14&4294967295|k>>>18),k=E+(P^x&(L^P))+T[0]+3921069994&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^P&(E^L))+T[5]+3593408605&4294967295,x=E+(k<<5&4294967295|k>>>27),k=P+(E^L&(x^E))+T[10]+38016083&4294967295,P=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(P^x))+T[15]+3634488961&4294967295,L=P+(k<<14&4294967295|k>>>18),k=E+(P^x&(L^P))+T[4]+3889429448&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^P&(E^L))+T[9]+568446438&4294967295,x=E+(k<<5&4294967295|k>>>27),k=P+(E^L&(x^E))+T[14]+3275163606&4294967295,P=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(P^x))+T[3]+4107603335&4294967295,L=P+(k<<14&4294967295|k>>>18),k=E+(P^x&(L^P))+T[8]+1163531501&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^P&(E^L))+T[13]+2850285829&4294967295,x=E+(k<<5&4294967295|k>>>27),k=P+(E^L&(x^E))+T[2]+4243563512&4294967295,P=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(P^x))+T[7]+1735328473&4294967295,L=P+(k<<14&4294967295|k>>>18),k=E+(P^x&(L^P))+T[12]+2368359562&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(E^L^P)+T[5]+4294588738&4294967295,x=E+(k<<4&4294967295|k>>>28),k=P+(x^E^L)+T[8]+2272392833&4294967295,P=x+(k<<11&4294967295|k>>>21),k=L+(P^x^E)+T[11]+1839030562&4294967295,L=P+(k<<16&4294967295|k>>>16),k=E+(L^P^x)+T[14]+4259657740&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^P)+T[1]+2763975236&4294967295,x=E+(k<<4&4294967295|k>>>28),k=P+(x^E^L)+T[4]+1272893353&4294967295,P=x+(k<<11&4294967295|k>>>21),k=L+(P^x^E)+T[7]+4139469664&4294967295,L=P+(k<<16&4294967295|k>>>16),k=E+(L^P^x)+T[10]+3200236656&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^P)+T[13]+681279174&4294967295,x=E+(k<<4&4294967295|k>>>28),k=P+(x^E^L)+T[0]+3936430074&4294967295,P=x+(k<<11&4294967295|k>>>21),k=L+(P^x^E)+T[3]+3572445317&4294967295,L=P+(k<<16&4294967295|k>>>16),k=E+(L^P^x)+T[6]+76029189&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^P)+T[9]+3654602809&4294967295,x=E+(k<<4&4294967295|k>>>28),k=P+(x^E^L)+T[12]+3873151461&4294967295,P=x+(k<<11&4294967295|k>>>21),k=L+(P^x^E)+T[15]+530742520&4294967295,L=P+(k<<16&4294967295|k>>>16),k=E+(L^P^x)+T[2]+3299628645&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(L^(E|~P))+T[0]+4096336452&4294967295,x=E+(k<<6&4294967295|k>>>26),k=P+(E^(x|~L))+T[7]+1126891415&4294967295,P=x+(k<<10&4294967295|k>>>22),k=L+(x^(P|~E))+T[14]+2878612391&4294967295,L=P+(k<<15&4294967295|k>>>17),k=E+(P^(L|~x))+T[5]+4237533241&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~P))+T[12]+1700485571&4294967295,x=E+(k<<6&4294967295|k>>>26),k=P+(E^(x|~L))+T[3]+2399980690&4294967295,P=x+(k<<10&4294967295|k>>>22),k=L+(x^(P|~E))+T[10]+4293915773&4294967295,L=P+(k<<15&4294967295|k>>>17),k=E+(P^(L|~x))+T[1]+2240044497&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~P))+T[8]+1873313359&4294967295,x=E+(k<<6&4294967295|k>>>26),k=P+(E^(x|~L))+T[15]+4264355552&4294967295,P=x+(k<<10&4294967295|k>>>22),k=L+(x^(P|~E))+T[6]+2734768916&4294967295,L=P+(k<<15&4294967295|k>>>17),k=E+(P^(L|~x))+T[13]+1309151649&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~P))+T[4]+4149444226&4294967295,x=E+(k<<6&4294967295|k>>>26),k=P+(E^(x|~L))+T[11]+3174756917&4294967295,P=x+(k<<10&4294967295|k>>>22),k=L+(x^(P|~E))+T[2]+718787259&4294967295,L=P+(k<<15&4294967295|k>>>17),k=E+(P^(L|~x))+T[9]+3951481745&4294967295,A.g[0]=A.g[0]+x&4294967295,A.g[1]=A.g[1]+(L+(k<<21&4294967295|k>>>11))&4294967295,A.g[2]=A.g[2]+L&4294967295,A.g[3]=A.g[3]+P&4294967295}n.prototype.v=function(A,x){x===void 0&&(x=A.length);const E=x-this.blockSize,T=this.C;let L=this.h,P=0;for(;P<x;){if(L==0)for(;P<=E;)r(this,A,P),P+=this.blockSize;if(typeof A=="string"){for(;P<x;)if(T[L++]=A.charCodeAt(P++),L==this.blockSize){r(this,T),L=0;break}}else for(;P<x;)if(T[L++]=A[P++],L==this.blockSize){r(this,T),L=0;break}}this.h=L,this.o+=x},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var x=1;x<A.length-8;++x)A[x]=0;x=this.o*8;for(var E=A.length-8;E<A.length;++E)A[E]=x&255,x/=256;for(this.v(A),A=Array(16),x=0,E=0;E<4;++E)for(let T=0;T<32;T+=8)A[x++]=this.g[E]>>>T&255;return A};function i(A,x){var E=c;return Object.prototype.hasOwnProperty.call(E,A)?E[A]:E[A]=x(A)}function a(A,x){this.h=x;const E=[];let T=!0;for(let L=A.length-1;L>=0;L--){const P=A[L]|0;T&&P==x||(E[L]=P,T=!1)}this.g=E}var c={};function m(A){return-128<=A&&A<128?i(A,function(x){return new a([x|0],x<0?-1:0)}):new a([A|0],A<0?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return h;if(A<0)return C(u(-A));const x=[];let E=1;for(let T=0;A>=E;T++)x[T]=A/E|0,E*=4294967296;return new a(x,0)}function d(A,x){if(A.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(A.charAt(0)=="-")return C(d(A.substring(1),x));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=u(Math.pow(x,8));let T=h;for(let P=0;P<A.length;P+=8){var L=Math.min(8,A.length-P);const k=parseInt(A.substring(P,P+L),x);L<8?(L=u(Math.pow(x,L)),T=T.j(L).add(u(k))):(T=T.j(E),T=T.add(u(k)))}return T}var h=m(0),p=m(1),b=m(16777216);t=a.prototype,t.m=function(){if(v(this))return-C(this).m();let A=0,x=1;for(let E=0;E<this.g.length;E++){const T=this.i(E);A+=(T>=0?T:4294967296+T)*x,x*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(w(this))return"0";if(v(this))return"-"+C(this).toString(A);const x=u(Math.pow(A,6));var E=this;let T="";for(;;){const L=ie(E,x).g;E=R(E,L.j(x));let P=((E.g.length>0?E.g[0]:E.h)>>>0).toString(A);if(E=L,w(E))return P+T;for(;P.length<6;)P="0"+P;T=P+T}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function w(A){if(A.h!=0)return!1;for(let x=0;x<A.g.length;x++)if(A.g[x]!=0)return!1;return!0}function v(A){return A.h==-1}t.l=function(A){return A=R(this,A),v(A)?-1:w(A)?0:1};function C(A){const x=A.g.length,E=[];for(let T=0;T<x;T++)E[T]=~A.g[T];return new a(E,~A.h).add(p)}t.abs=function(){return v(this)?C(this):this},t.add=function(A){const x=Math.max(this.g.length,A.g.length),E=[];let T=0;for(let L=0;L<=x;L++){let P=T+(this.i(L)&65535)+(A.i(L)&65535),k=(P>>>16)+(this.i(L)>>>16)+(A.i(L)>>>16);T=k>>>16,P&=65535,k&=65535,E[L]=k<<16|P}return new a(E,E[E.length-1]&-2147483648?-1:0)};function R(A,x){return A.add(C(x))}t.j=function(A){if(w(this)||w(A))return h;if(v(this))return v(A)?C(this).j(C(A)):C(C(this).j(A));if(v(A))return C(this.j(C(A)));if(this.l(b)<0&&A.l(b)<0)return u(this.m()*A.m());const x=this.g.length+A.g.length,E=[];for(var T=0;T<2*x;T++)E[T]=0;for(T=0;T<this.g.length;T++)for(let L=0;L<A.g.length;L++){const P=this.i(T)>>>16,k=this.i(T)&65535,ke=A.i(L)>>>16,Re=A.i(L)&65535;E[2*T+2*L]+=k*Re,I(E,2*T+2*L),E[2*T+2*L+1]+=P*Re,I(E,2*T+2*L+1),E[2*T+2*L+1]+=k*ke,I(E,2*T+2*L+1),E[2*T+2*L+2]+=P*ke,I(E,2*T+2*L+2)}for(A=0;A<x;A++)E[A]=E[2*A+1]<<16|E[2*A];for(A=x;A<2*x;A++)E[A]=0;return new a(E,0)};function I(A,x){for(;(A[x]&65535)!=A[x];)A[x+1]+=A[x]>>>16,A[x]&=65535,x++}function z(A,x){this.g=A,this.h=x}function ie(A,x){if(w(x))throw Error("division by zero");if(w(A))return new z(h,h);if(v(A))return x=ie(C(A),x),new z(C(x.g),C(x.h));if(v(x))return x=ie(A,C(x)),new z(C(x.g),x.h);if(A.g.length>30){if(v(A)||v(x))throw Error("slowDivide_ only works with positive integers.");for(var E=p,T=x;T.l(A)<=0;)E=te(E),T=te(T);var L=O(E,1),P=O(T,1);for(T=O(T,2),E=O(E,2);!w(T);){var k=P.add(T);k.l(A)<=0&&(L=L.add(E),P=k),T=O(T,1),E=O(E,1)}return x=R(A,L.j(x)),new z(L,x)}for(L=h;A.l(x)>=0;){for(E=Math.max(1,Math.floor(A.m()/x.m())),T=Math.ceil(Math.log(E)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),P=u(E),k=P.j(x);v(k)||k.l(A)>0;)E-=T,P=u(E),k=P.j(x);w(P)&&(P=p),L=L.add(P),A=R(A,k)}return new z(L,A)}t.B=function(A){return ie(this,A).h},t.and=function(A){const x=Math.max(this.g.length,A.g.length),E=[];for(let T=0;T<x;T++)E[T]=this.i(T)&A.i(T);return new a(E,this.h&A.h)},t.or=function(A){const x=Math.max(this.g.length,A.g.length),E=[];for(let T=0;T<x;T++)E[T]=this.i(T)|A.i(T);return new a(E,this.h|A.h)},t.xor=function(A){const x=Math.max(this.g.length,A.g.length),E=[];for(let T=0;T<x;T++)E[T]=this.i(T)^A.i(T);return new a(E,this.h^A.h)};function te(A){const x=A.g.length+1,E=[];for(let T=0;T<x;T++)E[T]=A.i(T)<<1|A.i(T-1)>>>31;return new a(E,A.h)}function O(A,x){const E=x>>5;x%=32;const T=A.g.length-E,L=[];for(let P=0;P<T;P++)L[P]=x>0?A.i(P+E)>>>x|A.i(P+E+1)<<32-x:A.i(P+E);return new a(L,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,sh=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=d,_r=a}).apply(typeof bd<"u"?bd:typeof self<"u"?self:typeof window<"u"?window:{});var ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nh,Vo,rh,Wa,Wc,ih,oh,ah;(function(){var t,e=Object.defineProperty;function s(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof ka=="object"&&ka];for(var f=0;f<l.length;++f){var y=l[f];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var n=s(this);function r(l,f){if(f)e:{var y=n;l=l.split(".");for(var _=0;_<l.length-1;_++){var K=l[_];if(!(K in y))break e;y=y[K]}l=l[l.length-1],_=y[l],f=f(_),f!=_&&f!=null&&e(y,l,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(l){return l||function(f){var y=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&y.push([_,f[_]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function c(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function m(l,f,y){return l.call.apply(l.bind,arguments)}function u(l,f,y){return u=m,u.apply(null,arguments)}function d(l,f){var y=Array.prototype.slice.call(arguments,1);return function(){var _=y.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function h(l,f){function y(){}y.prototype=f.prototype,l.Z=f.prototype,l.prototype=new y,l.prototype.constructor=l,l.Ob=function(_,K,J){for(var _e=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)_e[dt-2]=arguments[dt];return f.prototype[K].apply(_,_e)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function b(l){const f=l.length;if(f>0){const y=Array(f);for(let _=0;_<f;_++)y[_]=l[_];return y}return[]}function w(l,f){for(let _=1;_<arguments.length;_++){const K=arguments[_];var y=typeof K;if(y=y!="object"?y:K?Array.isArray(K)?"array":y:"null",y=="array"||y=="object"&&typeof K.length=="number"){y=l.length||0;const J=K.length||0;l.length=y+J;for(let _e=0;_e<J;_e++)l[y+_e]=K[_e]}else l.push(K)}}class v{constructor(f,y){this.i=f,this.j=y,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function C(l){a.setTimeout(()=>{throw l},0)}function R(){var l=A;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class I{constructor(){this.h=this.g=null}add(f,y){const _=z.get();_.set(f,y),this.h?this.h.next=_:this.g=_,this.h=_}}var z=new v(()=>new ie,l=>l.reset());class ie{constructor(){this.next=this.g=this.h=null}set(f,y){this.h=f,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let te,O=!1,A=new I,x=()=>{const l=Promise.resolve(void 0);te=()=>{l.then(E)}};function E(){for(var l;l=R();){try{l.h.call(l.g)}catch(y){C(y)}var f=z;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}O=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const y=()=>{};a.addEventListener("test",y,f),a.removeEventListener("test",y,f)}catch{}return l}();function k(l){return/^[\s\xa0]*$/.test(l)}function ke(l,f){L.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}h(ke,L),ke.prototype.init=function(l,f){const y=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(y=="mouseover"?f=l.fromElement:y=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&ke.Z.h.call(this)},ke.prototype.h=function(){ke.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Re="closure_listenable_"+(Math.random()*1e6|0),ye=0;function Ie(l,f,y,_,K){this.listener=l,this.proxy=null,this.src=f,this.type=y,this.capture=!!_,this.ha=K,this.key=++ye,this.da=this.fa=!1}function rt(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Lt(l,f,y){for(const _ in l)f.call(y,l[_],_,l)}function Ht(l,f){for(const y in l)f.call(void 0,l[y],y,l)}function me(l){const f={};for(const y in l)f[y]=l[y];return f}const He="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ge(l,f){let y,_;for(let K=1;K<arguments.length;K++){_=arguments[K];for(y in _)l[y]=_[y];for(let J=0;J<He.length;J++)y=He[J],Object.prototype.hasOwnProperty.call(_,y)&&(l[y]=_[y])}}function xt(l){this.src=l,this.g={},this.h=0}xt.prototype.add=function(l,f,y,_,K){const J=l.toString();l=this.g[J],l||(l=this.g[J]=[],this.h++);const _e=qe(l,f,_,K);return _e>-1?(f=l[_e],y||(f.fa=!1)):(f=new Ie(f,this.src,J,!!_,K),f.fa=y,l.push(f)),f};function fe(l,f){const y=f.type;if(y in l.g){var _=l.g[y],K=Array.prototype.indexOf.call(_,f,void 0),J;(J=K>=0)&&Array.prototype.splice.call(_,K,1),J&&(rt(f),l.g[y].length==0&&(delete l.g[y],l.h--))}}function qe(l,f,y,_){for(let K=0;K<l.length;++K){const J=l[K];if(!J.da&&J.listener==f&&J.capture==!!y&&J.ha==_)return K}return-1}var ze="closure_lm_"+(Math.random()*1e6|0),ft={};function tt(l,f,y,_,K){if(Array.isArray(f)){for(let J=0;J<f.length;J++)tt(l,f[J],y,_,K);return null}return y=Ot(y),l&&l[Re]?l.J(f,y,c(_)?!!_.capture:!1,K):Bt(l,f,y,!1,_,K)}function Bt(l,f,y,_,K,J){if(!f)throw Error("Invalid event type");const _e=c(K)?!!K.capture:!!K;let dt=$e(l);if(dt||(l[ze]=dt=new xt(l)),y=dt.add(f,y,_,_e,J),y.proxy)return y;if(_=ds(),y.proxy=_,_.src=l,_.listener=y,l.addEventListener)P||(K=_e),K===void 0&&(K=!1),l.addEventListener(f.toString(),_,K);else if(l.attachEvent)l.attachEvent(Me(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return y}function ds(){function l(y){return f.call(l.src,l.listener,y)}const f=Le;return l}function W(l,f,y,_,K){if(Array.isArray(f))for(var J=0;J<f.length;J++)W(l,f[J],y,_,K);else _=c(_)?!!_.capture:!!_,y=Ot(y),l&&l[Re]?(l=l.i,J=String(f).toString(),J in l.g&&(f=l.g[J],y=qe(f,y,_,K),y>-1&&(rt(f[y]),Array.prototype.splice.call(f,y,1),f.length==0&&(delete l.g[J],l.h--)))):l&&(l=$e(l))&&(f=l.g[f.toString()],l=-1,f&&(l=qe(f,y,_,K)),(y=l>-1?f[l]:null)&&Ce(y))}function Ce(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Re])fe(f.i,l);else{var y=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(y,_,l.capture):f.detachEvent?f.detachEvent(Me(y),_):f.addListener&&f.removeListener&&f.removeListener(_),(y=$e(f))?(fe(y,l),y.h==0&&(y.src=null,f[ze]=null)):rt(l)}}}function Me(l){return l in ft?ft[l]:ft[l]="on"+l}function Le(l,f){if(l.da)l=!0;else{f=new ke(f,this);const y=l.listener,_=l.ha||l.src;l.fa&&Ce(l),l=y.call(_,f)}return l}function $e(l){return l=l[ze],l instanceof xt?l:null}var bt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ot(l){return typeof l=="function"?l:(l[bt]||(l[bt]=function(f){return l.handleEvent(f)}),l[bt])}function mt(){T.call(this),this.i=new xt(this),this.M=this,this.G=null}h(mt,T),mt.prototype[Re]=!0,mt.prototype.removeEventListener=function(l,f,y,_){W(this,l,f,y,_)};function j(l,f){var y,_=l.G;if(_)for(y=[];_;_=_.G)y.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new L(f,l);else if(f instanceof L)f.target=f.target||l;else{var K=f;f=new L(_,l),Ge(f,K)}K=!0;let J,_e;if(y)for(_e=y.length-1;_e>=0;_e--)J=f.g=y[_e],K=$(J,_,!0,f)&&K;if(J=f.g=l,K=$(J,_,!0,f)&&K,K=$(J,_,!1,f)&&K,y)for(_e=0;_e<y.length;_e++)J=f.g=y[_e],K=$(J,_,!1,f)&&K}mt.prototype.N=function(){if(mt.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const y=l.g[f];for(let _=0;_<y.length;_++)rt(y[_]);delete l.g[f],l.h--}}this.G=null},mt.prototype.J=function(l,f,y,_){return this.i.add(String(l),f,!1,y,_)},mt.prototype.K=function(l,f,y,_){return this.i.add(String(l),f,!0,y,_)};function $(l,f,y,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let K=!0;for(let J=0;J<f.length;++J){const _e=f[J];if(_e&&!_e.da&&_e.capture==y){const dt=_e.listener,As=_e.ha||_e.src;_e.fa&&fe(l.i,_e),K=dt.call(As,_)!==!1&&K}}return K&&!_.defaultPrevented}function X(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=u(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:a.setTimeout(l,f||0)}function ge(l){l.g=X(()=>{l.g=null,l.i&&(l.i=!1,ge(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class ae extends T{constructor(f,y){super(),this.m=f,this.l=y,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(l){T.call(this),this.h=l,this.g={}}h(de,T);var Ee=[];function Ke(l){Lt(l.g,function(f,y){this.g.hasOwnProperty(y)&&Ce(f)},l),l.g={}}de.prototype.N=function(){de.Z.N.call(this),Ke(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var st=a.JSON.stringify,Ne=a.JSON.parse,fs=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Pt(){}function it(){}var ss={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function V(){L.call(this,"d")}h(V,L);function oe(){L.call(this,"c")}h(oe,L);var De={},Be=null;function ue(){return Be=Be||new mt}De.Ia="serverreachability";function jt(l){L.call(this,De.Ia,l)}h(jt,L);function Nt(l){const f=ue();j(f,new jt(f))}De.STAT_EVENT="statevent";function zt(l,f){L.call(this,De.STAT_EVENT,l),this.stat=f}h(zt,L);function pt(l){const f=ue();j(f,new zt(f,l))}De.Ja="timingevent";function Xt(l,f){L.call(this,De.Ja,l),this.size=f}h(Xt,L);function Jt(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function Ss(){this.g=!0}Ss.prototype.ua=function(){this.g=!1};function fn(l,f,y,_,K,J){l.info(function(){if(l.g)if(J){var _e="",dt=J.split("&");for(let $t=0;$t<dt.length;$t++){var As=dt[$t].split("=");if(As.length>1){const Ls=As[0];As=As[1];const Ln=Ls.split("_");_e=Ln.length>=2&&Ln[1]=="type"?_e+(Ls+"="+As+"&"):_e+(Ls+"=redacted&")}}}else _e=null;else _e=J;return"XMLHTTP REQ ("+_+") [attempt "+K+"]: "+f+`
`+y+`
`+_e})}function Ks(l,f,y,_,K,J,_e){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+K+"]: "+f+`
`+y+`
`+J+" "+_e})}function pn(l,f,y,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+wn(l,y)+(_?" "+_:"")})}function $r(l,f){l.info(function(){return"TIMEOUT: "+f})}Ss.prototype.info=function(){};function wn(l,f){if(!l.g)return f;if(!f)return null;try{const J=JSON.parse(f);if(J){for(l=0;l<J.length;l++)if(Array.isArray(J[l])){var y=J[l];if(!(y.length<2)){var _=y[1];if(Array.isArray(_)&&!(_.length<1)){var K=_[0];if(K!="noop"&&K!="stop"&&K!="close")for(let _e=1;_e<_.length;_e++)_[_e]=""}}}}return st(J)}catch{return f}}var en={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Sn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bs;function Is(){}h(Is,Pt),Is.prototype.g=function(){return new XMLHttpRequest},Bs=new Is;function g(l){return encodeURIComponent(String(l))}function B(l){var f=1;l=l.split(":");const y=[];for(;f>0&&l.length;)y.push(l.shift()),f--;return l.length&&y.push(l.join(":")),y}function S(l,f,y,_){this.j=l,this.i=f,this.l=y,this.S=_||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new M}function M(){this.i=null,this.g="",this.h=!1}var H={},G={};function q(l,f,y){l.M=1,l.A=Wr(We(f)),l.u=y,l.R=!0,F(l,null)}function F(l,f){l.F=Date.now(),Xe(l),l.B=We(l.A);var y=l.B,_=l.S;Array.isArray(_)||(_=[String(_)]),le(y.i,"t",_),l.C=0,y=l.j.L,l.h=new M,l.g=Ku(l.j,y?f:null,!l.u),l.P>0&&(l.O=new ae(u(l.Y,l,l.g),l.P)),f=l.V,y=l.g,_=l.ba;var K="readystatechange";Array.isArray(K)||(K&&(Ee[0]=K.toString()),K=Ee);for(let J=0;J<K.length;J++){const _e=tt(y,K[J],_||f.handleEvent,!1,f.h||f);if(!_e)break;f.g[_e.key]=_e}f=l.J?me(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),Nt(),fn(l.i,l.v,l.B,l.l,l.S,l.u)}S.prototype.ba=function(l){l=l.target;const f=this.O;f&&Nn(l)==3?f.j():this.Y(l)},S.prototype.Y=function(l){try{if(l==this.g)e:{const dt=Nn(this.g),As=this.g.ya(),$t=this.g.ca();if(!(dt<3)&&(dt!=3||this.g&&(this.h.h||this.g.la()||Bu(this.g)))){this.K||dt!=4||As==7||(As==8||$t<=0?Nt(3):Nt(2)),xe(this);var f=this.g.ca();this.X=f;var y=Z(this);if(this.o=f==200,Ks(this.i,this.v,this.B,this.l,this.S,dt,f),this.o){if(this.U&&!this.L){t:{if(this.g){var _,K=this.g;if((_=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_)){var J=_;break t}}J=null}if(l=J)pn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ls(this,l);else{this.o=!1,this.m=3,pt(12),Qt(this),Ue(this);break e}}if(this.R){l=!0;let Ls;for(;!this.K&&this.C<y.length;)if(Ls=Se(this,y),Ls==G){dt==4&&(this.m=4,pt(14),l=!1),pn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ls==H){this.m=4,pt(15),pn(this.i,this.l,y,"[Invalid Chunk]"),l=!1;break}else pn(this.i,this.l,Ls,null),ls(this,Ls);if(re(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||y.length!=0||this.h.h||(this.m=1,pt(16),l=!1),this.o=this.o&&l,!l)pn(this.i,this.l,y,"[Invalid Chunked Response]"),Qt(this),Ue(this);else if(y.length>0&&!this.W){this.W=!0;var _e=this.j;_e.g==this&&_e.aa&&!_e.P&&(_e.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),cc(_e),_e.P=!0,pt(11))}}else pn(this.i,this.l,y,null),ls(this,y);dt==4&&Qt(this),this.o&&!this.K&&(dt==4?qu(this.j,this):(this.o=!1,Xe(this)))}else xb(this.g),f==400&&y.indexOf("Unknown SID")>0?(this.m=3,pt(12)):(this.m=0,pt(13)),Qt(this),Ue(this)}}}catch{}finally{}};function Z(l){if(!re(l))return l.g.la();const f=Bu(l.g);if(f==="")return"";let y="";const _=f.length,K=Nn(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Qt(l),Ue(l),"";l.h.i=new a.TextDecoder}for(let J=0;J<_;J++)l.h.h=!0,y+=l.h.i.decode(f[J],{stream:!(K&&J==_-1)});return f.length=0,l.h.g+=y,l.C=0,l.h.g}function re(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function Se(l,f){var y=l.C,_=f.indexOf(`
`,y);return _==-1?G:(y=Number(f.substring(y,_)),isNaN(y)?H:(_+=1,_+y>f.length?G:(f=f.slice(_,_+y),l.C=_+y,f)))}S.prototype.cancel=function(){this.K=!0,Qt(this)};function Xe(l){l.T=Date.now()+l.H,lt(l,l.H)}function lt(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Jt(u(l.aa,l),f)}function xe(l){l.D&&(a.clearTimeout(l.D),l.D=null)}S.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?($r(this.i,this.B),this.M!=2&&(Nt(),pt(17)),Qt(this),this.m=2,Ue(this)):lt(this,this.T-l)};function Ue(l){l.j.I==0||l.K||qu(l.j,l)}function Qt(l){xe(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,Ke(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function ls(l,f){try{var y=l.j;if(y.I!=0&&(y.g==l||Tt(y.h,l))){if(!l.L&&Tt(y.h,l)&&y.I==3){try{var _=y.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var K=_;if(K[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<l.F)xa(y),ba(y);else break e;lc(y),pt(18)}}else y.xa=K[1],0<y.xa-y.K&&K[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Jt(u(y.Va,y),6e3));Ys(y.h)<=1&&y.ta&&(y.ta=void 0)}else zr(y,11)}else if((l.L||y.g==l)&&xa(y),!k(f))for(K=y.Ba.g.parse(f),f=0;f<K.length;f++){let $t=K[f];const Ls=$t[0];if(!(Ls<=y.K))if(y.K=Ls,$t=$t[1],y.I==2)if($t[0]=="c"){y.M=$t[1],y.ba=$t[2];const Ln=$t[3];Ln!=null&&(y.ka=Ln,y.j.info("VER="+y.ka));const Kr=$t[4];Kr!=null&&(y.za=Kr,y.j.info("SVER="+y.za));const ar=$t[5];ar!=null&&typeof ar=="number"&&ar>0&&(_=1.5*ar,y.O=_,y.j.info("backChannelRequestTimeoutMs_="+_)),_=y;const lr=l.g;if(lr){const _a=lr.g?lr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_a){var J=_.h;J.g||_a.indexOf("spdy")==-1&&_a.indexOf("quic")==-1&&_a.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Pe(J,J.h),J.h=null))}if(_.G){const mc=lr.g?lr.g.getResponseHeader("X-HTTP-Session-Id"):null;mc&&(_.wa=mc,ct(_.J,_.G,mc))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-l.F,y.j.info("Handshake RTT: "+y.T+"ms")),_=y;var _e=l;if(_.na=zu(_,_.L?_.ba:null,_.W),_e.L){ve(_.h,_e);var dt=_e,As=_.O;As&&(dt.H=As),dt.D&&(xe(dt),Xe(dt)),_.g=_e}else Fu(_);y.i.length>0&&Na(y)}else $t[0]!="stop"&&$t[0]!="close"||zr(y,7);else y.I==3&&($t[0]=="stop"||$t[0]=="close"?$t[0]=="stop"?zr(y,7):ac(y):$t[0]!="noop"&&y.l&&y.l.qa($t),y.A=0)}}Nt(4)}catch{}}var tn=class{constructor(l,f){this.g=l,this.map=f}};function Zt(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qs(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ys(l){return l.h?1:l.g?l.g.size:0}function Tt(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Pe(l,f){l.g?l.g.add(f):l.h=f}function ve(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Zt.prototype.cancel=function(){if(this.i=Ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ze(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const y of l.g.values())f=f.concat(y.G);return f}return b(l.i)}var ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ut(l,f){if(l){l=l.split("&");for(let y=0;y<l.length;y++){const _=l[y].indexOf("=");let K,J=null;_>=0?(K=l[y].substring(0,_),J=l[y].substring(_+1)):K=l[y],f(K,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function je(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof je?(this.l=l.l,kt(this,l.j),this.o=l.o,this.g=l.g,_s(this,l.u),this.h=l.h,Ds(this,he(l.i)),this.m=l.m):l&&(f=String(l).match(ht))?(this.l=!1,kt(this,f[1]||"",!0),this.o=rr(f[2]||""),this.g=rr(f[3]||"",!0),_s(this,f[4]),this.h=rr(f[5]||"",!0),Ds(this,f[6]||"",!0),this.m=rr(f[7]||"")):(this.l=!1,this.i=new or(null,this.l))}je.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(ir(f,lo,!0),":");var y=this.g;return(y||f=="file")&&(l.push("//"),(f=this.o)&&l.push(ir(f,lo,!0),"@"),l.push(g(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&l.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&l.push("/"),l.push(ir(y,y.charAt(0)=="/"?nc:ya,!0))),(y=this.i.toString())&&l.push("?",y),(y=this.m)&&l.push("#",ir(y,ic)),l.join("")},je.prototype.resolve=function(l){const f=We(this);let y=!!l.j;y?kt(f,l.j):y=!!l.o,y?f.o=l.o:y=!!l.g,y?f.g=l.g:y=l.u!=null;var _=l.h;if(y)_s(f,l.u);else if(y=!!l.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var K=f.h.lastIndexOf("/");K!=-1&&(_=f.h.slice(0,K+1)+_)}if(K=_,K==".."||K==".")_="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){_=K.lastIndexOf("/",0)==0,K=K.split("/");const J=[];for(let _e=0;_e<K.length;){const dt=K[_e++];dt=="."?_&&_e==K.length&&J.push(""):dt==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),_&&_e==K.length&&J.push("")):(J.push(dt),_=!0)}_=J.join("/")}else _=K}return y?f.h=_:y=l.i.toString()!=="",y?Ds(f,he(l.i)):y=!!l.m,y&&(f.m=l.m),f};function We(l){return new je(l)}function kt(l,f,y){l.j=y?rr(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function _s(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function Ds(l,f,y){f instanceof or?(l.i=f,ot(l.i,l.l)):(y||(f=ir(f,rc)),l.i=new or(f,l.l))}function ct(l,f,y){l.i.set(f,y)}function Wr(l){return ct(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function rr(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ir(l,f,y){return typeof l=="string"?(l=encodeURI(l).replace(f,ga),y&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function ga(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var lo=/[#\/\?@]/g,ya=/[#\?:]/g,nc=/[#\?]/g,rc=/[#\?@]/g,ic=/#/g;function or(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function N(l){l.g||(l.g=new Map,l.h=0,l.i&&ut(l.i,function(f,y){l.add(decodeURIComponent(f.replace(/\+/g," ")),y)}))}t=or.prototype,t.add=function(l,f){N(this),this.i=null,l=pe(this,l);let y=this.g.get(l);return y||this.g.set(l,y=[]),y.push(f),this.h+=1,this};function U(l,f){N(l),f=pe(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Y(l,f){return N(l),f=pe(l,f),l.g.has(f)}t.forEach=function(l,f){N(this),this.g.forEach(function(y,_){y.forEach(function(K){l.call(f,K,_,this)},this)},this)};function Q(l,f){N(l);let y=[];if(typeof f=="string")Y(l,f)&&(y=y.concat(l.g.get(pe(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)y=y.concat(l[f]);return y}t.set=function(l,f){return N(this),this.i=null,l=pe(this,l),Y(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=Q(this,l),l.length>0?String(l[0]):f):f};function le(l,f,y){U(l,f),y.length>0&&(l.i=null,l.g.set(pe(l,f),b(y)),l.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var y=f[_];const K=g(y);y=Q(this,y);for(let J=0;J<y.length;J++){let _e=K;y[J]!==""&&(_e+="="+g(y[J])),l.push(_e)}}return this.i=l.join("&")};function he(l){const f=new or;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function pe(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function ot(l,f){f&&!l.j&&(N(l),l.i=null,l.g.forEach(function(y,_){const K=_.toLowerCase();_!=K&&(U(this,_),le(this,K,y))},l)),l.j=f}function gt(l,f){const y=new Ss;if(a.Image){const _=new Image;_.onload=d(wt,y,"TestLoadImage: loaded",!0,f,_),_.onerror=d(wt,y,"TestLoadImage: error",!1,f,_),_.onabort=d(wt,y,"TestLoadImage: abort",!1,f,_),_.ontimeout=d(wt,y,"TestLoadImage: timeout",!1,f,_),a.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function ps(l,f){const y=new Ss,_=new AbortController,K=setTimeout(()=>{_.abort(),wt(y,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(J=>{clearTimeout(K),J.ok?wt(y,"TestPingServer: ok",!0,f):wt(y,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(K),wt(y,"TestPingServer: error",!1,f)})}function wt(l,f,y,_,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),_(y)}catch{}}function St(){this.g=new fs}function es(l){this.i=l.Sb||null,this.h=l.ab||!1}h(es,Pt),es.prototype.g=function(){return new ks(this.i,this.h)};function ks(l,f){mt.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(ks,mt),t=ks.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,cs(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||a).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yt(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,cs(this)),this.g&&(this.readyState=3,cs(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Et(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Et(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Yt(this):cs(this),this.readyState==3&&Et(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Yt(this))},t.Na=function(l){this.g&&(this.response=l,Yt(this))},t.ga=function(){this.g&&Yt(this)};function Yt(l){l.readyState=4,l.l=null,l.j=null,l.B=null,cs(l)}t.setRequestHeader=function(l,f){this.A.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var y=f.next();!y.done;)y=y.value,l.push(y[0]+": "+y[1]),y=f.next();return l.join(`\r
`)};function cs(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ks.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Ft(l){let f="";return Lt(l,function(y,_){f+=_,f+=":",f+=y,f+=`\r
`}),f}function qt(l,f,y){e:{for(_ in y){var _=!1;break e}_=!0}_||(y=Ft(y),typeof l=="string"?y!=null&&g(y):ct(l,f,y))}function yt(l){mt.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(yt,mt);var Kt=/^https?$/i,bn=["POST","PUT"];t=yt.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,f,y,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bs.g(),this.g.onreadystatechange=p(u(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(J){In(this,J);return}if(l=y||"",y=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var K in _)y.set(K,_[K]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const J of _.keys())y.set(J,_.get(J));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(y.keys()).find(J=>J.toLowerCase()=="content-type"),K=a.FormData&&l instanceof a.FormData,!(Array.prototype.indexOf.call(bn,f,void 0)>=0)||_||K||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,_e]of y)this.g.setRequestHeader(J,_e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(J){In(this,J)}};function In(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,pi(l),hi(l)}function pi(l){l.A||(l.A=!0,j(l,"complete"),j(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,j(this,"complete"),j(this,"abort"),hi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hi(this,!0)),yt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?oc(this):this.Xa())},t.Xa=function(){oc(this)};function oc(l){if(l.h&&typeof i<"u"){if(l.v&&Nn(l)==4)setTimeout(l.Ca.bind(l),0);else if(j(l,"readystatechange"),Nn(l)==4){l.h=!1;try{const J=l.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var y;if(!(y=f)){var _;if(_=J===0){let _e=String(l.D).match(ht)[1]||null;!_e&&a.self&&a.self.location&&(_e=a.self.location.protocol.slice(0,-1)),_=!Kt.test(_e?_e.toLowerCase():"")}y=_}if(y)j(l,"complete"),j(l,"success");else{l.o=6;try{var K=Nn(l)>2?l.g.statusText:""}catch{K=""}l.l=K+" ["+l.ca()+"]",pi(l)}}finally{hi(l)}}}}function hi(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const y=l.g;l.g=null,f||j(l,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Nn(l){return l.g?l.g.readyState:0}t.ca=function(){try{return Nn(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Ne(f)}};function Bu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function xb(l){const f={};l=(l.g&&Nn(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(k(l[_]))continue;var y=B(l[_]);const K=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const J=f[K]||[];f[K]=J,J.push(y)}Ht(f,function(_){return _.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function co(l,f,y){return y&&y.internalChannelParams&&y.internalChannelParams[l]||f}function Ru(l){this.za=0,this.i=[],this.j=new Ss,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=co("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=co("baseRetryDelayMs",5e3,l),this.Za=co("retryDelaySeedMs",1e4,l),this.Ta=co("forwardChannelMaxRetries",2,l),this.va=co("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Zt(l&&l.concurrentRequestLimit),this.Ba=new St,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ru.prototype,t.ka=8,t.I=1,t.connect=function(l,f,y,_){pt(0),this.W=l,this.H=f||{},y&&_!==void 0&&(this.H.OSID=y,this.H.OAID=_),this.F=this.X,this.J=zu(this,null,this.W),Na(this)};function ac(l){if(Uu(l),l.I==3){var f=l.V++,y=We(l.J);if(ct(y,"SID",l.M),ct(y,"RID",f),ct(y,"TYPE","terminate"),mo(l,y),f=new S(l,l.j,f),f.M=2,f.A=Wr(We(y)),y=!1,a.navigator&&a.navigator.sendBeacon)try{y=a.navigator.sendBeacon(f.A.toString(),"")}catch{}!y&&a.Image&&(new Image().src=f.A,y=!0),y||(f.g=Ku(f.j,null),f.g.ea(f.A)),f.F=Date.now(),Xe(f)}Wu(l)}function ba(l){l.g&&(cc(l),l.g.cancel(),l.g=null)}function Uu(l){ba(l),l.v&&(a.clearTimeout(l.v),l.v=null),xa(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&a.clearTimeout(l.m),l.m=null)}function Na(l){if(!Qs(l.h)&&!l.m){l.m=!0;var f=l.Ea;te||x(),O||(te(),O=!0),A.add(f,l),l.D=0}}function vb(l,f){return Ys(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Jt(u(l.Ea,l,f),$u(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const K=new S(this,this.j,l);let J=this.o;if(this.U&&(J?(J=me(J),Ge(J,this.U)):J=this.U),this.u!==null||this.R||(K.J=J,J=null),this.S)e:{for(var f=0,y=0;y<this.i.length;y++){t:{var _=this.i[y];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=y;break e}if(f===4096||y===this.i.length-1){f=y+1;break e}}f=1e3}else f=1e3;f=Mu(this,K,f),y=We(this.J),ct(y,"RID",l),ct(y,"CVER",22),this.G&&ct(y,"X-HTTP-Session-Id",this.G),mo(this,y),J&&(this.R?f="headers="+g(Ft(J))+"&"+f:this.u&&qt(y,this.u,J)),Pe(this.h,K),this.Ra&&ct(y,"TYPE","init"),this.S?(ct(y,"$req",f),ct(y,"SID","null"),K.U=!0,q(K,y,null)):q(K,y,f),this.I=2}}else this.I==3&&(l?Hu(this,l):this.i.length==0||Qs(this.h)||Hu(this))};function Hu(l,f){var y;f?y=f.l:y=l.V++;const _=We(l.J);ct(_,"SID",l.M),ct(_,"RID",y),ct(_,"AID",l.K),mo(l,_),l.u&&l.o&&qt(_,l.u,l.o),y=new S(l,l.j,y,l.D+1),l.u===null&&(y.J=l.o),f&&(l.i=f.G.concat(l.i)),f=Mu(l,y,1e3),y.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Pe(l.h,y),q(y,_,f)}function mo(l,f){l.H&&Lt(l.H,function(y,_){ct(f,_,y)}),l.l&&Lt({},function(y,_){ct(f,_,y)})}function Mu(l,f,y){y=Math.min(l.i.length,y);const _=l.l?u(l.l.Ka,l.l,l):null;e:{var K=l.i;let dt=-1;for(;;){const As=["count="+y];dt==-1?y>0?(dt=K[0].g,As.push("ofs="+dt)):dt=0:As.push("ofs="+dt);let $t=!0;for(let Ls=0;Ls<y;Ls++){var J=K[Ls].g;const Ln=K[Ls].map;if(J-=dt,J<0)dt=Math.max(0,K[Ls].g-100),$t=!1;else try{J="req"+J+"_"||"";try{var _e=Ln instanceof Map?Ln:Object.entries(Ln);for(const[Kr,ar]of _e){let lr=ar;c(ar)&&(lr=st(ar)),As.push(J+Kr+"="+encodeURIComponent(lr))}}catch(Kr){throw As.push(J+"type="+encodeURIComponent("_badmap")),Kr}}catch{_&&_(Ln)}}if($t){_e=As.join("&");break e}}_e=void 0}return l=l.i.splice(0,y),f.G=l,_e}function Fu(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;te||x(),O||(te(),O=!0),A.add(f,l),l.A=0}}function lc(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Jt(u(l.Da,l),$u(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Ou(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Jt(u(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,pt(10),ba(this),Ou(this))};function cc(l){l.B!=null&&(a.clearTimeout(l.B),l.B=null)}function Ou(l){l.g=new S(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=We(l.na);ct(f,"RID","rpc"),ct(f,"SID",l.M),ct(f,"AID",l.K),ct(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&ct(f,"TO",l.ia),ct(f,"TYPE","xmlhttp"),mo(l,f),l.u&&l.o&&qt(f,l.u,l.o),l.O&&(l.g.H=l.O);var y=l.g;l=l.ba,y.M=1,y.A=Wr(We(f)),y.u=null,y.R=!0,F(y,l)}t.Va=function(){this.C!=null&&(this.C=null,ba(this),lc(this),pt(19))};function xa(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function qu(l,f){var y=null;if(l.g==f){xa(l),cc(l),l.g=null;var _=2}else if(Tt(l.h,f))y=f.G,ve(l.h,f),_=1;else return;if(l.I!=0){if(f.o)if(_==1){y=f.u?f.u.length:0,f=Date.now()-f.F;var K=l.D;_=ue(),j(_,new Xt(_,y)),Na(l)}else Fu(l);else if(K=f.m,K==3||K==0&&f.X>0||!(_==1&&vb(l,f)||_==2&&lc(l)))switch(y&&y.length>0&&(f=l.h,f.i=f.i.concat(y)),K){case 1:zr(l,5);break;case 4:zr(l,10);break;case 3:zr(l,6);break;default:zr(l,2)}}}function $u(l,f){let y=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(y*=2),y*f}function zr(l,f){if(l.j.info("Error code "+f),f==2){var y=u(l.bb,l),_=l.Ua;const K=!_;_=new je(_||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||kt(_,"https"),Wr(_),K?gt(_.toString(),y):ps(_.toString(),y)}else pt(2);l.I=0,l.l&&l.l.pa(f),Wu(l),Uu(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function Wu(l){if(l.I=0,l.ja=[],l.l){const f=Ze(l.h);(f.length!=0||l.i.length!=0)&&(w(l.ja,f),w(l.ja,l.i),l.h.i.length=0,b(l.i),l.i.length=0),l.l.oa()}}function zu(l,f,y){var _=y instanceof je?We(y):new je(y);if(_.g!="")f&&(_.g=f+"."+_.g),_s(_,_.u);else{var K=a.location;_=K.protocol,f=f?f+"."+K.hostname:K.hostname,K=+K.port;const J=new je(null);_&&kt(J,_),f&&(J.g=f),K&&_s(J,K),y&&(J.h=y),_=J}return y=l.G,f=l.wa,y&&f&&ct(_,y,f),ct(_,"VER",l.ka),mo(l,_),_}function Ku(l,f,y){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new yt(new es({ab:y})):new yt(l.ma),f.Fa(l.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qu(){}t=Qu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function va(){}va.prototype.g=function(l,f){return new an(l,f)};function an(l,f){mt.call(this),this.g=new Ru(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!k(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!k(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new gi(this)}h(an,mt),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){ac(this.g)},an.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var y={};y.__data__=l,l=y}else this.v&&(y={},y.__data__=st(l),l=y);f.i.push(new tn(f.Ya++,l)),f.I==3&&Na(f)},an.prototype.N=function(){this.g.l=null,delete this.j,ac(this.g),delete this.g,an.Z.N.call(this)};function Yu(l){V.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const y in f){l=y;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}h(Yu,V);function Gu(){oe.call(this),this.status=1}h(Gu,oe);function gi(l){this.g=l}h(gi,Qu),gi.prototype.ra=function(){j(this.g,"a")},gi.prototype.qa=function(l){j(this.g,new Yu(l))},gi.prototype.pa=function(l){j(this.g,new Gu)},gi.prototype.oa=function(){j(this.g,"b")},va.prototype.createWebChannel=va.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,ah=function(){return new va},oh=function(){return ue()},ih=De,Wc={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},en.NO_ERROR=0,en.TIMEOUT=8,en.HTTP_ERROR=6,Wa=en,Sn.COMPLETE="complete",rh=Sn,it.EventType=ss,ss.OPEN="a",ss.CLOSE="b",ss.ERROR="c",ss.MESSAGE="d",mt.prototype.listen=mt.prototype.J,Vo=it,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,nh=yt}).apply(typeof ka<"u"?ka:typeof self<"u"?self:typeof window<"u"?window:{});const Nd="@firebase/firestore",xd="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$s.UNAUTHENTICATED=new $s(null),$s.GOOGLE_CREDENTIALS=new $s("google-credentials-uid"),$s.FIRST_PARTY=new $s("first-party-uid"),$s.MOCK_USER=new $s("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xi="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni=new zp("@firebase/firestore");function Pi(){return ni.logLevel}function Ve(t,...e){if(ni.logLevel<=Vt.DEBUG){const s=e.map(Im);ni.debug(`Firestore (${Xi}): ${t}`,...s)}}function Zn(t,...e){if(ni.logLevel<=Vt.ERROR){const s=e.map(Im);ni.error(`Firestore (${Xi}): ${t}`,...s)}}function qi(t,...e){if(ni.logLevel<=Vt.WARN){const s=e.map(Im);ni.warn(`Firestore (${Xi}): ${t}`,...s)}}function Im(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(s){return JSON.stringify(s)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t,e,s){let n="Unexpected state";typeof e=="string"?n=e:s=e,lh(t,n,s)}function lh(t,e,s){let n=`FIRESTORE (${Xi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(s!==void 0)try{n+=" CONTEXT: "+JSON.stringify(s)}catch{n+=" CONTEXT: "+s}throw Zn(n),new Error(n)}function Ut(t,e,s,n){let r="Unexpected state";typeof s=="string"?r=s:n=s,t||lh(e,r,n)}function Je(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends ai{constructor(e,s){super(e,s),this.code=e,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(){this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,s){e.enqueueRetryable(()=>s($s.UNAUTHENTICATED))}shutdown(){}}class Sx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,s){this.changeListener=s,e.enqueueRetryable(()=>s(this.token.user))}shutdown(){this.changeListener=null}}class Ix{constructor(e){this.t=e,this.currentUser=$s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,s){Ut(this.o===void 0,42304);let n=this.i;const r=m=>this.i!==n?(n=this.i,s(m)):Promise.resolve();let i=new Gn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Gn,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const m=i;e.enqueueRetryable(async()=>{await m.promise,await r(this.currentUser)})},c=m=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(m=>c(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?c(m):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gn)}},0),a()}getToken(){const e=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then(n=>this.i!==e?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ut(typeof n.accessToken=="string",31837,{l:n}),new ch(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ut(e===null||typeof e=="string",2055,{h:e}),new $s(e)}}class Lx{constructor(e,s,n){this.P=e,this.T=s,this.I=n,this.type="FirstParty",this.user=$s.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Px{constructor(e,s,n){this.P=e,this.T=s,this.I=n}getToken(){return Promise.resolve(new Lx(this.P,this.T,this.I))}start(e,s){e.enqueueRetryable(()=>s($s.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class jx{constructor(e,s){this.V=s,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Gp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,s){Ut(this.o===void 0,3512);const n=i=>{i.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Ve("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?s(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const r=i=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new vd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(s=>s?(Ut(typeof s.token=="string",44558,{tokenResult:s}),this.m=s.token,new vd(s.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),s=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(s);else for(let n=0;n<t;n++)s[n]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=Tx(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<s&&(n+=e.charAt(r[i]%62))}return n}}function _t(t,e){return t<e?-1:t>e?1:0}function zc(t,e){const s=Math.min(t.length,e.length);for(let n=0;n<s;n++){const r=t.charAt(n),i=e.charAt(n);if(r!==i)return Nc(r)===Nc(i)?_t(r,i):Nc(r)?1:-1}return _t(t.length,e.length)}const Bx=55296,Rx=57343;function Nc(t){const e=t.charCodeAt(0);return e>=Bx&&e<=Rx}function $i(t,e,s){return t.length===e.length&&t.every((n,r)=>s(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d="__name__";class jn{constructor(e,s,n){s===void 0?s=0:s>e.length&&Ye(637,{offset:s,range:e.length}),n===void 0?n=e.length-s:n>e.length-s&&Ye(1746,{length:n,range:e.length-s}),this.segments=e,this.offset=s,this.len=n}get length(){return this.len}isEqual(e){return jn.comparator(this,e)===0}child(e){const s=this.segments.slice(this.offset,this.limit());return e instanceof jn?e.forEach(n=>{s.push(n)}):s.push(e),this.construct(s)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}forEach(e){for(let s=this.offset,n=this.limit();s<n;s++)e(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,s){const n=Math.min(e.length,s.length);for(let r=0;r<n;r++){const i=jn.compareSegments(e.get(r),s.get(r));if(i!==0)return i}return _t(e.length,s.length)}static compareSegments(e,s){const n=jn.isNumericId(e),r=jn.isNumericId(s);return n&&!r?-1:!n&&r?1:n&&r?jn.extractNumericId(e).compare(jn.extractNumericId(s)):zc(e,s)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _r.fromString(e.substring(4,e.length-2))}}class Wt extends jn{construct(e,s,n){return new Wt(e,s,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const s=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ae(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);s.push(...n.split("/").filter(r=>r.length>0))}return new Wt(s)}static emptyPath(){return new Wt([])}}const Ux=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hs extends jn{construct(e,s,n){return new Hs(e,s,n)}static isValidIdentifier(e){return Ux.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_d}static keyField(){return new Hs([_d])}static fromServerFormat(e){const s=[];let n="",r=0;const i=()=>{if(n.length===0)throw new Ae(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(n),n=""};let a=!1;for(;r<e.length;){const c=e[r];if(c==="\\"){if(r+1===e.length)throw new Ae(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[r+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Ae(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=m,r+=2}else c==="`"?(a=!a,r++):c!=="."||a?(n+=c,r++):(i(),r++)}if(i(),a)throw new Ae(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hs(s)}static emptyPath(){return new Hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.path=e}static fromPath(e){return new Oe(Wt.fromString(e))}static fromName(e){return new Oe(Wt.fromString(e).popFirst(5))}static empty(){return new Oe(Wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Wt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,s){return Wt.comparator(e.path,s.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oe(new Wt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(t,e,s){if(!s)throw new Ae(ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Hx(t,e,s,n){if(e===!0&&n===!0)throw new Ae(ne.INVALID_ARGUMENT,`${t} and ${s} cannot be used together.`)}function Dd(t){if(!Oe.isDocumentKey(t))throw new Ae(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function kd(t){if(Oe.isDocumentKey(t))throw new Ae(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function uh(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Cl(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ye(12329,{type:typeof t})}function Vs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ae(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=Cl(t);throw new Ae(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${s}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(t,e){const s={typeString:t};return e&&(s.value=e),s}function ia(t,e){if(!uh(t))throw new Ae(ne.INVALID_ARGUMENT,"JSON must be an object");let s;for(const n in e)if(e[n]){const r=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){s=`JSON missing required field: '${n}'`;break}const a=t[n];if(r&&typeof a!==r){s=`JSON field '${n}' must be a ${r}.`;break}if(i!==void 0&&a!==i.value){s=`Expected '${n}' field to equal '${i.value}'`;break}}if(s)throw new Ae(ne.INVALID_ARGUMENT,s);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad=-62135596800,Ed=1e6;class be{static now(){return be.fromMillis(Date.now())}static fromDate(e){return be.fromMillis(e.getTime())}static fromMillis(e){const s=Math.floor(e/1e3),n=Math.floor((e-1e3*s)*Ed);return new be(s,n)}constructor(e,s){if(this.seconds=e,this.nanoseconds=s,s<0)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(e<Ad)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ed}_compareTo(e){return this.seconds===e.seconds?_t(this.nanoseconds,e.nanoseconds):_t(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ia(e,be._jsonSchema))return new be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Ad;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:xs("string",be._jsonSchemaVersion),seconds:xs("number"),nanoseconds:xs("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new be(0,0))}static max(){return new et(new be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo=-1;function Mx(t,e){const s=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,r=et.fromTimestamp(n===1e9?new be(s+1,0):new be(s,n));return new Ar(r,Oe.empty(),e)}function Fx(t){return new Ar(t.readTime,t.key,zo)}class Ar{constructor(e,s,n){this.readTime=e,this.documentKey=s,this.largestBatchId=n}static min(){return new Ar(et.min(),Oe.empty(),zo)}static max(){return new Ar(et.max(),Oe.empty(),zo)}}function Ox(t,e){let s=t.readTime.compareTo(e.readTime);return s!==0?s:(s=Oe.comparator(t.documentKey,e.documentKey),s!==0?s:_t(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $x{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ji(t){if(t.code!==ne.FAILED_PRECONDITION||t.message!==qx)throw t;Ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)},s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)})}catch(e){return this.next(void 0,e)}next(e,s){return this.callbackAttached&&Ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(e,this.result):new ce((n,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,r)},this.catchCallback=i=>{this.wrapFailure(s,i).next(n,r)}})}toPromise(){return new Promise((e,s)=>{this.next(e,s)})}wrapUserFunction(e){try{const s=e();return s instanceof ce?s:ce.resolve(s)}catch(s){return ce.reject(s)}}wrapSuccess(e,s){return e?this.wrapUserFunction(()=>e(s)):ce.resolve(s)}wrapFailure(e,s){return e?this.wrapUserFunction(()=>e(s)):ce.reject(s)}static resolve(e){return new ce((s,n)=>{s(e)})}static reject(e){return new ce((s,n)=>{n(e)})}static waitFor(e){return new ce((s,n)=>{let r=0,i=0,a=!1;e.forEach(c=>{++r,c.next(()=>{++i,a&&i===r&&s()},m=>n(m))}),a=!0,i===r&&s()})}static or(e){let s=ce.resolve(!1);for(const n of e)s=s.next(r=>r?ce.resolve(r):n());return s}static forEach(e,s){const n=[];return e.forEach((r,i)=>{n.push(s.call(this,r,i))}),this.waitFor(n)}static mapArray(e,s){return new ce((n,r)=>{const i=e.length,a=new Array(i);let c=0;for(let m=0;m<i;m++){const u=m;s(e[u]).next(d=>{a[u]=d,++c,c===i&&n(a)},d=>r(d))}})}static doWhile(e,s){return new ce((n,r)=>{const i=()=>{e()===!0?s().next(()=>{i()},r):n()};i()})}}function Wx(t){const e=t.match(/Android ([\d.]+)/i),s=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(s)}function Zi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,s){this.previousValue=e,s&&(s.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>s.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Vl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm=-1;function wl(t){return t==null}function ol(t){return t===0&&1/t==-1/0}function zx(t){return typeof t=="number"&&Number.isInteger(t)&&!ol(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh="";function Kx(t){let e="";for(let s=0;s<t.length;s++)e.length>0&&(e=Cd(e)),e=Qx(t.get(s),e);return Cd(e)}function Qx(t,e){let s=e;const n=t.length;for(let r=0;r<n;r++){const i=t.charAt(r);switch(i){case"\0":s+="";break;case dh:s+="";break;default:s+=i}}return s}function Cd(t){return t+dh+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t){let e=0;for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&e++;return e}function jr(t,e){for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&e(s,t[s])}function fh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,s){this.comparator=e,this.root=s||Rs.EMPTY}insert(e,s){return new ts(this.comparator,this.root.insert(e,s,this.comparator).copy(null,null,Rs.BLACK,null,null))}remove(e){return new ts(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rs.BLACK,null,null))}get(e){let s=this.root;for(;!s.isEmpty();){const n=this.comparator(e,s.key);if(n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}indexOf(e){let s=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return s+n.left.size;r<0?n=n.left:(s+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((s,n)=>(e(s,n),!1))}toString(){const e=[];return this.inorderTraversal((s,n)=>(e.push(`${s}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Aa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Aa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Aa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Aa(this.root,e,this.comparator,!0)}}class Aa{constructor(e,s,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=s?n(e.key,s):1,s&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const s={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rs{constructor(e,s,n,r,i){this.key=e,this.value=s,this.color=n??Rs.RED,this.left=r??Rs.EMPTY,this.right=i??Rs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,s,n,r,i){return new Rs(e??this.key,s??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,s,n),null):i===0?r.copy(null,s,null,null,null):r.copy(null,null,null,null,r.right.insert(e,s,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Rs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,s){let n,r=this;if(s(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,s),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),s(e,r.key)===0){if(r.right.isEmpty())return Rs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,s))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ye(27949);return e+(this.isRed()?0:1)}}Rs.EMPTY=null,Rs.RED=!0,Rs.BLACK=!1;Rs.EMPTY=new class{constructor(){this.size=0}get key(){throw Ye(57766)}get value(){throw Ye(16141)}get color(){throw Ye(16727)}get left(){throw Ye(29726)}get right(){throw Ye(36894)}copy(e,s,n,r,i){return this}insert(e,s,n){return new Rs(e,s)}remove(e,s){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.comparator=e,this.data=new ts(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((s,n)=>(e(s),!1))}forEachInRange(e,s){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;s(r.key)}}forEachWhile(e,s){let n;for(n=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const s=this.data.getIteratorFrom(e);return s.hasNext()?s.getNext().key:null}getIterator(){return new wd(this.data.getIterator())}getIteratorFrom(e){return new wd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let s=this;return s.size<e.size&&(s=e,e=this),e.forEach(n=>{s=s.add(n)}),s}isEqual(e){if(!(e instanceof ws)||this.size!==e.size)return!1;const s=this.data.getIterator(),n=e.data.getIterator();for(;s.hasNext();){const r=s.getNext().key,i=n.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(s=>{e.push(s)}),e}toString(){const e=[];return this.forEach(s=>e.push(s)),"SortedSet("+e.toString()+")"}copy(e){const s=new ws(this.comparator);return s.data=e,s}}class wd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.fields=e,e.sort(Hs.comparator)}static empty(){return new cn([])}unionWith(e){let s=new ws(Hs.comparator);for(const n of this.fields)s=s.add(n);for(const n of e)s=s.add(n);return new cn(s.toArray())}covers(e){for(const s of this.fields)if(s.isPrefixOf(e))return!0;return!1}isEqual(e){return $i(this.fields,e.fields,(s,n)=>s.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const s=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new ph("Invalid base64 string: "+i):i}}(e);return new Fs(s)}static fromUint8Array(e){const s=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Fs(s)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(s){return btoa(s)}(this.binaryString)}toUint8Array(){return function(s){const n=new Uint8Array(s.length);for(let r=0;r<s.length;r++)n[r]=s.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _t(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const Yx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Er(t){if(Ut(!!t,39018),typeof t=="string"){let e=0;const s=Yx.exec(t);if(Ut(!!s,46558,{timestamp:t}),s[1]){let r=s[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ms(t.seconds),nanos:ms(t.nanos)}}function ms(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Cr(t){return typeof t=="string"?Fs.fromBase64String(t):Fs.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="server_timestamp",gh="__type__",yh="__previous_value__",bh="__local_write_time__";function jm(t){var s,n;return((n=(((s=t==null?void 0:t.mapValue)==null?void 0:s.fields)||{})[gh])==null?void 0:n.stringValue)===hh}function Sl(t){const e=t.mapValue.fields[yh];return jm(e)?Sl(e):e}function Ko(t){const e=Er(t.mapValue.fields[bh].timestampValue);return new be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(e,s,n,r,i,a,c,m,u,d){this.databaseId=e,this.appId=s,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=m,this.useFetchStreams=u,this.isUsingEmulator=d}}const al="(default)";class Qo{constructor(e,s){this.projectId=e,this.database=s||al}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database===al}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh="__type__",Xx="__max__",Ea={mapValue:{}},xh="__vector__",ll="value";function Vr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?jm(t)?4:Zx(t)?9007199254740991:Jx(t)?10:11:Ye(28295,{value:t})}function qn(t,e){if(t===e)return!0;const s=Vr(t);if(s!==Vr(e))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ko(t).isEqual(Ko(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=Er(r.timestampValue),c=Er(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return Cr(r.bytesValue).isEqual(Cr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return ms(r.geoPointValue.latitude)===ms(i.geoPointValue.latitude)&&ms(r.geoPointValue.longitude)===ms(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ms(r.integerValue)===ms(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=ms(r.doubleValue),c=ms(i.doubleValue);return a===c?ol(a)===ol(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return $i(t.arrayValue.values||[],e.arrayValue.values||[],qn);case 10:case 11:return function(r,i){const a=r.mapValue.fields||{},c=i.mapValue.fields||{};if(Vd(a)!==Vd(c))return!1;for(const m in a)if(a.hasOwnProperty(m)&&(c[m]===void 0||!qn(a[m],c[m])))return!1;return!0}(t,e);default:return Ye(52216,{left:t})}}function Yo(t,e){return(t.values||[]).find(s=>qn(s,e))!==void 0}function Wi(t,e){if(t===e)return 0;const s=Vr(t),n=Vr(e);if(s!==n)return _t(s,n);switch(s){case 0:case 9007199254740991:return 0;case 1:return _t(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=ms(i.integerValue||i.doubleValue),m=ms(a.integerValue||a.doubleValue);return c<m?-1:c>m?1:c===m?0:isNaN(c)?isNaN(m)?0:-1:1}(t,e);case 3:return Sd(t.timestampValue,e.timestampValue);case 4:return Sd(Ko(t),Ko(e));case 5:return zc(t.stringValue,e.stringValue);case 6:return function(i,a){const c=Cr(i),m=Cr(a);return c.compareTo(m)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),m=a.split("/");for(let u=0;u<c.length&&u<m.length;u++){const d=_t(c[u],m[u]);if(d!==0)return d}return _t(c.length,m.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=_t(ms(i.latitude),ms(a.latitude));return c!==0?c:_t(ms(i.longitude),ms(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Id(t.arrayValue,e.arrayValue);case 10:return function(i,a){var p,b,w,v;const c=i.fields||{},m=a.fields||{},u=(p=c[ll])==null?void 0:p.arrayValue,d=(b=m[ll])==null?void 0:b.arrayValue,h=_t(((w=u==null?void 0:u.values)==null?void 0:w.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return h!==0?h:Id(u,d)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Ea.mapValue&&a===Ea.mapValue)return 0;if(i===Ea.mapValue)return 1;if(a===Ea.mapValue)return-1;const c=i.fields||{},m=Object.keys(c),u=a.fields||{},d=Object.keys(u);m.sort(),d.sort();for(let h=0;h<m.length&&h<d.length;++h){const p=zc(m[h],d[h]);if(p!==0)return p;const b=Wi(c[m[h]],u[d[h]]);if(b!==0)return b}return _t(m.length,d.length)}(t.mapValue,e.mapValue);default:throw Ye(23264,{he:s})}}function Sd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return _t(t,e);const s=Er(t),n=Er(e),r=_t(s.seconds,n.seconds);return r!==0?r:_t(s.nanos,n.nanos)}function Id(t,e){const s=t.values||[],n=e.values||[];for(let r=0;r<s.length&&r<n.length;++r){const i=Wi(s[r],n[r]);if(i)return i}return _t(s.length,n.length)}function zi(t){return Kc(t)}function Kc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const n=Er(s);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(s){return Cr(s).toBase64()}(t.bytesValue):"referenceValue"in t?function(s){return Oe.fromName(s).toString()}(t.referenceValue):"geoPointValue"in t?function(s){return`geo(${s.latitude},${s.longitude})`}(t.geoPointValue):"arrayValue"in t?function(s){let n="[",r=!0;for(const i of s.values||[])r?r=!1:n+=",",n+=Kc(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(s){const n=Object.keys(s.fields||{}).sort();let r="{",i=!0;for(const a of n)i?i=!1:r+=",",r+=`${a}:${Kc(s.fields[a])}`;return r+"}"}(t.mapValue):Ye(61005,{value:t})}function za(t){switch(Vr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Sl(t);return e?16+za(e):16;case 5:return 2*t.stringValue.length;case 6:return Cr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,i)=>r+za(i),0)}(t.arrayValue);case 10:case 11:return function(n){let r=0;return jr(n.fields,(i,a)=>{r+=i.length+za(a)}),r}(t.mapValue);default:throw Ye(13486,{value:t})}}function Ld(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Qc(t){return!!t&&"integerValue"in t}function Tm(t){return!!t&&"arrayValue"in t}function Pd(t){return!!t&&"nullValue"in t}function jd(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ka(t){return!!t&&"mapValue"in t}function Jx(t){var s,n;return((n=(((s=t==null?void 0:t.mapValue)==null?void 0:s.fields)||{})[Nh])==null?void 0:n.stringValue)===xh}function jo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return jr(t.mapValue.fields,(s,n)=>e.mapValue.fields[s]=jo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let s=0;s<(t.arrayValue.values||[]).length;++s)e.arrayValue.values[s]=jo(t.arrayValue.values[s]);return e}return{...t}}function Zx(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Xx}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let s=this.value;for(let n=0;n<e.length-1;++n)if(s=(s.mapValue.fields||{})[e.get(n)],!Ka(s))return null;return s=(s.mapValue.fields||{})[e.lastSegment()],s||null}}set(e,s){this.getFieldsMap(e.popLast())[e.lastSegment()]=jo(s)}setAll(e){let s=Hs.emptyPath(),n={},r=[];e.forEach((a,c)=>{if(!s.isImmediateParentOf(c)){const m=this.getFieldsMap(s);this.applyChanges(m,n,r),n={},r=[],s=c.popLast()}a?n[c.lastSegment()]=jo(a):r.push(c.lastSegment())});const i=this.getFieldsMap(s);this.applyChanges(i,n,r)}delete(e){const s=this.field(e.popLast());Ka(s)&&s.mapValue.fields&&delete s.mapValue.fields[e.lastSegment()]}isEqual(e){return qn(this.value,e.value)}getFieldsMap(e){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=s.mapValue.fields[e.get(n)];Ka(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},s.mapValue.fields[e.get(n)]=r),s=r}return s.mapValue.fields}applyChanges(e,s,n){jr(s,(r,i)=>e[r]=i);for(const r of n)delete e[r]}clone(){return new on(jo(this.value))}}function vh(t){const e=[];return jr(t.fields,(s,n)=>{const r=new Hs([s]);if(Ka(n)){const i=vh(n.mapValue).fields;if(i.length===0)e.push(r);else for(const a of i)e.push(r.child(a))}else e.push(r)}),new cn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,s,n,r,i,a,c){this.key=e,this.documentType=s,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ws(e,0,et.min(),et.min(),et.min(),on.empty(),0)}static newFoundDocument(e,s,n,r){return new Ws(e,1,s,et.min(),n,r,0)}static newNoDocument(e,s){return new Ws(e,2,s,et.min(),et.min(),on.empty(),0)}static newUnknownDocument(e,s){return new Ws(e,3,s,et.min(),et.min(),on.empty(),2)}convertToFoundDocument(e,s){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ws&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ws(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,s){this.position=e,this.inclusive=s}}function Td(t,e,s){let n=0;for(let r=0;r<t.position.length;r++){const i=e[r],a=t.position[r];if(i.field.isKeyField()?n=Oe.comparator(Oe.fromName(a.referenceValue),s.key):n=Wi(a,s.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Bd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let s=0;s<t.position.length;s++)if(!qn(t.position[s],e.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,s="asc"){this.field=e,this.dir=s}}function ev(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{}class Ns extends _h{constructor(e,s,n){super(),this.field=e,this.op=s,this.value=n}static create(e,s,n){return e.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(e,s,n):new sv(e,s,n):s==="array-contains"?new iv(e,n):s==="in"?new ov(e,n):s==="not-in"?new av(e,n):s==="array-contains-any"?new lv(e,n):new Ns(e,s,n)}static createKeyFieldInFilter(e,s,n){return s==="in"?new nv(e,n):new rv(e,n)}matches(e){const s=e.data.field(this.field);return this.op==="!="?s!==null&&s.nullValue===void 0&&this.matchesComparison(Wi(s,this.value)):s!==null&&Vr(this.value)===Vr(s)&&this.matchesComparison(Wi(s,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class En extends _h{constructor(e,s){super(),this.filters=e,this.op=s,this.Pe=null}static create(e,s){return new En(e,s)}matches(e){return Dh(this)?this.filters.find(s=>!s.matches(e))===void 0:this.filters.find(s=>s.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,s)=>e.concat(s.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Dh(t){return t.op==="and"}function kh(t){return tv(t)&&Dh(t)}function tv(t){for(const e of t.filters)if(e instanceof En)return!1;return!0}function Yc(t){if(t instanceof Ns)return t.field.canonicalString()+t.op.toString()+zi(t.value);if(kh(t))return t.filters.map(e=>Yc(e)).join(",");{const e=t.filters.map(s=>Yc(s)).join(",");return`${t.op}(${e})`}}function Ah(t,e){return t instanceof Ns?function(n,r){return r instanceof Ns&&n.op===r.op&&n.field.isEqual(r.field)&&qn(n.value,r.value)}(t,e):t instanceof En?function(n,r){return r instanceof En&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((i,a,c)=>i&&Ah(a,r.filters[c]),!0):!1}(t,e):void Ye(19439)}function Eh(t){return t instanceof Ns?function(s){return`${s.field.canonicalString()} ${s.op} ${zi(s.value)}`}(t):t instanceof En?function(s){return s.op.toString()+" {"+s.getFilters().map(Eh).join(" ,")+"}"}(t):"Filter"}class sv extends Ns{constructor(e,s,n){super(e,s,n),this.key=Oe.fromName(n.referenceValue)}matches(e){const s=Oe.comparator(e.key,this.key);return this.matchesComparison(s)}}class nv extends Ns{constructor(e,s){super(e,"in",s),this.keys=Ch("in",s)}matches(e){return this.keys.some(s=>s.isEqual(e.key))}}class rv extends Ns{constructor(e,s){super(e,"not-in",s),this.keys=Ch("not-in",s)}matches(e){return!this.keys.some(s=>s.isEqual(e.key))}}function Ch(t,e){var s;return(((s=e.arrayValue)==null?void 0:s.values)||[]).map(n=>Oe.fromName(n.referenceValue))}class iv extends Ns{constructor(e,s){super(e,"array-contains",s)}matches(e){const s=e.data.field(this.field);return Tm(s)&&Yo(s.arrayValue,this.value)}}class ov extends Ns{constructor(e,s){super(e,"in",s)}matches(e){const s=e.data.field(this.field);return s!==null&&Yo(this.value.arrayValue,s)}}class av extends Ns{constructor(e,s){super(e,"not-in",s)}matches(e){if(Yo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=e.data.field(this.field);return s!==null&&s.nullValue===void 0&&!Yo(this.value.arrayValue,s)}}class lv extends Ns{constructor(e,s){super(e,"array-contains-any",s)}matches(e){const s=e.data.field(this.field);return!(!Tm(s)||!s.arrayValue.values)&&s.arrayValue.values.some(n=>Yo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,s=null,n=[],r=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=s,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function Rd(t,e=null,s=[],n=[],r=null,i=null,a=null){return new cv(t,e,s,n,r,i,a)}function Bm(t){const e=Je(t);if(e.Te===null){let s=e.path.canonicalString();e.collectionGroup!==null&&(s+="|cg:"+e.collectionGroup),s+="|f:",s+=e.filters.map(n=>Yc(n)).join(","),s+="|ob:",s+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),wl(e.limit)||(s+="|l:",s+=e.limit),e.startAt&&(s+="|lb:",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map(n=>zi(n)).join(",")),e.endAt&&(s+="|ub:",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map(n=>zi(n)).join(",")),e.Te=s}return e.Te}function Rm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!ev(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(!Ah(t.filters[s],e.filters[s]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bd(t.startAt,e.startAt)&&Bd(t.endAt,e.endAt)}function Gc(t){return Oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,s=null,n=[],r=[],i=null,a="F",c=null,m=null){this.path=e,this.collectionGroup=s,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function mv(t,e,s,n,r,i,a,c){return new eo(t,e,s,n,r,i,a,c)}function Il(t){return new eo(t)}function Ud(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Vh(t){return t.collectionGroup!==null}function To(t){const e=Je(t);if(e.Ie===null){e.Ie=[];const s=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),s.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ws(Hs.comparator);return a.filters.forEach(m=>{m.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(e).forEach(i=>{s.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Go(i,n))}),s.has(Hs.keyField().canonicalString())||e.Ie.push(new Go(Hs.keyField(),n))}return e.Ie}function Un(t){const e=Je(t);return e.Ee||(e.Ee=uv(e,To(t))),e.Ee}function uv(t,e){if(t.limitType==="F")return Rd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Go(r.field,i)});const s=t.endAt?new cl(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new cl(t.startAt.position,t.startAt.inclusive):null;return Rd(t.path,t.collectionGroup,e,t.filters,t.limit,s,n)}}function Xc(t,e){const s=t.filters.concat([e]);return new eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),s,t.limit,t.limitType,t.startAt,t.endAt)}function Jc(t,e,s){return new eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,s,t.startAt,t.endAt)}function Ll(t,e){return Rm(Un(t),Un(e))&&t.limitType===e.limitType}function wh(t){return`${Bm(Un(t))}|lt:${t.limitType}`}function ji(t){return`Query(target=${function(s){let n=s.path.canonicalString();return s.collectionGroup!==null&&(n+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(n+=`, filters: [${s.filters.map(r=>Eh(r)).join(", ")}]`),wl(s.limit)||(n+=", limit: "+s.limit),s.orderBy.length>0&&(n+=`, orderBy: [${s.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),s.startAt&&(n+=", startAt: ",n+=s.startAt.inclusive?"b:":"a:",n+=s.startAt.position.map(r=>zi(r)).join(",")),s.endAt&&(n+=", endAt: ",n+=s.endAt.inclusive?"a:":"b:",n+=s.endAt.position.map(r=>zi(r)).join(",")),`Target(${n})`}(Un(t))}; limitType=${t.limitType})`}function Pl(t,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Oe.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,r){for(const i of To(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(a,c,m){const u=Td(a,c,m);return a.inclusive?u<=0:u<0}(n.startAt,To(n),r)||n.endAt&&!function(a,c,m){const u=Td(a,c,m);return a.inclusive?u>=0:u>0}(n.endAt,To(n),r))}(t,e)}function dv(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Sh(t){return(e,s)=>{let n=!1;for(const r of To(t)){const i=fv(r,e,s);if(i!==0)return i;n=n||r.field.isKeyField()}return 0}}function fv(t,e,s){const n=t.field.isKeyField()?Oe.comparator(e.key,s.key):function(i,a,c){const m=a.data.field(i),u=c.data.field(i);return m!==null&&u!==null?Wi(m,u):Ye(42886)}(t.field,e,s);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ye(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,s){this.mapKeyFn=e,this.equalsFn=s,this.inner={},this.innerSize=0}get(e){const s=this.mapKeyFn(e),n=this.inner[s];if(n!==void 0){for(const[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,s){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,s]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,s]);r.push([e,s]),this.innerSize++}delete(e){const s=this.mapKeyFn(e),n=this.inner[s];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[s]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){jr(this.inner,(s,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return fh(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv=new ts(Oe.comparator);function er(){return pv}const Ih=new ts(Oe.comparator);function wo(...t){let e=Ih;for(const s of t)e=e.insert(s.key,s);return e}function Lh(t){let e=Ih;return t.forEach((s,n)=>e=e.insert(s,n.overlayedDocument)),e}function Xr(){return Bo()}function Ph(){return Bo()}function Bo(){return new li(t=>t.toString(),(t,e)=>t.isEqual(e))}const hv=new ts(Oe.comparator),gv=new ws(Oe.comparator);function Dt(...t){let e=gv;for(const s of t)e=e.add(s);return e}const yv=new ws(_t);function bv(){return yv}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ol(e)?"-0":e}}function jh(t){return{integerValue:""+t}}function Nv(t,e){return zx(e)?jh(e):Um(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(){this._=void 0}}function xv(t,e,s){return t instanceof Xo?function(r,i){const a={fields:{[gh]:{stringValue:hh},[bh]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&jm(i)&&(i=Sl(i)),i&&(a.fields[yh]=i),{mapValue:a}}(s,e):t instanceof Jo?Bh(t,e):t instanceof Zo?Rh(t,e):function(r,i){const a=Th(r,i),c=Hd(a)+Hd(r.Ae);return Qc(a)&&Qc(r.Ae)?jh(c):Um(r.serializer,c)}(t,e)}function vv(t,e,s){return t instanceof Jo?Bh(t,e):t instanceof Zo?Rh(t,e):s}function Th(t,e){return t instanceof ml?function(n){return Qc(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Xo extends jl{}class Jo extends jl{constructor(e){super(),this.elements=e}}function Bh(t,e){const s=Uh(e);for(const n of t.elements)s.some(r=>qn(r,n))||s.push(n);return{arrayValue:{values:s}}}class Zo extends jl{constructor(e){super(),this.elements=e}}function Rh(t,e){let s=Uh(e);for(const n of t.elements)s=s.filter(r=>!qn(r,n));return{arrayValue:{values:s}}}class ml extends jl{constructor(e,s){super(),this.serializer=e,this.Ae=s}}function Hd(t){return ms(t.integerValue||t.doubleValue)}function Uh(t){return Tm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,s){this.field=e,this.transform=s}}function Dv(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof Jo&&r instanceof Jo||n instanceof Zo&&r instanceof Zo?$i(n.elements,r.elements,qn):n instanceof ml&&r instanceof ml?qn(n.Ae,r.Ae):n instanceof Xo&&r instanceof Xo}(t.transform,e.transform)}class kv{constructor(e,s){this.version=e,this.transformResults=s}}class Zs{constructor(e,s){this.updateTime=e,this.exists=s}static none(){return new Zs}static exists(e){return new Zs(void 0,e)}static updateTime(e){return new Zs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tl{}function Hh(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Bl(t.key,Zs.none()):new oa(t.key,t.data,Zs.none());{const s=t.data,n=on.empty();let r=new ws(Hs.comparator);for(let i of e.fields)if(!r.has(i)){let a=s.field(i);a===null&&i.length>1&&(i=i.popLast(),a=s.field(i)),a===null?n.delete(i):n.set(i,a),r=r.add(i)}return new Tr(t.key,n,new cn(r.toArray()),Zs.none())}}function Av(t,e,s){t instanceof oa?function(r,i,a){const c=r.value.clone(),m=Fd(r.fieldTransforms,i,a.transformResults);c.setAll(m),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,s):t instanceof Tr?function(r,i,a){if(!Qa(r.precondition,i))return void i.convertToUnknownDocument(a.version);const c=Fd(r.fieldTransforms,i,a.transformResults),m=i.data;m.setAll(Mh(r)),m.setAll(c),i.convertToFoundDocument(a.version,m).setHasCommittedMutations()}(t,e,s):function(r,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,s)}function Ro(t,e,s,n){return t instanceof oa?function(i,a,c,m){if(!Qa(i.precondition,a))return c;const u=i.value.clone(),d=Od(i.fieldTransforms,m,a);return u.setAll(d),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,s,n):t instanceof Tr?function(i,a,c,m){if(!Qa(i.precondition,a))return c;const u=Od(i.fieldTransforms,m,a),d=a.data;return d.setAll(Mh(i)),d.setAll(u),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,s,n):function(i,a,c){return Qa(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,s)}function Ev(t,e){let s=null;for(const n of t.fieldTransforms){const r=e.data.field(n.field),i=Th(n.transform,r||null);i!=null&&(s===null&&(s=on.empty()),s.set(n.field,i))}return s||null}function Md(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&$i(n,r,(i,a)=>Dv(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class oa extends Tl{constructor(e,s,n,r=[]){super(),this.key=e,this.value=s,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Tr extends Tl{constructor(e,s,n,r,i=[]){super(),this.key=e,this.data=s,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Mh(t){const e=new Map;return t.fieldMask.fields.forEach(s=>{if(!s.isEmpty()){const n=t.data.field(s);e.set(s,n)}}),e}function Fd(t,e,s){const n=new Map;Ut(t.length===s.length,32656,{Re:s.length,Ve:t.length});for(let r=0;r<s.length;r++){const i=t[r],a=i.transform,c=e.data.field(i.field);n.set(i.field,vv(a,c,s[r]))}return n}function Od(t,e,s){const n=new Map;for(const r of t){const i=r.transform,a=s.data.field(r.field);n.set(r.field,xv(i,a,e))}return n}class Bl extends Tl{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Cv extends Tl{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,s,n,r){this.batchId=e,this.localWriteTime=s,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,s){const n=s.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&Av(i,e,n[r])}}applyToLocalView(e,s){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(s=Ro(n,e,s,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(s=Ro(n,e,s,this.localWriteTime));return s}applyToLocalDocumentSet(e,s){const n=Ph();return this.mutations.forEach(r=>{const i=e.get(r.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=s.has(r.key)?null:c;const m=Hh(a,c);m!==null&&n.set(r.key,m),a.isValidDocument()||a.convertToNoDocument(et.min())}),n}keys(){return this.mutations.reduce((e,s)=>e.add(s.key),Dt())}isEqual(e){return this.batchId===e.batchId&&$i(this.mutations,e.mutations,(s,n)=>Md(s,n))&&$i(this.baseMutations,e.baseMutations,(s,n)=>Md(s,n))}}class Hm{constructor(e,s,n,r){this.batch=e,this.commitVersion=s,this.mutationResults=n,this.docVersions=r}static from(e,s,n){Ut(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=function(){return hv}();const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,n[a].version);return new Hm(e,s,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,s){this.largestBatchId=e,this.mutation=s}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,s){this.count=e,this.unchangedNames=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gs,Ct;function Iv(t){switch(t){case ne.OK:return Ye(64938);case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return Ye(15467,{code:t})}}function Fh(t){if(t===void 0)return Zn("GRPC error has no .code"),ne.UNKNOWN;switch(t){case gs.OK:return ne.OK;case gs.CANCELLED:return ne.CANCELLED;case gs.UNKNOWN:return ne.UNKNOWN;case gs.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case gs.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case gs.INTERNAL:return ne.INTERNAL;case gs.UNAVAILABLE:return ne.UNAVAILABLE;case gs.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case gs.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case gs.NOT_FOUND:return ne.NOT_FOUND;case gs.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case gs.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case gs.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case gs.ABORTED:return ne.ABORTED;case gs.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case gs.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case gs.DATA_LOSS:return ne.DATA_LOSS;default:return Ye(39323,{code:t})}}(Ct=gs||(gs={}))[Ct.OK=0]="OK",Ct[Ct.CANCELLED=1]="CANCELLED",Ct[Ct.UNKNOWN=2]="UNKNOWN",Ct[Ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ct[Ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ct[Ct.NOT_FOUND=5]="NOT_FOUND",Ct[Ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ct[Ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ct[Ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ct[Ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ct[Ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ct[Ct.ABORTED=10]="ABORTED",Ct[Ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ct[Ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ct[Ct.INTERNAL=13]="INTERNAL",Ct[Ct.UNAVAILABLE=14]="UNAVAILABLE",Ct[Ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=new _r([4294967295,4294967295],0);function qd(t){const e=Lv().encode(t),s=new sh;return s.update(e),new Uint8Array(s.digest())}function $d(t){const e=new DataView(t.buffer),s=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new _r([s,n],0),new _r([r,i],0)]}class Mm{constructor(e,s,n){if(this.bitmap=e,this.padding=s,this.hashCount=n,s<0||s>=8)throw new So(`Invalid padding: ${s}`);if(n<0)throw new So(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new So(`Invalid hash count: ${n}`);if(e.length===0&&s!==0)throw new So(`Invalid padding when bitmap length is 0: ${s}`);this.ge=8*e.length-s,this.pe=_r.fromNumber(this.ge)}ye(e,s,n){let r=e.add(s.multiply(_r.fromNumber(n)));return r.compare(Pv)===1&&(r=new _r([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const s=qd(e),[n,r]=$d(s);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,r,i);if(!this.we(a))return!1}return!0}static create(e,s,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Mm(i,r,s);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const s=qd(e),[n,r]=$d(s);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,r,i);this.Se(a)}}Se(e){const s=Math.floor(e/8),n=e%8;this.bitmap[s]|=1<<n}}class So extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e,s,n,r,i){this.snapshotVersion=e,this.targetChanges=s,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,s,n){const r=new Map;return r.set(e,aa.createSynthesizedTargetChangeForCurrentChange(e,s,n)),new Rl(et.min(),r,new ts(_t),er(),Dt())}}class aa{constructor(e,s,n,r,i){this.resumeToken=e,this.current=s,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,s,n){return new aa(n,s,Dt(),Dt(),Dt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,s,n,r){this.be=e,this.removedTargetIds=s,this.key=n,this.De=r}}class Oh{constructor(e,s){this.targetId=e,this.Ce=s}}class qh{constructor(e,s,n=Fs.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=s,this.resumeToken=n,this.cause=r}}class Wd{constructor(){this.ve=0,this.Fe=zd(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Dt(),s=Dt(),n=Dt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:s=s.add(r);break;case 1:n=n.add(r);break;default:Ye(38017,{changeType:i})}}),new aa(this.Me,this.xe,e,s,n)}qe(){this.Oe=!1,this.Fe=zd()}Qe(e,s){this.Oe=!0,this.Fe=this.Fe.insert(e,s)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ut(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class jv{constructor(e){this.Ge=e,this.ze=new Map,this.je=er(),this.Je=Ca(),this.He=Ca(),this.Ye=new ts(_t)}Ze(e){for(const s of e.be)e.De&&e.De.isFoundDocument()?this.Xe(s,e.De):this.et(s,e.key,e.De);for(const s of e.removedTargetIds)this.et(s,e.key,e.De)}tt(e){this.forEachTarget(e,s=>{const n=this.nt(s);switch(e.state){case 0:this.rt(s)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(s);break;case 3:this.rt(s)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(s)&&(this.it(s),n.Le(e.resumeToken));break;default:Ye(56790,{state:e.state})}})}forEachTarget(e,s){e.targetIds.length>0?e.targetIds.forEach(s):this.ze.forEach((n,r)=>{this.rt(r)&&s(r)})}st(e){const s=e.targetId,n=e.Ce.count,r=this.ot(s);if(r){const i=r.target;if(Gc(i))if(n===0){const a=new Oe(i.path);this.et(s,a,Ws.newNoDocument(a,et.min()))}else Ut(n===1,20013,{expectedCount:n});else{const a=this._t(s);if(a!==n){const c=this.ut(e),m=c?this.ct(c,e,a):1;if(m!==0){this.it(s);const u=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(s,u)}}}}}ut(e){const s=e.Ce.unchangedNames;if(!s||!s.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=s;let a,c;try{a=Cr(n).toUint8Array()}catch(m){if(m instanceof ph)return qi("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{c=new Mm(a,r,i)}catch(m){return qi(m instanceof So?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return c.ge===0?null:c}ct(e,s,n){return s.Ce.count===n-this.Pt(e,s.targetId)?0:2}Pt(e,s){const n=this.Ge.getRemoteKeysForTarget(s);let r=0;return n.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(s,i,null),r++)}),r}Tt(e){const s=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Gc(c.target)){const m=new Oe(c.target.path);this.It(m).has(a)||this.Et(a,m)||this.et(a,m,Ws.newNoDocument(m,e))}i.Be&&(s.set(a,i.ke()),i.qe())}});let n=Dt();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(m=>{const u=this.ot(m);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const r=new Rl(e,s,this.Ye,this.je,n);return this.je=er(),this.Je=Ca(),this.He=Ca(),this.Ye=new ts(_t),r}Xe(e,s){if(!this.rt(e))return;const n=this.Et(e,s.key)?2:0;this.nt(e).Qe(s.key,n),this.je=this.je.insert(s.key,s),this.Je=this.Je.insert(s.key,this.It(s.key).add(e)),this.He=this.He.insert(s.key,this.dt(s.key).add(e))}et(e,s,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,s)?r.Qe(s,1):r.$e(s),this.He=this.He.insert(s,this.dt(s).delete(e)),this.He=this.He.insert(s,this.dt(s).add(e)),n&&(this.je=this.je.insert(s,n))}removeTarget(e){this.ze.delete(e)}_t(e){const s=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+s.addedDocuments.size-s.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let s=this.ze.get(e);return s||(s=new Wd,this.ze.set(e,s)),s}dt(e){let s=this.He.get(e);return s||(s=new ws(_t),this.He=this.He.insert(e,s)),s}It(e){let s=this.Je.get(e);return s||(s=new ws(_t),this.Je=this.Je.insert(e,s)),s}rt(e){const s=this.ot(e)!==null;return s||Ve("WatchChangeAggregator","Detected inactive target",e),s}ot(e){const s=this.ze.get(e);return s&&s.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Wd),this.Ge.getRemoteKeysForTarget(e).forEach(s=>{this.et(e,s,null)})}Et(e,s){return this.Ge.getRemoteKeysForTarget(e).has(s)}}function Ca(){return new ts(Oe.comparator)}function zd(){return new ts(Oe.comparator)}const Tv={asc:"ASCENDING",desc:"DESCENDING"},Bv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rv={and:"AND",or:"OR"};class Uv{constructor(e,s){this.databaseId=e,this.useProto3Json=s}}function Zc(t,e){return t.useProto3Json||wl(e)?e:{value:e}}function ul(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $h(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Hv(t,e){return ul(t,e.toTimestamp())}function Hn(t){return Ut(!!t,49232),et.fromTimestamp(function(s){const n=Er(s);return new be(n.seconds,n.nanos)}(t))}function Fm(t,e){return em(t,e).canonicalString()}function em(t,e){const s=function(r){return new Wt(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?s:s.child(e)}function Wh(t){const e=Wt.fromString(t);return Ut(Gh(e),10190,{key:e.toString()}),e}function tm(t,e){return Fm(t.databaseId,e.path)}function xc(t,e){const s=Wh(e);if(s.get(1)!==t.databaseId.projectId)throw new Ae(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+t.databaseId.projectId);if(s.get(3)!==t.databaseId.database)throw new Ae(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+t.databaseId.database);return new Oe(Kh(s))}function zh(t,e){return Fm(t.databaseId,e)}function Mv(t){const e=Wh(t);return e.length===4?Wt.emptyPath():Kh(e)}function sm(t){return new Wt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Kh(t){return Ut(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Kd(t,e,s){return{name:tm(t,e),fields:s.value.mapValue.fields}}function Fv(t,e){let s;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ye(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Ut(d===void 0||typeof d=="string",58123),Fs.fromBase64String(d||"")):(Ut(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Fs.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(u){const d=u.code===void 0?ne.UNKNOWN:Fh(u.code);return new Ae(d,u.message||"")}(a);s=new qh(n,r,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=xc(t,n.document.name),i=Hn(n.document.updateTime),a=n.document.createTime?Hn(n.document.createTime):et.min(),c=new on({mapValue:{fields:n.document.fields}}),m=Ws.newFoundDocument(r,i,a,c),u=n.targetIds||[],d=n.removedTargetIds||[];s=new Ya(u,d,m.key,m)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=xc(t,n.document),i=n.readTime?Hn(n.readTime):et.min(),a=Ws.newNoDocument(r,i),c=n.removedTargetIds||[];s=new Ya([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=xc(t,n.document),i=n.removedTargetIds||[];s=new Ya([],i,r,null)}else{if(!("filter"in e))return Ye(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:i}=n,a=new Sv(r,i),c=n.targetId;s=new Oh(c,a)}}return s}function Ov(t,e){let s;if(e instanceof oa)s={update:Kd(t,e.key,e.value)};else if(e instanceof Bl)s={delete:tm(t,e.key)};else if(e instanceof Tr)s={update:Kd(t,e.key,e.data),updateMask:Xv(e.fieldMask)};else{if(!(e instanceof Cv))return Ye(16599,{Vt:e.type});s={verify:tm(t,e.key)}}return e.fieldTransforms.length>0&&(s.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const c=a.transform;if(c instanceof Xo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Jo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Zo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ml)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw Ye(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(s.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:Hv(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ye(27497)}(t,e.precondition)),s}function qv(t,e){return t&&t.length>0?(Ut(e!==void 0,14353),t.map(s=>function(r,i){let a=r.updateTime?Hn(r.updateTime):Hn(i);return a.isEqual(et.min())&&(a=Hn(i)),new kv(a,r.transformResults||[])}(s,e))):[]}function $v(t,e){return{documents:[zh(t,e.path)]}}function Wv(t,e){const s={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,s.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),s.structuredQuery.from=[{collectionId:n.lastSegment()}]),s.parent=zh(t,r);const i=function(u){if(u.length!==0)return Yh(En.create(u,"and"))}(e.filters);i&&(s.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Ti(p.field),direction:Qv(p.dir)}}(d))}(e.orderBy);a&&(s.structuredQuery.orderBy=a);const c=Zc(t,e.limit);return c!==null&&(s.structuredQuery.limit=c),e.startAt&&(s.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(s.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:s,parent:r}}function zv(t){let e=Mv(t.parent);const s=t.structuredQuery,n=s.from?s.from.length:0;let r=null;if(n>0){Ut(n===1,65062);const d=s.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];s.where&&(i=function(h){const p=Qh(h);return p instanceof En&&kh(p)?p.getFilters():[p]}(s.where));let a=[];s.orderBy&&(a=function(h){return h.map(p=>function(w){return new Go(Bi(w.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(s.orderBy));let c=null;s.limit&&(c=function(h){let p;return p=typeof h=="object"?h.value:h,wl(p)?null:p}(s.limit));let m=null;s.startAt&&(m=function(h){const p=!!h.before,b=h.values||[];return new cl(b,p)}(s.startAt));let u=null;return s.endAt&&(u=function(h){const p=!h.before,b=h.values||[];return new cl(b,p)}(s.endAt)),mv(e,r,a,i,c,"F",m,u)}function Kv(t,e){const s=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ye(28987,{purpose:r})}}(e.purpose);return s==null?null:{"goog-listen-tags":s}}function Qh(t){return t.unaryFilter!==void 0?function(s){switch(s.unaryFilter.op){case"IS_NAN":const n=Bi(s.unaryFilter.field);return Ns.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Bi(s.unaryFilter.field);return Ns.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Bi(s.unaryFilter.field);return Ns.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Bi(s.unaryFilter.field);return Ns.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ye(61313);default:return Ye(60726)}}(t):t.fieldFilter!==void 0?function(s){return Ns.create(Bi(s.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ye(58110);default:return Ye(50506)}}(s.fieldFilter.op),s.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(s){return En.create(s.compositeFilter.filters.map(n=>Qh(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ye(1026)}}(s.compositeFilter.op))}(t):Ye(30097,{filter:t})}function Qv(t){return Tv[t]}function Yv(t){return Bv[t]}function Gv(t){return Rv[t]}function Ti(t){return{fieldPath:t.canonicalString()}}function Bi(t){return Hs.fromServerFormat(t.fieldPath)}function Yh(t){return t instanceof Ns?function(s){if(s.op==="=="){if(jd(s.value))return{unaryFilter:{field:Ti(s.field),op:"IS_NAN"}};if(Pd(s.value))return{unaryFilter:{field:Ti(s.field),op:"IS_NULL"}}}else if(s.op==="!="){if(jd(s.value))return{unaryFilter:{field:Ti(s.field),op:"IS_NOT_NAN"}};if(Pd(s.value))return{unaryFilter:{field:Ti(s.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ti(s.field),op:Yv(s.op),value:s.value}}}(t):t instanceof En?function(s){const n=s.getFilters().map(r=>Yh(r));return n.length===1?n[0]:{compositeFilter:{op:Gv(s.op),filters:n}}}(t):Ye(54877,{filter:t})}function Xv(t){const e=[];return t.fields.forEach(s=>e.push(s.canonicalString())),{fieldPaths:e}}function Gh(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,s,n,r,i=et.min(),a=et.min(),c=Fs.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=s,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=m}withSequenceNumber(e){return new br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,s){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e){this.yt=e}}function Zv(t){const e=zv({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(){this.Cn=new t_}addToCollectionParentIndex(e,s){return this.Cn.add(s),ce.resolve()}getCollectionParents(e,s){return ce.resolve(this.Cn.getEntries(s))}addFieldIndex(e,s){return ce.resolve()}deleteFieldIndex(e,s){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,s){return ce.resolve()}getDocumentsMatchingTarget(e,s){return ce.resolve(null)}getIndexType(e,s){return ce.resolve(0)}getFieldIndexes(e,s){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,s){return ce.resolve(Ar.min())}getMinOffsetFromCollectionGroup(e,s){return ce.resolve(Ar.min())}updateCollectionGroup(e,s,n){return ce.resolve()}updateIndexEntries(e,s){return ce.resolve()}}class t_{constructor(){this.index={}}add(e){const s=e.lastSegment(),n=e.popLast(),r=this.index[s]||new ws(Wt.comparator),i=!r.has(n);return this.index[s]=r.add(n),i}has(e){const s=e.lastSegment(),n=e.popLast(),r=this.index[s];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ws(Wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xh=41943040;class nn{static withCacheSize(e){return new nn(e,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,s,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=s,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn.DEFAULT_COLLECTION_PERCENTILE=10,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nn.DEFAULT=new nn(Xh,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nn.DISABLED=new nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ki(0)}static cr(){return new Ki(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="LruGarbageCollector",s_=1048576;function Gd([t,e],[s,n]){const r=_t(t,s);return r===0?_t(e,n):r}class n_{constructor(e){this.Ir=e,this.buffer=new ws(Gd),this.Er=0}dr(){return++this.Er}Ar(e){const s=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(s);else{const n=this.buffer.last();Gd(s,n)<0&&(this.buffer=this.buffer.delete(n).add(s))}}get maxValue(){return this.buffer.last()[0]}}class r_{constructor(e,s,n){this.garbageCollector=e,this.asyncQueue=s,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ve(Yd,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(s){Zi(s)?Ve(Yd,"Ignoring IndexedDB error during garbage collection: ",s):await Ji(s)}await this.Vr(3e5)})}}class i_{constructor(e,s){this.mr=e,this.params=s}calculateTargetCount(e,s){return this.mr.gr(e).next(n=>Math.floor(s/100*n))}nthSequenceNumber(e,s){if(s===0)return ce.resolve(Vl.ce);const n=new n_(s);return this.mr.forEachTarget(e,r=>n.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>n.Ar(r))).next(()=>n.maxValue)}removeTargets(e,s,n){return this.mr.removeTargets(e,s,n)}removeOrphanedDocuments(e,s){return this.mr.removeOrphanedDocuments(e,s)}collect(e,s){return this.params.cacheSizeCollectionThreshold===-1?(Ve("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(Qd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qd):this.yr(e,s))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,s){let n,r,i,a,c,m,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,a=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(n=h,c=Date.now(),this.removeTargets(e,n,s))).next(h=>(i=h,m=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(u=Date.now(),Pi()<=Vt.DEBUG&&Ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${r} in `+(c-a)+`ms
	Removed ${i} targets in `+(m-c)+`ms
	Removed ${h} documents in `+(u-m)+`ms
Total Duration: ${u-d}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}function o_(t,e){return new i_(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(){this.changes=new li(e=>e.toString(),(e,s)=>e.isEqual(s)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,s){this.assertNotApplied(),this.changes.set(e,Ws.newInvalidDocument(e).setReadTime(s))}getEntry(e,s){this.assertNotApplied();const n=this.changes.get(s);return n!==void 0?ce.resolve(n):this.getFromCache(e,s)}getEntries(e,s){return this.getAllFromCache(e,s)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,s){this.overlayedDocument=e,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,s,n,r){this.remoteDocumentCache=e,this.mutationQueue=s,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,s){let n=null;return this.documentOverlayCache.getOverlay(e,s).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,s))).next(r=>(n!==null&&Ro(n.mutation,r,cn.empty(),be.now()),r))}getDocuments(e,s){return this.remoteDocumentCache.getEntries(e,s).next(n=>this.getLocalViewOfDocuments(e,n,Dt()).next(()=>n))}getLocalViewOfDocuments(e,s,n=Dt()){const r=Xr();return this.populateOverlays(e,r,s).next(()=>this.computeViews(e,s,r,n).next(i=>{let a=wo();return i.forEach((c,m)=>{a=a.insert(c,m.overlayedDocument)}),a}))}getOverlayedDocuments(e,s){const n=Xr();return this.populateOverlays(e,n,s).next(()=>this.computeViews(e,s,n,Dt()))}populateOverlays(e,s,n){const r=[];return n.forEach(i=>{s.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((a,c)=>{s.set(a,c)})})}computeViews(e,s,n,r){let i=er();const a=Bo(),c=function(){return Bo()}();return s.forEach((m,u)=>{const d=n.get(u.key);r.has(u.key)&&(d===void 0||d.mutation instanceof Tr)?i=i.insert(u.key,u):d!==void 0?(a.set(u.key,d.mutation.getFieldMask()),Ro(d.mutation,u,d.mutation.getFieldMask(),be.now())):a.set(u.key,cn.empty())}),this.recalculateAndSaveOverlays(e,i).next(m=>(m.forEach((u,d)=>a.set(u,d)),s.forEach((u,d)=>c.set(u,new l_(d,a.get(u)??null))),c))}recalculateAndSaveOverlays(e,s){const n=Bo();let r=new ts((a,c)=>a-c),i=Dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,s).next(a=>{for(const c of a)c.keys().forEach(m=>{const u=s.get(m);if(u===null)return;let d=n.get(m)||cn.empty();d=c.applyToLocalView(u,d),n.set(m,d);const h=(r.get(c.batchId)||Dt()).add(m);r=r.insert(c.batchId,h)})}).next(()=>{const a=[],c=r.getReverseIterator();for(;c.hasNext();){const m=c.getNext(),u=m.key,d=m.value,h=Ph();d.forEach(p=>{if(!i.has(p)){const b=Hh(s.get(p),n.get(p));b!==null&&h.set(p,b),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ce.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,s){return this.remoteDocumentCache.getEntries(e,s).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,s,n,r){return function(a){return Oe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(s)?this.getDocumentsMatchingDocumentQuery(e,s.path):Vh(s)?this.getDocumentsMatchingCollectionGroupQuery(e,s,n,r):this.getDocumentsMatchingCollectionQuery(e,s,n,r)}getNextDocuments(e,s,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,s,n,r).next(i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,s,n.largestBatchId,r-i.size):ce.resolve(Xr());let c=zo,m=i;return a.next(u=>ce.forEach(u,(d,h)=>(c<h.largestBatchId&&(c=h.largestBatchId),i.get(d)?ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{m=m.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,m,u,Dt())).next(d=>({batchId:c,changes:Lh(d)})))})}getDocumentsMatchingDocumentQuery(e,s){return this.getDocument(e,new Oe(s)).next(n=>{let r=wo();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,s,n,r){const i=s.collectionGroup;let a=wo();return this.indexManager.getCollectionParents(e,i).next(c=>ce.forEach(c,m=>{const u=function(h,p){return new eo(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(s,m.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,n,r).next(d=>{d.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,s,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,s.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,s,n,i,r))).next(a=>{i.forEach((m,u)=>{const d=u.getKey();a.get(d)===null&&(a=a.insert(d,Ws.newInvalidDocument(d)))});let c=wo();return a.forEach((m,u)=>{const d=i.get(m);d!==void 0&&Ro(d.mutation,u,cn.empty(),be.now()),Pl(s,u)&&(c=c.insert(m,u))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,s){return ce.resolve(this.Lr.get(s))}saveBundleMetadata(e,s){return this.Lr.set(s.id,function(r){return{id:r.id,version:r.version,createTime:Hn(r.createTime)}}(s)),ce.resolve()}getNamedQuery(e,s){return ce.resolve(this.kr.get(s))}saveNamedQuery(e,s){return this.kr.set(s.name,function(r){return{name:r.name,query:Zv(r.bundledQuery),readTime:Hn(r.readTime)}}(s)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(){this.overlays=new ts(Oe.comparator),this.qr=new Map}getOverlay(e,s){return ce.resolve(this.overlays.get(s))}getOverlays(e,s){const n=Xr();return ce.forEach(s,r=>this.getOverlay(e,r).next(i=>{i!==null&&n.set(r,i)})).next(()=>n)}saveOverlays(e,s,n){return n.forEach((r,i)=>{this.St(e,s,i)}),ce.resolve()}removeOverlaysForBatchId(e,s,n){const r=this.qr.get(n);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),ce.resolve()}getOverlaysForCollection(e,s,n){const r=Xr(),i=s.length+1,a=new Oe(s.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const m=c.getNext().value,u=m.getKey();if(!s.isPrefixOf(u.path))break;u.path.length===i&&m.largestBatchId>n&&r.set(m.getKey(),m)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,s,n,r){let i=new ts((u,d)=>u-d);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===s&&u.largestBatchId>n){let d=i.get(u.largestBatchId);d===null&&(d=Xr(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const c=Xr(),m=i.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((u,d)=>c.set(u,d)),!(c.size()>=r)););return ce.resolve(c)}St(e,s,n){const r=this.overlays.get(n.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new wv(s,n));let i=this.qr.get(s);i===void 0&&(i=Dt(),this.qr.set(s,i)),this.qr.set(s,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,s){return this.sessionToken=s,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(){this.Qr=new ws(js.$r),this.Ur=new ws(js.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,s){const n=new js(e,s);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,s){e.forEach(n=>this.addReference(n,s))}removeReference(e,s){this.Gr(new js(e,s))}zr(e,s){e.forEach(n=>this.removeReference(n,s))}jr(e){const s=new Oe(new Wt([])),n=new js(s,e),r=new js(s,e+1),i=[];return this.Ur.forEachInRange([n,r],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const s=new Oe(new Wt([])),n=new js(s,e),r=new js(s,e+1);let i=Dt();return this.Ur.forEachInRange([n,r],a=>{i=i.add(a.key)}),i}containsKey(e){const s=new js(e,0),n=this.Qr.firstAfterOrEqual(s);return n!==null&&e.isEqual(n.key)}}class js{constructor(e,s){this.key=e,this.Yr=s}static $r(e,s){return Oe.comparator(e.key,s.key)||_t(e.Yr,s.Yr)}static Kr(e,s){return _t(e.Yr,s.Yr)||Oe.comparator(e.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,s){this.indexManager=e,this.referenceDelegate=s,this.mutationQueue=[],this.tr=1,this.Zr=new ws(js.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,s,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Vv(i,s,n,r);this.mutationQueue.push(a);for(const c of r)this.Zr=this.Zr.add(new js(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ce.resolve(a)}lookupMutationBatch(e,s){return ce.resolve(this.Xr(s))}getNextMutationBatchAfterBatchId(e,s){const n=s+1,r=this.ei(n),i=r<0?0:r;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?Pm:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,s){const n=new js(s,0),r=new js(s,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],a=>{const c=this.Xr(a.Yr);i.push(c)}),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,s){let n=new ws(_t);return s.forEach(r=>{const i=new js(r,0),a=new js(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{n=n.add(c.Yr)})}),ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,s){const n=s.path,r=n.length+1;let i=n;Oe.isDocumentKey(i)||(i=i.child(""));const a=new js(new Oe(i),0);let c=new ws(_t);return this.Zr.forEachWhile(m=>{const u=m.key.path;return!!n.isPrefixOf(u)&&(u.length===r&&(c=c.add(m.Yr)),!0)},a),ce.resolve(this.ti(c))}ti(e){const s=[];return e.forEach(n=>{const r=this.Xr(n);r!==null&&s.push(r)}),s}removeMutationBatch(e,s){Ut(this.ni(s.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ce.forEach(s.mutations,r=>{const i=new js(r.key,s.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,s){const n=new js(s,0),r=this.Zr.firstAfterOrEqual(n);return ce.resolve(s.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,s){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const s=this.ei(e);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e){this.ri=e,this.docs=function(){return new ts(Oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,s){const n=s.key,r=this.docs.get(n),i=r?r.size:0,a=this.ri(s);return this.docs=this.docs.insert(n,{document:s.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const s=this.docs.get(e);s&&(this.docs=this.docs.remove(e),this.size-=s.size)}getEntry(e,s){const n=this.docs.get(s);return ce.resolve(n?n.document.mutableCopy():Ws.newInvalidDocument(s))}getEntries(e,s){let n=er();return s.forEach(r=>{const i=this.docs.get(r);n=n.insert(r,i?i.document.mutableCopy():Ws.newInvalidDocument(r))}),ce.resolve(n)}getDocumentsMatchingQuery(e,s,n,r){let i=er();const a=s.path,c=new Oe(a.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(c);for(;m.hasNext();){const{key:u,value:{document:d}}=m.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||Ox(Fx(d),n)<=0||(r.has(d.key)||Pl(s,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,s,n,r){Ye(9500)}ii(e,s){return ce.forEach(this.docs,n=>s(n))}newChangeBuffer(e){return new h_(this)}getSize(e){return ce.resolve(this.size)}}class h_ extends a_{constructor(e){super(),this.Nr=e}applyChanges(e){const s=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?s.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ce.waitFor(s)}getFromCache(e,s){return this.Nr.getEntry(e,s)}getAllFromCache(e,s){return this.Nr.getEntries(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e){this.persistence=e,this.si=new li(s=>Bm(s),Rm),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.oi=0,this._i=new Om,this.targetCount=0,this.ai=Ki.ur()}forEachTarget(e,s){return this.si.forEach((n,r)=>s(r)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,s,n){return n&&(this.lastRemoteSnapshotVersion=n),s>this.oi&&(this.oi=s),ce.resolve()}Pr(e){this.si.set(e.target,e);const s=e.targetId;s>this.highestTargetId&&(this.ai=new Ki(s),this.highestTargetId=s),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,s){return this.Pr(s),this.targetCount+=1,ce.resolve()}updateTargetData(e,s){return this.Pr(s),ce.resolve()}removeTargetData(e,s){return this.si.delete(s.target),this._i.jr(s.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,s,n){let r=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=s&&n.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),ce.waitFor(i).next(()=>r)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,s){const n=this.si.get(s)||null;return ce.resolve(n)}addMatchingKeys(e,s,n){return this._i.Wr(s,n),ce.resolve()}removeMatchingKeys(e,s,n){this._i.zr(s,n);const r=this.persistence.referenceDelegate,i=[];return r&&s.forEach(a=>{i.push(r.markPotentiallyOrphaned(e,a))}),ce.waitFor(i)}removeMatchingKeysForTargetId(e,s){return this._i.jr(s),ce.resolve()}getMatchingKeysForTargetId(e,s){const n=this._i.Hr(s);return ce.resolve(n)}containsKey(e,s){return ce.resolve(this._i.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,s){this.ui={},this.overlays={},this.ci=new Vl(0),this.li=!1,this.li=!0,this.hi=new d_,this.referenceDelegate=e(this),this.Pi=new g_(this),this.indexManager=new e_,this.remoteDocumentCache=function(r){return new p_(r)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new Jv(s),this.Ii=new m_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let s=this.overlays[e.toKey()];return s||(s=new u_,this.overlays[e.toKey()]=s),s}getMutationQueue(e,s){let n=this.ui[e.toKey()];return n||(n=new f_(s,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,s,n){Ve("MemoryPersistence","Starting transaction:",e);const r=new y_(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,s){return ce.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,s)))}}class y_ extends $x{constructor(e){super(),this.currentSequenceNumber=e}}class qm{constructor(e){this.persistence=e,this.Ri=new Om,this.Vi=null}static mi(e){return new qm(e)}get fi(){if(this.Vi)return this.Vi;throw Ye(60996)}addReference(e,s,n){return this.Ri.addReference(n,s),this.fi.delete(n.toString()),ce.resolve()}removeReference(e,s,n){return this.Ri.removeReference(n,s),this.fi.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,s){return this.fi.add(s.toString()),ce.resolve()}removeTarget(e,s){this.Ri.jr(s.targetId).forEach(r=>this.fi.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,s.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,s))}Ei(){this.Vi=new Set}di(e){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,n=>{const r=Oe.fromPath(n);return this.gi(e,r).next(i=>{i||s.removeEntry(r,et.min())})}).next(()=>(this.Vi=null,s.apply(e)))}updateLimboDocument(e,s){return this.gi(e,s).next(n=>{n?this.fi.delete(s.toString()):this.fi.add(s.toString())})}Ti(e){return 0}gi(e,s){return ce.or([()=>ce.resolve(this.Ri.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(e,s),()=>this.persistence.Ai(e,s)])}}class dl{constructor(e,s){this.persistence=e,this.pi=new li(n=>Kx(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=o_(this,s)}static mi(e,s){return new dl(e,s)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,s){return this.persistence.getTargetCache().forEachTarget(e,s)}gr(e){const s=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>s.next(r=>n+r))}wr(e){let s=0;return this.pr(e,n=>{s++}).next(()=>s)}pr(e,s){return ce.forEach(this.pi,(n,r)=>this.br(e,n,r).next(i=>i?ce.resolve():s(r)))}removeTargets(e,s,n){return this.persistence.getTargetCache().removeTargets(e,s,n)}removeOrphanedDocuments(e,s){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,a=>this.br(e,a,s).next(c=>{c||(n++,i.removeEntry(a,et.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,s){return this.pi.set(s,e.currentSequenceNumber),ce.resolve()}removeTarget(e,s){const n=s.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,s,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeReference(e,s,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,s){return this.pi.set(s,e.currentSequenceNumber),ce.resolve()}Ti(e){let s=e.key.toString().length;return e.isFoundDocument()&&(s+=za(e.data.value)),s}br(e,s,n){return ce.or([()=>this.persistence.Ai(e,s),()=>this.persistence.getTargetCache().containsKey(e,s),()=>{const r=this.pi.get(s);return ce.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(e,s,n,r){this.targetId=e,this.fromCache=s,this.Es=n,this.ds=r}static As(e,s){let n=Dt(),r=Dt();for(const i of s.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new $m(e,s.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return f0()?8:Wx(u0())>0?6:4}()}initialize(e,s){this.ps=e,this.indexManager=s,this.Rs=!0}getDocumentsMatchingQuery(e,s,n,r){const i={result:null};return this.ys(e,s).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,s,r,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new b_;return this.Ss(e,s,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,s,a,c.size)})}).next(()=>i.result)}bs(e,s,n,r){return n.documentReadCount<this.fs?(Pi()<=Vt.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",ji(s),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Pi()<=Vt.DEBUG&&Ve("QueryEngine","Query:",ji(s),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Pi()<=Vt.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",ji(s),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Un(s))):ce.resolve())}ys(e,s){if(Ud(s))return ce.resolve(null);let n=Un(s);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(s.limit!==null&&r===1&&(s=Jc(s,null,"F"),n=Un(s)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Dt(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(m=>{const u=this.Ds(s,c);return this.Cs(s,u,a,m.readTime)?this.ys(e,Jc(s,null,"F")):this.vs(e,u,s,m)}))})))}ws(e,s,n,r){return Ud(s)||r.isEqual(et.min())?ce.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(s,i);return this.Cs(s,a,n,r)?ce.resolve(null):(Pi()<=Vt.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ji(s)),this.vs(e,a,s,Mx(r,zo)).next(c=>c))})}Ds(e,s){let n=new ws(Sh(e));return s.forEach((r,i)=>{Pl(e,i)&&(n=n.add(i))}),n}Cs(e,s,n,r){if(e.limit===null)return!1;if(n.size!==s.size)return!0;const i=e.limitType==="F"?s.last():s.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,s,n){return Pi()<=Vt.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",ji(s)),this.ps.getDocumentsMatchingQuery(e,s,Ar.min(),n)}vs(e,s,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(i=>(s.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="LocalStore",x_=3e8;class v_{constructor(e,s,n,r){this.persistence=e,this.Fs=s,this.serializer=r,this.Ms=new ts(_t),this.xs=new li(i=>Bm(i),Rm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new c_(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",s=>e.collect(s,this.Ms))}}function __(t,e,s,n){return new v_(t,e,s,n)}async function Zh(t,e){const s=Je(t);return await s.persistence.runTransaction("Handle user change","readonly",n=>{let r;return s.mutationQueue.getAllMutationBatches(n).next(i=>(r=i,s.Bs(e),s.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],c=[];let m=Dt();for(const u of r){a.push(u.batchId);for(const d of u.mutations)m=m.add(d.key)}for(const u of i){c.push(u.batchId);for(const d of u.mutations)m=m.add(d.key)}return s.localDocuments.getDocuments(n,m).next(u=>({Ls:u,removedBatchIds:a,addedBatchIds:c}))})})}function D_(t,e){const s=Je(t);return s.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),i=s.Ns.newChangeBuffer({trackRemovals:!0});return function(c,m,u,d){const h=u.batch,p=h.keys();let b=ce.resolve();return p.forEach(w=>{b=b.next(()=>d.getEntry(m,w)).next(v=>{const C=u.docVersions.get(w);Ut(C!==null,48541),v.version.compareTo(C)<0&&(h.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),d.addEntry(v)))})}),b.next(()=>c.mutationQueue.removeMutationBatch(m,h))}(s,n,e,i).next(()=>i.apply(n)).next(()=>s.mutationQueue.performConsistencyCheck(n)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let m=Dt();for(let u=0;u<c.mutationResults.length;++u)c.mutationResults[u].transformResults.length>0&&(m=m.add(c.batch.mutations[u].key));return m}(e))).next(()=>s.localDocuments.getDocuments(n,r))})}function eg(t){const e=Je(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",s=>e.Pi.getLastRemoteSnapshotVersion(s))}function k_(t,e){const s=Je(t),n=e.snapshotVersion;let r=s.Ms;return s.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=s.Ns.newChangeBuffer({trackRemovals:!0});r=s.Ms;const c=[];e.targetChanges.forEach((d,h)=>{const p=r.get(h);if(!p)return;c.push(s.Pi.removeMatchingKeys(i,d.removedDocuments,h).next(()=>s.Pi.addMatchingKeys(i,d.addedDocuments,h)));let b=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?b=b.withResumeToken(Fs.EMPTY_BYTE_STRING,et.min()).withLastLimboFreeSnapshotVersion(et.min()):d.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(d.resumeToken,n)),r=r.insert(h,b),function(v,C,R){return v.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=x_?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(p,b,d)&&c.push(s.Pi.updateTargetData(i,b))});let m=er(),u=Dt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&c.push(s.persistence.referenceDelegate.updateLimboDocument(i,d))}),c.push(A_(i,a,e.documentUpdates).next(d=>{m=d.ks,u=d.qs})),!n.isEqual(et.min())){const d=s.Pi.getLastRemoteSnapshotVersion(i).next(h=>s.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(d)}return ce.waitFor(c).next(()=>a.apply(i)).next(()=>s.localDocuments.getLocalViewOfDocuments(i,m,u)).next(()=>m)}).then(i=>(s.Ms=r,i))}function A_(t,e,s){let n=Dt(),r=Dt();return s.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=er();return s.forEach((c,m)=>{const u=i.get(c);m.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(c)),m.isNoDocument()&&m.version.isEqual(et.min())?(e.removeEntry(c,m.readTime),a=a.insert(c,m)):!u.isValidDocument()||m.version.compareTo(u.version)>0||m.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(m),a=a.insert(c,m)):Ve(Wm,"Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",m.version)}),{ks:a,qs:r}})}function E_(t,e){const s=Je(t);return s.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Pm),s.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function C_(t,e){const s=Je(t);return s.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return s.Pi.getTargetData(n,e).next(i=>i?(r=i,ce.resolve(r)):s.Pi.allocateTargetId(n).next(a=>(r=new br(e,a,"TargetPurposeListen",n.currentSequenceNumber),s.Pi.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=s.Ms.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(s.Ms=s.Ms.insert(n.targetId,n),s.xs.set(e,n.targetId)),n})}async function nm(t,e,s){const n=Je(t),r=n.Ms.get(e),i=s?"readwrite":"readwrite-primary";try{s||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!Zi(a))throw a;Ve(Wm,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(r.target)}function Xd(t,e,s){const n=Je(t);let r=et.min(),i=Dt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(m,u,d){const h=Je(m),p=h.xs.get(d);return p!==void 0?ce.resolve(h.Ms.get(p)):h.Pi.getTargetData(u,d)}(n,a,Un(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(m=>{i=m})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,s?r:et.min(),s?i:Dt())).next(c=>(V_(n,dv(e),c),{documents:c,Qs:i})))}function V_(t,e,s){let n=t.Os.get(e)||et.min();s.forEach((r,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class Jd{constructor(){this.activeTargetIds=bv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class w_{constructor(){this.Mo=new Jd,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,s,n){}addLocalQueryTarget(e,s=!0){return s&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,s,n){this.xo[e]=s}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Jd,Promise.resolve()}handleUserChange(e,s,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="ConnectivityMonitor";class ef{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ve(Zd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ve(Zd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Va=null;function rm(){return Va===null?Va=function(){return 268435456+Math.round(2147483648*Math.random())}():Va++,"0x"+Va.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc="RestConnection",I_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class L_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const s=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=s+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===al?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,s,n,r,i){const a=rm(),c=this.zo(e,s.toUriEncodedString());Ve(vc,`Sending RPC '${e}' ${a}:`,c,n);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,r,i);const{host:u}=new URL(c),d=ra(u);return this.Jo(e,c,m,n,d).then(h=>(Ve(vc,`Received RPC '${e}' ${a}: `,h),h),h=>{throw qi(vc,`RPC '${e}' ${a} failed with error: `,h,"url: ",c,"request:",n),h})}Ho(e,s,n,r,i,a){return this.Go(e,s,n,r,i)}jo(e,s,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Xi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((r,i)=>e[i]=r),n&&n.headers.forEach((r,i)=>e[i]=r)}zo(e,s){const n=I_[e];return`${this.Uo}/v1/${s}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os="WebChannelConnection";class j_ extends L_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,s,n,r,i){const a=rm();return new Promise((c,m)=>{const u=new nh;u.setWithCredentials(!0),u.listenOnce(rh.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Wa.NO_ERROR:const h=u.getResponseJson();Ve(Os,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),c(h);break;case Wa.TIMEOUT:Ve(Os,`RPC '${e}' ${a} timed out`),m(new Ae(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Wa.HTTP_ERROR:const p=u.getStatus();if(Ve(Os,`RPC '${e}' ${a} failed with status:`,p,"response text:",u.getResponseText()),p>0){let b=u.getResponseJson();Array.isArray(b)&&(b=b[0]);const w=b==null?void 0:b.error;if(w&&w.status&&w.message){const v=function(R){const I=R.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(I)>=0?I:ne.UNKNOWN}(w.status);m(new Ae(v,w.message))}else m(new Ae(ne.UNKNOWN,"Server responded with status "+u.getStatus()))}else m(new Ae(ne.UNAVAILABLE,"Connection failed."));break;default:Ye(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ve(Os,`RPC '${e}' ${a} completed.`)}});const d=JSON.stringify(r);Ve(Os,`RPC '${e}' ${a} sending request:`,r),u.send(s,"POST",d,n,15)})}T_(e,s,n){const r=rm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ah(),c=oh(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(m.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,s,n),m.encodeInitMessageHeaders=!0;const d=i.join("");Ve(Os,`Creating RPC '${e}' stream ${r}: ${d}`,m);const h=a.createWebChannel(d,m);this.I_(h);let p=!1,b=!1;const w=new P_({Yo:C=>{b?Ve(Os,`Not sending because RPC '${e}' stream ${r} is closed:`,C):(p||(Ve(Os,`Opening RPC '${e}' stream ${r} transport.`),h.open(),p=!0),Ve(Os,`RPC '${e}' stream ${r} sending:`,C),h.send(C))},Zo:()=>h.close()}),v=(C,R,I)=>{C.listen(R,z=>{try{I(z)}catch(ie){setTimeout(()=>{throw ie},0)}})};return v(h,Vo.EventType.OPEN,()=>{b||(Ve(Os,`RPC '${e}' stream ${r} transport opened.`),w.o_())}),v(h,Vo.EventType.CLOSE,()=>{b||(b=!0,Ve(Os,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(h))}),v(h,Vo.EventType.ERROR,C=>{b||(b=!0,qi(Os,`RPC '${e}' stream ${r} transport errored. Name:`,C.name,"Message:",C.message),w.a_(new Ae(ne.UNAVAILABLE,"The operation could not be completed")))}),v(h,Vo.EventType.MESSAGE,C=>{var R;if(!b){const I=C.data[0];Ut(!!I,16349);const z=I,ie=(z==null?void 0:z.error)||((R=z[0])==null?void 0:R.error);if(ie){Ve(Os,`RPC '${e}' stream ${r} received error:`,ie);const te=ie.status;let O=function(E){const T=gs[E];if(T!==void 0)return Fh(T)}(te),A=ie.message;O===void 0&&(O=ne.INTERNAL,A="Unknown error status: "+te+" with message "+ie.message),b=!0,w.a_(new Ae(O,A)),h.close()}else Ve(Os,`RPC '${e}' stream ${r} received:`,I),w.u_(I)}}),v(c,ih.STAT_EVENT,C=>{C.stat===Wc.PROXY?Ve(Os,`RPC '${e}' stream ${r} detected buffering proxy`):C.stat===Wc.NOPROXY&&Ve(Os,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(s=>s===e)}}function _c(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(t){return new Uv(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e,s,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=s,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const s=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,s-n);r>0&&Ve("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${s} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf="PersistentStream";class sg{constructor(e,s,n,r,i,a,c,m){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new tg(e,s)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,s){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():s&&s.code===ne.RESOURCE_EXHAUSTED?(Zn(s.toString()),Zn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):s&&s.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(s)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),s=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.D_===s&&this.G_(n,r)},n=>{e(()=>{const r=new Ae(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)})})}G_(e,s){const n=this.W_(this.D_);this.stream=this.j_(e,s),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{n(()=>this.z_(r))}),this.stream.onMessage(r=>{n(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ve(tf,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return s=>{this.Mi.enqueueAndForget(()=>this.D_===e?s():(Ve(tf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class T_ extends sg{constructor(e,s,n,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,n,r,a),this.serializer=i}j_(e,s){return this.connection.T_("Listen",e,s)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const s=Fv(this.serializer,e),n=function(i){if(!("targetChange"in i))return et.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?et.min():a.readTime?Hn(a.readTime):et.min()}(e);return this.listener.H_(s,n)}Y_(e){const s={};s.database=sm(this.serializer),s.addTarget=function(i,a){let c;const m=a.target;if(c=Gc(m)?{documents:$v(i,m)}:{query:Wv(i,m).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=$h(i,a.resumeToken);const u=Zc(i,a.expectedCount);u!==null&&(c.expectedCount=u)}else if(a.snapshotVersion.compareTo(et.min())>0){c.readTime=ul(i,a.snapshotVersion.toTimestamp());const u=Zc(i,a.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,e);const n=Kv(this.serializer,e);n&&(s.labels=n),this.q_(s)}Z_(e){const s={};s.database=sm(this.serializer),s.removeTarget=e,this.q_(s)}}class B_ extends sg{constructor(e,s,n,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",s,n,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,s){return this.connection.T_("Write",e,s)}J_(e){return Ut(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ut(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ut(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const s=qv(e.writeResults,e.commitTime),n=Hn(e.commitTime);return this.listener.na(n,s)}ra(){const e={};e.database=sm(this.serializer),this.q_(e)}ea(e){const s={streamToken:this.lastStreamToken,writes:e.map(n=>Ov(this.serializer,n))};this.q_(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{}class U_ extends R_{constructor(e,s,n,r){super(),this.authCredentials=e,this.appCheckCredentials=s,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ae(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,s,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,em(s,n),r,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ae(ne.UNKNOWN,i.toString())})}Ho(e,s,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,em(s,n),r,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ae(ne.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class H_{constructor(e,s){this.asyncQueue=e,this.onlineStateHandler=s,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const s=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zn(s),this.aa=!1):Ve("OnlineStateTracker",s)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri="RemoteStore";class M_{constructor(e,s,n,r,i){this.localStore=e,this.datastore=s,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{ci(this)&&(Ve(ri,"Restarting streams for network reachability change."),await async function(m){const u=Je(m);u.Ea.add(4),await to(u),u.Ra.set("Unknown"),u.Ea.delete(4),await la(u)}(this))})}),this.Ra=new H_(n,r)}}async function la(t){if(ci(t))for(const e of t.da)await e(!0)}async function to(t){for(const e of t.da)await e(!1)}function ng(t,e){const s=Je(t);s.Ia.has(e.targetId)||(s.Ia.set(e.targetId,e),Ym(s)?Qm(s):so(s).O_()&&Km(s,e))}function zm(t,e){const s=Je(t),n=so(s);s.Ia.delete(e),n.O_()&&rg(s,e),s.Ia.size===0&&(n.O_()?n.L_():ci(s)&&s.Ra.set("Unknown"))}function Km(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(et.min())>0){const s=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(s)}so(t).Y_(e)}function rg(t,e){t.Va.Ue(e),so(t).Z_(e)}function Qm(t){t.Va=new jv({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),so(t).start(),t.Ra.ua()}function Ym(t){return ci(t)&&!so(t).x_()&&t.Ia.size>0}function ci(t){return Je(t).Ea.size===0}function ig(t){t.Va=void 0}async function F_(t){t.Ra.set("Online")}async function O_(t){t.Ia.forEach((e,s)=>{Km(t,e)})}async function q_(t,e){ig(t),Ym(t)?(t.Ra.ha(e),Qm(t)):t.Ra.set("Unknown")}async function $_(t,e,s){if(t.Ra.set("Online"),e instanceof qh&&e.state===2&&e.cause)try{await async function(r,i){const a=i.cause;for(const c of i.targetIds)r.Ia.has(c)&&(await r.remoteSyncer.rejectListen(c,a),r.Ia.delete(c),r.Va.removeTarget(c))}(t,e)}catch(n){Ve(ri,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await fl(t,n)}else if(e instanceof Ya?t.Va.Ze(e):e instanceof Oh?t.Va.st(e):t.Va.tt(e),!s.isEqual(et.min()))try{const n=await eg(t.localStore);s.compareTo(n)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((m,u)=>{if(m.resumeToken.approximateByteSize()>0){const d=i.Ia.get(u);d&&i.Ia.set(u,d.withResumeToken(m.resumeToken,a))}}),c.targetMismatches.forEach((m,u)=>{const d=i.Ia.get(m);if(!d)return;i.Ia.set(m,d.withResumeToken(Fs.EMPTY_BYTE_STRING,d.snapshotVersion)),rg(i,m);const h=new br(d.target,m,u,d.sequenceNumber);Km(i,h)}),i.remoteSyncer.applyRemoteEvent(c)}(t,s)}catch(n){Ve(ri,"Failed to raise snapshot:",n),await fl(t,n)}}async function fl(t,e,s){if(!Zi(e))throw e;t.Ea.add(1),await to(t),t.Ra.set("Offline"),s||(s=()=>eg(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ve(ri,"Retrying IndexedDB access"),await s(),t.Ea.delete(1),await la(t)})}function og(t,e){return e().catch(s=>fl(t,s,e))}async function Hl(t){const e=Je(t),s=wr(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Pm;for(;W_(e);)try{const r=await E_(e.localStore,n);if(r===null){e.Ta.length===0&&s.L_();break}n=r.batchId,z_(e,r)}catch(r){await fl(e,r)}ag(e)&&lg(e)}function W_(t){return ci(t)&&t.Ta.length<10}function z_(t,e){t.Ta.push(e);const s=wr(t);s.O_()&&s.X_&&s.ea(e.mutations)}function ag(t){return ci(t)&&!wr(t).x_()&&t.Ta.length>0}function lg(t){wr(t).start()}async function K_(t){wr(t).ra()}async function Q_(t){const e=wr(t);for(const s of t.Ta)e.ea(s.mutations)}async function Y_(t,e,s){const n=t.Ta.shift(),r=Hm.from(n,e,s);await og(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Hl(t)}async function G_(t,e){e&&wr(t).X_&&await async function(n,r){if(function(a){return Iv(a)&&a!==ne.ABORTED}(r.code)){const i=n.Ta.shift();wr(n).B_(),await og(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Hl(n)}}(t,e),ag(t)&&lg(t)}async function sf(t,e){const s=Je(t);s.asyncQueue.verifyOperationInProgress(),Ve(ri,"RemoteStore received new credentials");const n=ci(s);s.Ea.add(3),await to(s),n&&s.Ra.set("Unknown"),await s.remoteSyncer.handleCredentialChange(e),s.Ea.delete(3),await la(s)}async function X_(t,e){const s=Je(t);e?(s.Ea.delete(2),await la(s)):e||(s.Ea.add(2),await to(s),s.Ra.set("Unknown"))}function so(t){return t.ma||(t.ma=function(s,n,r){const i=Je(s);return i.sa(),new T_(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:F_.bind(null,t),t_:O_.bind(null,t),r_:q_.bind(null,t),H_:$_.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Ym(t)?Qm(t):t.Ra.set("Unknown")):(await t.ma.stop(),ig(t))})),t.ma}function wr(t){return t.fa||(t.fa=function(s,n,r){const i=Je(s);return i.sa(),new B_(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:K_.bind(null,t),r_:G_.bind(null,t),ta:Q_.bind(null,t),na:Y_.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Hl(t)):(await t.fa.stop(),t.Ta.length>0&&(Ve(ri,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,s,n,r,i){this.asyncQueue=e,this.timerId=s,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Gn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,s,n,r,i){const a=Date.now()+n,c=new Gm(e,s,a,r,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xm(t,e){if(Zn("AsyncQueue",`${e}: ${t}`),Zi(t))return new Ae(ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{static emptySet(e){return new Fi(e.comparator)}constructor(e){this.comparator=e?(s,n)=>e(s,n)||Oe.comparator(s.key,n.key):(s,n)=>Oe.comparator(s.key,n.key),this.keyedMap=wo(),this.sortedSet=new ts(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const s=this.keyedMap.get(e);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((s,n)=>(e(s),!1))}add(e){const s=this.delete(e.key);return s.copy(s.keyedMap.insert(e.key,e),s.sortedSet.insert(e,null))}delete(e){const s=this.get(e);return s?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(s)):this}isEqual(e){if(!(e instanceof Fi)||this.size!==e.size)return!1;const s=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;s.hasNext();){const r=s.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(s=>{e.push(s.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,s){const n=new Fi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=s,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(){this.ga=new ts(Oe.comparator)}track(e){const s=e.doc.key,n=this.ga.get(s);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(s,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(s,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(s,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(s):e.type===1&&n.type===2?this.ga=this.ga.insert(s,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):Ye(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(s,e)}ya(){const e=[];return this.ga.inorderTraversal((s,n)=>{e.push(n)}),e}}class Qi{constructor(e,s,n,r,i,a,c,m,u){this.query=e,this.docs=s,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=m,this.hasCachedResults=u}static fromInitialDocuments(e,s,n,r,i){const a=[];return s.forEach(c=>{a.push({type:0,doc:c})}),new Qi(e,s,Fi.emptySet(s),a,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ll(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const s=this.docChanges,n=e.docChanges;if(s.length!==n.length)return!1;for(let r=0;r<s.length;r++)if(s[r].type!==n[r].type||!s[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Z_{constructor(){this.queries=rf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(s,n){const r=Je(s),i=r.queries;r.queries=rf(),i.forEach((a,c)=>{for(const m of c.Sa)m.onError(n)})})(this,new Ae(ne.ABORTED,"Firestore shutting down"))}}function rf(){return new li(t=>wh(t),Ll)}async function Jm(t,e){const s=Je(t);let n=3;const r=e.query;let i=s.queries.get(r);i?!i.ba()&&e.Da()&&(n=2):(i=new J_,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await s.onListen(r,!0);break;case 1:i.wa=await s.onListen(r,!1);break;case 2:await s.onFirstRemoteStoreListen(r)}}catch(a){const c=Xm(a,`Initialization of query '${ji(e.query)}' failed`);return void e.onError(c)}s.queries.set(r,i),i.Sa.push(e),e.va(s.onlineState),i.wa&&e.Fa(i.wa)&&eu(s)}async function Zm(t,e){const s=Je(t),n=e.query;let r=3;const i=s.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return s.queries.delete(n),s.onUnlisten(n,!0);case 1:return s.queries.delete(n),s.onUnlisten(n,!1);case 2:return s.onLastRemoteStoreUnlisten(n);default:return}}function eD(t,e){const s=Je(t);let n=!1;for(const r of e){const i=r.query,a=s.queries.get(i);if(a){for(const c of a.Sa)c.Fa(r)&&(n=!0);a.wa=r}}n&&eu(s)}function tD(t,e,s){const n=Je(t),r=n.queries.get(e);if(r)for(const i of r.Sa)i.onError(s);n.queries.delete(e)}function eu(t){t.Ca.forEach(e=>{e.next()})}var im,of;(of=im||(im={})).Ma="default",of.Cache="cache";class tu{constructor(e,s,n){this.query=e,this.xa=s,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new Qi(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let s=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),s=!0):this.La(e,this.onlineState)&&(this.ka(e),s=!0),this.Na=e,s}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let s=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),s=!0),s}La(e,s){if(!e.fromCache||!this.Da())return!0;const n=s!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||s==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const s=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}ka(e){e=Qi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==im.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e){this.key=e}}class mg{constructor(e){this.key=e}}class sD{constructor(e,s){this.query=e,this.Ya=s,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Dt(),this.mutatedKeys=Dt(),this.eu=Sh(e),this.tu=new Fi(this.eu)}get nu(){return this.Ya}ru(e,s){const n=s?s.iu:new nf,r=s?s.tu:this.tu;let i=s?s.mutatedKeys:this.mutatedKeys,a=r,c=!1;const m=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{const p=r.get(d),b=Pl(this.query,h)?h:null,w=!!p&&this.mutatedKeys.has(p.key),v=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let C=!1;p&&b?p.data.isEqual(b.data)?w!==v&&(n.track({type:3,doc:b}),C=!0):this.su(p,b)||(n.track({type:2,doc:b}),C=!0,(m&&this.eu(b,m)>0||u&&this.eu(b,u)<0)&&(c=!0)):!p&&b?(n.track({type:0,doc:b}),C=!0):p&&!b&&(n.track({type:1,doc:p}),C=!0,(m||u)&&(c=!0)),C&&(b?(a=a.add(b),i=v?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:a,iu:n,Cs:c,mutatedKeys:i}}su(e,s){return e.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(e,s,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((d,h)=>function(b,w){const v=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ye(20277,{Rt:C})}};return v(b)-v(w)}(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(n),r=r??!1;const c=s&&!r?this._u():[],m=this.Xa.size===0&&this.current&&!r?1:0,u=m!==this.Za;return this.Za=m,a.length!==0||u?{snapshot:new Qi(this.query,e.tu,i,a,e.mutatedKeys,m===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new nf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(s=>this.Ya=this.Ya.add(s)),e.modifiedDocuments.forEach(s=>{}),e.removedDocuments.forEach(s=>this.Ya=this.Ya.delete(s)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Dt(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const s=[];return e.forEach(n=>{this.Xa.has(n)||s.push(new mg(n))}),this.Xa.forEach(n=>{e.has(n)||s.push(new cg(n))}),s}cu(e){this.Ya=e.Qs,this.Xa=Dt();const s=this.ru(e.documents);return this.applyChanges(s,!0)}lu(){return Qi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const su="SyncEngine";class nD{constructor(e,s,n){this.query=e,this.targetId=s,this.view=n}}class rD{constructor(e){this.key=e,this.hu=!1}}class iD{constructor(e,s,n,r,i,a){this.localStore=e,this.remoteStore=s,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new li(c=>wh(c),Ll),this.Iu=new Map,this.Eu=new Set,this.du=new ts(Oe.comparator),this.Au=new Map,this.Ru=new Om,this.Vu={},this.mu=new Map,this.fu=Ki.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function oD(t,e,s=!0){const n=gg(t);let r;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await ug(n,e,s,!0),r}async function aD(t,e){const s=gg(t);await ug(s,e,!0,!1)}async function ug(t,e,s,n){const r=await C_(t.localStore,Un(e)),i=r.targetId,a=t.sharedClientState.addLocalQueryTarget(i,s);let c;return n&&(c=await lD(t,e,i,a==="current",r.resumeToken)),t.isPrimaryClient&&s&&ng(t.remoteStore,r),c}async function lD(t,e,s,n,r){t.pu=(h,p,b)=>async function(v,C,R,I){let z=C.view.ru(R);z.Cs&&(z=await Xd(v.localStore,C.query,!1).then(({documents:A})=>C.view.ru(A,z)));const ie=I&&I.targetChanges.get(C.targetId),te=I&&I.targetMismatches.get(C.targetId)!=null,O=C.view.applyChanges(z,v.isPrimaryClient,ie,te);return lf(v,C.targetId,O.au),O.snapshot}(t,h,p,b);const i=await Xd(t.localStore,e,!0),a=new sD(e,i.Qs),c=a.ru(i.documents),m=aa.createSynthesizedTargetChangeForCurrentChange(s,n&&t.onlineState!=="Offline",r),u=a.applyChanges(c,t.isPrimaryClient,m);lf(t,s,u.au);const d=new nD(e,s,a);return t.Tu.set(e,d),t.Iu.has(s)?t.Iu.get(s).push(e):t.Iu.set(s,[e]),u.snapshot}async function cD(t,e,s){const n=Je(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);if(i.length>1)return n.Iu.set(r.targetId,i.filter(a=>!Ll(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await nm(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),s&&zm(n.remoteStore,r.targetId),om(n,r.targetId)}).catch(Ji)):(om(n,r.targetId),await nm(n.localStore,r.targetId,!0))}async function mD(t,e){const s=Je(t),n=s.Tu.get(e),r=s.Iu.get(n.targetId);s.isPrimaryClient&&r.length===1&&(s.sharedClientState.removeLocalQueryTarget(n.targetId),zm(s.remoteStore,n.targetId))}async function uD(t,e,s){const n=bD(t);try{const r=await function(a,c){const m=Je(a),u=be.now(),d=c.reduce((b,w)=>b.add(w.key),Dt());let h,p;return m.persistence.runTransaction("Locally write mutations","readwrite",b=>{let w=er(),v=Dt();return m.Ns.getEntries(b,d).next(C=>{w=C,w.forEach((R,I)=>{I.isValidDocument()||(v=v.add(R))})}).next(()=>m.localDocuments.getOverlayedDocuments(b,w)).next(C=>{h=C;const R=[];for(const I of c){const z=Ev(I,h.get(I.key).overlayedDocument);z!=null&&R.push(new Tr(I.key,z,vh(z.value.mapValue),Zs.exists(!0)))}return m.mutationQueue.addMutationBatch(b,u,R,c)}).next(C=>{p=C;const R=C.applyToLocalDocumentSet(h,v);return m.documentOverlayCache.saveOverlays(b,C.batchId,R)})}).then(()=>({batchId:p.batchId,changes:Lh(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(a,c,m){let u=a.Vu[a.currentUser.toKey()];u||(u=new ts(_t)),u=u.insert(c,m),a.Vu[a.currentUser.toKey()]=u}(n,r.batchId,s),await ca(n,r.changes),await Hl(n.remoteStore)}catch(r){const i=Xm(r,"Failed to persist write");s.reject(i)}}async function dg(t,e){const s=Je(t);try{const n=await k_(s.localStore,e);e.targetChanges.forEach((r,i)=>{const a=s.Au.get(i);a&&(Ut(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?Ut(a.hu,14607):r.removedDocuments.size>0&&(Ut(a.hu,42227),a.hu=!1))}),await ca(s,n,e)}catch(n){await Ji(n)}}function af(t,e,s){const n=Je(t);if(n.isPrimaryClient&&s===0||!n.isPrimaryClient&&s===1){const r=[];n.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&r.push(c.snapshot)}),function(a,c){const m=Je(a);m.onlineState=c;let u=!1;m.queries.forEach((d,h)=>{for(const p of h.Sa)p.va(c)&&(u=!0)}),u&&eu(m)}(n.eventManager,e),r.length&&n.Pu.H_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function dD(t,e,s){const n=Je(t);n.sharedClientState.updateQueryState(e,"rejected",s);const r=n.Au.get(e),i=r&&r.key;if(i){let a=new ts(Oe.comparator);a=a.insert(i,Ws.newNoDocument(i,et.min()));const c=Dt().add(i),m=new Rl(et.min(),new Map,new ts(_t),a,c);await dg(n,m),n.du=n.du.remove(i),n.Au.delete(e),nu(n)}else await nm(n.localStore,e,!1).then(()=>om(n,e,s)).catch(Ji)}async function fD(t,e){const s=Je(t),n=e.batch.batchId;try{const r=await D_(s.localStore,e);pg(s,n,null),fg(s,n),s.sharedClientState.updateMutationState(n,"acknowledged"),await ca(s,r)}catch(r){await Ji(r)}}async function pD(t,e,s){const n=Je(t);try{const r=await function(a,c){const m=Je(a);return m.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return m.mutationQueue.lookupMutationBatch(u,c).next(h=>(Ut(h!==null,37113),d=h.keys(),m.mutationQueue.removeMutationBatch(u,h))).next(()=>m.mutationQueue.performConsistencyCheck(u)).next(()=>m.documentOverlayCache.removeOverlaysForBatchId(u,d,c)).next(()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>m.localDocuments.getDocuments(u,d))})}(n.localStore,e);pg(n,e,s),fg(n,e),n.sharedClientState.updateMutationState(e,"rejected",s),await ca(n,r)}catch(r){await Ji(r)}}function fg(t,e){(t.mu.get(e)||[]).forEach(s=>{s.resolve()}),t.mu.delete(e)}function pg(t,e,s){const n=Je(t);let r=n.Vu[n.currentUser.toKey()];if(r){const i=r.get(e);i&&(s?i.reject(s):i.resolve(),r=r.remove(e)),n.Vu[n.currentUser.toKey()]=r}}function om(t,e,s=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),s&&t.Pu.yu(n,s);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||hg(t,n)})}function hg(t,e){t.Eu.delete(e.path.canonicalString());const s=t.du.get(e);s!==null&&(zm(t.remoteStore,s),t.du=t.du.remove(e),t.Au.delete(s),nu(t))}function lf(t,e,s){for(const n of s)n instanceof cg?(t.Ru.addReference(n.key,e),hD(t,n)):n instanceof mg?(Ve(su,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||hg(t,n.key)):Ye(19791,{wu:n})}function hD(t,e){const s=e.key,n=s.path.canonicalString();t.du.get(s)||t.Eu.has(n)||(Ve(su,"New document in limbo: "+s),t.Eu.add(n),nu(t))}function nu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const s=new Oe(Wt.fromString(e)),n=t.fu.next();t.Au.set(n,new rD(s)),t.du=t.du.insert(s,n),ng(t.remoteStore,new br(Un(Il(s.path)),n,"TargetPurposeLimboResolution",Vl.ce))}}async function ca(t,e,s){const n=Je(t),r=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,m)=>{a.push(n.pu(m,e,s).then(u=>{var d;if((u||s)&&n.isPrimaryClient){const h=u?!u.fromCache:(d=s==null?void 0:s.targetChanges.get(m.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(m.targetId,h?"current":"not-current")}if(u){r.push(u);const h=$m.As(m.targetId,u);i.push(h)}}))}),await Promise.all(a),n.Pu.H_(r),await async function(m,u){const d=Je(m);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ce.forEach(u,p=>ce.forEach(p.Es,b=>d.persistence.referenceDelegate.addReference(h,p.targetId,b)).next(()=>ce.forEach(p.ds,b=>d.persistence.referenceDelegate.removeReference(h,p.targetId,b)))))}catch(h){if(!Zi(h))throw h;Ve(Wm,"Failed to update sequence numbers: "+h)}for(const h of u){const p=h.targetId;if(!h.fromCache){const b=d.Ms.get(p),w=b.snapshotVersion,v=b.withLastLimboFreeSnapshotVersion(w);d.Ms=d.Ms.insert(p,v)}}}(n.localStore,i))}async function gD(t,e){const s=Je(t);if(!s.currentUser.isEqual(e)){Ve(su,"User change. New user:",e.toKey());const n=await Zh(s.localStore,e);s.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(m=>{m.reject(new Ae(ne.CANCELLED,a))})}),i.mu.clear()}(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ca(s,n.Ls)}}function yD(t,e){const s=Je(t),n=s.Au.get(e);if(n&&n.hu)return Dt().add(n.key);{let r=Dt();const i=s.Iu.get(e);if(!i)return r;for(const a of i){const c=s.Tu.get(a);r=r.unionWith(c.view.nu)}return r}}function gg(t){const e=Je(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dD.bind(null,e),e.Pu.H_=eD.bind(null,e.eventManager),e.Pu.yu=tD.bind(null,e.eventManager),e}function bD(t){const e=Je(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pD.bind(null,e),e}class pl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ul(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,s){return null}Mu(e,s){return null}vu(e){return __(this.persistence,new N_,e.initialUser,this.serializer)}Cu(e){return new Jh(qm.mi,this.serializer)}Du(e){return new w_}async terminate(){var e,s;(e=this.gcScheduler)==null||e.stop(),(s=this.indexBackfillerScheduler)==null||s.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pl.provider={build:()=>new pl};class ND extends pl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,s){Ut(this.persistence.referenceDelegate instanceof dl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new r_(n,e.asyncQueue,s)}Cu(e){const s=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new Jh(n=>dl.mi(n,s),this.serializer)}}class am{async initialize(e,s){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>af(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=gD.bind(null,this.syncEngine),await X_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Z_}()}createDatastore(e){const s=Ul(e.databaseInfo.databaseId),n=function(i){return new j_(i)}(e.databaseInfo);return function(i,a,c,m){return new U_(i,a,c,m)}(e.authCredentials,e.appCheckCredentials,n,s)}createRemoteStore(e){return function(n,r,i,a,c){return new M_(n,r,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,s=>af(this.syncEngine,s,0),function(){return ef.v()?new ef:new S_}())}createSyncEngine(e,s){return function(r,i,a,c,m,u,d){const h=new iD(r,i,a,c,m,u);return d&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,s)}async terminate(){var e,s;await async function(r){const i=Je(r);Ve(ri,"RemoteStore shutting down."),i.Ea.add(5),await to(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(s=this.eventManager)==null||s.terminate()}}am.provider={build:()=>new am};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,s){setTimeout(()=>{this.muted||e(s)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr="FirestoreClient";class xD{constructor(e,s,n,r,i){this.authCredentials=e,this.appCheckCredentials=s,this.asyncQueue=n,this.databaseInfo=r,this.user=$s.UNAUTHENTICATED,this.clientId=Lm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Ve(Sr,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ve(Sr,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Gn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const n=Xm(s,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Dc(t,e){t.asyncQueue.verifyOperationInProgress(),Ve(Sr,"Initializing OfflineComponentProvider");const s=t.configuration;await e.initialize(s);let n=s.initialUser;t.setCredentialChangeListener(async r=>{n.isEqual(r)||(await Zh(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function cf(t,e){t.asyncQueue.verifyOperationInProgress();const s=await yg(t);Ve(Sr,"Initializing OnlineComponentProvider"),await e.initialize(s,t.configuration),t.setCredentialChangeListener(n=>sf(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,r)=>sf(e.remoteStore,r)),t._onlineComponents=e}async function yg(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ve(Sr,"Using user provided OfflineComponentProvider");try{await Dc(t,t._uninitializedComponentsProvider._offline)}catch(e){const s=e;if(!function(r){return r.name==="FirebaseError"?r.code===ne.FAILED_PRECONDITION||r.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(s))throw s;qi("Error using user provided cache. Falling back to memory cache: "+s),await Dc(t,new pl)}}else Ve(Sr,"Using default OfflineComponentProvider"),await Dc(t,new ND(void 0));return t._offlineComponents}async function iu(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ve(Sr,"Using user provided OnlineComponentProvider"),await cf(t,t._uninitializedComponentsProvider._online)):(Ve(Sr,"Using default OnlineComponentProvider"),await cf(t,new am))),t._onlineComponents}function bg(t){return yg(t).then(e=>e.persistence)}function Ng(t){return iu(t).then(e=>e.remoteStore)}function vD(t){return iu(t).then(e=>e.syncEngine)}async function hl(t){const e=await iu(t),s=e.eventManager;return s.onListen=oD.bind(null,e.syncEngine),s.onUnlisten=cD.bind(null,e.syncEngine),s.onFirstRemoteStoreListen=aD.bind(null,e.syncEngine),s.onLastRemoteStoreUnlisten=mD.bind(null,e.syncEngine),s}function _D(t){return t.asyncQueue.enqueue(async()=>{const e=await bg(t),s=await Ng(t);return e.setNetworkEnabled(!0),function(r){const i=Je(r);return i.Ea.delete(0),la(i)}(s)})}function DD(t){return t.asyncQueue.enqueue(async()=>{const e=await bg(t),s=await Ng(t);return e.setNetworkEnabled(!1),async function(r){const i=Je(r);i.Ea.add(0),await to(i),i.Ra.set("Offline")}(s)})}function kD(t,e,s={}){const n=new Gn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,m,u){const d=new ru({next:p=>{d.Nu(),a.enqueueAndForget(()=>Zm(i,h));const b=p.docs.has(c);!b&&p.fromCache?u.reject(new Ae(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&p.fromCache&&m&&m.source==="server"?u.reject(new Ae(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new tu(Il(c.path),d,{includeMetadataChanges:!0,qa:!0});return Jm(i,h)}(await hl(t),t.asyncQueue,e,s,n)),n.promise}function xg(t,e,s={}){const n=new Gn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,m,u){const d=new ru({next:p=>{d.Nu(),a.enqueueAndForget(()=>Zm(i,h)),p.fromCache&&m.source==="server"?u.reject(new Ae(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new tu(c,d,{includeMetadataChanges:!0,qa:!0});return Jm(i,h)}(await hl(t),t.asyncQueue,e,s,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g="firestore.googleapis.com",uf=!0;class df{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_g,this.ssl=uf}else this.host=e.host,this.ssl=e.ssl??uf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Xh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<s_)throw new Ae(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Hx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vg(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ae(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ae(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ae(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ml{constructor(e,s,n,r){this._authCredentials=e,this._appCheckCredentials=s,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new df({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new df(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new wx;switch(n.type){case"firstParty":return new Px(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ae(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(s){const n=mf.get(s);n&&(Ve("ComponentProvider","Removing Datastore"),mf.delete(s),n.terminate())}(this),Promise.resolve()}}function AD(t,e,s,n={}){var u;t=Vs(t,Ml);const r=ra(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${s}`;r&&(Op(`https://${c}`),$p("Firestore",!0)),i.host!==_g&&i.host!==c&&qi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...i,host:c,ssl:r,emulatorOptions:n};if(!il(m,a)&&(t._setSettings(m),n.mockUserToken)){let d,h;if(typeof n.mockUserToken=="string")d=n.mockUserToken,h=$s.MOCK_USER;else{d=qp(n.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new Ae(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new $s(p)}t._authCredentials=new Sx(new ch(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,s,n){this.converter=s,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new tr(this.firestore,e,this._query)}}class rs{constructor(e,s,n){this.converter=s,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rs(this.firestore,e,this._key)}toJSON(){return{type:rs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,s,n){if(ia(s,rs._jsonSchema))return new rs(e,n||null,new Oe(Wt.fromString(s.referencePath)))}}rs._jsonSchemaVersion="firestore/documentReference/1.0",rs._jsonSchema={type:xs("string",rs._jsonSchemaVersion),referencePath:xs("string")};class Dr extends tr{constructor(e,s,n){super(e,s,Il(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rs(this.firestore,null,new Oe(e))}withConverter(e){return new Dr(this.firestore,e,this._path)}}function Fe(t,e,...s){if(t=Ms(t),mh("collection","path",e),t instanceof Ml){const n=Wt.fromString(e,...s);return kd(n),new Dr(t,null,n)}{if(!(t instanceof rs||t instanceof Dr))throw new Ae(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Wt.fromString(e,...s));return kd(n),new Dr(t.firestore,null,n)}}function we(t,e,...s){if(t=Ms(t),arguments.length===1&&(e=Lm.newId()),mh("doc","path",e),t instanceof Ml){const n=Wt.fromString(e,...s);return Dd(n),new rs(t,null,new Oe(n))}{if(!(t instanceof rs||t instanceof Dr))throw new Ae(ne.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Wt.fromString(e,...s));return Dd(n),new rs(t.firestore,t instanceof Dr?t.converter:null,new Oe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff="AsyncQueue";class pf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new tg(this,"async_queue_retry"),this._c=()=>{const n=_c();n&&Ve(ff,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const s=_c();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const s=_c();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const s=new Gn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(s.resolve,s.reject),s.promise)).then(()=>s.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Zi(e))throw e;Ve(ff,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const s=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Zn("INTERNAL UNHANDLED ERROR: ",hf(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=s,s}enqueueAfterDelay(e,s,n){this.uc(),this.oc.indexOf(e)>-1&&(s=0);const r=Gm.createAndSchedule(this,e,s,n,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Ye(47125,{Pc:hf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const s of this.tc)if(s.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((s,n)=>s.targetTimeMs-n.targetTimeMs);for(const s of this.tc)if(s.skipDelay(),e!=="all"&&s.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const s=this.tc.indexOf(e);this.tc.splice(s,1)}}function hf(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(t){return function(s,n){if(typeof s!="object"||s===null)return!1;const r=s;for(const i of n)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class un extends Ml{constructor(e,s,n,r){super(e,s,n,r),this.type="firestore",this._queue=new pf,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pf(e),this._firestoreClient=void 0,await e}}}function ED(t,e){const s=typeof t=="object"?t:Zp(),n=typeof t=="string"?t:al,r=Yp(s,"firestore").getImmediate({identifier:n});if(!r._initialized){const i=Mp("firestore");i&&AD(r,...i)}return r}function Br(t){if(t._terminated)throw new Ae(ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||CD(t),t._firestoreClient}function CD(t){var n,r,i;const e=t._freezeSettings(),s=function(c,m,u,d){return new Gx(c,m,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,vg(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new xD(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(c){const m=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(m),_online:m}}(t._componentsProvider))}function VD(t){return _D(Br(t=Vs(t,un)))}function wD(t){return DD(Br(t=Vs(t,un)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yn(Fs.fromBase64String(e))}catch(s){throw new Ae(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(e){return new yn(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ia(e,yn._jsonSchema))return yn.fromBase64String(e.bytes)}}yn._jsonSchemaVersion="firestore/bytes/1.0",yn._jsonSchema={type:xs("string",yn._jsonSchemaVersion),bytes:xs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(...e){for(let s=0;s<e.length;++s)if(e[s].length===0)throw new Ae(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e,s){if(!isFinite(e)||e<-90||e>90)throw new Ae(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(s)||s<-180||s>180)throw new Ae(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=e,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return _t(this._lat,e._lat)||_t(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Mn._jsonSchemaVersion}}static fromJSON(e){if(ia(e,Mn._jsonSchema))return new Mn(e.latitude,e.longitude)}}Mn._jsonSchemaVersion="firestore/geoPoint/1.0",Mn._jsonSchema={type:xs("string",Mn._jsonSchemaVersion),latitude:xs("number"),longitude:xs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this._values=(e||[]).map(s=>s)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Fn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ia(e,Fn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(s=>typeof s=="number"))return new Fn(e.vectorValues);throw new Ae(ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fn._jsonSchemaVersion="firestore/vectorValue/1.0",Fn._jsonSchema={type:xs("string",Fn._jsonSchemaVersion),vectorValues:xs("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=/^__.*__$/;class ID{constructor(e,s,n){this.data=e,this.fieldMask=s,this.fieldTransforms=n}toMutation(e,s){return this.fieldMask!==null?new Tr(e,this.data,this.fieldMask,s,this.fieldTransforms):new oa(e,this.data,s,this.fieldTransforms)}}class Dg{constructor(e,s,n){this.data=e,this.fieldMask=s,this.fieldTransforms=n}toMutation(e,s){return new Tr(e,this.data,this.fieldMask,s,this.fieldTransforms)}}function kg(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ye(40011,{Ac:t})}}class ou{constructor(e,s,n,r,i,a){this.settings=e,this.databaseId=s,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ou({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const s=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:s,fc:!1});return n.gc(e),n}yc(e){var r;const s=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:s,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return gl(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(s=>e.isPrefixOf(s))!==void 0||this.fieldTransforms.find(s=>e.isPrefixOf(s.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(kg(this.Ac)&&SD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class LD{constructor(e,s,n){this.databaseId=e,this.ignoreUndefinedProperties=s,this.serializer=n||Ul(e)}Cc(e,s,n,r=!1){return new ou({Ac:e,methodName:s,Dc:n,path:Hs.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ua(t){const e=t._freezeSettings(),s=Ul(t._databaseId);return new LD(t._databaseId,!!e.ignoreUndefinedProperties,s)}function au(t,e,s,n,r,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,s,r);cu("Data must be an object, but it was:",a,n);const c=Cg(n,a);let m,u;if(i.merge)m=new cn(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const p=lm(e,h,s);if(!a.contains(p))throw new Ae(ne.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);wg(d,p)||d.push(p)}m=new cn(d),u=a.fieldTransforms.filter(h=>m.covers(h.field))}else m=null,u=a.fieldTransforms;return new ID(new on(c),m,u)}class Ol extends Fl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ol}}class lu extends Fl{_toFieldTransform(e){return new _v(e.path,new Xo)}isEqual(e){return e instanceof lu}}function Ag(t,e,s,n){const r=t.Cc(1,e,s);cu("Data must be an object, but it was:",r,n);const i=[],a=on.empty();jr(n,(m,u)=>{const d=mu(e,m,s);u=Ms(u);const h=r.yc(d);if(u instanceof Ol)i.push(d);else{const p=da(u,h);p!=null&&(i.push(d),a.set(d,p))}});const c=new cn(i);return new Dg(a,c,r.fieldTransforms)}function Eg(t,e,s,n,r,i){const a=t.Cc(1,e,s),c=[lm(e,n,s)],m=[r];if(i.length%2!=0)throw new Ae(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)c.push(lm(e,i[p])),m.push(i[p+1]);const u=[],d=on.empty();for(let p=c.length-1;p>=0;--p)if(!wg(u,c[p])){const b=c[p];let w=m[p];w=Ms(w);const v=a.yc(b);if(w instanceof Ol)u.push(b);else{const C=da(w,v);C!=null&&(u.push(b),d.set(b,C))}}const h=new cn(u);return new Dg(d,h,a.fieldTransforms)}function PD(t,e,s,n=!1){return da(s,t.Cc(n?4:3,e))}function da(t,e){if(Vg(t=Ms(t)))return cu("Unsupported field value:",e,t),Cg(t,e);if(t instanceof Fl)return function(n,r){if(!kg(r.Ac))throw r.Sc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,r){const i=[];let a=0;for(const c of n){let m=da(c,r.wc(a));m==null&&(m={nullValue:"NULL_VALUE"}),i.push(m),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,r){if((n=Ms(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Nv(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=be.fromDate(n);return{timestampValue:ul(r.serializer,i)}}if(n instanceof be){const i=new be(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ul(r.serializer,i)}}if(n instanceof Mn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof yn)return{bytesValue:$h(r.serializer,n._byteString)};if(n instanceof rs){const i=r.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Fm(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof Fn)return function(a,c){return{mapValue:{fields:{[Nh]:{stringValue:xh},[ll]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw c.Sc("VectorValues must only contain numeric values.");return Um(c.serializer,u)})}}}}}}(n,r);throw r.Sc(`Unsupported field value: ${Cl(n)}`)}(t,e)}function Cg(t,e){const s={};return fh(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jr(t,(n,r)=>{const i=da(r,e.mc(n));i!=null&&(s[n]=i)}),{mapValue:{fields:s}}}function Vg(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof be||t instanceof Mn||t instanceof yn||t instanceof rs||t instanceof Fl||t instanceof Fn)}function cu(t,e,s){if(!Vg(s)||!uh(s)){const n=Cl(s);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function lm(t,e,s){if((e=Ms(e))instanceof ma)return e._internalPath;if(typeof e=="string")return mu(t,e);throw gl("Field path arguments must be of type string or ",t,!1,void 0,s)}const jD=new RegExp("[~\\*/\\[\\]]");function mu(t,e,s){if(e.search(jD)>=0)throw gl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,s);try{return new ma(...e.split("."))._internalPath}catch{throw gl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,s)}}function gl(t,e,s,n,r){const i=n&&!n.isEmpty(),a=r!==void 0;let c=`Function ${e}() called with invalid data`;s&&(c+=" (via `toFirestore()`)"),c+=". ";let m="";return(i||a)&&(m+=" (found",i&&(m+=` in field ${n}`),a&&(m+=` in document ${r}`),m+=")"),new Ae(ne.INVALID_ARGUMENT,c+t+m)}function wg(t,e){return t.some(s=>s.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e,s,n,r,i){this._firestore=e,this._userDataWriter=s,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new rs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const s=this._document.data.field(ql("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s)}}}class TD extends Sg{data(){return super.data()}}function ql(t,e){return typeof e=="string"?mu(t,e):e instanceof ma?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ae(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class uu{}class Lg extends uu{}function vt(t,e,...s){let n=[];e instanceof uu&&n.push(e),n=n.concat(s),function(i){const a=i.filter(m=>m instanceof du).length,c=i.filter(m=>m instanceof $l).length;if(a>1||a>0&&c>0)throw new Ae(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)t=r._apply(t);return t}class $l extends Lg{constructor(e,s,n){super(),this._field=e,this._op=s,this._value=n,this.type="where"}static _create(e,s,n){return new $l(e,s,n)}_apply(e){const s=this._parse(e);return Pg(e._query,s),new tr(e.firestore,e.converter,Xc(e._query,s))}_parse(e){const s=ua(e.firestore);return function(i,a,c,m,u,d,h){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ae(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){bf(h,d);const w=[];for(const v of h)w.push(yf(m,i,v));p={arrayValue:{values:w}}}else p=yf(m,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||bf(h,d),p=PD(c,a,h,d==="in"||d==="not-in");return Ns.create(u,d,p)}(e._query,"where",s,e.firestore._databaseId,this._field,this._op,this._value)}}function Ts(t,e,s){const n=e,r=ql("where",t);return $l._create(r,n,s)}class du extends uu{constructor(e,s){super(),this.type=e,this._queryConstraints=s}static _create(e,s){return new du(e,s)}_parse(e){const s=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return s.length===1?s[0]:En.create(s,this._getOperator())}_apply(e){const s=this._parse(e);return s.getFilters().length===0?e:(function(r,i){let a=r;const c=i.getFlattenedFilters();for(const m of c)Pg(a,m),a=Xc(a,m)}(e._query,s),new tr(e.firestore,e.converter,Xc(e._query,s)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class fu extends Lg{constructor(e,s){super(),this._field=e,this._direction=s,this.type="orderBy"}static _create(e,s){return new fu(e,s)}_apply(e){const s=function(r,i,a){if(r.startAt!==null)throw new Ae(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ae(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Go(i,a)}(e._query,this._field,this._direction);return new tr(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new eo(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,s))}}function is(t,e="asc"){const s=e,n=ql("orderBy",t);return fu._create(n,s)}function yf(t,e,s){if(typeof(s=Ms(s))=="string"){if(s==="")throw new Ae(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vh(e)&&s.indexOf("/")!==-1)throw new Ae(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${s}' contains a '/' character.`);const n=e.path.child(Wt.fromString(s));if(!Oe.isDocumentKey(n))throw new Ae(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Ld(t,new Oe(n))}if(s instanceof rs)return Ld(t,s._key);throw new Ae(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Cl(s)}.`)}function bf(t,e){if(!Array.isArray(t)||t.length===0)throw new Ae(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Pg(t,e){const s=function(r,i){for(const a of r)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(s!==null)throw s===e.op?new Ae(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ae(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${s.toString()}' filters.`)}class BD{convertValue(e,s="none"){switch(Vr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ms(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,s);case 5:return e.stringValue;case 6:return this.convertBytes(Cr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,s);case 11:return this.convertObject(e.mapValue,s);case 10:return this.convertVectorValue(e.mapValue);default:throw Ye(62114,{value:e})}}convertObject(e,s){return this.convertObjectMap(e.fields,s)}convertObjectMap(e,s="none"){const n={};return jr(e,(r,i)=>{n[r]=this.convertValue(i,s)}),n}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)==null?void 0:n[ll].arrayValue)==null?void 0:r.values)==null?void 0:i.map(a=>ms(a.doubleValue));return new Fn(s)}convertGeoPoint(e){return new Mn(ms(e.latitude),ms(e.longitude))}convertArray(e,s){return(e.values||[]).map(n=>this.convertValue(n,s))}convertServerTimestamp(e,s){switch(s){case"previous":const n=Sl(e);return n==null?null:this.convertValue(n,s);case"estimate":return this.convertTimestamp(Ko(e));default:return null}}convertTimestamp(e){const s=Er(e);return new be(s.seconds,s.nanos)}convertDocumentKey(e,s){const n=Wt.fromString(e);Ut(Gh(n),9688,{name:e});const r=new Qo(n.get(1),n.get(3)),i=new Oe(n.popFirst(5));return r.isEqual(s)||Zn(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(t,e,s){let n;return n=t?s&&(s.merge||s.mergeFields)?t.toFirestore(e,s):t.toFirestore(e):e,n}class Io{constructor(e,s){this.hasPendingWrites=e,this.fromCache=s}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zr extends Sg{constructor(e,s,n,r,i,a){super(e,s,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const s=new Ga(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,s={}){if(this._document){const n=this._document.data.field(ql("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,s.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,s={};return s.type=Zr._jsonSchemaVersion,s.bundle="",s.bundleSource="DocumentSnapshot",s.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?s:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),s.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),s)}}Zr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zr._jsonSchema={type:xs("string",Zr._jsonSchemaVersion),bundleSource:xs("string","DocumentSnapshot"),bundleName:xs("string"),bundle:xs("string")};class Ga extends Zr{data(e={}){return super.data(e)}}class kr{constructor(e,s,n,r){this._firestore=e,this._userDataWriter=s,this._snapshot=r,this.metadata=new Io(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(s=>e.push(s)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,s){this._snapshot.docs.forEach(n=>{e.call(s,new Ga(this._firestore,this._userDataWriter,n.key,n,new Io(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const s=!!e.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new Ae(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>{const m=new Ga(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Io(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:m,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const m=new Ga(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Io(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,d=-1;return c.type!==0&&(u=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:RD(c.type),doc:m,oldIndex:u,newIndex:d}})}}(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=kr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Lm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const s=[],n=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(s.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function RD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ye(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(t){t=Vs(t,rs);const e=Vs(t.firestore,un);return kD(Br(e),t._key).then(s=>jg(e,t,s))}kr._jsonSchemaVersion="firestore/querySnapshot/1.0",kr._jsonSchema={type:xs("string",kr._jsonSchemaVersion),bundleSource:xs("string","QuerySnapshot"),bundleName:xs("string"),bundle:xs("string")};class Wl extends BD{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new rs(this.firestore,null,s)}}function At(t){t=Vs(t,tr);const e=Vs(t.firestore,un),s=Br(e),n=new Wl(e);return Ig(t._query),xg(s,t._query).then(r=>new kr(e,n,t,r))}function UD(t){t=Vs(t,tr);const e=Vs(t.firestore,un),s=Br(e),n=new Wl(e);return xg(s,t._query,{source:"server"}).then(r=>new kr(e,n,t,r))}function ii(t,e,s){t=Vs(t,rs);const n=Vs(t.firestore,un),r=pu(t.converter,e,s);return fa(n,[au(ua(n),"setDoc",t._key,r,t.converter!==null,s).toMutation(t._key,Zs.none())])}function Rt(t,e,s,...n){t=Vs(t,rs);const r=Vs(t.firestore,un),i=ua(r);let a;return a=typeof(e=Ms(e))=="string"||e instanceof ma?Eg(i,"updateDoc",t._key,e,s,n):Ag(i,"updateDoc",t._key,e),fa(r,[a.toMutation(t._key,Zs.exists(!0))])}function Us(t){return fa(Vs(t.firestore,un),[new Bl(t._key,Zs.none())])}function On(t,e){const s=Vs(t.firestore,un),n=we(t),r=pu(t.converter,e);return fa(s,[au(ua(t.firestore),"addDoc",n._key,r,t.converter!==null,{}).toMutation(n._key,Zs.exists(!1))]).then(()=>n)}function dn(t,...e){var m,u,d;t=Ms(t);let s={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||gf(e[n])||(s=e[n++]);const r={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(gf(e[n])){const h=e[n];e[n]=(m=h.next)==null?void 0:m.bind(h),e[n+1]=(u=h.error)==null?void 0:u.bind(h),e[n+2]=(d=h.complete)==null?void 0:d.bind(h)}let i,a,c;if(t instanceof rs)a=Vs(t.firestore,un),c=Il(t._key.path),i={next:h=>{e[n]&&e[n](jg(a,t,h))},error:e[n+1],complete:e[n+2]};else{const h=Vs(t,tr);a=Vs(h.firestore,un),c=h._query;const p=new Wl(a);i={next:b=>{e[n]&&e[n](new kr(a,p,h,b))},error:e[n+1],complete:e[n+2]},Ig(t._query)}return function(p,b,w,v){const C=new ru(v),R=new tu(b,C,w);return p.asyncQueue.enqueueAndForget(async()=>Jm(await hl(p),R)),()=>{C.Nu(),p.asyncQueue.enqueueAndForget(async()=>Zm(await hl(p),R))}}(Br(a),c,r,i)}function fa(t,e){return function(n,r){const i=new Gn;return n.asyncQueue.enqueueAndForget(async()=>uD(await vD(n),r,i)),i.promise}(Br(t),e)}function jg(t,e,s){const n=s.docs.get(e._key),r=new Wl(t);return new Zr(t,r,e._key,n,new Io(s.hasPendingWrites,s.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,s){this._firestore=e,this._commitHandler=s,this._mutations=[],this._committed=!1,this._dataReader=ua(e)}set(e,s,n){this._verifyNotCommitted();const r=kc(e,this._firestore),i=pu(r.converter,s,n),a=au(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,n);return this._mutations.push(a.toMutation(r._key,Zs.none())),this}update(e,s,n,...r){this._verifyNotCommitted();const i=kc(e,this._firestore);let a;return a=typeof(s=Ms(s))=="string"||s instanceof ma?Eg(this._dataReader,"WriteBatch.update",i._key,s,n,r):Ag(this._dataReader,"WriteBatch.update",i._key,s),this._mutations.push(a.toMutation(i._key,Zs.exists(!0))),this}delete(e){this._verifyNotCommitted();const s=kc(e,this._firestore);return this._mutations=this._mutations.concat(new Bl(s._key,Zs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ae(ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function kc(t,e){if((t=Ms(t)).firestore!==e)throw new Ae(ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function ns(){return new lu("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t){return Br(t=Vs(t,un)),new HD(t,e=>fa(t,e))}(function(e,s=!0){(function(r){Xi=r})(Xp),$o(new Oi("firestore",(n,{instanceIdentifier:r,options:i})=>{const a=n.getProvider("app").getImmediate(),c=new un(new Ix(n.getProvider("auth-internal")),new jx(a,n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Ae(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(u.options.projectId,d)}(a,r),a);return i={useFetchStreams:s,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),vr(Nd,xd,e),vr(Nd,xd,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg="firebasestorage.googleapis.com",Rg="storageBucket",MD=2*60*1e3,FD=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as extends ai{constructor(e,s,n=0){super(Ac(e),`Firebase Storage: ${s} (${Ac(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,as.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ac(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var os;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(os||(os={}));function Ac(t){return"storage/"+t}function hu(){const t="An unknown error occurred, please check the error payload for server response.";return new as(os.UNKNOWN,t)}function OD(t){return new as(os.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function qD(t){return new as(os.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $D(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new as(os.UNAUTHENTICATED,t)}function WD(){return new as(os.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function zD(t){return new as(os.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function KD(){return new as(os.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function QD(){return new as(os.CANCELED,"User canceled the upload/download.")}function YD(t){return new as(os.INVALID_URL,"Invalid URL '"+t+"'.")}function GD(t){return new as(os.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function XD(){return new as(os.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Rg+"' property when initializing the app?")}function JD(){return new as(os.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ZD(){return new as(os.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function ek(t){return new as(os.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function cm(t){return new as(os.INVALID_ARGUMENT,t)}function Ug(){return new as(os.APP_DELETED,"The Firebase app was deleted.")}function tk(t){return new as(os.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Uo(t,e){return new as(os.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function po(t){throw new as(os.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,s){this.bucket=e,this.path_=s}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,s){let n;try{n=mn.makeFromUrl(e,s)}catch{return new mn(e,"")}if(n.path==="")return n;throw GD(e)}static makeFromUrl(e,s){let n=null;const r="([A-Za-z0-9.\\-_]+)";function i(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+r+a,"i"),m={bucket:1,path:3};function u(ie){ie.path_=decodeURIComponent(ie.path)}const d="v[A-Za-z0-9_]+",h=s.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",b=new RegExp(`^https?://${h}/${d}/b/${r}/o${p}`,"i"),w={bucket:1,path:3},v=s===Bg?"(?:storage.googleapis.com|storage.cloud.google.com)":s,C="([^?#]*)",R=new RegExp(`^https?://${v}/${r}/${C}`,"i"),z=[{regex:c,indices:m,postModify:i},{regex:b,indices:w,postModify:u},{regex:R,indices:{bucket:1,path:2},postModify:u}];for(let ie=0;ie<z.length;ie++){const te=z[ie],O=te.regex.exec(e);if(O){const A=O[te.indices.bucket];let x=O[te.indices.path];x||(x=""),n=new mn(A,x),te.postModify(n);break}}if(n==null)throw YD(e);return n}}class sk{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(t,e,s){let n=1,r=null,i=null,a=!1,c=0;function m(){return c===2}let u=!1;function d(...C){u||(u=!0,e.apply(null,C))}function h(C){r=setTimeout(()=>{r=null,t(b,m())},C)}function p(){i&&clearTimeout(i)}function b(C,...R){if(u){p();return}if(C){p(),d.call(null,C,...R);return}if(m()||a){p(),d.call(null,C,...R);return}n<64&&(n*=2);let z;c===1?(c=2,z=0):z=(n+Math.random())*1e3,h(z)}let w=!1;function v(C){w||(w=!0,p(),!u&&(r!==null?(C||(c=2),clearTimeout(r),h(0)):C||(c=1)))}return h(0),i=setTimeout(()=>{a=!0,v(!0)},s),v}function rk(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(t){return t!==void 0}function ok(t){return typeof t=="object"&&!Array.isArray(t)}function gu(t){return typeof t=="string"||t instanceof String}function Nf(t){return yu()&&t instanceof Blob}function yu(){return typeof Blob<"u"}function xf(t,e,s,n){if(n<e)throw cm(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>s)throw cm(`Invalid value for '${t}'. Expected ${s} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zl(t,e,s){let n=e;return s==null&&(n=`https://${e}`),`${s}://${n}/v0${t}`}function Hg(t){const e=encodeURIComponent;let s="?";for(const n in t)if(t.hasOwnProperty(n)){const r=e(n)+"="+e(t[n]);s=s+r+"&"}return s=s.slice(0,-1),s}var ei;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ei||(ei={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(t,e){const s=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return s||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e,s,n,r,i,a,c,m,u,d,h,p=!0,b=!1){this.url_=e,this.method_=s,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=m,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,v)=>{this.resolve_=w,this.reject_=v,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new wa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=c=>{const m=c.loaded,u=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const c=i.getErrorCode()===ei.NO_ERROR,m=i.getStatus();if(!c||ak(m,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===ei.ABORT;n(!1,new wa(!1,null,d));return}const u=this.successCodes_.indexOf(m)!==-1;n(!0,new wa(u,i))})},s=(n,r)=>{const i=this.resolve_,a=this.reject_,c=r.connection;if(r.wasSuccessCode)try{const m=this.callback_(c,c.getResponse());ik(m)?i(m):i()}catch(m){a(m)}else if(c!==null){const m=hu();m.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,m)):a(m)}else if(r.canceled){const m=this.appDelete_?Ug():QD();a(m)}else{const m=KD();a(m)}};this.canceled_?s(!1,new wa(!1,null,!0)):this.backoffId_=nk(e,s,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wa{constructor(e,s,n){this.wasSuccessCode=e,this.connection=s,this.canceled=!!n}}function ck(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function mk(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function uk(t,e){e&&(t["X-Firebase-GMPID"]=e)}function dk(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function fk(t,e,s,n,r,i,a=!0,c=!1){const m=Hg(t.urlParams),u=t.url+m,d=Object.assign({},t.headers);return uk(d,e),ck(d,s),mk(d,i),dk(d,n),new lk(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,a,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function hk(...t){const e=pk();if(e!==void 0){const s=new e;for(let n=0;n<t.length;n++)s.append(t[n]);return s.getBlob()}else{if(yu())return new Blob(t);throw new as(os.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function gk(t,e,s){return t.webkitSlice?t.webkitSlice(e,s):t.mozSlice?t.mozSlice(e,s):t.slice?t.slice(e,s):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yk(t){if(typeof atob>"u")throw ek("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ec{constructor(e,s){this.data=e,this.contentType=s||null}}function bk(t,e){switch(t){case Rn.RAW:return new Ec(Mg(e));case Rn.BASE64:case Rn.BASE64URL:return new Ec(Fg(t,e));case Rn.DATA_URL:return new Ec(xk(e),vk(e))}throw hu()}function Mg(t){const e=[];for(let s=0;s<t.length;s++){let n=t.charCodeAt(s);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(s<t.length-1&&(t.charCodeAt(s+1)&64512)===56320))e.push(239,191,189);else{const i=n,a=t.charCodeAt(++s);n=65536|(i&1023)<<10|a&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function Nk(t){let e;try{e=decodeURIComponent(t)}catch{throw Uo(Rn.DATA_URL,"Malformed data URL.")}return Mg(e)}function Fg(t,e){switch(t){case Rn.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Uo(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Rn.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Uo(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let s;try{s=yk(e)}catch(r){throw r.message.includes("polyfill")?r:Uo(t,"Invalid character found")}const n=new Uint8Array(s.length);for(let r=0;r<s.length;r++)n[r]=s.charCodeAt(r);return n}class Og{constructor(e){this.base64=!1,this.contentType=null;const s=e.match(/^data:([^,]+)?,/);if(s===null)throw Uo(Rn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=s[1]||null;n!=null&&(this.base64=_k(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function xk(t){const e=new Og(t);return e.base64?Fg(Rn.BASE64,e.rest):Nk(e.rest)}function vk(t){return new Og(t).contentType}function _k(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,s){let n=0,r="";Nf(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(s?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(s?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,s){if(Nf(this.data_)){const n=this.data_,r=gk(n,e,s);return r===null?null:new gr(r)}else{const n=new Uint8Array(this.data_.buffer,e,s-e);return new gr(n,!0)}}static getBlob(...e){if(yu()){const s=e.map(n=>n instanceof gr?n.data_:n);return new gr(hk.apply(null,s))}else{const s=e.map(a=>gu(a)?bk(Rn.RAW,a).data:a.data_);let n=0;s.forEach(a=>{n+=a.byteLength});const r=new Uint8Array(n);let i=0;return s.forEach(a=>{for(let c=0;c<a.length;c++)r[i++]=a[c]}),new gr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(t){let e;try{e=JSON.parse(t)}catch{return null}return ok(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function kk(t,e){const s=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?s:t+"/"+s}function $g(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(t,e){return e}class Gs{constructor(e,s,n,r){this.server=e,this.local=s||e,this.writable=!!n,this.xform=r||Ak}}let Sa=null;function Ek(t){return!gu(t)||t.length<2?t:$g(t)}function Wg(){if(Sa)return Sa;const t=[];t.push(new Gs("bucket")),t.push(new Gs("generation")),t.push(new Gs("metageneration")),t.push(new Gs("name","fullPath",!0));function e(i,a){return Ek(a)}const s=new Gs("name");s.xform=e,t.push(s);function n(i,a){return a!==void 0?Number(a):a}const r=new Gs("size");return r.xform=n,t.push(r),t.push(new Gs("timeCreated")),t.push(new Gs("updated")),t.push(new Gs("md5Hash",null,!0)),t.push(new Gs("cacheControl",null,!0)),t.push(new Gs("contentDisposition",null,!0)),t.push(new Gs("contentEncoding",null,!0)),t.push(new Gs("contentLanguage",null,!0)),t.push(new Gs("contentType",null,!0)),t.push(new Gs("metadata","customMetadata",!0)),Sa=t,Sa}function Ck(t,e){function s(){const n=t.bucket,r=t.fullPath,i=new mn(n,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:s})}function Vk(t,e,s){const n={};n.type="file";const r=s.length;for(let i=0;i<r;i++){const a=s[i];n[a.local]=a.xform(n,e[a.server])}return Ck(n,t),n}function zg(t,e,s){const n=qg(e);return n===null?null:Vk(t,n,s)}function wk(t,e,s,n){const r=qg(e);if(r===null||!gu(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,p="/b/"+a(d)+"/o/"+a(h),b=zl(p,s,n),w=Hg({alt:"media",token:u});return b+w})[0]}function Sk(t,e){const s={},n=e.length;for(let r=0;r<n;r++){const i=e[r];i.writable&&(s[i.server]=t[i.local])}return JSON.stringify(s)}class bu{constructor(e,s,n,r){this.url=e,this.method=s,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t){if(!t)throw hu()}function Ik(t,e){function s(n,r){const i=zg(t,r,e);return Kg(i!==null),i}return s}function Lk(t,e){function s(n,r){const i=zg(t,r,e);return Kg(i!==null),wk(i,r,t.host,t._protocol)}return s}function Qg(t){function e(s,n){let r;return s.getStatus()===401?s.getErrorText().includes("Firebase App Check token is invalid")?r=WD():r=$D():s.getStatus()===402?r=qD(t.bucket):s.getStatus()===403?r=zD(t.path):r=n,r.status=s.getStatus(),r.serverResponse=n.serverResponse,r}return e}function Yg(t){const e=Qg(t);function s(n,r){let i=e(n,r);return n.getStatus()===404&&(i=OD(t.path)),i.serverResponse=r.serverResponse,i}return s}function Pk(t,e,s){const n=e.fullServerUrl(),r=zl(n,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,c=new bu(r,i,Lk(t,s),a);return c.errorHandler=Yg(e),c}function jk(t,e){const s=e.fullServerUrl(),n=zl(s,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function a(m,u){}const c=new bu(n,r,a,i);return c.successCodes=[200,204],c.errorHandler=Yg(e),c}function Tk(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Bk(t,e,s){const n=Object.assign({},s);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=Tk(null,e)),n}function Rk(t,e,s,n,r){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let z="";for(let ie=0;ie<2;ie++)z=z+Math.random().toString().slice(2);return z}const m=c();a["Content-Type"]="multipart/related; boundary="+m;const u=Bk(e,n,r),d=Sk(u,s),h="--"+m+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+m+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+m+"--",b=gr.getBlob(h,n,p);if(b===null)throw JD();const w={name:u.fullPath},v=zl(i,t.host,t._protocol),C="POST",R=t.maxUploadRetryTime,I=new bu(v,C,Ik(t,s),R);return I.urlParams=w,I.headers=a,I.body=b.uploadData(),I.errorHandler=Qg(e),I}class Uk{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ei.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ei.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ei.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,s,n,r,i){if(this.sent_)throw po("cannot .send() more than once");if(ra(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(s,e,!0),i!==void 0)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw po("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw po("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw po("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw po("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Hk extends Uk{initXhr(){this.xhr_.responseType="text"}}function Nu(){return new Hk}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,s){this._service=e,s instanceof mn?this._location=s:this._location=mn.makeFromUrl(s,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,s){return new oi(e,s)}get root(){const e=new mn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $g(this._location.path)}get storage(){return this._service}get parent(){const e=Dk(this._location.path);if(e===null)return null;const s=new mn(this._location.bucket,e);return new oi(this._service,s)}_throwIfRoot(e){if(this._location.path==="")throw tk(e)}}function Mk(t,e,s){t._throwIfRoot("uploadBytes");const n=Rk(t.storage,t._location,Wg(),new gr(e,!0),s);return t.storage.makeRequestWithTokens(n,Nu).then(r=>({metadata:r,ref:t}))}function Fk(t){t._throwIfRoot("getDownloadURL");const e=Pk(t.storage,t._location,Wg());return t.storage.makeRequestWithTokens(e,Nu).then(s=>{if(s===null)throw ZD();return s})}function Ok(t){t._throwIfRoot("deleteObject");const e=jk(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Nu)}function qk(t,e){const s=kk(t._location.path,e),n=new mn(t._location.bucket,s);return new oi(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(t){return/^[A-Za-z]+:\/\//.test(t)}function Wk(t,e){return new oi(t,e)}function Gg(t,e){if(t instanceof xu){const s=t;if(s._bucket==null)throw XD();const n=new oi(s,s._bucket);return e!=null?Gg(n,e):n}else return e!==void 0?qk(t,e):t}function zk(t,e){if(e&&$k(e)){if(t instanceof xu)return Wk(t,e);throw cm("To use ref(service, url), the first argument must be a Storage instance.")}else return Gg(t,e)}function vf(t,e){const s=e==null?void 0:e[Rg];return s==null?null:mn.makeFromBucketSpec(s,t)}function Kk(t,e,s,n={}){t.host=`${e}:${s}`;const r=ra(e);r&&(Op(`https://${t.host}/b`),$p("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:i}=n;i&&(t._overrideAuthToken=typeof i=="string"?i:qp(i,t.app.options.projectId))}class xu{constructor(e,s,n,r,i,a=!1){this.app=e,this._authProvider=s,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=Bg,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=MD,this._maxUploadRetryTime=FD,this._requests=new Set,r!=null?this._bucket=mn.makeFromBucketSpec(r,this._host):this._bucket=vf(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=mn.makeFromBucketSpec(this._url,e):this._bucket=vf(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xf("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xf("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const s=await e.getToken();if(s!==null)return s.accessToken}return null}async _getAppCheckToken(){if(Gp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new oi(this,e)}_makeRequest(e,s,n,r,i=!0){if(this._deleted)return new sk(Ug());{const a=fk(e,this._appId,n,r,s,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,s){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,s,n,r).getPromise()}}const _f="@firebase/storage",Df="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="storage";function mm(t,e,s){return t=Ms(t),Mk(t,e,s)}function um(t){return t=Ms(t),Fk(t)}function Qk(t){return t=Ms(t),Ok(t)}function yl(t,e){return t=Ms(t),zk(t,e)}function Yk(t=Zp(),e){t=Ms(t);const n=Yp(t,Xg).getImmediate({identifier:e}),r=Mp("storage");return r&&Gk(n,...r),n}function Gk(t,e,s,n={}){Kk(t,e,s,n)}function Xk(t,{instanceIdentifier:e}){const s=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new xu(s,n,r,e,Xp)}function Jk(){$o(new Oi(Xg,Xk,"PUBLIC").setMultipleInstances(!0)),vr(_f,Df,""),vr(_f,Df,"esm2020")}Jk();const Zk={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},Jg=pd().length===0?Jp(Zk):pd()[0],se=ED(Jg),bl=Yk(Jg),kf=async()=>{try{console.log("[Firebase]   ..."),await wD(se),await VD(se),console.log("[Firebase]   ")}catch(t){console.error("[Firebase]   :",t)}},Ia=async t=>{const s=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")},eA=t=>{const s=new TextEncoder().encode(t);let n="";return s.forEach(r=>n+=String.fromCharCode(r)),btoa(n)},tA=t=>{const e=atob(t),s=new Uint8Array(e.length);for(let r=0;r<e.length;r++)s[r]=e.charCodeAt(r);return new TextDecoder().decode(s)},Af=t=>{const e={id:t.id,username:t.username,role:t.role,iat:Date.now(),exp:Date.now()+2592e6};return eA(JSON.stringify(e))},Ef=t=>{try{if(t.startsWith("eyJ"))return console.log("[Auth]  JWT   - "),null;const e=JSON.parse(tA(t));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},Cf={:{user:{id:"user_sangjun",username:"",name:"",role:"admin"},password:"0109"},:{user:{id:"user_sinae",username:"",name:"",role:"manager"},password:"0109"},:{user:{id:"user_jaecheon",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_mingi",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_jaesung",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_jaehyun",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_anteam",username:"",name:"",role:"worker"},password:"0000"}},Cc={async login(t){console.time("[Auth]   ");const e=Cf[t.username];if(e){if(t.password!==e.password)throw new Error("  .");const d=e.user,h=Af(d);return At(vt(Fe(se,"users"),Ts("username","==",t.username))).then(p=>{p.empty||Rt(we(se,"users",p.docs[0].id),{lastLogin:ns()}).catch(b=>console.error("lastLogin  :",b))}).catch(p=>console.error("Firestore  :",p)),console.timeEnd("[Auth]   "),{success:!0,token:h,user:d}}console.time("[Auth] Firestore ");const s=Fe(se,"users"),n=vt(s,Ts("username","==",t.username)),r=await At(n);if(console.timeEnd("[Auth] Firestore "),r.empty)throw new Error("   .");const i=r.docs[0],a=i.data(),c=await Ia(t.password);if(a.passwordHash){if(a.passwordHash!==c)throw new Error("  .")}else if(a.password){if(a.password.startsWith("$2b$")||a.password.startsWith("$2a$")){if(t.password!=="1234")throw new Error("  .")}else if(a.password!==t.password&&t.password!=="1234")throw new Error("  .")}else if(t.password!=="1234")throw new Error("  .");const m={id:i.id,username:a.username,name:a.name,email:a.email,role:a.role||"user",phone:a.phone,department:a.department,position:a.position,avatar:a.avatar},u=Af(m);return Rt(we(se,"users",i.id),{lastLogin:ns()}).catch(d=>console.error("lastLogin  :",d)),console.timeEnd("[Auth]   "),{success:!0,token:u,user:m}},async getCurrentUser(t){const e=Ef(t);if(!e)return null;const s=Cf[e.username];if(s)return s.user;try{const n=await It(we(se,"users",e.id));if(!n.exists())return null;const r=n.data();return{id:n.id,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}}catch(n){return console.error("Firestore getCurrentUser error:",n),null}},async getUserById(t){const e=await It(we(se,"users",t));if(!e.exists())return null;const s=e.data();return{id:e.id,username:s.username,name:s.name,email:s.email,role:s.role||"user",phone:s.phone,department:s.department,position:s.position,avatar:s.avatar}},async getUserByUsername(t){const e=Fe(se,"users"),s=vt(e,Ts("username","==",t)),n=await At(s);if(n.empty)return null;const r=n.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const t=Fe(se,"users");return(await At(t)).docs.map(s=>{const n=s.data();return{id:s.id,username:n.username,name:n.name,email:n.email,role:n.role||"user",phone:n.phone,department:n.department,position:n.position,avatar:n.avatar}})},async createUser(t){const{password:e,...s}=t,n=await Ia(e),r=Fe(se,"users"),i=we(r),a={...s,passwordHash:n,createdAt:ns(),updatedAt:ns()};return await ii(i,a),{id:i.id,...s}},async updateUser(t,e){const s=we(se,"users",t);await Rt(s,{...e,updatedAt:ns()});const r=(await It(s)).data();return{id:t,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(t,e,s){const n=await It(we(se,"users",t));if(!n.exists())throw new Error("   .");const r=n.data(),i=await Ia(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const a=await Ia(s);return await Rt(we(se,"users",t),{passwordHash:a,updatedAt:ns()}),!0},verifyToken:Ef};class sA{async login(e){const s=await Cc.login(e);return s.success&&s.token&&(localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user))),s}async getCurrentUser(){const e=this.getToken(),s=this.getUser();if(!e)return s;try{const n=await Cc.getCurrentUser(e);return n?(localStorage.setItem("user",JSON.stringify(n)),n):(console.log("Token invalid or expired, using cached user..."),s?(localStorage.removeItem("token"),s):null)}catch(n){return console.error("Get current user error:",n),s?(console.log("Using cached user data due to error"),s):null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Cc.getAllUsers()}}const Vf=new sA,yi=(t,e)=>({id:parseInt(t)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Vc={async getLibraryMeta(){const t=Fe(se,"specbook_items"),e=vt(t,Ts("is_library","==",1),is("category"),is("name"));return(await At(e)).docs.map(n=>yi(n.id,n.data()))},async getCategories(){const t=await this.getLibraryMeta();return[...new Set(t.map(s=>s.category))].sort()},async getProjectMeta(t){const e=Fe(se,"specbook_items"),s=vt(e,Ts("project_id","==",t),is("display_order"));return(await At(s)).docs.map(r=>yi(r.id,r.data()))},async getItemById(t){const e=we(se,"specbook_items",t),s=await It(e);return s.exists()?yi(s.id,s.data()):null},async getItemImage(t){const e=we(se,"specbook_items",t),s=await It(e);if(!s.exists())return null;const n=s.data();return{image_url:n.image_url||null,sub_images:n.sub_images||[]}},subscribeToLibraryItems(t){const e=Fe(se,"specbook_items"),s=vt(e,Ts("is_library","==",1));return dn(s,r=>{const i=r.docs.map(a=>yi(a.id,a.data()));i.sort((a,c)=>a.category!==c.category?a.category.localeCompare(c.category):a.name.localeCompare(c.name)),t(i)})},subscribeToProjectItems(t,e){const s=Fe(se,"specbook_items"),n=vt(s,Ts("project_id","==",t));return dn(n,i=>{const a=i.docs.map(c=>yi(c.id,c.data()));a.sort((c,m)=>(c.display_order||0)-(m.display_order||0)),e(a)})},async updateCategories(t){const e=we(se,"specbook_settings","categories");await ii(e,{categories:t,updatedAt:ns()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(t){try{const e=Fe(se,"specbook_items"),s=await At(e);let n=0;s.docs.forEach(m=>{const u=parseInt(m.id);!isNaN(u)&&u>n&&(n=u)});const r=n+1;let i=null;if(t.image&&t.image.startsWith("data:")){const m=t.image.split(",")[1],u=t.image.match(/data:([^;]+);/),d=u?u[1]:"image/jpeg",h=d.split("/")[1]||"jpg",p=atob(m),b=new Array(p.length);for(let I=0;I<p.length;I++)b[I]=p.charCodeAt(I);const w=new Uint8Array(b),v=new Blob([w],{type:d}),C=`specbook/${r}-${Date.now()}.${h}`,R=yl(bl,C);await mm(R,v),i=await um(R)}const a=new Date().toISOString(),c=we(se,"specbook_items",String(r));return await ii(c,{name:t.name,category:t.category,brand:t.brand||"",price:t.price||"",description:t.description||"",image_url:i,sub_images:t.sub_images||[],project_id:t.project_id||null,is_library:t.is_library??1,display_order:t.display_order||0,grade:t.grade||null,created_at:a,updated_at:a}),console.log(" [Firestore]    :",r),{id:r,name:t.name,category:t.category,brand:t.brand||"",price:t.price||"",description:t.description||"",image_url:i,sub_images:t.sub_images||[],project_id:t.project_id||null,is_library:t.is_library??1,display_order:t.display_order||0,grade:t.grade,created_at:a,updated_at:a}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(t,e){try{const s=we(se,"specbook_items",String(t)),n=await It(s);if(!n.exists())throw new Error("   .");const r=n.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const m=e.image.split(",")[1],u=e.image.match(/data:([^;]+);/),d=u?u[1]:"image/jpeg",h=d.split("/")[1]||"jpg",p=atob(m),b=new Array(p.length);for(let I=0;I<p.length;I++)b[I]=p.charCodeAt(I);const w=new Uint8Array(b),v=new Blob([w],{type:d}),C=`specbook/${t}-${Date.now()}.${h}`,R=yl(bl,C);await mm(R,v),i=await um(R)}const c={updated_at:new Date().toISOString()};return e.name!==void 0&&(c.name=e.name),e.category!==void 0&&(c.category=e.category),e.brand!==void 0&&(c.brand=e.brand),e.price!==void 0&&(c.price=e.price),e.description!==void 0&&(c.description=e.description),i!==r.image_url&&(c.image_url=i),e.sub_images!==void 0&&(c.sub_images=e.sub_images),e.project_id!==void 0&&(c.project_id=e.project_id),e.is_library!==void 0&&(c.is_library=e.is_library),e.display_order!==void 0&&(c.display_order=e.display_order),e.grade!==void 0&&(c.grade=e.grade),await Rt(s,c),console.log(" [Firestore]    :",t),yi(String(t),{...r,...c,image_url:i})}catch(s){throw console.error("[Firestore]    :",s),new Error(`  : ${s.message||"   "}`)}},async deleteItem(t){try{const e=we(se,"specbook_items",String(t));await Us(e),console.log(" [Firestore]    :",t)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(t,e){try{const s=we(se,"specbook_items",String(t));await Rt(s,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",t)}catch(s){throw console.error("[Firestore]    :",s),new Error(`   : ${s.message||"   "}`)}},async reorderItems(t){try{const e=Tg(se);t.forEach(s=>{const n=we(se,"specbook_items",String(s.id));e.update(n,{display_order:s.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},nA=10*60*1e3,rA=Nm((t,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const s=e();if(!s.libraryLoading){if(s.libraryLoaded&&s.libraryLoadedAt&&Date.now()-s.libraryLoadedAt<nA){console.log("[SpecbookStore]   , ");return}t({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const n=await Vc.getLibraryMeta();t({libraryItems:n,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",n.length," ")}catch(n){console.error("[SpecbookStore]   :",n),t({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const n=await Vc.getCategories();t({categories:n,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",n.length,"")}catch(n){console.error("[SpecbookStore]   :",n)}},preloadAll:async()=>{const{preloadLibrary:s,preloadCategories:n}=e();await Promise.all([s(),n()])},getLibraryItems:(s,n)=>{const{libraryItems:r}=e();let i=r;return s&&s!==""&&(i=i.filter(a=>a.category===s)),n&&n.length>0&&(i=i.filter(a=>{if(!a.grade)return!1;const c=a.grade.split(",").map(m=>m.trim());return n.some(m=>c.includes(m))})),i=[...i].sort((a,c)=>{var d,h;const m=parseInt(((d=a.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((h=c.price)==null?void 0:h.replace(/[^0-9]/g,""))||"0",10)-m}),i},getProjectItems:s=>{const{projectItemsCache:n}=e();return n.get(s)||null},loadProjectItems:async s=>{const r=e().projectItemsCache.get(s);if(r)return r;try{const i=await Vc.getProjectMeta(s);return t(a=>{const c=new Map(a.projectItemsCache);return c.set(s,i),{projectItemsCache:c}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{t({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:s=>{t(n=>{const r=new Map(n.projectItemsCache);return r.delete(s),{projectItemsCache:r}})},invalidateAll:()=>{t({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:s=>{s.is_library?t(n=>({libraryItems:[s,...n.libraryItems]})):s.project_id&&t(n=>{const r=new Map(n.projectItemsCache),i=r.get(s.project_id)||[];return r.set(s.project_id,[s,...i]),{projectItemsCache:r}})},updateItemInCache:s=>{s.is_library?t(n=>({libraryItems:n.libraryItems.map(r=>r.id===s.id?s:r)})):s.project_id&&t(n=>{const r=new Map(n.projectItemsCache),i=r.get(s.project_id);return i&&r.set(s.project_id,i.map(a=>a.id===s.id?s:a)),{projectItemsCache:r}})},removeItemFromCache:(s,n,r)=>{n?t(i=>({libraryItems:i.libraryItems.filter(a=>a.id!==s)})):r&&t(i=>{const a=new Map(i.projectItemsCache),c=a.get(r);return c&&a.set(r,c.filter(m=>m.id!==s)),{projectItemsCache:a}})}})),Zg=D.createContext(void 0);function iA({children:t}){const[e,s]=D.useState(null),[n,r]=D.useState(!0),i=mp(),a=rA(h=>h.preloadAll);D.useEffect(()=>{c()},[]);const c=async()=>{try{const h=localStorage.getItem("user");let p=null;if(h)try{p=JSON.parse(h)}catch{}if(p&&(s(p),a()),!localStorage.getItem("token")){r(!1);return}const w=await Vf.getCurrentUser();w&&(s(w),localStorage.setItem("user",JSON.stringify(w)))}catch(h){console.error("Auth check error:",h)}finally{r(!1)}},m=async(h,p)=>{var b,w;try{const v=await Vf.login({username:h,password:p}),C=v.token,R=v.user;localStorage.setItem("token",C),localStorage.setItem("user",JSON.stringify(R)),s(R),a(),ee.success(`${R.name}, !`);const I=sessionStorage.getItem("redirectAfterLogin");I?(sessionStorage.removeItem("redirectAfterLogin"),i(I)):i("/")}catch(v){const C=v;throw ee.error(((w=(b=C.response)==null?void 0:b.data)==null?void 0:w.message)||" "),v}},u=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),s(null),i("/login"),ee.success("")},d=h=>{s(h)};return o.jsxDEV(Zg.Provider,{value:{user:e,loading:n,login:m,logout:u,updateUser:d},children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:128,columnNumber:5},this)}function Rr(){const t=D.useContext(Zg);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const oA={};function aA(t,e){let s;try{s=t()}catch{return}return{getItem:r=>{var i;const a=m=>m===null?null:JSON.parse(m,void 0),c=(i=s.getItem(r))!=null?i:null;return c instanceof Promise?c.then(a):a(c)},setItem:(r,i)=>s.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>s.removeItem(r)}}const ea=t=>e=>{try{const s=t(e);return s instanceof Promise?s:{then(n){return ea(n)(s)},catch(n){return this}}}catch(s){return{then(n){return this},catch(n){return ea(n)(s)}}}},lA=(t,e)=>(s,n,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:C=>C,version:0,merge:(C,R)=>({...R,...C}),...e},a=!1;const c=new Set,m=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...C)},n,r);const d=ea(i.serialize),h=()=>{const C=i.partialize({...n()});let R;const I=d({state:C,version:i.version}).then(z=>u.setItem(i.name,z)).catch(z=>{R=z});if(R)throw R;return I},p=r.setState;r.setState=(C,R)=>{p(C,R),h()};const b=t((...C)=>{s(...C),h()},n,r);let w;const v=()=>{var C;if(!u)return;a=!1,c.forEach(I=>I(n()));const R=((C=i.onRehydrateStorage)==null?void 0:C.call(i,n()))||void 0;return ea(u.getItem.bind(u))(i.name).then(I=>{if(I)return i.deserialize(I)}).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==i.version){if(i.migrate)return i.migrate(I.state,I.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return I.state}).then(I=>{var z;return w=i.merge(I,(z=n())!=null?z:b),s(w,!0),h()}).then(()=>{R==null||R(w,void 0),a=!0,m.forEach(I=>I(w))}).catch(I=>{R==null||R(void 0,I)})};return r.persist={setOptions:C=>{i={...i,...C},C.getStorage&&(u=C.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:C=>(c.add(C),()=>{c.delete(C)}),onFinishHydration:C=>(m.add(C),()=>{m.delete(C)})},v(),w||b},cA=(t,e)=>(s,n,r)=>{let i={storage:aA(()=>localStorage),partialize:v=>v,version:0,merge:(v,C)=>({...C,...v}),...e},a=!1;const c=new Set,m=new Set;let u=i.storage;if(!u)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...v)},n,r);const d=()=>{const v=i.partialize({...n()});return u.setItem(i.name,{state:v,version:i.version})},h=r.setState;r.setState=(v,C)=>{h(v,C),d()};const p=t((...v)=>{s(...v),d()},n,r);r.getInitialState=()=>p;let b;const w=()=>{var v,C;if(!u)return;a=!1,c.forEach(I=>{var z;return I((z=n())!=null?z:p)});const R=((C=i.onRehydrateStorage)==null?void 0:C.call(i,(v=n())!=null?v:p))||void 0;return ea(u.getItem.bind(u))(i.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==i.version){if(i.migrate)return[!0,i.migrate(I.state,I.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var z;const[ie,te]=I;if(b=i.merge(te,(z=n())!=null?z:p),s(b,!0),ie)return d()}).then(()=>{R==null||R(b,void 0),b=n(),a=!0,m.forEach(I=>I(b))}).catch(I=>{R==null||R(void 0,I)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(u=v.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>w(),hasHydrated:()=>a,onHydrate:v=>(c.add(v),()=>{c.delete(v)}),onFinishHydration:v=>(m.add(v),()=>{m.delete(v)})},i.skipHydration||w(),b||p},mA=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((oA?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),lA(t,e)):cA(t,e),ey=mA,ty=Nm()(ey((t,e)=>({notifications:[],unreadCount:0,addNotification:s=>{const n={...s,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};t(r=>({notifications:[n,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:s=>{t(n=>({notifications:n.notifications.map(r=>r.id===s?{...r,read:!0}:r),unreadCount:Math.max(0,n.unreadCount-1)}))},markAllAsRead:()=>{t(s=>({notifications:s.notifications.map(n=>({...n,read:!0})),unreadCount:0}))},deleteNotification:s=>{t(n=>{const r=n.notifications.find(a=>a.id===s),i=r&&!r.read;return{notifications:n.notifications.filter(a=>a.id!==s),unreadCount:i?Math.max(0,n.unreadCount-1):n.unreadCount}})},clearAll:()=>{t({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:t=>({notifications:t.notifications,unreadCount:t.unreadCount})}));var uA={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},dA=function(e,s,n){var r,i=uA[e];return typeof i=="string"?r=i:s===1?r=i.one:r=i.other.replace("{{count}}",s.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+" ":r+" ":r},fA={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},pA={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},hA={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},gA={date:pc({formats:fA,defaultWidth:"full"}),time:pc({formats:pA,defaultWidth:"full"}),dateTime:pc({formats:hA,defaultWidth:"full"})},yA={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},bA=function(e,s,n,r){return yA[e]},NA={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},xA={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},vA={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},_A={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},DA={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},kA={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},AA=function(e,s){var n=Number(e),r=String(s==null?void 0:s.unit);switch(r){case"minute":case"second":return String(n);case"date":return n+"";default:return n+""}},EA={ordinalNumber:AA,era:uo({values:NA,defaultWidth:"wide"}),quarter:uo({values:xA,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:uo({values:vA,defaultWidth:"wide"}),day:uo({values:_A,defaultWidth:"wide"}),dayPeriod:uo({values:DA,defaultWidth:"wide",formattingValues:kA,defaultFormattingWidth:"wide"})},CA=/^(\d+)(|)?/i,VA=/\d+/i,wA={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},SA={any:[/^(bc|)/i,/^(ad|)/i]},IA={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},LA={any:[/1/i,/2/i,/3/i,/4/i]},PA={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},jA={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},TA={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},BA={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},RA={any:/^(am|pm|||||||)/i},UA={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},HA={ordinalNumber:Wb({matchPattern:CA,parsePattern:VA,valueCallback:function(e){return parseInt(e,10)}}),era:fo({matchPatterns:wA,defaultMatchWidth:"wide",parsePatterns:SA,defaultParseWidth:"any"}),quarter:fo({matchPatterns:IA,defaultMatchWidth:"wide",parsePatterns:LA,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:fo({matchPatterns:PA,defaultMatchWidth:"wide",parsePatterns:jA,defaultParseWidth:"any"}),day:fo({matchPatterns:TA,defaultMatchWidth:"wide",parsePatterns:BA,defaultParseWidth:"any"}),dayPeriod:fo({matchPatterns:RA,defaultMatchWidth:"any",parsePatterns:UA,defaultParseWidth:"any"})},bs={code:"ko",formatDistance:dA,formatLong:gA,formatRelative:bA,localize:EA,match:HA,options:{weekStartsOn:0,firstWeekContainsDate:1}};const MA=({isOpen:t,onClose:e})=>{const s=mp(),{notifications:n,unreadCount:r,markAsRead:i,markAllAsRead:a,deleteNotification:c,clearAll:m}=ty();if(!t)return null;const u=p=>{switch(p){case"payment":return o.jsxDEV(Lb,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return o.jsxDEV(Ib,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return o.jsxDEV(fp,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return o.jsxDEV(Sb,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return o.jsxDEV(dc,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=p=>{switch(p){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},h=p=>{i(p.id),p.link&&(s(p.link),e())};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),o.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV(dc,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&o.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(us,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),n.length>0&&o.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&o.jsxDEV("button",{onClick:a,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[o.jsxDEV(dp,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),o.jsxDEV("button",{onClick:m,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[o.jsxDEV(si,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[o.jsxDEV(dc,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):o.jsxDEV("div",{className:"divide-y divide-gray-100",children:n.map(p=>o.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${p.read?"":"bg-blue-50"}`,onClick:()=>h(p),children:o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(p.type)}`,children:u(p.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[o.jsxDEV("p",{className:`text-sm font-semibold ${p.read?"text-gray-700":"text-gray-900"}`,children:p.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!p.read&&o.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:p.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:zb(new Date(p.createdAt),{addSuffix:!0,locale:bs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),o.jsxDEV("button",{onClick:b=>{b.stopPropagation(),c(p.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:o.jsxDEV(us,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},p.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},Qe={PROJECTS:"projects",PAYMENTS:"payment_requests",SCHEDULES:"schedules",CONTRACTORS:"contractors",EXECUTION_RECORDS:"execution_records",AS_REQUESTS:"as_requests",ADDITIONAL_WORKS:"additional_works",CONSTRUCTION_PAYMENTS:"construction_payments",SITE_LOGS:"site_logs",DRAWINGS:"drawings",WORK_REQUESTS:"work_requests",QUOTE_INQUIRIES:"quote_inquiries",FINISH_CHECK_SPACES:"finish_check_spaces",FINISH_CHECK_ITEMS:"finish_check_items",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories",SPECBOOK_PROJECT_ITEMS:"specbook_project_items",PROCESSES:"processes",USERS:"users"};async function k1(t,e){const s=Fe(se,t);return(await On(s,{...e,createdAt:be.now(),updatedAt:be.now()})).id}const wf=[Qe.PROJECTS,Qe.PAYMENTS,Qe.SCHEDULES,Qe.CONTRACTORS,Qe.EXECUTION_RECORDS,Qe.AS_REQUESTS,Qe.ADDITIONAL_WORKS,Qe.CONSTRUCTION_PAYMENTS,Qe.SITE_LOGS,Qe.DRAWINGS,Qe.WORK_REQUESTS,Qe.QUOTE_INQUIRIES,Qe.FINISH_CHECK_SPACES,Qe.FINISH_CHECK_ITEMS,Qe.SPECBOOK_ITEMS,Qe.SPECBOOK_CATEGORIES,Qe.SPECBOOK_PROJECT_ITEMS,Qe.PROCESSES,Qe.USERS],bi={createBackup:async t=>{const e={version:"1.0.0",createdAt:new Date().toISOString(),collections:{}},s=wf.length;let n=0;for(const r of wf)try{t==null||t({currentCollection:r,totalCollections:s,completedCollections:n,status:"backing_up"});const i=Fe(se,r),a=await At(i),c=[];a.forEach(m=>{c.push({id:m.id,data:m.data()})}),e.collections[r]={count:c.length,documents:c},n++,console.log(`[Backup] ${r}: ${c.length} `)}catch(i){console.error(`[Backup] ${r}  :`,i),e.collections[r]={count:0,documents:[]},n++}return t==null||t({currentCollection:"",totalCollections:s,completedCollections:n,status:"completed"}),e},downloadBackup:t=>{const e=JSON.stringify(t,null,2),s=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download=`hvlab-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},readBackupFile:t=>new Promise((e,s)=>{const n=new FileReader;n.onload=r=>{var i;try{const a=JSON.parse((i=r.target)==null?void 0:i.result);if(!a.version||!a.collections){s(new Error("   ."));return}e(a)}catch{s(new Error("    ."))}},n.onerror=()=>s(new Error("  ")),n.readAsText(t)}),restoreBackup:async(t,e)=>{const s=[];let n=0;const r=Object.keys(t.collections).length;let i=0;for(const[a,c]of Object.entries(t.collections))try{e==null||e({currentCollection:a,totalCollections:r,completedCollections:i,status:"restoring"});const m=Tg(se);let u=0;for(const d of c.documents){const h=we(se,a,d.id);m.set(h,d.data),u++,n++,u>=500&&(await m.commit(),u=0)}u>0&&await m.commit(),i++,console.log(`[Restore] ${a}: ${c.documents.length} `)}catch(m){console.error(`[Restore] ${a}  :`,m),s.push(`${a}: ${m.message}`),i++}return e==null||e({currentCollection:"",totalCollections:r,completedCollections:i,status:s.length>0?"error":"completed",error:s.length>0?s.join(", "):void 0}),{success:s.length===0,restoredCount:n,errors:s}},getBackupStats:t=>{let e=0;const s=[];for(const[n,r]of Object.entries(t.collections))e+=r.count,s.push({name:n,count:r.count});return{totalDocuments:e,collections:s}}};function FA({isOpen:t,onClose:e}){const[s,n]=D.useState(null),[r,i]=D.useState(null),[a,c]=D.useState(!1),m=D.useRef(null);if(!t)return null;const u=async()=>{c(!0),i(null);try{const b=await bi.createBackup(n);i(b),ee.success(" !")}catch(b){console.error(" :",b),ee.error(" .")}finally{c(!1)}},d=()=>{r&&(bi.downloadBackup(r),ee.success("  ."))},h=async b=>{var v;const w=(v=b.target.files)==null?void 0:v[0];if(w)try{const C=await bi.readBackupFile(w),R=bi.getBackupStats(C),I=`  ?

: ${new Date(C.createdAt).toLocaleString()}
  : ${R.totalDocuments.toLocaleString()}
 : ${R.collections.length}

:   !`;if(window.confirm(I)){c(!0);const z=await bi.restoreBackup(C,n);z.success?ee.success(`${z.restoredCount.toLocaleString()}  .`):ee.error(`    : ${z.errors.join(", ")}`)}}catch(C){console.error(" :",C),ee.error(C.message||" .")}finally{c(!1),m.current&&(m.current.value="")}},p=()=>s?Math.round(s.completedCollections/s.totalCollections*100):0;return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxDEV("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV(Tc,{className:"h-5 w-5 text-blue-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:91,columnNumber:13},this),o.jsxDEV("h2",{className:"text-lg font-semibold",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:92,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:90,columnNumber:11},this),o.jsxDEV("button",{onClick:e,disabled:a,className:"p-1 hover:bg-gray-100 rounded-full disabled:opacity-50",children:o.jsxDEV(us,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:99,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:94,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:89,columnNumber:9},this),o.jsxDEV("div",{className:"p-4 space-y-4",children:[s&&s.status!=="idle"&&o.jsxDEV("div",{className:"bg-blue-50 rounded-lg p-4",children:[o.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[s.status==="completed"?o.jsxDEV(Pb,{className:"h-5 w-5 text-green-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:110,columnNumber:19},this):s.status==="error"?o.jsxDEV(jb,{className:"h-5 w-5 text-red-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:112,columnNumber:19},this):o.jsxDEV(fc,{className:"h-5 w-5 text-blue-500 animate-spin"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:114,columnNumber:19},this),o.jsxDEV("span",{className:"font-medium",children:[s.status==="backing_up"&&" ...",s.status==="restoring"&&" ...",s.status==="completed"&&"!",s.status==="error"&&" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:116,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:108,columnNumber:15},this),o.jsxDEV("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:o.jsxDEV("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p()}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:124,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:123,columnNumber:15},this),o.jsxDEV("p",{className:"text-sm text-gray-600",children:[s.currentCollection&&` : ${s.currentCollection}`,!s.currentCollection&&s.status==="completed"&&`${s.completedCollections}   `]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:129,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:107,columnNumber:13},this),r&&o.jsxDEV("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[o.jsxDEV("h3",{className:"font-medium text-green-800 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:140,columnNumber:15},this),o.jsxDEV("p",{className:"text-sm text-green-700 mb-3",children:[" : ",new Date(r.createdAt).toLocaleString(),o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:143,columnNumber:17},this)," ",bi.getBackupStats(r).totalDocuments.toLocaleString()," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:141,columnNumber:15},this),o.jsxDEV("button",{onClick:d,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[o.jsxDEV(Xu,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:150,columnNumber:17},this),"  "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:146,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:139,columnNumber:13},this),o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("button",{onClick:u,disabled:a,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[a&&(s==null?void 0:s.status)==="backing_up"?o.jsxDEV(fc,{className:"h-5 w-5 animate-spin"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:164,columnNumber:17},this):o.jsxDEV(Xu,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:166,columnNumber:17},this),"  "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:158,columnNumber:13},this),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("input",{ref:m,type:"file",accept:".json",onChange:h,disabled:a,className:"hidden"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:172,columnNumber:15},this),o.jsxDEV("button",{onClick:()=>{var b;return(b=m.current)==null?void 0:b.click()},disabled:a,className:"w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed border-gray-300 text-gray-700 rounded-lg hover:border-gray-400 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[a&&(s==null?void 0:s.status)==="restoring"?o.jsxDEV(fc,{className:"h-5 w-5 animate-spin"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:186,columnNumber:19},this):o.jsxDEV(el,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:188,columnNumber:19},this),"  "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:180,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:171,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:157,columnNumber:11},this),o.jsxDEV("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:o.jsxDEV("p",{className:"text-xs text-yellow-800",children:[o.jsxDEV("strong",{children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:198,columnNumber:15},this),"     .      ."]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:197,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:196,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:104,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:87,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/BackupModal.tsx",lineNumber:86,columnNumber:5},this)}const Ni="work_requests",ho=t=>{const e=t.data();return{_id:t.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof be?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof be?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},xi={getAllWorkRequests:async()=>{const t=vt(Fe(se,Ni),is("createdAt","desc"));return(await At(t)).docs.map(ho)},getWorkRequestById:async t=>{const e=we(se,Ni,t),s=await It(e);return s.exists()?ho(s):null},createWorkRequest:async t=>{const e=be.now(),s={project:t.project,requestType:t.requestType,description:t.description,requestDate:t.requestDate instanceof Date?be.fromDate(t.requestDate):t.requestDate,dueDate:t.dueDate instanceof Date?be.fromDate(t.dueDate):t.dueDate,requestedBy:t.requestedBy,assignedTo:t.assignedTo,status:t.status||"pending",priority:t.priority||"medium",notes:t.notes||"",createdAt:e,updatedAt:e},n=await On(Fe(se,Ni),s),r=await It(n);return ho(r)},updateWorkRequest:async(t,e)=>{const s=we(se,Ni,t),n={updatedAt:be.now()};e.project!==void 0&&(n.project=e.project),e.requestType!==void 0&&(n.requestType=e.requestType),e.description!==void 0&&(n.description=e.description),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(n.dueDate=e.dueDate instanceof Date?be.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(n.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.status!==void 0&&(n.status=e.status),e.priority!==void 0&&(n.priority=e.priority),e.notes!==void 0&&(n.notes=e.notes),e.completedDate!==void 0&&(n.completedDate=e.completedDate instanceof Date?be.fromDate(e.completedDate):e.completedDate),await Rt(s,n);const r=await It(s);return ho(r)},deleteWorkRequest:async t=>{const e=we(se,Ni,t);await Us(e)},subscribeToWorkRequests:t=>{const e=vt(Fe(se,Ni),is("createdAt","desc"));return dn(e,s=>{const n=s.docs.map(ho);t(n)})}},OA={getAllWorkRequests:()=>xi.getAllWorkRequests(),getWorkRequestById:async t=>{const e=await xi.getWorkRequestById(t);if(!e)throw new Error("Work request not found");return e},createWorkRequest:t=>xi.createWorkRequest(t),updateWorkRequest:(t,e)=>xi.updateWorkRequest(t,e),deleteWorkRequest:t=>xi.deleteWorkRequest(t),subscribeToWorkRequests:xi.subscribeToWorkRequests},qA=()=>{if(typeof window<"u"){const t=window.location.hostname;if(t==="hvlab.app"||t.includes("hv-lab-app")||t.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},$A=Cb.create({baseURL:qA(),headers:{"Content-Type":"application/json"}});function Yi(t){return!t||typeof t!="string"||t.startsWith("http://")||t.startsWith("https://")?!1:!!(t.startsWith("data:image")||t.length>1e3)}function WA(t){if(t.startsWith("data:")){const e=t.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function zA(t){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[t]||"jpg"}function KA(t){let e=t,s="image/jpeg";if(t.includes(",")){const a=t.split(",");e=a[1];const c=a[0].match(/data:([^;]+);/);c&&(s=c[1])}const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const i=new Uint8Array(r);return new Blob([i],{type:s})}async function sy(t,e,s,n){if(!Yi(s))return s;const r=WA(s),i=zA(r),a=n!==void 0?`image_${n}.${i}`:`main.${i}`,c=`${t}/${e}/${a}`,m=yl(bl,c),u=KA(s);return await mm(m,u,{contentType:r}),await um(m)}async function Nl(t,e,s){const n=[];for(let r=0;r<s.length;r++){const i=s[r],a=await sy(t,e,i,r);n.push(a)}return n}async function ny(t){if(t.includes("firebasestorage.googleapis.com"))try{const e=t.match(/\/o\/(.+)\?/);if(e){const s=decodeURIComponent(e[1]),n=yl(bl,s);await Qk(n)}}catch(e){console.warn("  :",e)}}async function ry(t){await Promise.all(t.map(e=>ny(e)))}let ti=new Map,Ri=null;async function cr(){if(!(ti.size>0))return Ri||(Ri=(async()=>{try{const t=Fe(se,Qe.PROJECTS);(await At(t)).docs.forEach(s=>{const n=s.data();ti.set(s.id,{name:n.name||"",color:n.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",ti.size,"")}catch(t){throw console.error("[paymentFirestoreService]    :",t),Ri=null,t}})(),Ri)}function go(t){const e=ti.get(String(t.projectId))||{name:"",color:"#4A90E2"};return!e.name&&t.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:t.id,projectId:t.projectId,cacheSize:ti.size,cacheKeys:Array.from(ti.keys()).slice(0,5),vendorName:t.vendorName}),{id:t.id,project_id:t.projectId,project_name:e.name,project_color:e.color,user_id:t.userId||0,requester_name:t.requestedBy||"",approved_by:t.approvedBy||void 0,request_type:t.requestType||"material",vendor_name:t.vendorName||"",description:t.description||"",amount:t.amount||0,account_holder:t.accountHolder||"",bank_name:t.bankName||"",account_number:t.accountNumber||"",item_name:t.itemName||"",material_amount:t.materialAmount||0,labor_amount:t.laborAmount||0,original_material_amount:t.originalMaterialAmount||0,original_labor_amount:t.originalLaborAmount||0,apply_tax_deduction:t.applyTaxDeduction?1:0,includes_vat:t.includesVAT?1:0,quick_text:t.quickText||"",images:t.images?JSON.stringify(t.images):"[]",notes:t.notes||"",status:t.status||"pending",created_at:t.createdAt||"",updated_at:t.updatedAt||"",paid_at:t.paidAt||void 0,request_date:t.requestDate||t.createdAt||""}}function Sf(t){const e={};if(t.project_id!==void 0&&(e.projectId=t.project_id),t.projectId!==void 0&&(e.projectId=t.projectId),t.request_type!==void 0&&(e.requestType=t.request_type),t.category!==void 0&&(e.requestType=t.category),t.vendor_name!==void 0&&(e.vendorName=t.vendor_name),t.process!==void 0&&(e.vendorName=t.process),t.description!==void 0&&(e.description=t.description),t.purpose!==void 0&&(e.description=t.purpose),t.amount!==void 0&&(e.amount=t.amount),t.account_holder!==void 0&&(e.accountHolder=t.account_holder),t.bank_name!==void 0&&(e.bankName=t.bank_name),t.account_number!==void 0&&(e.accountNumber=t.account_number),t.bankInfo!==void 0&&typeof t.bankInfo=="object"&&t.bankInfo!==null){const s=t.bankInfo;s.accountHolder&&(e.accountHolder=s.accountHolder),s.bankName&&(e.bankName=s.bankName),s.accountNumber&&(e.accountNumber=s.accountNumber)}if(t.notes!==void 0&&(e.notes=t.notes),t.itemName!==void 0&&(e.itemName=t.itemName),t.item_name!==void 0&&(e.itemName=t.item_name),t.materialAmount!==void 0&&(e.materialAmount=t.materialAmount),t.laborAmount!==void 0&&(e.laborAmount=t.laborAmount),t.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=t.originalMaterialAmount),t.originalLaborAmount!==void 0&&(e.originalLaborAmount=t.originalLaborAmount),t.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=t.applyTaxDeduction),t.includesVAT!==void 0&&(e.includesVAT=t.includesVAT),t.quickText!==void 0&&(e.quickText=t.quickText),t.images!==void 0&&(e.images=Array.isArray(t.images)?t.images:[]),t.status!==void 0&&(e.status=t.status),t.requestedBy!==void 0&&(e.requestedBy=t.requestedBy),t.requestDate!==void 0){const s=t.requestDate;s instanceof Date?e.requestDate=s.toISOString():typeof s=="string"&&(e.requestDate=s)}return t.request_date!==void 0&&typeof t.request_date=="string"&&(e.requestDate=t.request_date),e}const Xs={getAllPayments:async()=>{await cr();const t=Fe(se,Qe.PAYMENTS),e=vt(t,is("id","desc"));let s;try{s=await UD(e),console.log("[getAllPayments]   :",s.docs.length,"")}catch(n){console.warn("[getAllPayments]   ,  :",n),s=await At(e)}return s.docs.map(n=>{const r=n.data();return go({...r,id:parseInt(n.id)||r.id})})},getPaymentById:async t=>{await cr();const e=we(se,Qe.PAYMENTS,t),s=await It(e);if(s.exists()){const n=s.data();return go({...n,id:parseInt(s.id)||n.id})}return null},createPayment:async t=>{await cr();const e=Fe(se,Qe.PAYMENTS),s=await At(e);let n=0;s.docs.forEach(u=>{const d=parseInt(u.id);!isNaN(d)&&d>n&&(n=d)});const r=n+1,i=Sf(t),a=new Date().toISOString(),c={id:r,projectId:i.projectId||0,userId:1,requestedBy:i.requestedBy||"",requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",requestDate:i.requestDate||a,createdAt:a,updatedAt:a,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},m=we(se,Qe.PAYMENTS,String(r));if(await ii(m,c),i.images&&i.images.length>0)if(i.images.some(d=>Yi(d))){const d=await Nl("payments",String(r),i.images);await Rt(m,{images:d,imageCount:d.length}),c.images=d,c.imageCount=d.length}else await Rt(m,{images:i.images,imageCount:i.images.length}),c.images=i.images,c.imageCount=i.images.length;return go(c)},updatePayment:async(t,e)=>{await cr();const s=we(se,Qe.PAYMENTS,t),n=Sf(e);await Rt(s,{...n,updatedAt:new Date().toISOString()});const r=await Xs.getPaymentById(t);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(t,e)=>{console.log("[Firestore]   :",t,"->",e),await cr();const s=we(se,Qe.PAYMENTS,t),n=new Date().toISOString(),r={status:e,updatedAt:n};e==="completed"&&(r.paidAt=n),await Rt(s,r),console.log("[Firestore]   :",t,"->",e);const i=await Xs.getPaymentById(t);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(t,e,s)=>{await cr();const n=we(se,Qe.PAYMENTS,t);await Rt(n,{materialAmount:e,laborAmount:s,updatedAt:new Date().toISOString()});const r=await Xs.getPaymentById(t);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(t,e)=>{const s=we(se,Qe.PAYMENTS,t);let n=e;return e.length>0&&e.some(i=>Yi(i))&&(n=await Nl("payments",t,e)),await Rt(s,{images:n,imageCount:n.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:n}},deletePayment:async t=>{console.log("[Firestore ]  - ID:",t);const e=we(se,Qe.PAYMENTS,t),s=await It(e);if(console.log("[Firestore ]   :",s.exists()),s.exists()){const n=s.data();n.images&&n.images.length>0&&(console.log("[Firestore ]   ...",n.images.length,""),await ry(n.images))}await Us(e),console.log("[Firestore ]  - ID:",t)},subscribeToPayments:t=>{console.log("[paymentFirestoreService] subscribeToPayments ");let e=null;return cr().then(()=>{const s=Fe(se,Qe.PAYMENTS),n=vt(s,is("id","desc"));console.log("[paymentFirestoreService] Firestore onSnapshot  ..."),e=dn(n,r=>{r.metadata.fromCache&&r.metadata.hasPendingWrites===!1&&console.log("[ ]   ,   ..."),console.log("[ ]  :",r.docs.length,", fromCache:",r.metadata.fromCache),r.docChanges().forEach(a=>{const c=a.doc.data();console.log(`[ ] : ${a.type} - ID: ${a.doc.id}, status: ${c.status}`)});const i=r.docs.map(a=>{const c=a.data();return go({...c,id:parseInt(a.id)||c.id})});t(i)},r=>{console.error("[ ]  :",r)})}).catch(s=>{console.error("[paymentFirestoreService]    :",s)}),()=>{console.log("[paymentFirestoreService]   "),e&&e()}},getPaymentsByProject:async t=>{await cr();const e=Fe(se,Qe.PAYMENTS),s=vt(e,Ts("projectId","==",t),is("id","desc"));return(await At(s)).docs.map(r=>{const i=r.data();return go({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{ti.clear(),Ri=null}},gn={getAllPayments:()=>Xs.getAllPayments(),getPaymentById:async t=>{const e=await Xs.getPaymentById(t);if(!e)throw new Error("Payment not found");return e},createPayment:t=>Xs.createPayment(t),updatePayment:(t,e)=>Xs.updatePayment(t,e),updatePaymentStatus:(t,e)=>Xs.updatePaymentStatus(t,e),updatePaymentAmounts:(t,e,s)=>Xs.updatePaymentAmounts(t,e,s),updatePaymentImages:(t,e)=>Xs.updatePaymentImages(t,e),deletePayment:t=>Xs.deletePayment(t),sendTossPaymentSms:async t=>(await $A.post("/payments/send-toss-payment-sms",t)).data,subscribeToPayments:Xs.subscribeToPayments,getPaymentsByProject:Xs.getPaymentsByProject,clearProjectsCache:Xs.clearProjectsCache},vi="as_requests",yo=t=>{const e=t.data();return{_id:t.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof be?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof be?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},_i={getAllASRequests:async()=>{const t=vt(Fe(se,vi),is("createdAt","desc"));return(await At(t)).docs.map(yo)},getASRequestById:async t=>{const e=we(se,vi,t),s=await It(e);return s.exists()?yo(s):null},createASRequest:async t=>{const e=be.now(),s={project:t.project,client:t.client,requestDate:t.requestDate instanceof Date?be.fromDate(t.requestDate):t.requestDate,siteAddress:t.siteAddress,entrancePassword:t.entrancePassword,description:t.description,status:t.status||"pending",notes:t.notes||"",createdAt:e,updatedAt:e};t.scheduledVisitDate&&(s.scheduledVisitDate=t.scheduledVisitDate instanceof Date?be.fromDate(t.scheduledVisitDate):t.scheduledVisitDate),t.scheduledVisitTime&&(s.scheduledVisitTime=t.scheduledVisitTime),t.assignedTo&&(s.assignedTo=t.assignedTo);const n=await On(Fe(se,vi),s),r=await It(n);return yo(r)},updateASRequest:async(t,e)=>{const s=we(se,vi,t),n={updatedAt:be.now()};e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(n.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(n.entrancePassword=e.entrancePassword),e.description!==void 0&&(n.description=e.description),e.scheduledVisitDate!==void 0&&(n.scheduledVisitDate=e.scheduledVisitDate instanceof Date?be.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(n.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.completionDate!==void 0&&(n.completionDate=e.completionDate instanceof Date?be.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(n.notes=e.notes),e.status!==void 0&&(n.status=e.status),await Rt(s,n);const r=await It(s);return yo(r)},deleteASRequest:async t=>{const e=we(se,vi,t);await Us(e)},subscribeToASRequests:t=>{const e=vt(Fe(se,vi),is("createdAt","desc"));return dn(e,s=>{const n=s.docs.map(yo);t(n)})}},Lo={getAllASRequests:()=>_i.getAllASRequests(),getASRequestById:async t=>{const e=await _i.getASRequestById(t);if(!e)throw new Error("AS Request not found");return e},createASRequest:t=>_i.createASRequest(t),updateASRequest:(t,e)=>_i.updateASRequest(t,e),deleteASRequest:t=>_i.deleteASRequest(t),subscribeToASRequests:_i.subscribeToASRequests};function bo(t){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:t.id,id:parseInt(t.id)||0,name:t.name,client:{name:t.client||"",phone:"",address:t.address||""},location:{address:t.address||""},startDate:t.startDate||"",endDate:t.endDate||"",status:e[t.status]||"planning",budget:0,actualCost:0,manager:{_id:String(t.managerId||""),name:t.managerName||t.manager||"",username:t.managerUsername||""},fieldManagers:[],workers:[],colorCode:t.color||"#4A90E2",progress:0,description:t.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:t.createdAt||"",updatedAt:t.updatedAt||"",meetingNotes:t.meetingNotes||[],customerRequests:t.customerRequests||[],entrancePassword:t.entrancePassword||"",sitePassword:t.sitePassword||""}}function If(t){var s,n,r,i,a,c,m,u;const e={};if(t.name!==void 0&&(e.name=t.name),t.client!==void 0&&(e.client=typeof t.client=="string"?t.client:((s=t.client)==null?void 0:s.name)||""),t.location!==void 0&&(e.address=typeof t.location=="string"?t.location:((n=t.location)==null?void 0:n.address)||""),t.address!==void 0&&(e.address=t.address),t.startDate!==void 0&&(e.startDate=typeof t.startDate=="string"?t.startDate:((a=(i=(r=t.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:a.split("T")[0])||null),t.endDate!==void 0&&(e.endDate=typeof t.endDate=="string"?t.endDate:((u=(m=(c=t.endDate)==null?void 0:c.toISOString)==null?void 0:m.call(c))==null?void 0:u.split("T")[0])||null),t.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[t.status]||"planning"}return t.description!==void 0&&(e.description=t.description),t.manager!==void 0&&(e.manager=t.manager),t.meetingNotes!==void 0&&(e.meetingNotes=t.meetingNotes),t.customerRequests!==void 0&&(e.customerRequests=t.customerRequests),t.entrancePassword!==void 0&&(e.entrancePassword=t.entrancePassword),t.sitePassword!==void 0&&(e.sitePassword=t.sitePassword),t.color!==void 0&&(e.color=t.color),t.colorCode!==void 0&&(e.color=t.colorCode),e}const fr={getAllProjects:async()=>{const t=Fe(se,Qe.PROJECTS);return(await At(t)).docs.map(n=>{const r=n.data();return bo({...r,id:n.id})}).sort((n,r)=>(r.id||0)-(n.id||0))},getProjectById:async t=>{const e=we(se,Qe.PROJECTS,t),s=await It(e);if(s.exists()){const n=s.data();return bo({...n,id:s.id})}return null},createProject:async t=>{const e=Fe(se,Qe.PROJECTS),s=await At(e);let n=0;s.docs.forEach(u=>{const d=parseInt(u.id);!isNaN(d)&&d>n&&(n=d)});const r=String(n+1),i=If(t),a=new Date().toISOString(),c={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:a,updatedAt:a},m=we(se,Qe.PROJECTS,r);return await ii(m,c),bo(c)},updateProject:async(t,e)=>{const s=we(se,Qe.PROJECTS,t),n=If(e);await Rt(s,{...n,updatedAt:new Date().toISOString()});const r=await fr.getProjectById(t);if(!r)throw new Error("Project not found after update");return r},deleteProject:async t=>{const e=we(se,Qe.PROJECTS,t);await Us(e)},subscribeToProjects:t=>{const e=Fe(se,Qe.PROJECTS);return dn(e,s=>{const n=s.docs.map(r=>{const i=r.data();return bo({...i,id:r.id})});n.sort((r,i)=>(i.id||0)-(r.id||0)),t(n)})},subscribeToProject:(t,e)=>{const s=we(se,Qe.PROJECTS,t);return dn(s,n=>{if(n.exists()){const r=n.data();e(bo({...r,id:n.id}))}else e(null)})}},Hi={getAllProjects:()=>fr.getAllProjects(),getProjectById:async t=>{const e=await fr.getProjectById(t);if(!e)throw new Error("Project not found");return e},createProject:t=>fr.createProject(t),updateProject:(t,e)=>fr.updateProject(t,e),deleteProject:t=>fr.deleteProject(t),subscribeToProjects:fr.subscribeToProjects,subscribeToProject:fr.subscribeToProject},wc=t=>t?typeof t=="string"?t:t instanceof be?t.toDate().toISOString():new Date().toISOString():new Date().toISOString(),La={async getAllQuoteInquiries(){const t=Fe(se,"quote_inquiries"),e=vt(t,is("createdAt","desc"));return(await At(e)).docs.map(n=>{const r=n.data();return{id:n.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:wc(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(t){const e=we(se,"quote_inquiries",t),s=await It(e);if(!s.exists())return null;const n=s.data();return{id:s.id,name:n.name||"",phone:n.phone||"",email:n.email||"",address:n.address,projectType:n.projectType,budget:n.budget,message:n.message||"",createdAt:wc(n.createdAt),isRead:n.isRead||!1}},async createQuoteInquiry(t){const e=Fe(se,"quote_inquiries"),s={...t,isRead:!1,createdAt:ns()};return{id:(await On(e,s)).id,...t,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(t){const e=we(se,"quote_inquiries",t);await Rt(e,{isRead:!0,updatedAt:ns()})},async deleteQuoteInquiry(t){const e=we(se,"quote_inquiries",t);await Us(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(t){const e=Fe(se,"quote_inquiries"),s=vt(e,is("createdAt","desc"));return dn(s,r=>{const i=r.docs.map(a=>{const c=a.data();return{id:a.id,name:c.name||"",phone:c.phone||"",email:c.email||"",address:c.address,projectType:c.projectType,budget:c.budget,message:c.message||"",createdAt:wc(c.createdAt),isRead:c.isRead||!1}});t(i)})}},Xa={getAllQuoteInquiries:()=>La.getAllQuoteInquiries(),markAsRead:t=>La.markAsRead(t),deleteQuoteInquiry:t=>La.deleteQuoteInquiry(t),subscribeToQuoteInquiries:La.subscribeToQuoteInquiries},QA=()=>{var Ge,xt;const{user:t,logout:e,loading:s}=Rr(),[n,r]=D.useState(!1),[i,a]=D.useState(!1),[c,m]=D.useState(!1),[u,d]=D.useState(!1),h=Db(),{unreadCount:p}=ty(),[b,w]=D.useState(0),[v,C]=D.useState(0),[R,I]=D.useState(0),[z,ie]=D.useState(0),[te,O]=D.useState(!1),[A,x]=D.useState(0),[E,T]=D.useState(!1),L=D.useRef(0),P=D.useRef(null),k=80,ke=D.useCallback(fe=>{if(window.scrollY>0)return!1;let qe=fe;for(;qe&&qe!==document.body;){const ft=window.getComputedStyle(qe).overflowY;if((ft==="auto"||ft==="scroll")&&qe.scrollTop>0)return!1;qe=qe.parentElement}return!0},[]),Re=D.useCallback(fe=>{if(window.innerWidth>=768)return;const qe=fe.target;ke(qe)&&(L.current=fe.touches[0].clientY,O(!0))},[ke]),ye=D.useCallback(fe=>{if(!te||E)return;const qe=fe.target;if(!ke(qe)){O(!1),x(0);return}const ft=fe.touches[0].clientY-L.current;if(ft>0){const tt=Math.min(ft*.5,120);x(tt)}else O(!1),x(0)},[te,E,ke]),Ie=D.useCallback(()=>{te&&(A>=k&&!E?(T(!0),x(50),setTimeout(()=>{window.location.reload()},300)):x(0),O(!1))},[te,A,E]);if(D.useEffect(()=>{m(!1)},[h.pathname]),D.useEffect(()=>{const fe=qe=>{m(qe.detail.isOpen)};return window.addEventListener("mobileFormStateChange",fe),()=>window.removeEventListener("mobileFormStateChange",fe)},[]),D.useEffect(()=>{const fe=()=>{ie(qe=>Math.max(0,qe-1))};return window.addEventListener("quoteInquiryRead",fe),()=>window.removeEventListener("quoteInquiryRead",fe)},[]),D.useEffect(()=>{const fe=()=>{C(qe=>Math.max(0,qe-1))};return window.addEventListener("paymentCompleted",fe),()=>window.removeEventListener("paymentCompleted",fe)},[]),D.useEffect(()=>{if(!t)return;const fe=Xs.subscribeToPayments(async qe=>{try{let ze=qe;if(t.name===""){const tt=(await Hi.getAllProjects()).map(Bt=>Bt.name);ze=qe.filter(Bt=>tt.includes(Bt.project_name))}C(ze.filter(ft=>ft.status==="pending").length)}catch(ze){console.error("Failed to refresh payment count:",ze)}});return()=>{fe()}},[t]),D.useEffect(()=>{if(!t)return;const fe=async()=>{try{const[ze,ft,tt,Bt]=await Promise.all([OA.getAllWorkRequests(),gn.getAllPayments(),Lo.getAllASRequests(),Hi.getAllProjects()]);w(ze.filter(W=>W.assignedTo===t.name&&W.status==="pending").length);let ds=ft;if(t.name===""){const W=Bt.map(Ce=>Ce.name);ds=ft.filter(Ce=>W.includes(Ce.project))}if(C(ds.filter(W=>W.status==="pending").length),I(tt.filter(W=>W.status==="in-progress").length),t.role==="admin"||t.role==="manager")try{const Ce=(await Xa.getAllQuoteInquiries()).filter(Me=>!Me.isRead).length;ie(Ce)}catch(W){console.error("Failed to load quote inquiry count:",W)}}catch(ze){console.error("Failed to load badge counts:",ze)}};fe();const qe=setInterval(fe,3e4);return()=>clearInterval(qe)},[t]),s)return o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:o.jsxDEV("div",{className:"text-center",children:[o.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:242,columnNumber:11},void 0),o.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:243,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:241,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:240,columnNumber:7},void 0);if(!t){const fe=window.location.pathname+window.location.search;return fe&&fe!=="/login"&&fe!=="/"&&sessionStorage.setItem("redirectAfterLogin",fe),o.jsxDEV(up,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:256,columnNumber:12},void 0)}const rt=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...b>0&&{badge:b}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...v>0&&{badge:v}},{name:"AS ",href:"/after-service",...R>0&&{badge:R}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...z>0&&{badge:z}},{name:"",href:"/contractors"}],Lt=rt.filter(fe=>!fe.roles||fe.roles.includes((t==null?void 0:t.role)||"")),Ht=((Ge=rt.find(fe=>fe.href===h.pathname))==null?void 0:Ge.name)||"",He=(()=>{const fe=h.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(fe)?()=>{const ze=new CustomEvent("headerAddButtonClick");window.dispatchEvent(ze)}:null})();return o.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[o.jsxDEV("div",{className:vn("fixed inset-0 z-40 lg:hidden",n?"block":"hidden"),children:[o.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:324,columnNumber:9},void 0),o.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[o.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:330,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:331,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:11},void 0),o.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Lt.map(fe=>o.jsxDEV(uc,{to:fe.href,className:({isActive:qe})=>vn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",qe?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:o.jsxDEV("span",{className:"flex items-center justify-between",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:357,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:359,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:356,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:340,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:338,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4 space-y-2",children:[(t==null?void 0:t.role)==="admin"&&o.jsxDEV("button",{onClick:()=>{r(!1),d(!0)},className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left flex items-center gap-2",children:[o.jsxDEV(Tc,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:376,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:369,columnNumber:15},void 0),o.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:380,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:367,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:328,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:318,columnNumber:7},void 0),o.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:o.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[o.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:394,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:393,columnNumber:11},void 0),o.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Lt.map(fe=>o.jsxDEV(uc,{to:fe.href,className:({isActive:qe})=>vn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",qe?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:o.jsxDEV("span",{className:"flex items-center justify-between",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:411,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:413,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:410,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:398,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:396,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4 space-y-2",children:[(t==null?void 0:t.role)==="admin"&&o.jsxDEV("button",{onClick:()=>d(!0),className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left flex items-center gap-2",children:[o.jsxDEV(Tc,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:427,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:423,columnNumber:15},void 0),o.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:421,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:392,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:7},void 0),o.jsxDEV("div",{className:"main-content lg:pl-56",children:[o.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:o.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[o.jsxDEV("div",{className:"flex items-center space-x-3",children:[o.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:o.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:454,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:453,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:448,columnNumber:15},void 0),Ht&&o.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:Ht},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:458,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[He&&o.jsxDEV("button",{onClick:He,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":c?"":"",children:c?o.jsxDEV(us,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:471,columnNumber:37},void 0):o.jsxDEV(Mi,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:471,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:466,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>a(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[o.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:481,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:480,columnNumber:17},void 0),p>0&&o.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:p>9?"9+":p},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:484,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:15},void 0),o.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[o.jsxDEV("div",{className:"text-right",children:[o.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:t==null?void 0:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:491,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:492,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:17},void 0),o.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(xt=t==null?void 0:t.name)==null?void 0:xt.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:494,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:489,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:463,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:445,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:444,columnNumber:9},void 0),o.jsxDEV("div",{className:"portrait-top-nav hidden",children:o.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:Lt.map(fe=>o.jsxDEV(uc,{to:fe.href,className:({isActive:qe})=>vn("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",qe?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:o.jsxDEV("span",{className:"flex items-center gap-1",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:519,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:521,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:518,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:506,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:504,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:9},void 0),o.jsxDEV("main",{ref:P,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:Re,onTouchMove:ye,onTouchEnd:Ie,children:[A>0&&o.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:A,transition:te?"none":"height 0.2s ease-out"},children:o.jsxDEV("div",{className:vn("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",E&&"animate-spin"),style:{transform:`rotate(${E?0:A*2}deg)`,opacity:Math.min(A/k,1)},children:o.jsxDEV(Tb,{className:vn("w-5 h-5",A>=k?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:559,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:549,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:541,columnNumber:13},void 0),o.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:A>0?`translateY(${A}px)`:"none",transition:te?"none":"transform 0.2s ease-out"},children:o.jsxDEV(kb,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:576,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:569,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:532,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:7},void 0),o.jsxDEV(MA,{isOpen:i,onClose:()=>a(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:582,columnNumber:7},void 0),o.jsxDEV(FA,{isOpen:u,onClose:()=>d(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:588,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:316,columnNumber:5},void 0)},YA=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",Di="schedules",No=t=>{const e=t.data();return{_id:t.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof be?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof be?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof be?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},ki={getAllSchedules:async()=>{const t=vt(Fe(se,Di),is("startDate","desc"));return(await At(t)).docs.map(No)},getScheduleById:async t=>{const e=we(se,Di,t),s=await It(e);return s.exists()?No(s):null},createSchedule:async t=>{const e=be.now(),s={project:typeof t.project=="string"?{_id:t.project,name:t.project}:t.project,title:t.title,type:t.type||"other",phase:t.phase||"",startDate:t.startDate instanceof Date?be.fromDate(t.startDate):t.startDate,endDate:t.endDate instanceof Date?be.fromDate(t.endDate):t.endDate,allDay:t.allDay??!0,assignedTo:t.assignedTo||[],description:t.description||"",location:t.location||"",priority:t.priority||"medium",progress:t.progress??0,isCompleted:t.isCompleted??!1,time:t.time||"",asRequestId:t.asRequestId||null,createdAt:e,updatedAt:e},n=await On(Fe(se,Di),s),r=await It(n);return No(r)},updateSchedule:async(t,e)=>{const s=we(se,Di,t),n={updatedAt:be.now()};e.project!==void 0&&(n.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(n.title=e.title),e.type!==void 0&&(n.type=e.type),e.phase!==void 0&&(n.phase=e.phase),e.startDate!==void 0&&(n.startDate=e.startDate instanceof Date?be.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(n.endDate=e.endDate instanceof Date?be.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(n.allDay=e.allDay),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.description!==void 0&&(n.description=e.description),e.location!==void 0&&(n.location=e.location),e.priority!==void 0&&(n.priority=e.priority),e.progress!==void 0&&(n.progress=e.progress),e.isCompleted!==void 0&&(n.isCompleted=e.isCompleted,e.isCompleted&&(n.completedAt=be.now())),e.time!==void 0&&(n.time=e.time),await Rt(s,n);const r=await It(s);return No(r)},deleteSchedule:async t=>{const e=we(se,Di,t);await Us(e)},subscribeToSchedules:t=>{const e=vt(Fe(se,Di),is("startDate","desc"));return dn(e,s=>{const n=s.docs.map(No);t(n)})}},Pa={getAllSchedules:()=>ki.getAllSchedules(),getScheduleById:async t=>{const e=await ki.getScheduleById(t);if(!e)throw new Error("Schedule not found");return e},createSchedule:t=>ki.createSchedule(t),updateSchedule:(t,e)=>ki.updateSchedule(t,e),deleteSchedule:t=>ki.deleteSchedule(t),subscribeToSchedules:ki.subscribeToSchedules},Ai="contractors",xo=t=>{const e=t.data();return{_id:t.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ei={getAllContractors:async()=>{const t=vt(Fe(se,Ai),is("name","asc"));return(await At(t)).docs.map(xo)},getContractorById:async t=>{const e=we(se,Ai,t),s=await It(e);return s.exists()?xo(s):null},createContractor:async t=>{const e=be.now(),s={rank:t.rank||"",companyName:t.companyName||"",name:t.name,position:t.position||"",process:t.process,contact:t.contact||"",accountNumber:t.accountNumber,notes:t.notes||"",createdAt:e,updatedAt:e},n=await On(Fe(se,Ai),s),r=await It(n);return xo(r)},updateContractor:async(t,e)=>{const s=we(se,Ai,t),n={updatedAt:be.now()};e.rank!==void 0&&(n.rank=e.rank),e.companyName!==void 0&&(n.companyName=e.companyName),e.name!==void 0&&(n.name=e.name),e.position!==void 0&&(n.position=e.position),e.process!==void 0&&(n.process=e.process),e.contact!==void 0&&(n.contact=e.contact),e.accountNumber!==void 0&&(n.accountNumber=e.accountNumber),e.notes!==void 0&&(n.notes=e.notes),await Rt(s,n);const r=await It(s);return xo(r)},deleteContractor:async t=>{const e=we(se,Ai,t);await Us(e)},subscribeToContractors:t=>{const e=vt(Fe(se,Ai),is("name","asc"));return dn(e,s=>{const n=s.docs.map(xo);t(n)})}},Yn={getAllContractors:()=>Ei.getAllContractors(),getContractorById:async t=>{const e=await Ei.getContractorById(t);if(!e)throw new Error("Contractor not found");return e},createContractor:t=>Ei.createContractor(t),updateContractor:(t,e)=>Ei.updateContractor(t,e),deleteContractor:t=>Ei.deleteContractor(t),subscribeToContractors:Ei.subscribeToContractors},Ci="construction_payments",vo=t=>{const e=t.data();let s=e.payments||[];if(typeof s=="string")try{s=JSON.parse(s)}catch{s=[]}Array.isArray(s)||(s=[]);const n=s.map(i=>{let a=i.types||[];if(typeof a=="string")try{a=JSON.parse(a)}catch{a=[a]}return Array.isArray(a)||(a=[]),{types:a,type:a[0]||i.type||"",amount:i.amount||0,date:i.date instanceof be?i.date.toDate().toISOString():i.date||"",method:i.method||"",notes:i.notes||""}}),r={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(r.contract=e.expectedPaymentDates.contract instanceof be?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(r.start=e.expectedPaymentDates.start instanceof be?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(r.middle=e.expectedPaymentDates.middle instanceof be?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(r.final=e.expectedPaymentDates.final instanceof be?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:t.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:n,expectedPaymentDates:r,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Vi={getAllConstructionPayments:async()=>{console.log("[ConstructionPayment] Firestore  ...");try{const t=await At(Fe(se,Ci));console.log("[ConstructionPayment] Firestore :",t.size," ");const e=t.docs.map(vo).filter(s=>s.project&&s.totalAmount);return console.log("[ConstructionPayment] Firestore  :",e.length,""),e}catch(t){return console.error("[ConstructionPayment] Firestore  :",t),[]}},getConstructionPaymentById:async t=>{const e=we(se,Ci,t),s=await It(e);return s.exists()?vo(s):null},createConstructionPayment:async t=>{const e=be.now(),s=(t.payments||[]).map(c=>({types:c.types,amount:c.amount,date:c.date instanceof Date?be.fromDate(c.date):c.date,method:c.method,notes:c.notes||""})),n={};t.expectedPaymentDates&&(t.expectedPaymentDates.contract&&(n.contract=t.expectedPaymentDates.contract instanceof Date?be.fromDate(t.expectedPaymentDates.contract):t.expectedPaymentDates.contract),t.expectedPaymentDates.start&&(n.start=t.expectedPaymentDates.start instanceof Date?be.fromDate(t.expectedPaymentDates.start):t.expectedPaymentDates.start),t.expectedPaymentDates.middle&&(n.middle=t.expectedPaymentDates.middle instanceof Date?be.fromDate(t.expectedPaymentDates.middle):t.expectedPaymentDates.middle),t.expectedPaymentDates.final&&(n.final=t.expectedPaymentDates.final instanceof Date?be.fromDate(t.expectedPaymentDates.final):t.expectedPaymentDates.final));const r={project:t.project,client:t.client,totalAmount:t.totalAmount,vatType:t.vatType,vatPercentage:t.vatPercentage,vatAmount:t.vatAmount,payments:s,expectedPaymentDates:n,createdAt:e,updatedAt:e},i=await On(Fe(se,Ci),r),a=await It(i);return vo(a)},updateConstructionPayment:async(t,e)=>{const s=we(se,Ci,t),n={updatedAt:be.now()};if(e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.totalAmount!==void 0&&(n.totalAmount=e.totalAmount),e.vatType!==void 0&&(n.vatType=e.vatType),e.vatPercentage!==void 0&&(n.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(n.vatAmount=e.vatAmount),e.payments!==void 0&&(n.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?be.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?be.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?be.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?be.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?be.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),n.expectedPaymentDates=i}await Rt(s,n);const r=await It(s);return vo(r)},deleteConstructionPayment:async t=>{const e=we(se,Ci,t);await Us(e)},subscribeToConstructionPayments:t=>{const e=vt(Fe(se,Ci),is("createdAt","desc"));return dn(e,s=>{const n=s.docs.map(vo);t(n)})}},ja={getAllConstructionPayments:()=>Vi.getAllConstructionPayments(),getConstructionPaymentById:async t=>{const e=await Vi.getConstructionPaymentById(t);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:t=>Vi.createConstructionPayment(t),updateConstructionPayment:(t,e)=>Vi.updateConstructionPayment(t,e),deleteConstructionPayment:t=>Vi.deleteConstructionPayment(t),subscribeToConstructionPayments:Vi.subscribeToConstructionPayments};let Ja=new Map,_o=null;async function GA(){if(!(Ja.size>0))return _o||(_o=(async()=>{try{const t=Fe(se,Qe.PROJECTS);(await At(t)).docs.forEach(s=>{const n=s.data(),r=parseInt(s.id);!isNaN(r)&&n.name&&Ja.set(n.name,r)}),console.log("[executionRecordFirestoreService]    :",Ja.size,"")}catch(t){throw console.error("[executionRecordFirestoreService]    :",t),_o=null,t}})(),_o)}function wi(t){return{id:t.id,project_id:t.projectId,project_name:t.projectName||"",author:t.author||"",date:t.date||"",process:t.process||"",item_name:t.itemName||"",material_cost:t.materialCost||0,labor_cost:t.laborCost||0,vat_amount:t.vatAmount||0,total_amount:t.totalAmount||0,notes:t.notes||"",images:t.images||[],payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction?1:0,includes_vat:t.includesVAT?1:0,created_at:t.createdAt||"",updated_at:t.updatedAt||""}}function Lf(t){const e={};return t.project_id!==void 0&&(e.projectId=t.project_id),t.projectId!==void 0&&(e.projectId=t.projectId),t.project_name!==void 0&&(e.projectName=t.project_name),t.projectName!==void 0&&(e.projectName=t.projectName),t.author!==void 0&&(e.author=t.author),t.date!==void 0&&(e.date=t.date),t.process!==void 0&&(e.process=t.process),t.item_name!==void 0&&(e.itemName=t.item_name),t.itemName!==void 0&&(e.itemName=t.itemName),t.material_cost!==void 0&&(e.materialCost=t.material_cost),t.materialCost!==void 0&&(e.materialCost=t.materialCost),t.labor_cost!==void 0&&(e.laborCost=t.labor_cost),t.laborCost!==void 0&&(e.laborCost=t.laborCost),t.vat_amount!==void 0&&(e.vatAmount=t.vat_amount),t.vatAmount!==void 0&&(e.vatAmount=t.vatAmount),t.total_amount!==void 0&&(e.totalAmount=t.total_amount),t.totalAmount!==void 0&&(e.totalAmount=t.totalAmount),t.notes!==void 0&&(e.notes=t.notes),t.images!==void 0&&(e.images=t.images),t.payment_id!==void 0&&(e.paymentId=t.payment_id),t.paymentId!==void 0&&(e.paymentId=t.paymentId),t.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=t.includes_tax_deduction===!0||t.includes_tax_deduction===1),t.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=t.includesTaxDeduction),t.includes_vat!==void 0&&(e.includesVAT=t.includes_vat===!0||t.includes_vat===1),t.includesVAT!==void 0&&(e.includesVAT=t.includesVAT),e}const Qn={getAllRecords:async()=>{const t=Fe(se,Qe.EXECUTION_RECORDS),e=vt(t,is("id","desc"));return(await At(e)).docs.map(n=>{const r=n.data();return wi({...r,id:parseInt(n.id)||r.id})})},getRecordById:async t=>{const e=we(se,Qe.EXECUTION_RECORDS,t),s=await It(e);if(s.exists()){const n=s.data();return wi({...n,id:parseInt(s.id)||n.id})}return null},createRecord:async t=>{await GA();const e=Fe(se,Qe.EXECUTION_RECORDS),s=await At(e);let n=0;s.docs.forEach(h=>{const p=parseInt(h.id);!isNaN(p)&&p>n&&(n=p)});const r=n+1,i=Lf(t),a=new Date().toISOString();let c=i.projectId||0;const m=i.projectName||"";if((!c||c===0)&&m){const h=Ja.get(m);h?(c=h,console.log("[executionRecordFirestoreService]  ID :",m,"->",c)):console.warn("[executionRecordFirestoreService]   ID   :",m)}const u={id:r,projectId:c,projectName:m,author:i.author||"",date:i.date||a.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:a,updatedAt:a,images:[],imageCount:0},d=we(se,Qe.EXECUTION_RECORDS,String(r));if(await ii(d,u),i.images&&i.images.length>0)if(i.images.some(p=>Yi(p))){const p=await Nl("execution_records",String(r),i.images);await Rt(d,{images:p,imageCount:p.length}),u.images=p,u.imageCount=p.length}else await Rt(d,{images:i.images,imageCount:i.images.length}),u.images=i.images,u.imageCount=i.images.length;return wi(u)},updateRecord:async(t,e)=>{const s=we(se,Qe.EXECUTION_RECORDS,t),n=Lf(e);n.images!==void 0&&(n.images.some(a=>Yi(a))&&(n.images=await Nl("execution_records",t,n.images)),n.imageCount=n.images.length),await Rt(s,{...n,updatedAt:new Date().toISOString()});const r=await Qn.getRecordById(t);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async t=>{const e=we(se,Qe.EXECUTION_RECORDS,t),s=await It(e);if(s.exists()){const n=s.data();n.images&&n.images.length>0&&await ry(n.images)}await Us(e)},subscribeToRecords:t=>{const e=Fe(se,Qe.EXECUTION_RECORDS),s=vt(e,is("id","desc"));return dn(s,n=>{const r=n.docs.map(i=>{const a=i.data();return wi({...a,id:parseInt(i.id)||a.id})});t(r)})},getRecordsByProject:async t=>{const e=Fe(se,Qe.EXECUTION_RECORDS),s=vt(e,Ts("projectId","==",t),is("id","desc"));return(await At(s)).docs.map(r=>{const i=r.data();return wi({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async t=>{const e=Fe(se,Qe.EXECUTION_RECORDS),s=vt(e,Ts("paymentId","==",t)),n=await At(s);if(n.empty)return null;const r=n.docs[0],i=r.data();return wi({...i,id:parseInt(r.id)||i.id})}},Ta={getAllRecords:()=>Qn.getAllRecords(),getRecordById:async t=>{const e=await Qn.getRecordById(t);if(!e)throw new Error("Execution record not found");return e},createRecord:t=>Qn.createRecord(t),updateRecord:(t,e)=>Qn.updateRecord(t,e),deleteRecord:t=>Qn.deleteRecord(t),subscribeToRecords:Qn.subscribeToRecords,getRecordsByProject:Qn.getRecordsByProject,getRecordByPaymentId:Qn.getRecordByPaymentId},Ir=Nm()(ey((t,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:s=>t({projects:s}),addProject:s=>t(n=>{const r={id:s.id,project:s.name,client:s.client,totalAmount:s.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[s,...n.projects],constructionPayments:[r,...n.constructionPayments]}}),updateProject:(s,n)=>t(r=>({projects:r.projects.map(i=>i.id===s?{...i,...n}:i)})),deleteProject:s=>t(n=>({projects:n.projects.filter(r=>r.id!==s),constructionPayments:n.constructionPayments.filter(r=>r.id!==s)})),setSchedules:s=>t({schedules:s}),addSchedule:s=>t(n=>({schedules:[s,...n.schedules]})),updateSchedule:(s,n)=>t(r=>({schedules:r.schedules.map(i=>i.id===s?{...i,...n}:i)})),deleteSchedule:s=>t(n=>({schedules:n.schedules.filter(r=>r.id!==s)})),setPayments:s=>t({payments:s}),addPayment:s=>t(n=>({payments:[s,...n.payments]})),updatePayment:(s,n)=>t(r=>({payments:r.payments.map(i=>i.id===s?{...i,...n}:i)})),deletePayment:s=>t(n=>({payments:n.payments.filter(r=>r.id!==s)})),setContractors:s=>t({contractors:s}),addContractor:s=>t(n=>({contractors:[s,...n.contractors]})),updateContractor:(s,n)=>t(r=>({contractors:r.contractors.map(i=>i.id===s?{...i,...n}:i)})),deleteContractor:s=>t(n=>({contractors:n.contractors.filter(r=>r.id!==s)})),setConstructionPayments:s=>t({constructionPayments:s}),addConstructionPayment:s=>t(n=>({constructionPayments:[s,...n.constructionPayments]})),updateConstructionPayment:(s,n)=>t(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===s?{...i,...n}:i)})),deleteConstructionPayment:s=>t(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==s)})),setASRequests:s=>t({asRequests:s}),addASRequest:s=>t(n=>({asRequests:[s,...n.asRequests]})),updateASRequest:(s,n)=>t(r=>({asRequests:r.asRequests.map(i=>i.id===s?{...i,...n}:i)})),deleteASRequest:s=>t(n=>({asRequests:n.asRequests.filter(r=>r.id!==s)})),setExecutionRecords:s=>t({executionRecords:s}),addExecutionRecord:s=>{console.log("[dataStore]  :",s.id,s.itemName),t(n=>{const r=[s,...n.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(s,n)=>t(r=>({executionRecords:r.executionRecords.map(i=>i.id===s?{...i,...n}:i)})),deleteExecutionRecord:s=>t(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==s)})),loadPaymentsFromAPI:async()=>{try{const s=await gn.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",s[0]);const n=s.map(d=>{var h;return{id:String(d.id),project:typeof d.project=="object"&&((h=d.project)!=null&&h.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const p=JSON.parse(d.images);return Array.isArray(p)?p:[]}catch(p){return console.error("  :",p),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.request_date||d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));n.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const h=i.get(d.id);h!=null&&h.completionDate?d.completionDate=h.completionDate:d.completionDate=new Date}});const a=new Set(n.map(d=>d.id)),c=3e4,m=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",n.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const u=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(a.has(d.id))return!1;const h=d._addedAt;return h&&m-h<c?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(m-h)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",u.length),console.log("[loadPaymentsFromAPI]   ID:",u.map(d=>d.id)),u.length>0){console.log(`[loadPaymentsFromAPI]  ${u.length}  `);const d=new Set(u.map(w=>w.id)),h=n.filter(w=>!d.has(w.id)),b=[...u.map(w=>({...w,_addedAt:Date.now()})),...h];console.log("[loadPaymentsFromAPI]   :",b.length),t({payments:b})}else console.log("[loadPaymentsFromAPI]    - API  "),t({payments:n})}catch(s){throw console.error("Failed to load payments from API:",s),s}},addPaymentToAPI:async s=>{const n=`temp_${Date.now()}`,r={...s,id:n,_addedAt:Date.now(),_tempId:n};t(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",n);try{const a=e().projects.find(h=>h.name===s.project),m={projectId:a?a.id:s.project,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,status:s.status||"pending",category:s.category,urgency:s.urgency,requestedBy:s.requestedBy,bankInfo:s.bankInfo,notes:s.notes,attachments:[],materialAmount:s.materialAmount||0,laborAmount:s.laborAmount||0,originalMaterialAmount:s.originalMaterialAmount||0,originalLaborAmount:s.originalLaborAmount||0,applyTaxDeduction:s.applyTaxDeduction||!1,includesVAT:s.includesVAT||!1,quickText:s.quickText||"",images:s.images||[]};console.log("[addPaymentToAPI] Sending payment data:",m);const u=await gn.createPayment(m),d=String(u.id);return t(h=>({payments:h.payments.map(p=>p._tempId===n?{...p,id:d,_addedAt:Date.now()}:p)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),t(a=>({payments:a.payments.filter(c=>c._tempId!==n)})),i}},updatePaymentInAPI:async(s,n)=>{try{if(n.status&&Object.keys(n).length===1)await gn.updatePaymentStatus(s,n.status);else{let r=n.project;if(n.project){const a=e().projects.find(c=>c.name===n.project);r=a?a.id:n.project}await gn.updatePayment(s,{projectId:r,purpose:n.purpose,process:n.process,itemName:n.itemName,amount:n.amount,materialAmount:n.materialAmount,laborAmount:n.laborAmount,originalMaterialAmount:n.originalMaterialAmount,originalLaborAmount:n.originalLaborAmount,category:n.category,urgency:n.urgency,bankInfo:n.bankInfo,notes:n.notes,requestDate:n.requestDate,includesVAT:n.includesVAT,applyTaxDeduction:n.applyTaxDeduction})}t(r=>({payments:r.payments.map(i=>i.id===s?{...i,...n}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async s=>{try{await gn.deletePayment(s),t(n=>({payments:n.payments.filter(r=>r.id!==s)}))}catch(n){throw console.error("Failed to delete payment from API:",n),n}},loadSchedulesFromAPI:async()=>{try{const s=await Pa.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",s[0]);const n=s.map(r=>{var a;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(c=>c.trim()):[r.assigneeNames]:((a=r.assignedTo)==null?void 0:a.map(c=>typeof c=="object"?c.name:c))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});n.sort((r,i)=>{const a=parseInt(r.id)||0,c=parseInt(i.id)||0;return a-c}),t({schedules:n})}catch(s){throw console.error("Failed to load schedules from API:",s),s}},addScheduleToAPI:async s=>{var i,a;const n=(i=s.id)!=null&&i.startsWith("temp_")?s.id:`temp_${Date.now()}`,r={...s,id:n};t(c=>({schedules:[...c.schedules,r]}));try{const c=await Pa.createSchedule({project:s.project||"",title:s.title,type:s.type,startDate:s.start,endDate:s.end,allDay:!s.time||s.time==="-",location:s.location,assignedTo:s.attendees||[],description:s.description,asRequestId:s.asRequestId,time:s.time}),m=s.attendees||[];let u=c.assigneeNames||((a=c.assignedTo)==null?void 0:a.map(h=>typeof h=="object"?h.name:h))||[];m.length>0&&u.length>m.length&&(u=m);const d={id:c._id,title:c.title,start:new Date(c.startDate),end:new Date(c.endDate),type:c.type,project:typeof c.project=="object"?c.project.name:c.project,location:c.location,attendees:u,description:c.description,time:c.time};t(h=>({schedules:h.schedules.map(p=>p.id===n?d:p)}))}catch(c){throw console.error("Failed to add schedule to API:",c),t(m=>({schedules:m.schedules.filter(u=>u.id!==n)})),c}},updateScheduleInAPI:async(s,n)=>{var r,i,a;try{console.log(" updateScheduleInAPI called with:",{id:s,updatedSchedule:n});const c={};n.project!==void 0&&(c.project=n.project),n.title!==void 0&&(c.title=n.title),n.type!==void 0&&(c.type=n.type),n.start!==void 0&&(c.startDate=n.start),n.end!==void 0&&(c.endDate=n.end),n.location!==void 0&&(c.location=n.location),n.description!==void 0&&(c.description=n.description),n.attendees!==void 0&&(c.assignedTo=n.attendees),n.time!==void 0&&(c.time=n.time),console.log(" Sending update data:",c);const m=await Pa.updateSchedule(s,c);console.log(" updateScheduleInAPI response:",m);const u={id:m._id,title:m.title,start:new Date(m.startDate),end:new Date(m.endDate),type:m.type,project:typeof m.project=="object"?m.project.name:m.project,location:m.location,attendees:m.assigneeNames||((r=m.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:m.description,time:m.time};t(d=>({schedules:d.schedules.map(h=>h.id===s?u:h)}))}catch(c){throw console.error("Failed to update schedule in API:",c),console.error("Error details:",{message:c instanceof Error?c.message:"Unknown error",response:c&&typeof c=="object"&&"response"in c?(i=c.response)==null?void 0:i.data:void 0,status:c&&typeof c=="object"&&"response"in c?(a=c.response)==null?void 0:a.status:void 0}),c}},deleteScheduleFromAPI:async s=>{var i;const{schedules:n}=e(),r=n.find(a=>a.id===s);if(r){t(a=>({schedules:a.schedules.filter(c=>c.id!==s)}));try{s.startsWith("temp_")||await Pa.deleteSchedule(s)}catch(a){const c=a,m=(i=c==null?void 0:c.response)==null?void 0:i.status;if(m===404||m===502||m===503||m===504){console.log("Schedule delete - ignoring error (status:",m,"):",s);return}throw console.error("Failed to delete schedule from API:",a),r&&t(u=>({schedules:[...u.schedules,r]})),a}}},loadProjectsFromAPI:async()=>{try{const n=(await Hi.getAllProjects()).map(r=>{var i,a;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(c=>({id:c.id,content:c.content,date:new Date(c.date)})))||[],customerRequests:((a=r.customerRequests)==null?void 0:a.map(c=>({id:c.id,content:c.content,completed:c.completed,createdAt:new Date(c.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});t({projects:n})}catch(s){throw console.error("Failed to load projects from API:",s),s}},addProjectToAPI:async s=>{var n,r;try{const i=await Hi.createProject({name:s.name,client:s.client,location:s.location,startDate:s.startDate,endDate:s.endDate,status:s.status,contractAmount:s.contractAmount,spent:s.spent,manager:s.manager,team:s.team,progress:s.progress,description:s.description}),a={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((n=i.meetingNotes)==null?void 0:n.map(c=>({id:c.id,content:c.content,date:new Date(c.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(c=>({id:c.id,content:c.content,completed:c.completed,createdAt:new Date(c.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};t(c=>({projects:[a,...c.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(s,n)=>{var r,i;try{const a=await Hi.updateProject(s,n),c={id:a._id||a.id,name:a.name,client:typeof a.client=="object"?a.client.name:a.client||"",location:typeof a.location=="object"?a.location.address:a.location||a.address||"",status:a.status==="inProgress"?"in-progress":a.status==="onHold"?"on-hold":a.status,progress:a.progress||0,startDate:a.startDate||a.start_date?new Date(a.startDate||a.start_date):void 0,endDate:a.endDate||a.end_date?new Date(a.endDate||a.end_date):void 0,contractAmount:a.budget||a.contractAmount||0,spent:a.actualCost||a.spent||0,manager:typeof a.manager=="object"&&a.manager!==null?a.manager.name||"":a.manager||"",team:[],description:a.description||"",meetingNotes:((r=a.meetingNotes)==null?void 0:r.map(m=>({id:m.id,content:m.content,date:new Date(m.date)})))||[],customerRequests:((i=a.customerRequests)==null?void 0:i.map(m=>({id:m.id,content:m.content,completed:m.completed,createdAt:new Date(m.createdAt)})))||[],entrancePassword:a.entrancePassword||"",sitePassword:a.sitePassword||""};t(m=>({projects:m.projects.map(u=>u.id===s?c:u)}))}catch(a){throw console.error("Failed to update project in API:",a),a}},deleteProjectFromAPI:async s=>{try{await Hi.deleteProject(s),t(n=>({projects:n.projects.filter(r=>r.id!==s)}))}catch(n){throw console.error("Failed to delete project from API:",n),n}},loadContractorsFromAPI:async()=>{try{const n=(await Yn.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));t({contractors:n})}catch(s){throw console.error("Failed to load contractors from API:",s),s}},addContractorToAPI:async s=>{try{const n=await Yn.createContractor({rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),r={id:n._id,rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes,createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)};t(i=>({contractors:[r,...i.contractors]}))}catch(n){throw console.error("Failed to add contractor to API:",n),n}},updateContractorInAPI:async(s,n)=>{try{const r=await Yn.updateContractor(s,{rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};t(a=>({contractors:a.contractors.map(c=>c.id===s?i:c)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async s=>{try{await Yn.deleteContractor(s),t(n=>({contractors:n.contractors.filter(r=>r.id!==s)}))}catch(n){throw console.error("Failed to delete contractor from API:",n),n}},loadConstructionPaymentsFromAPI:async()=>{try{const n=(await ja.getAllConstructionPayments()).map(r=>{var a;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((a=r.payments)==null?void 0:a.map(c=>{var d;const m=c.date?new Date(c.date):new Date,u=isNaN(m.getTime())?new Date:m;return{type:c.type||((d=c.types)==null?void 0:d[0])||"",amount:c.amount,date:u,method:c.method,notes:c.notes}}))||[]}});t({constructionPayments:n})}catch(s){throw console.error("Failed to load construction payments from API:",s),s}},addConstructionPaymentToAPI:async s=>{var n;try{const r=await ja.createConstructionPayment(s),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((n=r.payments)==null?void 0:n.map(a=>{var u;const c=a.date?new Date(a.date):new Date,m=isNaN(c.getTime())?new Date:c;return{type:a.type||((u=a.types)==null?void 0:u[0])||"",amount:a.amount,date:m,method:a.method,notes:a.notes}}))||[]};t(a=>({constructionPayments:[i,...a.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(s,n)=>{var r;try{const i=await ja.updateConstructionPayment(s,n);let a;i.expectedPaymentDates&&(a={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const c={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:a,payments:((r=i.payments)==null?void 0:r.map(m=>{var u;return{type:m.type||((u=m.types)==null?void 0:u[0])||"",amount:m.amount,date:new Date(m.date),method:m.method,notes:m.notes}}))||[]};t(m=>({constructionPayments:m.constructionPayments.map(u=>u.id===s?c:u)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async s=>{try{await ja.deleteConstructionPayment(s),t(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==s)}))}catch(n){throw console.error("Failed to delete construction payment from API:",n),n}},loadASRequestsFromAPI:async()=>{try{const n=(await Lo.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));t({asRequests:n})}catch(s){throw console.error("Failed to load AS requests from API:",s),s}},addASRequestToAPI:async s=>{try{const n=await Lo.createASRequest(s),r={id:n._id,project:n.project,client:n.client,requestDate:new Date(n.requestDate),siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,scheduledVisitDate:n.scheduledVisitDate?new Date(n.scheduledVisitDate):void 0,scheduledVisitTime:n.scheduledVisitTime,assignedTo:Array.isArray(n.assignedTo)?n.assignedTo:[],completionDate:n.completionDate?new Date(n.completionDate):void 0,notes:n.notes};return t(i=>({asRequests:[r,...i.asRequests]})),r}catch(n){throw console.error("Failed to add AS request to API:",n),n}},updateASRequestInAPI:async(s,n)=>{try{const r=await Lo.updateASRequest(s,n),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};t(a=>({asRequests:a.asRequests.map(c=>c.id===s?i:c)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async s=>{try{await Lo.deleteASRequest(s),t(n=>({asRequests:n.asRequests.filter(r=>r.id!==s)}))}catch(n){throw console.error("Failed to delete AS request from API:",n),n}},loadExecutionRecordsFromAPI:async()=>{try{const s=await Ta.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",s.length,"records");const n=s.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));t({executionRecords:n})}catch(s){throw console.error("Failed to load execution records from API:",s),s}},addExecutionRecordToAPI:async s=>{try{console.log("[addExecutionRecordToAPI] Adding:",s.itemName,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat);const n=await Ta.createRecord({project_name:s.project,author:s.author,date:s.date.toISOString().split("T")[0],process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),r={id:String(n.id),project:n.project_name,author:n.author||void 0,date:new Date(n.date),process:n.process||void 0,itemName:n.item_name,materialCost:n.material_cost||0,laborCost:n.labor_cost||0,vatAmount:n.vat_amount||0,totalAmount:n.total_amount||0,notes:n.notes||void 0,paymentId:n.payment_id?String(n.payment_id):void 0,includesTaxDeduction:n.includes_tax_deduction===1,includesVat:n.includes_vat===1,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",n.includes_vat),t(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(n){throw console.error("Failed to add execution record to API:",n),n}},updateExecutionRecordInAPI:async(s,n)=>{console.log("[updateExecutionRecordInAPI] Called with id:",s,"record:",n);try{let r;if(n.date){const i=n.date instanceof Date?n.date:new Date(n.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:n.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",n.includesTaxDeduction,"includesVat:",n.includesVat),await Ta.updateRecord(s,{project_name:n.project,author:n.author,date:r,process:n.process,item_name:n.itemName,material_cost:n.materialCost,labor_cost:n.laborCost,vat_amount:n.vatAmount,total_amount:n.totalAmount,notes:n.notes,payment_id:n.paymentId,images:n.images,includes_tax_deduction:n.includesTaxDeduction,includes_vat:n.includesVat}),t(i=>({executionRecords:i.executionRecords.map(a=>a.id===s?{...a,...n,updatedAt:new Date}:a)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async s=>{try{await Ta.deleteRecord(s),t(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==s)}))}catch(n){throw console.error("Failed to delete execution record from API:",n),n}}}),{name:"interior-management-storage",partialize:t=>({...t,payments:t.payments.map(e=>{const{images:s,...n}=e;return n}),executionRecords:t.executionRecords.map(e=>{const{images:s,...n}=e;return n})}),storage:{getItem:t=>{var m,u,d,h,p,b,w;const e=localStorage.getItem(t);if(!e)return null;const{state:s}=JSON.parse(e),n=((m=s.projects)==null?void 0:m.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((u=s.constructionPayments)==null?void 0:u.map(v=>{var C;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((C=v.payments)==null?void 0:C.map(R=>({...R,date:new Date(R.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),a=n.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),c=[...r,...a];return{state:{...s,projects:n,schedules:((d=s.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((h=s.payments)==null?void 0:h.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((p=s.contractors)==null?void 0:p.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:c,asRequests:((b=s.asRequests)==null?void 0:b.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((w=s.executionRecords)==null?void 0:w.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(t,e)=>{try{const s=JSON.stringify(e);localStorage.setItem(t,s)}catch(s){console.error("[dataStore] localStorage  :",s),s instanceof DOMException&&s.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:t=>localStorage.removeItem(t)}}));var pa=t=>t.type==="checkbox",Jr=t=>t instanceof Date,Js=t=>t==null;const iy=t=>typeof t=="object";var vs=t=>!Js(t)&&!Array.isArray(t)&&iy(t)&&!Jr(t),XA=t=>vs(t)&&t.target?pa(t.target)?t.target.checked:t.target.value:t,JA=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,ZA=(t,e)=>t.has(JA(e)),eE=t=>{const e=t.constructor&&t.constructor.prototype;return vs(e)&&e.hasOwnProperty("isPrototypeOf")},vu=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ps(t){let e;const s=Array.isArray(t),n=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(vu&&(t instanceof Blob||n))&&(s||vs(t)))if(e=s?[]:Object.create(Object.getPrototypeOf(t)),!s&&!eE(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=Ps(t[r]));else return t;return e}var Kl=t=>/^\w*$/.test(t),ys=t=>t===void 0,_u=t=>Array.isArray(t)?t.filter(Boolean):[],Du=t=>_u(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Te=(t,e,s)=>{if(!e||!vs(t))return s;const n=(Kl(e)?[e]:Du(e)).reduce((r,i)=>Js(r)?r:r[i],t);return ys(n)||n===t?ys(t[e])?s:t[e]:n},Tn=t=>typeof t=="boolean",Gt=(t,e,s)=>{let n=-1;const r=Kl(e)?[e]:Du(e),i=r.length,a=i-1;for(;++n<i;){const c=r[n];let m=s;if(n!==a){const u=t[c];m=vs(u)||Array.isArray(u)?u:isNaN(+r[n+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=m,t=t[c]}};const Pf={BLUR:"blur",FOCUS_OUT:"focusout"},Dn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},zn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},tE=at.createContext(null);tE.displayName="HookFormContext";var sE=(t,e,s,n=!0)=>{const r={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(r,i,{get:()=>{const a=i;return e._proxyFormState[a]!==Dn.all&&(e._proxyFormState[a]=!n||Dn.all),t[a]}});return r};const nE=typeof window<"u"?at.useLayoutEffect:at.useEffect;var ln=t=>typeof t=="string",rE=(t,e,s,n,r)=>ln(t)?(n&&e.watch.add(t),Te(s,t,r)):Array.isArray(t)?t.map(i=>(n&&e.watch.add(i),Te(s,i))):(n&&(e.watchAll=!0),s),dm=t=>Js(t)||!iy(t);function yr(t,e,s=new WeakSet){if(dm(t)||dm(e))return t===e;if(Jr(t)&&Jr(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;if(s.has(t)||s.has(e))return!0;s.add(t),s.add(e);for(const i of n){const a=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const c=e[i];if(Jr(a)&&Jr(c)||vs(a)&&vs(c)||Array.isArray(a)&&Array.isArray(c)?!yr(a,c,s):a!==c)return!1}}return!0}var iE=(t,e,s,n,r)=>e?{...s[t],types:{...s[t]&&s[t].types?s[t].types:{},[n]:r||!0}}:{},Ho=t=>Array.isArray(t)?t:[t],jf=()=>{let t=[];return{get observers(){return t},next:r=>{for(const i of t)i.next&&i.next(r)},subscribe:r=>(t.push(r),{unsubscribe:()=>{t=t.filter(i=>i!==r)}}),unsubscribe:()=>{t=[]}}};function oy(t,e){const s={};for(const n in t)if(t.hasOwnProperty(n)){const r=t[n],i=e[n];if(r&&vs(r)&&i){const a=oy(r,i);vs(a)&&(s[n]=a)}else t[n]&&(s[n]=i)}return s}var sn=t=>vs(t)&&!Object.keys(t).length,ku=t=>t.type==="file",kn=t=>typeof t=="function",xl=t=>{if(!vu)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},ay=t=>t.type==="select-multiple",Au=t=>t.type==="radio",oE=t=>Au(t)||pa(t),Sc=t=>xl(t)&&t.isConnected;function aE(t,e){const s=e.slice(0,-1).length;let n=0;for(;n<s;)t=ys(t)?n++:t[e[n++]];return t}function lE(t){for(const e in t)if(t.hasOwnProperty(e)&&!ys(t[e]))return!1;return!0}function hs(t,e){const s=Array.isArray(e)?e:Kl(e)?[e]:Du(e),n=s.length===1?t:aE(t,s),r=s.length-1,i=s[r];return n&&delete n[i],r!==0&&(vs(n)&&sn(n)||Array.isArray(n)&&lE(n))&&hs(t,s.slice(0,-1)),t}var cE=t=>{for(const e in t)if(kn(t[e]))return!0;return!1};function ly(t){return Array.isArray(t)||vs(t)&&!cE(t)}function fm(t,e={}){for(const s in t)ly(t[s])?(e[s]=Array.isArray(t[s])?[]:{},fm(t[s],e[s])):Js(t[s])||(e[s]=!0);return e}function Ui(t,e,s){s||(s=fm(e));for(const n in t)ly(t[n])?ys(e)||dm(s[n])?s[n]=fm(t[n],Array.isArray(t[n])?[]:{}):Ui(t[n],Js(e)?{}:e[n],s[n]):s[n]=!yr(t[n],e[n]);return s}const Tf={value:!1,isValid:!1},Bf={value:!0,isValid:!0};var cy=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!ys(t[0].attributes.value)?ys(t[0].value)||t[0].value===""?Bf:{value:t[0].value,isValid:!0}:Bf:Tf}return Tf},my=(t,{valueAsNumber:e,valueAsDate:s,setValueAs:n})=>ys(t)?t:e?t===""?NaN:t&&+t:s&&ln(t)?new Date(t):n?n(t):t;const Rf={isValid:!1,value:null};var uy=t=>Array.isArray(t)?t.reduce((e,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:e,Rf):Rf;function Uf(t){const e=t.ref;return ku(e)?e.files:Au(e)?uy(t.refs).value:ay(e)?[...e.selectedOptions].map(({value:s})=>s):pa(e)?cy(t.refs).value:my(ys(e.value)?t.ref.value:e.value,t)}var mE=(t,e,s,n)=>{const r={};for(const i of t){const a=Te(e,i);a&&Gt(r,i,a._f)}return{criteriaMode:s,names:[...t],fields:r,shouldUseNativeValidation:n}},vl=t=>t instanceof RegExp,Do=t=>ys(t)?t:vl(t)?t.source:vs(t)?vl(t.value)?t.value.source:t.value:t,Hf=t=>({isOnSubmit:!t||t===Dn.onSubmit,isOnBlur:t===Dn.onBlur,isOnChange:t===Dn.onChange,isOnAll:t===Dn.all,isOnTouch:t===Dn.onTouched});const Mf="AsyncFunction";var uE=t=>!!t&&!!t.validate&&!!(kn(t.validate)&&t.validate.constructor.name===Mf||vs(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===Mf)),dE=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Ff=(t,e,s)=>!s&&(e.watchAll||e.watch.has(t)||[...e.watch].some(n=>t.startsWith(n)&&/^\.\w+/.test(t.slice(n.length))));const Mo=(t,e,s,n)=>{for(const r of s||Object.keys(t)){const i=Te(t,r);if(i){const{_f:a,...c}=i;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],r)&&!n)return!0;if(a.ref&&e(a.ref,a.name)&&!n)return!0;if(Mo(c,e))break}else if(vs(c)&&Mo(c,e))break}}};function Of(t,e,s){const n=Te(t,s);if(n||Kl(s))return{error:n,name:s};const r=s.split(".");for(;r.length;){const i=r.join("."),a=Te(e,i),c=Te(t,i);if(a&&!Array.isArray(a)&&s!==i)return{name:s};if(c&&c.type)return{name:i,error:c};if(c&&c.root&&c.root.type)return{name:`${i}.root`,error:c.root};r.pop()}return{name:s}}var fE=(t,e,s,n)=>{s(t);const{name:r,...i}=t;return sn(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(a=>e[a]===(!n||Dn.all))},pE=(t,e,s)=>!t||!e||t===e||Ho(t).some(n=>n&&(s?n===e:n.startsWith(e)||e.startsWith(n))),hE=(t,e,s,n,r)=>r.isOnAll?!1:!s&&r.isOnTouch?!(e||t):(s?n.isOnBlur:r.isOnBlur)?!t:(s?n.isOnChange:r.isOnChange)?t:!0,gE=(t,e)=>!_u(Te(t,e)).length&&hs(t,e),yE=(t,e,s)=>{const n=Ho(Te(t,s));return Gt(n,"root",e[s]),Gt(t,s,n),t};function qf(t,e,s="validate"){if(ln(t)||Array.isArray(t)&&t.every(ln)||Tn(t)&&!t)return{type:s,message:ln(t)?t:"",ref:e}}var Si=t=>vs(t)&&!vl(t)?t:{value:t,message:""},$f=async(t,e,s,n,r,i)=>{const{ref:a,refs:c,required:m,maxLength:u,minLength:d,min:h,max:p,pattern:b,validate:w,name:v,valueAsNumber:C,mount:R}=t._f,I=Te(s,v);if(!R||e.has(v))return{};const z=c?c[0]:a,ie=P=>{r&&z.reportValidity&&(z.setCustomValidity(Tn(P)?"":P||""),z.reportValidity())},te={},O=Au(a),A=pa(a),x=O||A,E=(C||ku(a))&&ys(a.value)&&ys(I)||xl(a)&&a.value===""||I===""||Array.isArray(I)&&!I.length,T=iE.bind(null,v,n,te),L=(P,k,ke,Re=zn.maxLength,ye=zn.minLength)=>{const Ie=P?k:ke;te[v]={type:P?Re:ye,message:Ie,ref:a,...T(P?Re:ye,Ie)}};if(i?!Array.isArray(I)||!I.length:m&&(!x&&(E||Js(I))||Tn(I)&&!I||A&&!cy(c).isValid||O&&!uy(c).isValid)){const{value:P,message:k}=ln(m)?{value:!!m,message:m}:Si(m);if(P&&(te[v]={type:zn.required,message:k,ref:z,...T(zn.required,k)},!n))return ie(k),te}if(!E&&(!Js(h)||!Js(p))){let P,k;const ke=Si(p),Re=Si(h);if(!Js(I)&&!isNaN(I)){const ye=a.valueAsNumber||I&&+I;Js(ke.value)||(P=ye>ke.value),Js(Re.value)||(k=ye<Re.value)}else{const ye=a.valueAsDate||new Date(I),Ie=Ht=>new Date(new Date().toDateString()+" "+Ht),rt=a.type=="time",Lt=a.type=="week";ln(ke.value)&&I&&(P=rt?Ie(I)>Ie(ke.value):Lt?I>ke.value:ye>new Date(ke.value)),ln(Re.value)&&I&&(k=rt?Ie(I)<Ie(Re.value):Lt?I<Re.value:ye<new Date(Re.value))}if((P||k)&&(L(!!P,ke.message,Re.message,zn.max,zn.min),!n))return ie(te[v].message),te}if((u||d)&&!E&&(ln(I)||i&&Array.isArray(I))){const P=Si(u),k=Si(d),ke=!Js(P.value)&&I.length>+P.value,Re=!Js(k.value)&&I.length<+k.value;if((ke||Re)&&(L(ke,P.message,k.message),!n))return ie(te[v].message),te}if(b&&!E&&ln(I)){const{value:P,message:k}=Si(b);if(vl(P)&&!I.match(P)&&(te[v]={type:zn.pattern,message:k,ref:a,...T(zn.pattern,k)},!n))return ie(k),te}if(w){if(kn(w)){const P=await w(I,s),k=qf(P,z);if(k&&(te[v]={...k,...T(zn.validate,k.message)},!n))return ie(k.message),te}else if(vs(w)){let P={};for(const k in w){if(!sn(P)&&!n)break;const ke=qf(await w[k](I,s),z,k);ke&&(P={...ke,...T(k,ke.message)},ie(ke.message),n&&(te[v]=P))}if(!sn(P)&&(te[v]={ref:z,...P},!n))return te}}return ie(!0),te};const bE={mode:Dn.onSubmit,reValidateMode:Dn.onChange,shouldFocusError:!0};function NE(t={}){let e={...bE,...t},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:kn(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},r=vs(e.defaultValues)||vs(e.values)?Ps(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Ps(r),a={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},m,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...d};const p={array:jf(),state:jf()},b=e.criteriaMode===Dn.all,w=j=>$=>{clearTimeout(u),u=setTimeout(j,$)},v=async j=>{if(!e.disabled&&(d.isValid||h.isValid||j)){const $=e.resolver?sn((await A()).errors):await E(n,!0);$!==s.isValid&&p.state.next({isValid:$})}},C=(j,$)=>{!e.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((j||Array.from(c.mount)).forEach(X=>{X&&($?Gt(s.validatingFields,X,$):hs(s.validatingFields,X))}),p.state.next({validatingFields:s.validatingFields,isValidating:!sn(s.validatingFields)}))},R=(j,$=[],X,ge,ae=!0,de=!0)=>{if(ge&&X&&!e.disabled){if(a.action=!0,de&&Array.isArray(Te(n,j))){const Ee=X(Te(n,j),ge.argA,ge.argB);ae&&Gt(n,j,Ee)}if(de&&Array.isArray(Te(s.errors,j))){const Ee=X(Te(s.errors,j),ge.argA,ge.argB);ae&&Gt(s.errors,j,Ee),gE(s.errors,j)}if((d.touchedFields||h.touchedFields)&&de&&Array.isArray(Te(s.touchedFields,j))){const Ee=X(Te(s.touchedFields,j),ge.argA,ge.argB);ae&&Gt(s.touchedFields,j,Ee)}(d.dirtyFields||h.dirtyFields)&&(s.dirtyFields=Ui(r,i)),p.state.next({name:j,isDirty:L(j,$),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else Gt(i,j,$)},I=(j,$)=>{Gt(s.errors,j,$),p.state.next({errors:s.errors})},z=j=>{s.errors=j,p.state.next({errors:s.errors,isValid:!1})},ie=(j,$,X,ge)=>{const ae=Te(n,j);if(ae){const de=Te(i,j,ys(X)?Te(r,j):X);ys(de)||ge&&ge.defaultChecked||$?Gt(i,j,$?de:Uf(ae._f)):ke(j,de),a.mount&&v()}},te=(j,$,X,ge,ae)=>{let de=!1,Ee=!1;const Ke={name:j};if(!e.disabled){if(!X||ge){(d.isDirty||h.isDirty)&&(Ee=s.isDirty,s.isDirty=Ke.isDirty=L(),de=Ee!==Ke.isDirty);const st=yr(Te(r,j),$);Ee=!!Te(s.dirtyFields,j),st?hs(s.dirtyFields,j):Gt(s.dirtyFields,j,!0),Ke.dirtyFields=s.dirtyFields,de=de||(d.dirtyFields||h.dirtyFields)&&Ee!==!st}if(X){const st=Te(s.touchedFields,j);st||(Gt(s.touchedFields,j,X),Ke.touchedFields=s.touchedFields,de=de||(d.touchedFields||h.touchedFields)&&st!==X)}de&&ae&&p.state.next(Ke)}return de?Ke:{}},O=(j,$,X,ge)=>{const ae=Te(s.errors,j),de=(d.isValid||h.isValid)&&Tn($)&&s.isValid!==$;if(e.delayError&&X?(m=w(()=>I(j,X)),m(e.delayError)):(clearTimeout(u),m=null,X?Gt(s.errors,j,X):hs(s.errors,j)),(X?!yr(ae,X):ae)||!sn(ge)||de){const Ee={...ge,...de&&Tn($)?{isValid:$}:{},errors:s.errors,name:j};s={...s,...Ee},p.state.next(Ee)}},A=async j=>{C(j,!0);const $=await e.resolver(i,e.context,mE(j||c.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return C(j),$},x=async j=>{const{errors:$}=await A(j);if(j)for(const X of j){const ge=Te($,X);ge?Gt(s.errors,X,ge):hs(s.errors,X)}else s.errors=$;return $},E=async(j,$,X={valid:!0})=>{for(const ge in j){const ae=j[ge];if(ae){const{_f:de,...Ee}=ae;if(de){const Ke=c.array.has(de.name),st=ae._f&&uE(ae._f);st&&d.validatingFields&&C([de.name],!0);const Ne=await $f(ae,c.disabled,i,b,e.shouldUseNativeValidation&&!$,Ke);if(st&&d.validatingFields&&C([de.name]),Ne[de.name]&&(X.valid=!1,$))break;!$&&(Te(Ne,de.name)?Ke?yE(s.errors,Ne,de.name):Gt(s.errors,de.name,Ne[de.name]):hs(s.errors,de.name))}!sn(Ee)&&await E(Ee,$,X)}}return X.valid},T=()=>{for(const j of c.unMount){const $=Te(n,j);$&&($._f.refs?$._f.refs.every(X=>!Sc(X)):!Sc($._f.ref))&&ze(j)}c.unMount=new Set},L=(j,$)=>!e.disabled&&(j&&$&&Gt(i,j,$),!yr(Ht(),r)),P=(j,$,X)=>rE(j,c,{...a.mount?i:ys($)?r:ln(j)?{[j]:$}:$},X,$),k=j=>_u(Te(a.mount?i:r,j,e.shouldUnregister?Te(r,j,[]):[])),ke=(j,$,X={})=>{const ge=Te(n,j);let ae=$;if(ge){const de=ge._f;de&&(!de.disabled&&Gt(i,j,my($,de)),ae=xl(de.ref)&&Js($)?"":$,ay(de.ref)?[...de.ref.options].forEach(Ee=>Ee.selected=ae.includes(Ee.value)):de.refs?pa(de.ref)?de.refs.forEach(Ee=>{(!Ee.defaultChecked||!Ee.disabled)&&(Array.isArray(ae)?Ee.checked=!!ae.find(Ke=>Ke===Ee.value):Ee.checked=ae===Ee.value||!!ae)}):de.refs.forEach(Ee=>Ee.checked=Ee.value===ae):ku(de.ref)?de.ref.value="":(de.ref.value=ae,de.ref.type||p.state.next({name:j,values:Ps(i)})))}(X.shouldDirty||X.shouldTouch)&&te(j,ae,X.shouldTouch,X.shouldDirty,!0),X.shouldValidate&&Lt(j)},Re=(j,$,X)=>{for(const ge in $){if(!$.hasOwnProperty(ge))return;const ae=$[ge],de=j+"."+ge,Ee=Te(n,de);(c.array.has(j)||vs(ae)||Ee&&!Ee._f)&&!Jr(ae)?Re(de,ae,X):ke(de,ae,X)}},ye=(j,$,X={})=>{const ge=Te(n,j),ae=c.array.has(j),de=Ps($);Gt(i,j,de),ae?(p.array.next({name:j,values:Ps(i)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&X.shouldDirty&&p.state.next({name:j,dirtyFields:Ui(r,i),isDirty:L(j,de)})):ge&&!ge._f&&!Js(de)?Re(j,de,X):ke(j,de,X),Ff(j,c)&&p.state.next({...s,name:j}),p.state.next({name:a.mount?j:void 0,values:Ps(i)})},Ie=async j=>{a.mount=!0;const $=j.target;let X=$.name,ge=!0;const ae=Te(n,X),de=st=>{ge=Number.isNaN(st)||Jr(st)&&isNaN(st.getTime())||yr(st,Te(i,X,st))},Ee=Hf(e.mode),Ke=Hf(e.reValidateMode);if(ae){let st,Ne;const fs=$.type?Uf(ae._f):XA(j),Pt=j.type===Pf.BLUR||j.type===Pf.FOCUS_OUT,it=!dE(ae._f)&&!e.resolver&&!Te(s.errors,X)&&!ae._f.deps||hE(Pt,Te(s.touchedFields,X),s.isSubmitted,Ke,Ee),ss=Ff(X,c,Pt);Gt(i,X,fs),Pt?(!$||!$.readOnly)&&(ae._f.onBlur&&ae._f.onBlur(j),m&&m(0)):ae._f.onChange&&ae._f.onChange(j);const V=te(X,fs,Pt),oe=!sn(V)||ss;if(!Pt&&p.state.next({name:X,type:j.type,values:Ps(i)}),it)return(d.isValid||h.isValid)&&(e.mode==="onBlur"?Pt&&v():Pt||v()),oe&&p.state.next({name:X,...ss?{}:V});if(!Pt&&ss&&p.state.next({...s}),e.resolver){const{errors:De}=await A([X]);if(de(fs),ge){const Be=Of(s.errors,n,X),ue=Of(De,n,Be.name||X);st=ue.error,X=ue.name,Ne=sn(De)}}else C([X],!0),st=(await $f(ae,c.disabled,i,b,e.shouldUseNativeValidation))[X],C([X]),de(fs),ge&&(st?Ne=!1:(d.isValid||h.isValid)&&(Ne=await E(n,!0)));ge&&(ae._f.deps&&(!Array.isArray(ae._f.deps)||ae._f.deps.length>0)&&Lt(ae._f.deps),O(X,Ne,st,V))}},rt=(j,$)=>{if(Te(s.errors,$)&&j.focus)return j.focus(),1},Lt=async(j,$={})=>{let X,ge;const ae=Ho(j);if(e.resolver){const de=await x(ys(j)?j:ae);X=sn(de),ge=j?!ae.some(Ee=>Te(de,Ee)):X}else j?(ge=(await Promise.all(ae.map(async de=>{const Ee=Te(n,de);return await E(Ee&&Ee._f?{[de]:Ee}:Ee)}))).every(Boolean),!(!ge&&!s.isValid)&&v()):ge=X=await E(n);return p.state.next({...!ln(j)||(d.isValid||h.isValid)&&X!==s.isValid?{}:{name:j},...e.resolver||!j?{isValid:X}:{},errors:s.errors}),$.shouldFocus&&!ge&&Mo(n,rt,j?ae:c.mount),ge},Ht=(j,$)=>{let X={...a.mount?i:r};return $&&(X=oy($.dirtyFields?s.dirtyFields:s.touchedFields,X)),ys(j)?X:ln(j)?Te(X,j):j.map(ge=>Te(X,ge))},me=(j,$)=>({invalid:!!Te(($||s).errors,j),isDirty:!!Te(($||s).dirtyFields,j),error:Te(($||s).errors,j),isValidating:!!Te(s.validatingFields,j),isTouched:!!Te(($||s).touchedFields,j)}),He=j=>{j&&Ho(j).forEach($=>hs(s.errors,$)),p.state.next({errors:j?s.errors:{}})},Ge=(j,$,X)=>{const ge=(Te(n,j,{_f:{}})._f||{}).ref,ae=Te(s.errors,j)||{},{ref:de,message:Ee,type:Ke,...st}=ae;Gt(s.errors,j,{...st,...$,ref:ge}),p.state.next({name:j,errors:s.errors,isValid:!1}),X&&X.shouldFocus&&ge&&ge.focus&&ge.focus()},xt=(j,$)=>kn(j)?p.state.subscribe({next:X=>"values"in X&&j(P(void 0,$),X)}):P(j,$,!0),fe=j=>p.state.subscribe({next:$=>{pE(j.name,$.name,j.exact)&&fE($,j.formState||d,bt,j.reRenderRoot)&&j.callback({values:{...i},...s,...$,defaultValues:r})}}).unsubscribe,qe=j=>(a.mount=!0,h={...h,...j.formState},fe({...j,formState:h})),ze=(j,$={})=>{for(const X of j?Ho(j):c.mount)c.mount.delete(X),c.array.delete(X),$.keepValue||(hs(n,X),hs(i,X)),!$.keepError&&hs(s.errors,X),!$.keepDirty&&hs(s.dirtyFields,X),!$.keepTouched&&hs(s.touchedFields,X),!$.keepIsValidating&&hs(s.validatingFields,X),!e.shouldUnregister&&!$.keepDefaultValue&&hs(r,X);p.state.next({values:Ps(i)}),p.state.next({...s,...$.keepDirty?{isDirty:L()}:{}}),!$.keepIsValid&&v()},ft=({disabled:j,name:$})=>{(Tn(j)&&a.mount||j||c.disabled.has($))&&(j?c.disabled.add($):c.disabled.delete($))},tt=(j,$={})=>{let X=Te(n,j);const ge=Tn($.disabled)||Tn(e.disabled);return Gt(n,j,{...X||{},_f:{...X&&X._f?X._f:{ref:{name:j}},name:j,mount:!0,...$}}),c.mount.add(j),X?ft({disabled:Tn($.disabled)?$.disabled:e.disabled,name:j}):ie(j,!0,$.value),{...ge?{disabled:$.disabled||e.disabled}:{},...e.progressive?{required:!!$.required,min:Do($.min),max:Do($.max),minLength:Do($.minLength),maxLength:Do($.maxLength),pattern:Do($.pattern)}:{},name:j,onChange:Ie,onBlur:Ie,ref:ae=>{if(ae){tt(j,$),X=Te(n,j);const de=ys(ae.value)&&ae.querySelectorAll&&ae.querySelectorAll("input,select,textarea")[0]||ae,Ee=oE(de),Ke=X._f.refs||[];if(Ee?Ke.find(st=>st===de):de===X._f.ref)return;Gt(n,j,{_f:{...X._f,...Ee?{refs:[...Ke.filter(Sc),de,...Array.isArray(Te(r,j))?[{}]:[]],ref:{type:de.type,name:j}}:{ref:de}}}),ie(j,!1,void 0,de)}else X=Te(n,j,{}),X._f&&(X._f.mount=!1),(e.shouldUnregister||$.shouldUnregister)&&!(ZA(c.array,j)&&a.action)&&c.unMount.add(j)}}},Bt=()=>e.shouldFocusError&&Mo(n,rt,c.mount),ds=j=>{Tn(j)&&(p.state.next({disabled:j}),Mo(n,($,X)=>{const ge=Te(n,X);ge&&($.disabled=ge._f.disabled||j,Array.isArray(ge._f.refs)&&ge._f.refs.forEach(ae=>{ae.disabled=ge._f.disabled||j}))},0,!1))},W=(j,$)=>async X=>{let ge;X&&(X.preventDefault&&X.preventDefault(),X.persist&&X.persist());let ae=Ps(i);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:de,values:Ee}=await A();s.errors=de,ae=Ps(Ee)}else await E(n);if(c.disabled.size)for(const de of c.disabled)hs(ae,de);if(hs(s.errors,"root"),sn(s.errors)){p.state.next({errors:{}});try{await j(ae,X)}catch(de){ge=de}}else $&&await $({...s.errors},X),Bt(),setTimeout(Bt);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:sn(s.errors)&&!ge,submitCount:s.submitCount+1,errors:s.errors}),ge)throw ge},Ce=(j,$={})=>{Te(n,j)&&(ys($.defaultValue)?ye(j,Ps(Te(r,j))):(ye(j,$.defaultValue),Gt(r,j,Ps($.defaultValue))),$.keepTouched||hs(s.touchedFields,j),$.keepDirty||(hs(s.dirtyFields,j),s.isDirty=$.defaultValue?L(j,Ps(Te(r,j))):L()),$.keepError||(hs(s.errors,j),d.isValid&&v()),p.state.next({...s}))},Me=(j,$={})=>{const X=j?Ps(j):r,ge=Ps(X),ae=sn(j),de=ae?r:ge;if($.keepDefaultValues||(r=X),!$.keepValues){if($.keepDirtyValues){const Ee=new Set([...c.mount,...Object.keys(Ui(r,i))]);for(const Ke of Array.from(Ee))Te(s.dirtyFields,Ke)?Gt(de,Ke,Te(i,Ke)):ye(Ke,Te(de,Ke))}else{if(vu&&ys(j))for(const Ee of c.mount){const Ke=Te(n,Ee);if(Ke&&Ke._f){const st=Array.isArray(Ke._f.refs)?Ke._f.refs[0]:Ke._f.ref;if(xl(st)){const Ne=st.closest("form");if(Ne){Ne.reset();break}}}}if($.keepFieldsRef)for(const Ee of c.mount)ye(Ee,Te(de,Ee));else n={}}i=e.shouldUnregister?$.keepDefaultValues?Ps(r):{}:Ps(de),p.array.next({values:{...de}}),p.state.next({values:{...de}})}c={mount:$.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!d.isValid||!!$.keepIsValid||!!$.keepDirtyValues,a.watch=!!e.shouldUnregister,p.state.next({submitCount:$.keepSubmitCount?s.submitCount:0,isDirty:ae?!1:$.keepDirty?s.isDirty:!!($.keepDefaultValues&&!yr(j,r)),isSubmitted:$.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:ae?{}:$.keepDirtyValues?$.keepDefaultValues&&i?Ui(r,i):s.dirtyFields:$.keepDefaultValues&&j?Ui(r,j):$.keepDirty?s.dirtyFields:{},touchedFields:$.keepTouched?s.touchedFields:{},errors:$.keepErrors?s.errors:{},isSubmitSuccessful:$.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Le=(j,$)=>Me(kn(j)?j(i):j,$),$e=(j,$={})=>{const X=Te(n,j),ge=X&&X._f;if(ge){const ae=ge.refs?ge.refs[0]:ge.ref;ae.focus&&(ae.focus(),$.shouldSelect&&kn(ae.select)&&ae.select())}},bt=j=>{s={...s,...j}},mt={control:{register:tt,unregister:ze,getFieldState:me,handleSubmit:W,setError:Ge,_subscribe:fe,_runSchema:A,_focusError:Bt,_getWatch:P,_getDirty:L,_setValid:v,_setFieldArray:R,_setDisabledField:ft,_setErrors:z,_getFieldArray:k,_reset:Me,_resetDefaultValues:()=>kn(e.defaultValues)&&e.defaultValues().then(j=>{Le(j,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:T,_disableForm:ds,_subjects:p,_proxyFormState:d,get _fields(){return n},get _formValues(){return i},get _state(){return a},set _state(j){a=j},get _defaultValues(){return r},get _names(){return c},set _names(j){c=j},get _formState(){return s},get _options(){return e},set _options(j){e={...e,...j}}},subscribe:qe,trigger:Lt,register:tt,handleSubmit:W,watch:xt,setValue:ye,getValues:Ht,reset:Le,resetField:Ce,clearErrors:He,unregister:ze,setError:Ge,setFocus:$e,getFieldState:me};return{...mt,formControl:mt}}function Eu(t={}){const e=at.useRef(void 0),s=at.useRef(void 0),[n,r]=at.useState({isDirty:!1,isValidating:!1,isLoading:kn(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:kn(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:n},t.defaultValues&&!kn(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:a,...c}=NE(t);e.current={...c,formState:n}}const i=e.current.control;return i._options=t,nE(()=>{const a=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(c=>({...c,isReady:!0})),i._formState.isReady=!0,a},[i]),at.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),at.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),at.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),at.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),at.useEffect(()=>{if(i._proxyFormState.isDirty){const a=i._getDirty();a!==n.isDirty&&i._subjects.state.next({isDirty:a})}},[i,n.isDirty]),at.useEffect(()=>{t.values&&!yr(t.values,s.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),s.current=t.values,r(a=>({...a}))):i._resetDefaultValues()},[i,t.values]),at.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=sE(n,i),e.current}const Wf=["","","","","","",""],dy=({event:t,slotInfo:e,defaultProjectName:s,onClose:n,onSave:r,onDelete:i})=>{const[a,c]=D.useState(!1),{register:m,handleSubmit:u,setValue:d,watch:h,formState:{errors:p},reset:b}=Eu({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:w}=Ir(),[v,C]=D.useState([]),[R,I]=D.useState(""),[z,ie]=D.useState(!1),[te,O]=D.useState(""),[A,x]=D.useState(9),[E,T]=D.useState(0),[L,P]=D.useState(""),k=h("projectId");D.useEffect(()=>{if(k){const me=w.find(He=>He.id===k||He.id===parseInt(k)||He.id.toString()===k.toString());console.log(" Selected project:",me==null?void 0:me.name),console.log(" Project team:",me==null?void 0:me.team),console.log(" Current selectedMembers:",v)}},[k,w,v]),D.useEffect(()=>{console.log(" Modal mount - initializing states"),C([]),P(""),I("")},[]),D.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!t,eventId:t==null?void 0:t.id,hasSlotInfo:!!e,hasMergedEvents:!!(t!=null&&t.mergedEventIds)}),t&&t.id){console.log(" ScheduleModal processing event:",{title:t.title,projectId:t.projectId,projectName:t.projectName,start:t.start,assignedTo:t.assignedTo,time:t.time});const me=t.originalTitle||t.title,He=/ - (|) \d{1,2}$/,Ge=me.replace(He,"");if(d("title",Ge,{shouldValidate:!1,shouldDirty:!1}),d("date",Mt(t.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",t.description||"",{shouldValidate:!1,shouldDirty:!1}),t.projectId&&t.projectId!==""&&t.projectId!=="undefined")console.log(" Setting projectId from event:",t.projectId),d("projectId",t.projectId,{shouldValidate:!1,shouldDirty:!1}),P("");else if(t.projectName){const fe=w.find(qe=>qe.name===t.projectName);console.log(" Finding project by name:",t.projectName,"found:",fe),fe?(console.log(" Setting projectId from found project:",fe.id),d("projectId",fe.id,{shouldValidate:!1,shouldDirty:!1}),P("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),P(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),P("");const xt=t.assignedTo||t.attendees||[];if(console.log(" Setting selectedMembers to:",xt),C(Array.isArray(xt)?xt:[]),t.time&&t.time!=="-"){console.log(" Setting time from event:",{eventTime:t.time,parsedHours:t.time.split(":")[0],parsedMinutes:t.time.split(":")[1]}),ie(!0);const[fe,qe]=t.time.split(":"),ze=parseInt(fe,10),ft=parseInt(qe,10);ze>=12?(O(""),x(ze===12?12:ze-12)):(O(""),x(ze===0?12:ze)),T(ft),console.log(" Time state set:",{hasTime:!0,period:ze>=12?"":"",hour:ze>=12?ze===12?12:ze-12:ze===0?12:ze,minute:ft})}else console.log(" No time in event, setting hasTime to false"),ie(!1),O(""),x(9),T(0)}else if(e&&!t&&(console.log(" New schedule from slot:",e),b({projectId:"",title:"",date:Mt(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),C([]),P(""),s)){const me=w.find(He=>He.name===s);me&&d("projectId",me.id,{shouldValidate:!1,shouldDirty:!1})}},[t==null?void 0:t.id]);const ke=me=>{console.log(" toggleMember called with:",me),console.log(" Current selectedMembers before toggle:",v),C(He=>{console.log(" Previous members in setState:",He);const Ge=He.includes(me)?He.filter(xt=>xt!==me):[...He,me];return console.log(" Updated members after toggle:",Ge),Ge})},Re=()=>{const me="HV LAB";v.includes(me)?C(He=>He.filter(Ge=>Ge!==me)):C(He=>[...He.filter(Ge=>Ge!==""),me])},ye=()=>{const me="";v.includes(me)?C(He=>He.filter(Ge=>Ge!==me)):C(He=>[...He,me])},Ie=()=>{const me="";v.includes(me)?C(He=>He.filter(Ge=>Ge!==me)):C(He=>[...He,me])},rt=()=>{R.trim()&&!v.includes(R.trim())&&(C(me=>[...me,R.trim()]),I(""))},Lt=me=>{C(He=>He.filter(Ge=>Ge!==me))},Ht=async me=>{console.log(" Form onSubmit called with data:",me),console.log(" selectedMembers:",v),console.log(" hasTime state:",z),console.log(" timePeriod:",te,"timeHour:",A,"timeMinute:",E),console.log(" Available projects:",w.map(tt=>({id:tt.id,name:tt.name,idType:typeof tt.id}))),console.log(" Merged event IDs:",t==null?void 0:t.mergedEventIds);const He=/ - (|) \d{1,2}$/,Ge=me.title.replace(He,"").trim();let xt="",fe="";if(me.projectId){const tt=w.find(Bt=>Bt.id===me.projectId||Bt.id===parseInt(me.projectId)||Bt.id.toString()===me.projectId.toString());console.log(" Looking for project with id:",me.projectId,"type:",typeof me.projectId),console.log(" Found project:",tt),xt=(tt==null?void 0:tt.name)||"",fe=me.projectId}else xt="",fe="";console.log(" Final projectId:",fe,"projectName:",xt,"cleanedTitle:",Ge);const qe=new Date(me.date);let ze="-";if(z){let tt=A;te===""&&A!==12?tt=A+12:te===""&&A===12&&(tt=0),ze=`${tt.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`,console.log(" Time calculated:",ze)}else console.log(" No time set (hasTime is false)");const ft={...t,title:Ge,start:qe,end:qe,projectId:fe,projectName:xt,assignedTo:v,description:me.description||"",time:ze,mergedEventIds:t==null?void 0:t.mergedEventIds};if(!a){c(!0),console.log(" Calling onSave with newEvent:",ft);try{await r(ft),console.log(" onSave completed successfully")}catch(tt){throw console.error(" onSave failed:",tt),tt}finally{c(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[o.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:t?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),o.jsxDEV("button",{onClick:n,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(us,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),o.jsxDEV("form",{onSubmit:u(Ht),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),o.jsxDEV("select",{...m("projectId"),className:"input w-full",children:[o.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),w.filter(me=>t!=null&&t.isASVisit?!0:me.status!=="completed").map(me=>o.jsxDEV("option",{value:me.id,children:me.name},me.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),o.jsxDEV("input",{...m("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),p.title&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),o.jsxDEV("input",{...m("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),p.date&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),o.jsxDEV("div",{className:"mb-2",children:o.jsxDEV("button",{type:"button",onClick:()=>ie(!z),className:`px-3 py-1.5 text-xs rounded border transition-colors ${z?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:z?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),z&&o.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsxDEV("div",{className:"flex gap-1",children:[o.jsxDEV("button",{type:"button",onClick:()=>O(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${te===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),o.jsxDEV("button",{type:"button",onClick:()=>O(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${te===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),o.jsxDEV("select",{value:A,onChange:me=>x(parseInt(me.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(me=>o.jsxDEV("option",{value:me,children:[me,""]},me,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),o.jsxDEV("select",{value:E,onChange:me=>T(parseInt(me.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(me=>o.jsxDEV("option",{value:me,children:[me,""]},me,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[o.jsxDEV("button",{type:"button",onClick:Re,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:ye,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:Ie,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Wf.map(me=>o.jsxDEV("button",{type:"button",onClick:()=>ke(me),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(me)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:me},me,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(me=>!Wf.includes(me)&&me!=="HV LAB"&&me!==""&&me!=="").map(me=>o.jsxDEV("button",{type:"button",onClick:()=>Lt(me),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[me," "]},me,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:R,onChange:me=>I(me.target.value),onKeyPress:me=>{me.key==="Enter"&&(me.preventDefault(),rt())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:rt,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),o.jsxDEV("textarea",{...m("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[o.jsxDEV("div",{children:t&&o.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(t.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[o.jsxDEV(si,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[o.jsxDEV("button",{type:"button",onClick:n,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),o.jsxDEV("button",{type:"submit",disabled:a,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:a?" ...":t?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},pm=t=>{if(!t||t==="-")return"";const[e,s]=t.split(":"),n=parseInt(e,10),r=parseInt(s,10),i=n>=12?"":"",a=n%12||12;return r>0?`${i} ${a} ${r}`:`${i} ${a}`},_l=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Fo=t=>{if(!t)return t;const e=t.replace(/$/g,"").trim(),s=e.split(" ");if(s.length>=2){const n=s[s.length-1];for(const r of _l)if(n===r)return s.slice(0,-1).join(" ").trim()}for(const n of _l)if(e.endsWith(n))return e.substring(0,e.length-n.length).trim()||e;return e},Ba=t=>{const e=t.replace(/$/g,"").trim(),s=e.split(" ");if(s.length>=2){const n=s[s.length-1];for(const r of _l)if(n===r)return r}for(const n of _l)if(e.endsWith(n))return n;return""},xE=["","","","","","",""],vE=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Ic=["","","/","","","","","","","","","","","","",""],_E={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},DE={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},zf=xE,kE=()=>{const{schedules:t,loadSchedulesFromAPI:e,addScheduleToAPI:s,deleteScheduleFromAPI:n}=Ir(),{user:r}=Rr(),[i,a]=D.useState(!1);D.useEffect(()=>{e().catch(d=>{console.error("Failed to load schedules:",d)})},[e]);const c=r!=null&&r.name?r.name.slice(-2):null,m=(r==null?void 0:r.name)===""?[""]:c?[c,...zf.filter(d=>d!==c)]:zf,u=d=>{const h=t.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),p=v=>{const C=new Set;return v.filter(R=>{const z=`${Mt(new Date(R.start),"yyyy-MM-dd")}|${R.project}|${R.title}`;return C.has(z)?!1:(C.add(z),!0)})},b=p(h.filter(v=>td(new Date(v.start)))),w=p(h.filter(v=>Qb(new Date(v.start))&&!td(new Date(v.start))).sort((v,C)=>new Date(v.start).getTime()-new Date(C.start).getTime())).slice(0,3);return{todaySchedules:b,upcomingSchedules:w,member:d}};return o.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[o.jsxDEV("div",{children:o.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:m.map(d=>{const{todaySchedules:h,upcomingSchedules:p}=u(d),b=h.length+p.length,w=d===c;return o.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${w?"ring-1 ring-gray-300":""}`,children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:21},void 0),w&&o.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:122,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center gap-2",children:[w&&o.jsxDEV("button",{onClick:()=>a(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:o.jsxDEV(Mi,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:23},void 0),o.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${w&&h.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:135,columnNumber:21},void 0),o.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[p.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:17},void 0),h.length>0&&o.jsxDEV("div",{className:"mb-4",children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[o.jsxDEV(fp,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:148,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:149,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:147,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((C,R)=>{const I=R.project||"-";return C[I]||(C[I]=[]),C[I].push(R),C},{});return Object.entries(v).map(([C,R])=>{const I=d===c;return o.jsxDEV("div",{className:`border-l-3 ${I?"border-gray-400":"border-gray-900"} ${I?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[o.jsxDEV("div",{className:`px-3 py-1 ${I?"bg-amber-100":"bg-gray-100"} border-b ${I?"border-amber-200":"border-gray-200"}`,children:o.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:171,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:31},void 0),o.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:R.map(z=>{const ie=z.time&&z.time!=="-"?` - ${pm(z.time)}`:"";return o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",z.title,ie]},z.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:177,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:173,columnNumber:31},void 0)]},C,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:146,columnNumber:19},void 0),p.length>0&&o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[o.jsxDEV(Bb,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:195,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:196,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:194,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=p.reduce((C,R)=>{const I=Mt(new Date(R.start),"MM.dd",{locale:bs}),z=R.project||"-",ie=`${I}|${z}`;return C[ie]||(C[ie]={date:I,project:z,schedules:[]}),C[ie].schedules.push(R),C},{});return Object.values(v).map(({date:C,project:R,schedules:I})=>{const ie=I.length>0&&Kb(new Date(I[0].start))?`${C} ()`:C;return o.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[o.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:R},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:ie},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:219,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:217,columnNumber:31},void 0),o.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:I.map(te=>{const O=te.time&&te.time!=="-"?` - ${pm(te.time)}`:"";return o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",te.title,O]},te.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:225,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:221,columnNumber:31},void 0)]},`${C}-${R}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:216,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:198,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:193,columnNumber:19},void 0),b===0&&o.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:241,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:107,columnNumber:7},void 0),i&&o.jsxDEV(dy,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>a(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await s({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),a(!1)}catch(h){console.error("Failed to add schedule:",h),alert("  : "+(h instanceof Error?h.message:"   "))}},onDelete:async d=>{try{await n(d),await e(),a(!1)}catch(h){console.error("Failed to delete schedule:",h),alert("  : "+(h instanceof Error?h.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:253,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:105,columnNumber:5},void 0)},Ql=()=>{const{user:t}=Rr(),{projects:e}=Ir();return D.useMemo(()=>t?t.name===""?e.filter(n=>{const i=(n.manager?n.manager.split(",").map(c=>c.trim()):[]).includes(""),a=n.team&&Array.isArray(n.team)&&n.team.includes("");return i||a}):e:[],[t,e])},AE=({value:t,detailValue:e="",onChange:s,onDetailChange:n,placeholder:r=" ",error:i})=>{const[a,c]=D.useState(!1),[m,u]=D.useState(t),[d,h]=D.useState(e),p=D.useRef(null);D.useEffect(()=>{const R=I=>{p.current&&!p.current.contains(I.target)&&c(!1)};return a&&document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[a]),D.useEffect(()=>{u(t)},[t]),D.useEffect(()=>{h(e)},[e]);const b=()=>new Promise((R,I)=>{if(window.daum&&window.daum.Postcode){R(!0);return}const z=document.createElement("script");z.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",z.async=!0,z.onload=()=>R(!0),z.onerror=()=>I(new Error("Kakao Postcode   ")),document.head.appendChild(z)}),w=R=>{const I=R.roadAddr||R.jibunAddr;u(I),s(I,d),c(!1)},v=R=>{const I=R.target.value;h(I),n&&n(I),m&&s(m,I)},C=async()=>{try{(!window.daum||!window.daum.Postcode)&&await b(),window.daum&&new window.daum.Postcode({oncomplete:function(R){const I={roadAddr:R.roadAddress,jibunAddr:R.jibunAddress||R.autoJibunAddress||"",zipNo:R.zonecode,bdNm:R.buildingName,siNm:R.sido,sggNm:R.sigungu,emdNm:R.bname,rn:R.roadname};w(I)}}).open()}catch(R){console.error("  :",R),alert("     .  .")}};return o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("div",{className:"relative flex-1",children:[o.jsxDEV("input",{type:"text",value:m,onClick:()=>C(),onChange:R=>{u(R.target.value),s(R.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),o.jsxDEV(pp,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),o.jsxDEV("button",{type:"button",onClick:C,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),o.jsxDEV("div",{children:o.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!m},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),m&&o.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:o.jsxDEV("p",{className:"text-sm text-gray-600",children:[o.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",m,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),o.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},Kf=["","","","","","",""],EE=({project:t,onClose:e,onSave:s})=>{const{register:n,handleSubmit:r,setValue:i,reset:a,formState:{errors:c}}=Eu({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[m,u]=D.useState([]),[d,h]=D.useState(""),[p,b]=D.useState(""),[w,v]=D.useState(""),[C,R]=D.useState(!1);D.useEffect(()=>{var O;if(t){const A=t.location?t.location.split(","):["",""],x=((O=A[0])==null?void 0:O.trim())||t.location||"",E=A.length>1?A.slice(1).join(",").trim():"";a({name:t.name,client:t.client||"",location:x,detailLocation:E,startDate:t.startDate?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate?new Date(t.endDate).toISOString().split("T")[0]:""}),b(x),v(E);const T=t.manager?t.manager.split(",").map(L=>L.trim()).filter(L=>L&&L!==""):[];u(T)}else a({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),b(""),v(""),u([])},[t,a]);const I=O=>{u(A=>A.includes(O)?A.filter(x=>x!==O):[...A,O])},z=()=>{d.trim()&&!m.includes(d.trim())&&(u(O=>[...O,d.trim()]),h(""))},ie=O=>{u(A=>A.filter(x=>x!==O))},te=async O=>{if(C)return;R(!0),console.log(" ProjectModal onSubmit - Raw form data:",O);const A=p&&w?`${p}, ${w}`:p||O.location,x={name:O.name,client:O.client,location:A,manager:m.join(", "),contractAmount:(t==null?void 0:t.contractAmount)??0,spent:(t==null?void 0:t.spent)??0,status:(t==null?void 0:t.status)??"planning",progress:(t==null?void 0:t.progress)??0,description:(t==null?void 0:t.description)??"",meetingNotes:(t==null?void 0:t.meetingNotes)??[],customerRequests:(t==null?void 0:t.customerRequests)??[],entrancePassword:(t==null?void 0:t.entrancePassword)??"",sitePassword:(t==null?void 0:t.sitePassword)??""};if(O.startDate&&O.startDate!=="")x.startDate=O.startDate,console.log(" Setting startDate from form:",O.startDate);else if(t!=null&&t.startDate){const E=typeof t.startDate=="string"&&t.startDate.includes("T")?t.startDate.split("T")[0]:t.startDate;x.startDate=E,console.log(" Keeping existing startDate:",x.startDate)}if(O.endDate&&O.endDate!=="")x.endDate=O.endDate,console.log(" Setting endDate from form:",O.endDate);else if(t!=null&&t.endDate){const E=typeof t.endDate=="string"&&t.endDate.includes("T")?t.endDate.split("T")[0]:t.endDate;x.endDate=E,console.log(" Keeping existing endDate:",x.endDate)}console.log(" ProjectModal onSubmit - Final formData:",x);try{await s(x)}catch(E){throw R(!1),E}};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[o.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:t?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),o.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(us,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),o.jsxDEV("form",{onSubmit:r(te),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),o.jsxDEV("input",{...n("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),c.name&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(c.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),o.jsxDEV("input",{...n("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),o.jsxDEV(AE,{value:p,detailValue:w,onChange:(O,A)=>{b(O),v(A||""),i("location",O),i("detailLocation",A||"")},onDetailChange:O=>{v(O),i("detailLocation",O)},placeholder:"  ",required:!0,error:c.location?String(c.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),o.jsxDEV("input",{...n("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),o.jsxDEV("input",{...n("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[Kf.map(O=>o.jsxDEV("button",{type:"button",onClick:()=>I(O),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${m.includes(O)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:O},O,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),m.filter(O=>!Kf.includes(O)).map(O=>o.jsxDEV("button",{type:"button",onClick:()=>ie(O),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[O," "]},O,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:d,onChange:O=>h(O.target.value),onKeyPress:O=>{O.key==="Enter"&&(O.preventDefault(),z())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:z,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[o.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),o.jsxDEV("button",{type:"submit",disabled:C,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:C?" ...":t?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},CE=({projectName:t,meetingNotes:e,onClose:s,onSave:n,onDelete:r})=>{const[i,a]=D.useState(""),[c,m]=D.useState(new Date().toISOString().split("T")[0]),[u,d]=D.useState(!1),[h,p]=D.useState(!1),b=()=>{d(!0),a(""),m(new Date().toISOString().split("T")[0])},w=async()=>{if(!h){if(!i.trim()){alert(" ");return}if(!c){alert(" ");return}p(!0);try{await n(i.trim(),new Date(c)),a(""),m(new Date().toISOString().split("T")[0]),d(!1)}finally{p(!1)}}},v=()=>{a(""),m(new Date().toISOString().split("T")[0]),d(!1)},C=R=>{window.confirm("   ?")&&r(R)};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:R=>R.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),o.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(us,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!u&&o.jsxDEV("button",{onClick:b,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),u&&o.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:c,onChange:R=>m(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),o.jsxDEV("textarea",{value:i,onChange:R=>a(R.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:w,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),o.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-3",children:e.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(R=>o.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Mt(new Date(R.date),"yyyy.MM.dd (eee)",{locale:bs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:R.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),o.jsxDEV("button",{onClick:()=>C(R.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},R.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},VE=({projectName:t,customerRequests:e,onClose:s,onSave:n,onToggleComplete:r,onDelete:i})=>{const[a,c]=D.useState(""),[m,u]=D.useState(new Date().toISOString().split("T")[0]),[d,h]=D.useState(!1),[p,b]=D.useState(!1),w=()=>{h(!0),c(""),u(new Date().toISOString().split("T")[0])},v=async()=>{if(!p){if(!a.trim()){alert(" ");return}if(!m){alert(" ");return}b(!0);try{await n(a.trim(),new Date(m)),c(""),u(new Date().toISOString().split("T")[0]),h(!1)}finally{b(!1)}}},C=()=>{c(""),u(new Date().toISOString().split("T")[0]),h(!1)},R=te=>{window.confirm("  ?")&&i(te)},I=te=>{r(te)},z=e.filter(te=>!te.completed),ie=e.filter(te=>te.completed);return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:te=>te.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),o.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(us,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&o.jsxDEV("button",{onClick:w,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&o.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:m,onChange:te=>u(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),o.jsxDEV("textarea",{value:a,onChange:te=>c(te.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:v,disabled:p,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:p?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),o.jsxDEV("button",{onClick:C,disabled:p,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-2",children:e.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):o.jsxDEV(o.Fragment,{children:[z.map(te=>o.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start gap-3",children:[o.jsxDEV("button",{onClick:()=>I(te.id),className:"mt-0.5 flex-shrink-0",children:o.jsxDEV(Rb,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:te.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Mt(new Date(te.createdAt),"yyyy.MM.dd",{locale:bs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>R(te.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},te.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),ie.map(te=>o.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start gap-3",children:[o.jsxDEV("button",{onClick:()=>I(te.id),className:"mt-0.5 flex-shrink-0",children:o.jsxDEV(Ub,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:te.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Mt(new Date(te.createdAt),"yyyy.MM.dd",{locale:bs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>R(te.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},te.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},wE=({projectName:t,entrancePassword:e,sitePassword:s,onClose:n,onSave:r})=>{const[i,a]=D.useState(e||""),[c,m]=D.useState(s||""),[u,d]=D.useState(!1),[h,p]=D.useState(!1),b=()=>{d(!0)},w=async()=>{if(!h){p(!0);try{await r(i,c),d(!1)}finally{p(!1)}}},v=()=>{a(e||""),m(s||""),d(!1)};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:C=>C.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),o.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(us,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),o.jsxDEV("div",{className:"p-6 space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),u?o.jsxDEV("input",{type:"text",value:i,onChange:C=>a(C.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?o.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):o.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),u?o.jsxDEV("input",{type:"text",value:c,onChange:C=>m(C.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:c?o.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:c},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):o.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:u?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("button",{onClick:w,disabled:h,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),o.jsxDEV("button",{onClick:v,disabled:h,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),o.jsxDEV("button",{onClick:n,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},SE=({projectName:t,onClose:e})=>{var a;const[s,n]=D.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=c=>{const m=Number(c.replace(/,/g,""));return isNaN(m)?"":m.toLocaleString()};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(us,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),o.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:s.clientName,onChange:c=>n({...s,clientName:c.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:s.phoneNumber,onChange:c=>n({...s,phoneNumber:c.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:s.address,onChange:c=>n({...s,address:c.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:s.startDate,onChange:c=>n({...s,startDate:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:s.endDate,onChange:c=>n({...s,endDate:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:s.area,onChange:c=>n({...s,area:c.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:i(s.designFee),onChange:c=>{const m=c.target.value.replace(/,/g,"");/^\d*$/.test(m)&&n({...s,designFee:m})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:s.bankAccount,onChange:c=>n({...s,bankAccount:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),o.jsxDEV("button",{onClick:r,disabled:!s.clientName||!s.phoneNumber||!s.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsxDEV(hp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden print:block p-16",children:o.jsxDEV("div",{className:"space-y-16",children:[o.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:s.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:s.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:s.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:s.startDate&&s.endDate?o.jsxDEV(o.Fragment,{children:[Mt(new Date(s.startDate),"yyyy",{locale:bs}),"",Mt(new Date(s.startDate),"MM",{locale:bs}),"",Mt(new Date(s.startDate),"dd",{locale:bs})," ~ ",Mt(new Date(s.endDate),"yyyy",{locale:bs}),"",Mt(new Date(s.endDate),"MM",{locale:bs}),"",Mt(new Date(s.endDate),"dd",{locale:bs})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:s.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex flex-col",children:[o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),o.jsxDEV("span",{className:"flex-1",children:[s.designFee?`${i(s.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),s.bankAccount&&o.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:s.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-20 space-y-3",children:[o.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),o.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[o.jsxDEV("div",{children:[" : ",s.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{children:[" : ",(a=s.clientName)==null?void 0:a.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),o.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-12 space-y-3",children:[o.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),o.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[o.jsxDEV("div",{children:[" : ",s.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),o.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{children:[" : ",s.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),o.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:o.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),o.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),o.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),o.jsxDEV("div",{className:"text-right",children:[o.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),o.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),o.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},IE=()=>{const{loadProjectsFromAPI:t,addProjectToAPI:e,updateProjectInAPI:s,deleteProjectFromAPI:n}=Ir(),{user:r}=Rr(),i=Ql(),[a,c]=D.useState("in-progress"),[m,u]=D.useState("grid"),[d,h]=D.useState(!1),[p,b]=D.useState(null),[w,v]=D.useState(!1),[C,R]=D.useState(!1),[I,z]=D.useState(!1),[ie,te]=D.useState(!1),[O,A]=D.useState(null),x=(W,Ce)=>`lastViewed_${r==null?void 0:r.id}_${W}_${Ce}`,E=(W,Ce)=>{const Me=x(W,Ce),Le=localStorage.getItem(Me);return Le?parseInt(Le,10):0},T=(W,Ce)=>{const Me=x(W,Ce);localStorage.setItem(Me,Date.now().toString())},L=(W,Ce)=>{const Me=E(W.id,Ce);return Ce==="meeting"?(W.meetingNotes||[]).some($e=>($e.createdAt?new Date($e.createdAt).getTime():new Date($e.date).getTime())>Me):(W.customerRequests||[]).some($e=>!$e.completed)};D.useEffect(()=>{t().catch(W=>{console.error("Failed to load projects:",W),ee.error("   ")})},[t]),D.useEffect(()=>{const W=()=>{b(null),h(!0)};return window.addEventListener("headerAddButtonClick",W),()=>window.removeEventListener("headerAddButtonClick",W)},[]);const P=(W,Ce)=>{if(!W||!Ce)return 0;const Me=new Date,Le=new Date(W),$e=new Date(Ce);if(Me<Le)return 0;if(Me>$e)return 100;const bt=Math.ceil(($e.getTime()-Le.getTime())/(1e3*60*60*24)),Ot=Math.ceil((Me.getTime()-Le.getTime())/(1e3*60*60*24)),mt=Math.round(Ot/bt*100);return Math.min(100,Math.max(0,mt))},k=W=>{b(W),h(!0)},ke=async(W,Ce)=>{if(window.confirm(`"${Ce}"  ?

    .`))try{await n(W),ee.success(" ")}catch(Me){console.error("Failed to delete project:",Me),ee.error("  ")}},Re=async W=>{try{if(p)await s(p.id,W),ee.success(" ");else{const Ce={id:"",...W,team:W.team||[]};await e(Ce),ee.success(" "),c(W.status||"planning")}h(!1),b(null)}catch(Ce){console.error("Failed to save project:",Ce),ee.error("  ")}},ye=async(W,Ce)=>{try{await s(W,{status:Ce}),ee.success(" ")}catch(Me){console.error("Failed to update project status:",Me),ee.error("  ")}},Ie=W=>{A(W),v(!0),T(W.id,"meeting")},rt=W=>{A(W),R(!0),T(W.id,"request")},Lt=W=>{A(W),z(!0)},Ht=W=>{A(W),te(!0)},me=async(W,Ce)=>{if(!O)return;const Me=O.entrancePassword,Le=O.sitePassword;A({...O,entrancePassword:W,sitePassword:Ce});try{await s(O.id,{entrancePassword:W,sitePassword:Ce}),ee.success(" ")}catch($e){console.error("Failed to save passwords:",$e),ee.error("  "),A({...O,entrancePassword:Me,sitePassword:Le})}},He=async(W,Ce)=>{if(!O)return;const Me={id:Date.now().toString(),content:W,date:Ce,createdAt:new Date},Le=[...O.meetingNotes||[],Me];A({...O,meetingNotes:Le});try{await s(O.id,{meetingNotes:Le}),ee.success("  ")}catch($e){console.error("Failed to save meeting note:",$e),ee.error("   "),A({...O,meetingNotes:O.meetingNotes||[]})}},Ge=async(W,Ce)=>{if(!O)return;const Me={id:Date.now().toString(),content:W,completed:!1,createdAt:Ce},Le=[...O.customerRequests||[],Me];A({...O,customerRequests:Le});try{await s(O.id,{customerRequests:Le}),ee.success("  ")}catch($e){console.error("Failed to save customer request:",$e),ee.error("   "),A({...O,customerRequests:O.customerRequests||[]})}},xt=async W=>{if(!O)return;const Ce=O.customerRequests||[],Me=Ce.map(Le=>Le.id===W?{...Le,completed:!Le.completed}:Le);A({...O,customerRequests:Me});try{await s(O.id,{customerRequests:Me}),ee.success("  ")}catch(Le){console.error("Failed to toggle request:",Le),ee.error("  "),A({...O,customerRequests:Ce})}},fe=async W=>{if(!O)return;const Ce=O.meetingNotes||[],Me=Ce.filter(Le=>Le.id!==W);A({...O,meetingNotes:Me});try{await s(O.id,{meetingNotes:Me}),ee.success("  ")}catch(Le){console.error("Failed to delete meeting note:",Le),ee.error(" "),A({...O,meetingNotes:Ce})}},qe=async W=>{if(!O)return;const Ce=O.customerRequests||[],Me=Ce.filter(Le=>Le.id!==W);A({...O,customerRequests:Me});try{await s(O.id,{customerRequests:Me}),ee.success("  ")}catch(Le){console.error("Failed to delete customer request:",Le),ee.error(" "),A({...O,customerRequests:Ce})}},ze=({project:W})=>{const Me={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[W.status];return o.jsxDEV("select",{value:W.status,onChange:Le=>ye(W.id,Le.target.value),className:vn("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Me.color),onClick:Le=>Le.stopPropagation(),children:[o.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),o.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),o.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),o.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},tt=(()=>{let W=i;return a!=="all"&&(W=W.filter(Ce=>Ce.status===a)),r!=null&&r.name&&(W=[...W].sort((Ce,Me)=>{var bt,Ot;const Le=Ce.manager===r.name||((bt=Ce.team)==null?void 0:bt.includes(r.name)),$e=Me.manager===r.name||((Ot=Me.team)==null?void 0:Ot.includes(r.name));return Le&&!$e?-1:!Le&&$e?1:0})),W})(),Bt={planning:i.filter(W=>W.status==="planning").length,inProgress:i.filter(W=>W.status==="in-progress").length,completed:i.filter(W=>W.status==="completed").length,onHold:i.filter(W=>W.status==="on-hold").length},ds=({project:W})=>{var Me,Le,$e;const Ce=P(W.startDate,W.endDate);return o.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[o.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:W.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[W.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[W.status==="planning"&&o.jsxDEV("button",{onClick:()=>Ht(W),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),o.jsxDEV(ze,{project:W},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>k(W),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),o.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[o.jsxDEV("div",{className:"text-gray-600",children:[": ",W.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),o.jsxDEV("div",{className:"text-gray-600",children:[": ",W.startDate&&W.endDate?`${Mt(W.startDate,"MM.dd (eee)",{locale:bs})} - ${Mt(W.endDate,"MM.dd (eee)",{locale:bs})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),o.jsxDEV("div",{className:"text-gray-600",children:[": ",W.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),o.jsxDEV("div",{className:"mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:o.jsxDEV("button",{onClick:()=>Lt(W),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[o.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),o.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Ce,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),o.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:o.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Ce}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),o.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[o.jsxDEV("div",{onClick:()=>Ie(W),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Me=W.meetingNotes)==null?void 0:Me.length)||0)>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",(Le=W.meetingNotes)==null?void 0:Le.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),L(W,"meeting")&&o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),W.meetingNotes&&W.meetingNotes.length>0?o.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:(($e=W.meetingNotes[W.meetingNotes.length-1])==null?void 0:$e.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):o.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var mt;const bt=((mt=W.customerRequests)==null?void 0:mt.filter(j=>!j.completed))||[],Ot=bt[bt.length-1];return o.jsxDEV("div",{onClick:()=>rt(W),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",bt.length>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",bt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),L(W,"request")&&o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Ot?o.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Ot.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):o.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&o.jsxDEV("div",{className:"flex justify-end pt-1",children:o.jsxDEV("button",{onClick:()=>ke(W.id,W.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:Bt.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:Bt.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:Bt.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(W=>o.jsxDEV("button",{onClick:()=>c(W.id),className:vn("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",a===W.id?`border-gray-700 ${W.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[W.label,o.jsxDEV("span",{className:vn("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",a===W.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:W.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},W.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[o.jsxDEV("button",{onClick:()=>u("grid"),className:vn("px-3 md:px-4 py-2 text-xs md:text-sm",m==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>u("list"),className:vn("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",m==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>{b(null),h(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[o.jsxDEV(Mi,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),o.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),m==="grid"||window.innerWidth<768?o.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:tt.map(W=>o.jsxDEV(ds,{project:W},W.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):o.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:o.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsxDEV("thead",{className:"bg-gray-50",children:o.jsxDEV("tr",{children:[o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),o.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:tt.map(W=>{var Me,Le,$e,bt;const Ce=P(W.startDate,W.endDate);return o.jsxDEV("tr",{className:"hover:bg-gray-50",children:[o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{children:[o.jsxDEV("p",{className:"font-medium",children:W.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500",children:W.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("p",{className:"text-sm",children:[W.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:W.startDate&&W.endDate?o.jsxDEV(o.Fragment,{children:[Mt(W.startDate,"yyyy.MM.dd (eee)",{locale:bs})," -",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Mt(W.endDate,"yyyy.MM.dd (eee)",{locale:bs})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"flex items-center gap-2",children:[W.status==="planning"&&o.jsxDEV("button",{onClick:()=>Ht(W),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),o.jsxDEV(ze,{project:W},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("button",{onClick:()=>Lt(W),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:o.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Ce}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-sm",children:[Ce,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4",children:o.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[o.jsxDEV("div",{onClick:()=>Ie(W),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[o.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Me=W.meetingNotes)==null?void 0:Me.length)||0)>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",(Le=W.meetingNotes)==null?void 0:Le.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),L(W,"meeting")&&o.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:($e=W.meetingNotes)!=null&&$e.length?((bt=W.meetingNotes[W.meetingNotes.length-1])==null?void 0:bt.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var j;const Ot=((j=W.customerRequests)==null?void 0:j.filter($=>!$.completed))||[],mt=Ot[Ot.length-1];return o.jsxDEV("div",{onClick:()=>rt(W),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[o.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Ot.length>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",Ot.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),L(W,"request")&&o.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),o.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:mt?mt.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),o.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[o.jsxDEV("button",{onClick:()=>k(W),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&o.jsxDEV("button",{onClick:()=>ke(W.id,W.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},W.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&o.jsxDEV(EE,{project:p,onClose:()=>{h(!1),b(null)},onSave:Re},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),w&&O&&o.jsxDEV(CE,{projectName:O.name,meetingNotes:O.meetingNotes||[],onClose:()=>{v(!1),A(null)},onSave:He,onDelete:fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),C&&O&&o.jsxDEV(VE,{projectName:O.name,customerRequests:O.customerRequests||[],onClose:()=>{R(!1),A(null)},onSave:Ge,onToggleComplete:xt,onDelete:qe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),I&&O&&o.jsxDEV(wE,{projectName:O.name,entrancePassword:O.entrancePassword||"",sitePassword:O.sitePassword||"",onClose:()=>{z(!1),A(null)},onSave:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),ie&&O&&o.jsxDEV(SE,{projectName:O.name,onClose:()=>{te(!1),A(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var Cu={},fy={exports:{}};(function(t){function e(s){return s&&s.__esModule?s:{default:s}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(fy);var zs=fy.exports,Vu={},py={exports:{}},hy={exports:{}},gy={exports:{}},yy={exports:{}};(function(t){function e(s){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t.exports.__esModule=!0,t.exports.default=t.exports,e(s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(yy);var no=yy.exports,by={exports:{}};(function(t){var e=no.default;function s(n,r){if(e(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var a=i.call(n,r||"default");if(e(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(by);var LE=by.exports;(function(t){var e=no.default,s=LE;function n(r){var i=s(r,"string");return e(i)=="symbol"?i:i+""}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(gy);var Ny=gy.exports;(function(t){var e=Ny;function s(n,r,i){return(r=e(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(hy);var xy=hy.exports;(function(t){var e=xy;function s(r,i){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);i&&(c=c.filter(function(m){return Object.getOwnPropertyDescriptor(r,m).enumerable})),a.push.apply(a,c)}return a}function n(r){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?s(Object(a),!0).forEach(function(c){e(r,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(a,c))})}return r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(py);var Ur=py.exports,vy={exports:{}},_y={exports:{}};(function(t){function e(s,n){if(s==null)return{};var r={};for(var i in s)if({}.hasOwnProperty.call(s,i)){if(n.indexOf(i)!==-1)continue;r[i]=s[i]}return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(_y);var PE=_y.exports;(function(t){var e=PE;function s(n,r){if(n==null)return{};var i,a,c=e(n,r);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(n);for(a=0;a<m.length;a++)i=m[a],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(n,i)&&(c[i]=n[i])}return c}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(vy);var wu=vy.exports,Dy={exports:{}};(function(t){function e(s,n){if(!(s instanceof n))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Dy);var mi=Dy.exports,ky={exports:{}};(function(t){var e=Ny;function s(r,i){for(var a=0;a<i.length;a++){var c=i[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(r,e(c.key),c)}}function n(r,i,a){return i&&s(r.prototype,i),a&&s(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ky);var ui=ky.exports,Ay={exports:{}},Ey={exports:{}};(function(t){function e(s){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},t.exports.__esModule=!0,t.exports.default=t.exports,e(s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Ey);var jE=Ey.exports,Cy={exports:{}};(function(t){function e(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t.exports=e=function(){return!!s},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Cy);var TE=Cy.exports,Vy={exports:{}},wy={exports:{}};(function(t){function e(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(wy);var BE=wy.exports;(function(t){var e=no.default,s=BE;function n(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s(r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Vy);var RE=Vy.exports;(function(t){var e=jE,s=TE,n=RE;function r(i,a,c){return a=e(a),n(i,s()?Reflect.construct(a,c||[],e(i).constructor):a.apply(i,c))}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Ay);var ro=Ay.exports,Sy={exports:{}},Iy={exports:{}};(function(t){function e(s,n){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},t.exports.__esModule=!0,t.exports.default=t.exports,e(s,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Iy);var UE=Iy.exports;(function(t){var e=UE;function s(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&e(n,r)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(Sy);var io=Sy.exports;const ha=sa(Yb);var An={},Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});Gi.views=Gi.navigate=void 0;Gi.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};Gi.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var HE=zs.default;Object.defineProperty(An,"__esModule",{value:!0});An.views=An.dateRangeFormat=An.dateFormat=An.accessor=An.DayLayoutAlgorithmPropType=void 0;var rn=HE(gp),Qf=Gi,Yf=Object.keys(Qf.views).map(function(t){return Qf.views[t]});An.accessor=rn.default.oneOfType([rn.default.string,rn.default.func]);An.dateFormat=rn.default.any;An.dateRangeFormat=rn.default.func;An.views=rn.default.oneOfType([rn.default.arrayOf(rn.default.oneOf(Yf)),rn.default.objectOf(function(t,e){var s=Yf.indexOf(e)!==-1&&typeof t[e]=="boolean";if(s)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return rn.default.elementType.apply(rn.default,[t,e].concat(r))})]);An.DayLayoutAlgorithmPropType=rn.default.oneOfType([rn.default.oneOf(["overlap","no-overlap"]),rn.default.func]);var Yl={},oo={},ME=zs.default;Object.defineProperty(oo,"__esModule",{value:!0});oo.accessor=Ly;oo.wrapAccessor=void 0;var FE=ME(no);function Ly(t,e){var s=null;return typeof e=="function"?s=e(t):typeof e=="string"&&(0,FE.default)(t)==="object"&&t!=null&&e in t&&(s=t[e]),s}oo.wrapAccessor=function(e){return function(s){return Ly(s,e)}};var di={},OE=zs.default;Object.defineProperty(di,"__esModule",{value:!0});di.DnDContext=void 0;var qE=OE(D);di.DnDContext=qE.default.createContext();var fi=zs.default;Object.defineProperty(Yl,"__esModule",{value:!0});Yl.default=void 0;var $E=fi(Ur),WE=fi(mi),zE=fi(ui),KE=fi(ro),QE=fi(io),Ii=fi(D),Gf=fi(ha),Xf=oo,YE=di,Py=function(t){function e(){var s;(0,WE.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return s=(0,KE.default)(this,e,[].concat(r)),s.handleResizeUp=function(a){a.button===0&&s.context.draggable.onBeginAction(s.props.event,"resize","UP")},s.handleResizeDown=function(a){a.button===0&&s.context.draggable.onBeginAction(s.props.event,"resize","DOWN")},s.handleResizeLeft=function(a){a.button===0&&s.context.draggable.onBeginAction(s.props.event,"resize","LEFT")},s.handleResizeRight=function(a){a.button===0&&s.context.draggable.onBeginAction(s.props.event,"resize","RIGHT")},s.handleStartDragging=function(a){var c;if(a.button===0){var m=(c=a.target.getAttribute("class"))===null||c===void 0?void 0:c.includes("rbc-addons-dnd-resize");if(!m){var u=(0,$E.default)({},s.props.event);u.sourceResource=s.props.resource,s.context.draggable.onBeginAction(s.props.event,"move")}}},s}return(0,QE.default)(e,t),(0,zE.default)(e,[{key:"renderAnchor",value:function(n){var r=n==="Up"||n==="Down"?"ns":"ew";return Ii.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(n)]},Ii.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var n=this.props,r=n.event,i=n.type,a=n.continuesPrior,c=n.continuesAfter,m=n.resizable,u=this.props.children;if(r.__isPreview)return Ii.default.cloneElement(u,{className:(0,Gf.default)(u.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,h=d.draggableAccessor,p=d.resizableAccessor,b=h?!!(0,Xf.accessor)(r,h):!0;if(!b)return u;var w=m&&(p?!!(0,Xf.accessor)(r,p):!0);if(w||b){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(w){var C=null,R=null;i==="date"?(C=!a&&this.renderAnchor("Left"),R=!c&&this.renderAnchor("Right")):(C=!a&&this.renderAnchor("Up"),R=!c&&this.renderAnchor("Down")),v.children=Ii.default.createElement("div",{className:"rbc-addons-dnd-resizable"},C,u.props.children,R)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Gf.default)(u.props.className,"rbc-addons-dnd-dragged-event")),u=Ii.default.cloneElement(u,v)}return u}}])}(Ii.default.Component);Py.contextType=YE.DnDContext;Yl.default=Py;var Gl={},jy={exports:{}};(function(t){var e=no.default;function s(n,r){if(typeof WeakMap=="function")var i=new WeakMap,a=new WeakMap;return(t.exports=s=function(m,u){if(!u&&m&&m.__esModule)return m;var d,h,p={__proto__:null,default:m};if(m===null||e(m)!="object"&&typeof m!="function")return p;if(d=u?a:i){if(d.has(m))return d.get(m);d.set(m,p)}for(var b in m)b!=="default"&&{}.hasOwnProperty.call(m,b)&&((h=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(m,b))&&(h.get||h.set)?d(p,b,h):p[b]=m[b]);return p},t.exports.__esModule=!0,t.exports.default=t.exports)(n,r)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(jy);var Ty=jy.exports;function Su(t,e,s,n){if(s===void 0&&(s=!1),n===void 0&&(n=!0),t){var r=document.createEvent("HTMLEvents");r.initEvent(e,s,n),t.dispatchEvent(r)}}function GE(t){var e=_n(t,"transitionDuration")||"",s=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*s}function XE(t,e,s){s===void 0&&(s=5);var n=!1,r=setTimeout(function(){n||Su(t,"transitionend",!0)},e+s),i=Dl(t,"transitionend",function(){n=!0},{once:!0});return function(){clearTimeout(r),i()}}function Iu(t,e,s,n){s==null&&(s=GE(t)||0);var r=XE(t,s,n),i=Dl(t,"transitionend",e);return function(){r(),i()}}var Jf={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Zf(t){var e=t.node,s=t.properties,n=t.duration,r=n===void 0?200:n,i=t.easing,a=t.callback,c=[],m={},u="";Object.keys(s).forEach(function(p){var b=s[p];Gb(p)?u+=p+"("+b+") ":(m[p]=b,c.push(Xb(p)))}),u&&(m.transform=u,c.push("transform"));function d(p){p.target===p.currentTarget&&(_n(e,Jf),a&&a.call(this,p))}r>0&&(m.transition=c.join(", "),m["transition-duration"]=r/1e3+"s",m["transition-delay"]="0s",m["transition-timing-function"]=i||"linear");var h=Iu(e,d,r);return e.clientLeft,_n(e,m),{cancel:function(){h(),_n(e,Jf)}}}function By(t,e,s,n,r){if(!("nodeType"in t))return Zf(t);if(!e)throw new Error("must include properties to animate");return typeof n=="function"&&(r=n,n=""),Zf({node:t,properties:e,duration:s,easing:n,callback:r})}function Ry(t,e,s){if(t){if(typeof s>"u")return t.getAttribute(e);!s&&s!==""?t.removeAttribute(e):t.setAttribute(e,String(s))}}function Uy(t){return t?Array.from(t.children):[]}function Hy(t){if(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}return null}var JE=Function.prototype.bind.call(Function.prototype.call,[].slice);function My(t){return t?JE(t.childNodes):[]}function Fy(t,e){return function(n){var r=n.currentTarget,i=n.target,a=xm(r,t);a.some(function(c){return vm(c,i)})&&e.call(this,n)}}function Oy(t,e){return t&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t):null}var ZE=/^(?:input|select|textarea|button)$/i;function qy(t){return t?ZE.test(t.nodeName):!1}function $y(t){return t?!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length):!1}function Wy(t,e,s){e===void 0&&(e=null),s===void 0&&(s=null);for(var n=[];t;t=t.nextElementSibling)if(t!==e){if(s&&_m(t,s))break;n.push(t)}return n}function zy(t,e){return Wy(t,t,e)}function eC(t,e){var s=null,n=[];for(s=t?t[e]:null;s&&s.nodeType!==9;)n.push(s),s=s[e]||null;return n}function Ky(t){return eC(t,"parentElement")}function Qy(t,e){return t&&e?(e.firstElementChild?e.insertBefore(t,e.firstElementChild):e.appendChild(t),t):null}function Yy(t){return t&&t.parentNode?(t.parentNode.removeChild(t),t):null}function Lu(t,e){var s=_n(t,"position"),n=s==="absolute",r=t.ownerDocument;if(s==="fixed")return r||document;for(;(t=t.parentNode)&&!Jb(t);){var i=n&&_n(t,"position")==="static",a=(_n(t,"overflow")||"")+(_n(t,"overflow-y")||"")+_n(t,"overflow-x");if(!i&&/(auto|scroll)/.test(a)&&(e||kl(t)<t.scrollHeight))return t}return r||document}function Gy(t,e){var s=tl(t),n={top:0,left:0};if(t){var r=e||Lu(t),i=Zb(r),a=sl(r),c=kl(r,!0);i||(n=tl(r)),s={top:s.top-n.top,left:s.left-n.left,height:s.height,width:s.width};var m=s.height,u=s.top+(i?0:a),d=u+m;a=a>u?u:d>a+c?d-c:a;var h=Dm(function(){return sl(r,a)});return function(){return km(h)}}}function Xy(t){return Wy(t&&t.parentElement?t.parentElement.firstElementChild:null,t)}var tC=/&nbsp;/gi,sC=/\xA0/g,nC=/\s+([^\s])/gm;function Jy(t,e,s){e===void 0&&(e=!0),s===void 0&&(s=!0);var n="";return t&&(n=(t.textContent||"").replace(tC," ").replace(sC," "),e&&(n=n.trim()),s&&(n=n.replace(nC," $1"))),n}function Zy(t,e){t.classList?t.classList.toggle(e):Am(t,e)?Em(t,e):Cm(t,e)}const rC={addEventListener:Vp,removeEventListener:Cp,triggerEvent:Su,animate:By,filter:Fy,listen:Dl,style:_n,getComputedStyle:Ep,attribute:Ry,activeElement:Ap,ownerDocument:kp,ownerWindow:Dp,requestAnimationFrame:Dm,cancelAnimationFrame:km,matches:_m,height:kl,width:_p,offset:tl,offsetParent:vp,position:xp,contains:vm,scrollbarSize:Np,scrollLeft:bp,scrollParent:Lu,scrollTo:Gy,scrollTop:sl,querySelectorAll:xm,closest:yp,addClass:Cm,removeClass:Em,hasClass:Am,toggleClass:Zy,transitionEnd:Iu,childNodes:My,childElements:Uy,nextUntil:zy,parents:Ky,siblings:Xy,clear:Hy,insertAfter:Oy,isInput:qy,isVisible:$y,prepend:Qy,remove:Yy,text:Jy},iC=Object.freeze(Object.defineProperty({__proto__:null,activeElement:Ap,addClass:Cm,addEventListener:Vp,animate:By,attribute:Ry,cancelAnimationFrame:km,childElements:Uy,childNodes:My,clear:Hy,closest:yp,contains:vm,default:rC,filter:Fy,getComputedStyle:Ep,hasClass:Am,height:kl,insertAfter:Oy,isInput:qy,isVisible:$y,listen:Dl,matches:_m,nextUntil:zy,offset:tl,offsetParent:vp,ownerDocument:kp,ownerWindow:Dp,parents:Ky,position:xp,prepend:Qy,querySelectorAll:xm,remove:Yy,removeClass:Em,removeEventListener:Cp,requestAnimationFrame:Dm,scrollLeft:bp,scrollParent:Lu,scrollTo:Gy,scrollTop:sl,scrollbarSize:Np,siblings:Xy,style:_n,text:Jy,toggleClass:Zy,transitionEnd:Iu,triggerEvent:Su,width:_p},Symbol.toStringTag,{value:"Module"})),oC=sa(iC);var hm={exports:{}};(function(t,e){e.__esModule=!0,e.default=n;var s=Function.prototype.bind.call(Function.prototype.call,[].slice);function n(r,i){return s(r.querySelectorAll(i))}t.exports=e.default})(hm,hm.exports);var aC=hm.exports,Cn={};const lC=sa(eN),cC=sa(tN),mC=sa(sN);var ao=zs.default;Object.defineProperty(Cn,"__esModule",{value:!0});Cn.default=void 0;Cn.getBoundsForNode=ta;Cn.getEventNodeFromPoint=tb;Cn.getShowMoreNodeFromPoint=sb;Cn.isEvent=gC;Cn.isShowMore=yC;Cn.objectsCollide=ym;var uC=ao(no),dC=ao(mi),fC=ao(ui),gm=ao(lC),eb=ao(cC),pC=ao(mC);function qs(t,e){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,pC.default)(s,t,e,{passive:!1})}function hC(t,e,s){return!t||(0,gm.default)(t,document.elementFromPoint(e,s))}function tb(t,e){var s=e.clientX,n=e.clientY,r=document.elementFromPoint(s,n);return(0,eb.default)(r,".rbc-event",t)}function sb(t,e){var s=e.clientX,n=e.clientY,r=document.elementFromPoint(s,n);return(0,eb.default)(r,".rbc-show-more",t)}function gC(t,e){return!!tb(t,e)}function yC(t,e){return!!sb(t,e)}function ko(t){var e=t;return t.touches&&t.touches.length&&(e=t.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var ep=5,bC=250,NC=function(){function t(e){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=s.global,r=n===void 0?!1:n,i=s.longPressThreshold,a=i===void 0?250:i,c=s.validContainers,m=c===void 0?[]:c;(0,dC.default)(this,t),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=a,this.validContainers=m,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=qs("touchmove",function(){},window),this._removeKeyDownListener=qs("keydown",this._keyListener),this._removeKeyUpListener=qs("keyup",this._keyListener),this._removeDropFromOutsideListener=qs("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=qs("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,fC.default)(t,[{key:"on",value:function(s,n){var r=this._listeners[s]||(this._listeners[s]=[]);return r.push(n),{remove:function(){var a=r.indexOf(n);a!==-1&&r.splice(a,1)}}}},{key:"emit",value:function(s){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a,c=this._listeners[s]||[];return c.forEach(function(m){a===void 0&&(a=m.apply(void 0,r))}),a}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(s){var n=this._selectRect;return!n||!this.selecting?!1:ym(n,ta(s))}},{key:"filter",value:function(s){var n=this._selectRect;return!n||!this.selecting?[]:s.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(s,n){var r=this,i=null,a=null,c=null,m=function(p){i=setTimeout(function(){d(),s(p)},r.longPressThreshold),a=qs("touchmove",function(){return d()}),c=qs("touchend",function(){return d()})},u=qs("touchstart",m),d=function(){i&&clearTimeout(i),a&&a(),c&&c(),i=null,a=null,c=null};return n&&m(n),function(){d(),u()}}},{key:"_addInitialEventListener",value:function(){var s=this,n=qs("mousedown",function(i){s._removeInitialEventListener(),s._handleInitialEvent(i),s._removeInitialEventListener=qs("mousedown",s._handleInitialEvent)}),r=qs("touchstart",function(i){s._removeInitialEventListener(),s._removeInitialEventListener=s._addLongPressListener(s._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),r()}}},{key:"_dropFromOutsideListener",value:function(s){var n=ko(s),r=n.pageX,i=n.pageY,a=n.clientX,c=n.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:a,clientY:c}),s.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(s){var n=ko(s),r=n.pageX,i=n.pageY,a=n.clientX,c=n.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:a,clientY:c}),s.preventDefault()}},{key:"_handleInitialEvent",value:function(s){if(this._initialEvent=s,!this.isDetached){var n=ko(s),r=n.clientX,i=n.clientY,a=n.pageX,c=n.pageY,m=this.container(),u,d;if(!(s.which===3||s.button===2||!hC(m,r,i))){if(!this.globalMouse&&m&&!(0,gm.default)(m,s.target)){var h=xC(0),p=h.top,b=h.left,w=h.bottom,v=h.right;if(d=ta(m),u=ym({top:d.top-p,left:d.left-b,bottom:d.bottom+w,right:d.right+v},{top:c,left:a}),!u)return}var C=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(s.type),x:a,y:c,clientX:r,clientY:i});if(C!==!1)switch(s.type){case"mousedown":this._removeEndListener=qs("mouseup",this._handleTerminatingEvent),this._onEscListener=qs("keydown",this._handleTerminatingEvent),this._removeMoveListener=qs("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(s),this._removeEndListener=qs("touchend",this._handleTerminatingEvent),this._removeMoveListener=qs("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(s){var n=s.target,r=this.validContainers;return!r||!r.length||!n?!0:r.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(s){var n=this.selecting,r=this._selectRect;if(!n&&s.type.includes("key")&&(s=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!s){var i=!this.container||(0,gm.default)(this.container(),s.target),a=this._isWithinValidContainer(s);return s.key==="Escape"||!a?this.emit("reset"):!n&&i?this._handleClickEvent(s):n?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(s){var n=ko(s),r=n.pageX,i=n.pageY,a=n.clientX,c=n.clientY,m=new Date().getTime();return this._lastClickData&&m-this._lastClickData.timestamp<bC?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:a,clientY:c})):(this._lastClickData={timestamp:m},this.emit("click",{x:r,y:i,clientX:a,clientY:c}))}},{key:"_handleMoveEvent",value:function(s){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,r=n.x,i=n.y,a=ko(s),c=a.pageX,m=a.pageY,u=Math.abs(r-c),d=Math.abs(i-m),h=Math.min(c,r),p=Math.min(m,i),b=this.selecting,w=this.isClick(c,m);w&&!b&&!(u||d)||(!b&&!w&&this.emit("selectStart",this._initialEventData),w||(this.selecting=!0,this._selectRect={top:p,left:h,x:c,y:m,right:h+u,bottom:p+d},this.emit("selecting",this._selectRect)),s.preventDefault())}}},{key:"_keyListener",value:function(s){this.ctrl=s.metaKey||s.ctrlKey}},{key:"isClick",value:function(s,n){var r=this._initialEventData,i=r.x,a=r.y,c=r.isTouch;return!c&&Math.abs(s-i)<=ep&&Math.abs(n-a)<=ep}}])}();function xC(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,uC.default)(t)!=="object"&&(t={top:t,left:t,right:t,bottom:t}),t}function ym(t,e){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=ta(t),r=n.top,i=n.left,a=n.right,c=a===void 0?i:a,m=n.bottom,u=m===void 0?r:m,d=ta(e),h=d.top,p=d.left,b=d.right,w=b===void 0?p:b,v=d.bottom,C=v===void 0?h:v;return!(u-s<h||r+s>C||c-s<p||i+s>w)}function ta(t){if(!t.getBoundingClientRect)return t;var e=t.getBoundingClientRect(),s=e.left+tp("left"),n=e.top+tp("top");return{top:n,left:s,right:(t.offsetWidth||0)+s,bottom:(t.offsetHeight||0)+n}}function tp(t){if(t==="left")return window.pageXOffset||document.body.scrollLeft||0;if(t==="top")return window.pageYOffset||document.body.scrollTop||0}Cn.default=NC;var Xl={},Jl=zs.default;Object.defineProperty(Xl,"__esModule",{value:!0});Xl.default=void 0;var vC=Jl(xy),sp=Jl(Ur),_C=Jl(ha),Ao=Jl(D);function Ra(t){return typeof t=="string"?t:t+"%"}function DC(t){var e=t.style,s=t.className,n=t.event,r=t.accessors,i=t.rtl,a=t.selected,c=t.label,m=t.continuesPrior,u=t.continuesAfter,d=t.getters,h=t.onClick,p=t.onDoubleClick,b=t.isBackgroundEvent,w=t.onKeyPress,v=t.components,C=v.event,R=v.eventWrapper,I=r.title(n),z=r.tooltip(n),ie=r.end(n),te=r.start(n),O=d.eventProp(n,te,ie,a),A=[Ao.default.createElement("div",{key:"1",className:"rbc-event-label"},c),Ao.default.createElement("div",{key:"2",className:"rbc-event-content"},C?Ao.default.createElement(C,{event:n,title:I}):I)],x=e.height,E=e.top,T=e.width,L=e.xOffset,P=(0,sp.default)((0,sp.default)({},O.style),{},(0,vC.default)({top:Ra(E),height:Ra(x),width:Ra(T)},i?"right":"left",Ra(L)));return Ao.default.createElement(R,Object.assign({type:"time"},t),Ao.default.createElement("div",{role:"button",tabIndex:0,onClick:h,onDoubleClick:p,style:P,onKeyDown:w,title:z?(typeof c=="string"?c+": ":"")+z:void 0,className:(0,_C.default)(b?"rbc-background-event":"rbc-event",s,O.className,{"rbc-selected":a,"rbc-event-continues-earlier":m,"rbc-event-continues-later":u})},A))}Xl.default=DC;var sr={},nb=zs.default;Object.defineProperty(sr,"__esModule",{value:!0});sr.dragAccessors=void 0;sr.eventTimes=IC;sr.mergeComponents=wC;sr.pointInColumn=SC;var kC=nb(Ur),AC=nb(wu),np=oo,EC=D,CC=["children"];sr.dragAccessors={start:(0,np.wrapAccessor)(function(t){return t.start}),end:(0,np.wrapAccessor)(function(t){return t.end})};function VC(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];var n=function(i){var a=i.children,c=(0,AC.default)(i,CC);return e.filter(Boolean).reduceRight(function(m,u){return(0,EC.createElement)(u,c,m)},a)};return n}function wC(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,s=Object.keys(e),n=(0,kC.default)({},t);return s.forEach(function(r){n[r]=t[r]?VC(t[r],e[r]):e[r]}),n}function SC(t,e){var s=t.left,n=t.right,r=t.top,i=e.x,a=e.y;return i<n+10&&i>s&&a>r}function IC(t,e,s){var n=e.start(t),r=e.end(t),i=s.eq(n,r,"minutes")&&s.diff(n,r,"minutes")===0;i&&(r=s.add(r,1,"day"));var a=s.diff(n,r,"milliseconds");return{start:n,end:r,duration:a}}var LC=Ty.default,Hr=zs.default;Object.defineProperty(Gl,"__esModule",{value:!0});Gl.default=void 0;var mr=Hr(Ur),PC=Hr(mi),jC=Hr(ui),TC=Hr(ro),BC=Hr(io),Lc=oC,RC=Hr(aC),Qr=Hr(D),UC=di,ur=LC(Cn),HC=Hr(Xl),Kn=sr,rb=function(t){function e(){var s;(0,PC.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return s=(0,TC.default)(this,e,[].concat(r)),s.handleMove=function(a,c){if(!(0,Kn.pointInColumn)(c,a))return s.reset();var m=s.context.draggable.dragAndDropAction.event,u=s.props,d=u.accessors,h=u.slotMetrics,p=h.closestSlotFromPoint({y:a.y-s.eventOffsetTop,x:a.x},c),b=(0,Kn.eventTimes)(m,d,s.props.localizer),w=b.duration,v=s.props.localizer.add(p,w,"milliseconds");s.update(m,h.getRange(p,v,!1,!0))},s.handleDropFromOutside=function(a,c){var m=s.props,u=m.slotMetrics,d=m.resource,h=u.closestSlotFromPoint({y:a.y,x:a.x},c),p=s._calculateDnDEnd(h);s.context.draggable.onDropFromOutside({start:h,end:p,allDay:!1,resource:d}),s.reset()},s.handleDragOverFromOutside=function(a,c){var m=s.props.slotMetrics,u=m.closestSlotFromPoint({y:a.y,x:a.x},c),d=s._calculateDnDEnd(u),h=s.context.draggable.dragFromOutsideItem();s.update(h,m.getRange(u,d,!1,!0))},s._calculateDnDEnd=function(a){var c=s.props,m=c.accessors,u=c.slotMetrics,d=c.localizer,h=s.context.draggable.dragFromOutsideItem(),p=(0,Kn.eventTimes)(h,m,d),b=p.duration,w=u.nextSlot(a),v=!isNaN(b);if(v){var C=d.add(a,b,"milliseconds");w=new Date(Math.max(C,w))}return w},s.updateParentScroll=function(a,c){setTimeout(function(){var m=(0,RC.default)(c,".rbc-addons-dnd-drag-preview")[0];m&&(m.offsetTop<a.scrollTop?(0,Lc.scrollTop)(a,Math.max(m.offsetTop,0)):m.offsetTop+m.offsetHeight>a.scrollTop+a.clientHeight&&(0,Lc.scrollTop)(a,Math.min(m.offsetTop-a.offsetHeight+m.offsetHeight,a.scrollHeight)))})},s._selectable=function(){var a=s.ref.current,c=a.children[0],m=!1,u=s._selector=new ur.default(function(){return a.closest(".rbc-time-view")}),d=(0,Lc.scrollParent)(a);u.on("beforeSelect",function(h){var p=s.context.draggable.dragAndDropAction;if(!p.action)return!1;if(p.action==="resize")return(0,Kn.pointInColumn)((0,ur.getBoundsForNode)(c),h);var b=(0,ur.getEventNodeFromPoint)(c,h);if(!b)return!1;s.eventOffsetTop=h.y-(0,ur.getBoundsForNode)(b).top}),u.on("selecting",function(h){var p=(0,ur.getBoundsForNode)(c),b=s.context.draggable.dragAndDropAction;b.action==="move"&&(s.updateParentScroll(d,c),s.handleMove(h,p)),b.action==="resize"&&(s.updateParentScroll(d,c),s.handleResize(h,p))}),u.on("dropFromOutside",function(h){if(s.context.draggable.onDropFromOutside){var p=(0,ur.getBoundsForNode)(c);(0,Kn.pointInColumn)(p,h)&&s.handleDropFromOutside(h,p)}}),u.on("dragOverFromOutside",function(h){var p=s.context.draggable.dragFromOutsideItem?s.context.draggable.dragFromOutsideItem():null;if(p){var b=(0,ur.getBoundsForNode)(c);if(!(0,Kn.pointInColumn)(b,h))return s.reset();s.handleDragOverFromOutside(h,b)}}),u.on("selectStart",function(){m=!0,s.context.draggable.onStart()}),u.on("select",function(h){var p=(0,ur.getBoundsForNode)(c);m=!1;var b=s.context.draggable.dragAndDropAction;if(b.action==="resize")s.handleInteractionEnd();else{if(!s.state.event||!(0,Kn.pointInColumn)(p,h))return;s.handleInteractionEnd()}}),u.on("click",function(){m&&s.reset(),s.context.draggable.onEnd(null)}),u.on("reset",function(){s.reset(),s.context.draggable.onEnd(null)})},s.handleInteractionEnd=function(){var a=s.props.resource,c=s.state.event;s.reset(),s.context.draggable.onEnd({start:c.start,end:c.end,resourceId:a})},s._teardownSelectable=function(){s._selector&&(s._selector.teardown(),s._selector=null)},s.state={},s.ref=Qr.default.createRef(),s}return(0,BC.default)(e,t),(0,jC.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(n,r){var i=r.startDate,a=r.endDate,c=r.top,m=r.height,u=this.state.event;u&&i===u.start&&a===u.end||this.setState({top:c,height:m,event:(0,mr.default)((0,mr.default)({},n),{},{start:i,end:a})})}},{key:"handleResize",value:function(n,r){var i=this.props,a=i.accessors,c=i.slotMetrics,m=i.localizer,u=this.context.draggable.dragAndDropAction,d=u.event,h=u.direction,p=c.closestSlotFromPoint(n,r),b=(0,Kn.eventTimes)(d,a,m),w=b.start,v=b.end,C;if(h==="UP"){var R=m.min(p,c.closestSlotFromDate(v,-1));C=c.getRange(R,v),C=(0,mr.default)((0,mr.default)({},C),{},{endDate:v})}else if(h==="DOWN"){var I=m.max(p,c.closestSlotFromDate(w));C=c.getRange(w,I),C=(0,mr.default)((0,mr.default)({},C),{},{startDate:w})}this.update(d,C)}},{key:"renderContent",value:function(){var n=this.props,r=n.children,i=n.accessors,a=n.components,c=n.getters,m=n.slotMetrics,u=n.localizer,d=this.state,h=d.event,p=d.top,b=d.height;if(!h)return r;var w=r.props.children,v=h.start,C=h.end,R,I="eventTimeRangeFormat",z=m.startsBeforeDay(v),ie=m.startsAfterDay(C);return z?I="eventTimeRangeEndFormat":ie&&(I="eventTimeRangeStartFormat"),z&&ie?R=u.messages.allDay:R=u.format({start:v,end:C},I),Qr.default.cloneElement(r,{children:Qr.default.createElement(Qr.default.Fragment,null,w,h&&Qr.default.createElement(HC.default,{event:h,label:R,className:"rbc-addons-dnd-drag-preview",style:{top:p,height:b,width:100},getters:c,components:a,accessors:(0,mr.default)((0,mr.default)({},i),Kn.dragAccessors),continuesPrior:z,continuesAfter:ie}))})}},{key:"render",value:function(){return Qr.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(Qr.default.Component);rb.contextType=UC.DnDContext;Gl.default=rb;var Zl={},ib={exports:{}},ob={exports:{}},ab={exports:{}};(function(t){function e(s,n){(n==null||n>s.length)&&(n=s.length);for(var r=0,i=Array(n);r<n;r++)i[r]=s[r];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ab);var lb=ab.exports;(function(t){var e=lb;function s(n){if(Array.isArray(n))return e(n)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(ob);var MC=ob.exports,cb={exports:{}};(function(t){function e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(cb);var FC=cb.exports,mb={exports:{}};(function(t){var e=lb;function s(n,r){if(n){if(typeof n=="string")return e(n,r);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,r):void 0}}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(mb);var OC=mb.exports,ub={exports:{}};(function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ub);var qC=ub.exports;(function(t){var e=MC,s=FC,n=OC,r=qC;function i(a){return e(a)||s(a)||n(a)||r()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports})(ib);var db=ib.exports,ec={},tc={},sc={},Mr=zs.default;Object.defineProperty(sc,"__esModule",{value:!0});sc.default=void 0;var rp=Mr(Ur),$C=Mr(wu),WC=Mr(mi),zC=Mr(ui),KC=Mr(ro),QC=Mr(io),Eo=Mr(D),YC=Mr(ha),GC=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],XC=function(t){function e(){return(0,WC.default)(this,e),(0,KC.default)(this,e,arguments)}return(0,QC.default)(e,t),(0,zC.default)(e,[{key:"render",value:function(){var n=this.props,r=n.style,i=n.className,a=n.event,c=n.selected,m=n.isAllDay,u=n.onSelect,d=n.onDoubleClick,h=n.onKeyPress,p=n.localizer,b=n.continuesPrior,w=n.continuesAfter,v=n.accessors,C=n.getters,R=n.children,I=n.components,z=I.event,ie=I.eventWrapper,te=n.slotStart,O=n.slotEnd,A=(0,$C.default)(n,GC);delete A.resizable;var x=v.title(a),E=v.tooltip(a),T=v.end(a),L=v.start(a),P=v.allDay(a),k=m||P||p.diff(L,p.ceil(T,"day"),"day")>1,ke=C.eventProp(a,L,T,c),Re=Eo.default.createElement("div",{className:"rbc-event-content",title:E||void 0},z?Eo.default.createElement(z,{event:a,continuesPrior:b,continuesAfter:w,title:x,isAllDay:P,localizer:p,slotStart:te,slotEnd:O}):x);return Eo.default.createElement(ie,Object.assign({},this.props,{type:"date"}),Eo.default.createElement("div",Object.assign({},A,{style:(0,rp.default)((0,rp.default)({},ke.style),r),className:(0,YC.default)("rbc-event",i,ke.className,{"rbc-selected":c,"rbc-event-allday":k,"rbc-event-continues-prior":b,"rbc-event-continues-after":w}),onClick:function(Ie){return u&&u(a,Ie)},onDoubleClick:function(Ie){return d&&d(a,Ie)},onKeyDown:function(Ie){return h&&h(a,Ie)}}),typeof R=="function"?R(Re):Re))}}])}(Eo.default.Component);sc.default=XC;var Fr={},JC=zs.default;Object.defineProperty(Fr,"__esModule",{value:!0});Fr.dateCellSelection=sV;Fr.getSlotAtX=fb;Fr.isSelected=eV;Fr.pointInBox=tV;Fr.slotWidth=Pu;var ZC=JC(nN);function eV(t,e){return!t||e==null?!1:(0,ZC.default)(t,e)}function Pu(t,e){var s=t.right-t.left,n=s/e;return n}function fb(t,e,s,n){var r=Pu(t,n);return s?n-1-Math.floor((e-t.left)/r):Math.floor((e-t.left)/r)}function tV(t,e){var s=e.x,n=e.y;return n>=t.top&&n<=t.bottom&&s>=t.left&&s<=t.right}function sV(t,e,s,n,r){var i=-1,a=-1,c=n-1,m=Pu(e,n),u=fb(e,s.x,r,n),d=e.top<s.y&&e.bottom>s.y,h=e.top<t.y&&e.bottom>t.y,p=t.y>e.bottom,b=e.top>t.y,w=s.top<e.top&&s.bottom>e.bottom;return w&&(i=0,a=c),d&&(b?(i=0,a=u):p&&(i=u,a=c)),h&&(i=a=r?c-Math.floor((t.x-e.left)/m):Math.floor((t.x-e.left)/m),d?u<i?i=u:a=u:t.y<s.y?a=c:i=0),{startIdx:i,endIdx:a}}var ju=zs.default;Object.defineProperty(tc,"__esModule",{value:!0});tc.default=void 0;var Pn=ju(gp),ip=ju(D),nV=ju(sc),rV=Fr;tc.default={propTypes:{slotMetrics:Pn.default.object.isRequired,selected:Pn.default.object,isAllDay:Pn.default.bool,accessors:Pn.default.object.isRequired,localizer:Pn.default.object.isRequired,components:Pn.default.object.isRequired,getters:Pn.default.object.isRequired,onSelect:Pn.default.func,onDoubleClick:Pn.default.func,onKeyPress:Pn.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,s){var n=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,a=e.onSelect,c=e.onDoubleClick,m=e.onKeyPress,u=e.localizer,d=e.slotMetrics,h=e.components,p=e.resizable,b=d.continuesPrior(s),w=d.continuesAfter(s);return ip.default.createElement(nV.default,{event:s,getters:i,localizer:u,accessors:r,components:h,onSelect:a,onDoubleClick:c,onKeyPress:m,continuesPrior:b,continuesAfter:w,slotStart:d.first,slotEnd:d.last,selected:(0,rV.isSelected)(s,n),resizable:p})},renderSpan:function(e,s,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(s)/e*100+"%";return ip.default.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Or=zs.default;Object.defineProperty(ec,"__esModule",{value:!0});ec.default=void 0;var iV=Or(Ur),oV=Or(mi),aV=Or(ui),lV=Or(ro),cV=Or(io),mV=Or(ha),op=Or(D),Za=Or(tc),pb=function(t){function e(){return(0,oV.default)(this,e),(0,lV.default)(this,e,arguments)}return(0,cV.default)(e,t),(0,aV.default)(e,[{key:"render",value:function(){var n=this,r=this.props,i=r.segments,a=r.slotMetrics.slots,c=r.className,m=1;return op.default.createElement("div",{className:(0,mV.default)(c,"rbc-row")},i.reduce(function(u,d,h){var p=d.event,b=d.left,w=d.right,v=d.span,C="_lvl_"+h,R=b-m,I=Za.default.renderEvent(n.props,p);return R&&u.push(Za.default.renderSpan(a,R,"".concat(C,"_gap"))),u.push(Za.default.renderSpan(a,v,C,I)),m=w+1,u},[]))}}])}(op.default.Component);pb.defaultProps=(0,iV.default)({},Za.default.defaultProps);ec.default=pb;var nr={},hb=zs.default;Object.defineProperty(nr,"__esModule",{value:!0});nr.endOfRange=gb;nr.eventLevels=fV;nr.eventSegments=dV;nr.inRange=pV;nr.segsOverlap=yb;nr.sortEvents=bm;nr.sortWeekEvents=hV;var Pc=hb(db),uV=hb(rN);function gb(t){var e=t.dateRange,s=t.unit,n=s===void 0?"day":s,r=t.localizer;return{first:e[0],last:r.add(e[e.length-1],1,n)}}function dV(t,e,s,n){var r=gb({dateRange:e,localizer:n}),i=r.first,a=r.last,c=n.diff(i,a,"day"),m=n.max(n.startOf(s.start(t),"day"),i),u=n.min(n.ceil(s.end(t),"day"),a),d=(0,uV.default)(e,function(p){return n.isSameDate(p,m)}),h=n.diff(m,u,"day");return h=Math.min(h,c),h=Math.max(h-n.segmentOffset,1),{event:t,span:h,left:d+1,right:Math.max(d+h,1)}}function fV(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s,n,r,i=[],a=[];for(s=0;s<t.length;s++){for(r=t[s],n=0;n<i.length&&yb(r,i[n]);n++);n>=e?a.push(r):(i[n]||(i[n]=[])).push(r)}for(s=0;s<i.length;s++)i[s].sort(function(c,m){return c.left-m.left});return{levels:i,extra:a}}function pV(t,e,s,n,r){var i={start:n.start(t),end:n.end(t)},a={start:e,end:s};return r.inEventRange({event:i,range:a})}function yb(t,e){return e.some(function(s){return s.left<=t.right&&s.right>=t.left})}function hV(t,e,s){var n=(0,Pc.default)(t),r=[],i=[];n.forEach(function(m){var u=e.start(m),d=e.end(m);s.daySpan(u,d)>1?r.push(m):i.push(m)});var a=r.sort(function(m,u){return bm(m,u,e,s)}),c=i.sort(function(m,u){return bm(m,u,e,s)});return[].concat((0,Pc.default)(a),(0,Pc.default)(c))}function bm(t,e,s,n){var r={start:s.start(t),end:s.end(t),allDay:s.allDay(t)},i={start:s.start(e),end:s.end(e),allDay:s.allDay(e)};return n.sortEvents({evtA:r,evtB:i})}var gV=Ty.default,qr=zs.default;Object.defineProperty(Zl,"__esModule",{value:!0});Zl.default=void 0;var Ua=qr(Ur),yV=qr(db),bV=qr(mi),NV=qr(ui),xV=qr(ro),vV=qr(io),Ha=qr(D),_V=qr(ec),Li=gV(Cn),DV=nr,dr=Fr,Ma=sr,kV=di,bb=function(t){function e(){var s;(0,bV.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return s=(0,xV.default)(this,e,[].concat(r)),s.handleMove=function(a,c,m){if(!(0,dr.pointInBox)(c,a))return s.reset();var u=s.context.draggable.dragAndDropAction.event||m,d=s.props,h=d.accessors,p=d.slotMetrics,b=d.rtl,w=d.localizer,v=(0,dr.getSlotAtX)(c,a.x,b,p.slots),C=p.getDateForSlot(v),R=(0,Ma.eventTimes)(u,h,w),I=R.start,z=R.duration;I=w.merge(C,I);var ie=w.add(I,z,"milliseconds");s.update(u,I,ie)},s.handleDropFromOutside=function(a,c){if(s.context.draggable.onDropFromOutside){var m=s.props,u=m.slotMetrics,d=m.rtl,h=m.localizer,p=(0,dr.getSlotAtX)(c,a.x,d,u.slots),b=u.getDateForSlot(p);s.context.draggable.onDropFromOutside({start:b,end:h.add(b,1,"day"),allDay:!1})}},s.handleDragOverFromOutside=function(a,c){var m=s.context.draggable.dragFromOutsideItem?s.context.draggable.dragFromOutsideItem():null;m&&s.handleMove(a,c,m)},s._selectable=function(){var a=s.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),c=a.closest(".rbc-month-view, .rbc-time-view"),m=a.classList.contains("rbc-month-row"),u=s._selector=new Li.default(function(){return c},{validContainers:(0,yV.default)(m?[]:[".rbc-day-slot",".rbc-allday-cell"])});u.on("beforeSelect",function(d){var h=s.props.isAllDay,p=s.context.draggable.dragAndDropAction.action,b=(0,Li.getBoundsForNode)(a),w=(0,dr.pointInBox)(b,d);return p==="move"||p==="resize"&&(!h||w)}),u.on("selecting",function(d){var h=(0,Li.getBoundsForNode)(a),p=s.context.draggable.dragAndDropAction;p.action==="move"&&s.handleMove(d,h),p.action==="resize"&&s.handleResize(d,h)}),u.on("selectStart",function(){return s.context.draggable.onStart()}),u.on("select",function(d){var h=(0,Li.getBoundsForNode)(a);s.state.segment&&((0,dr.pointInBox)(h,d)?s.handleInteractionEnd():s.reset())}),u.on("dropFromOutside",function(d){if(s.context.draggable.onDropFromOutside){var h=(0,Li.getBoundsForNode)(a);(0,dr.pointInBox)(h,d)&&s.handleDropFromOutside(d,h)}}),u.on("dragOverFromOutside",function(d){if(s.context.draggable.dragFromOutsideItem){var h=(0,Li.getBoundsForNode)(a);s.handleDragOverFromOutside(d,h)}}),u.on("click",function(){return s.context.draggable.onEnd(null)}),u.on("reset",function(){s.reset(),s.context.draggable.onEnd(null)})},s.handleInteractionEnd=function(){var a=s.props,c=a.resourceId,m=a.isAllDay,u=s.state.segment.event;s.reset(),s.context.draggable.onEnd({start:u.start,end:u.end,resourceId:c,isAllDay:m})},s._teardownSelectable=function(){s._selector&&(s._selector.teardown(),s._selector=null)},s.state={},s.ref=Ha.default.createRef(),s}return(0,vV.default)(e,t),(0,NV.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(n,r,i){var a=(0,DV.eventSegments)((0,Ua.default)((0,Ua.default)({},n),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Ma.dragAccessors,this.props.localizer),c=this.state.segment;c&&a.span===c.span&&a.left===c.left&&a.right===c.right||this.setState({segment:a})}},{key:"handleResize",value:function(n,r){var i=this.context.draggable.dragAndDropAction,a=i.event,c=i.direction,m=this.props,u=m.accessors,d=m.slotMetrics,h=m.rtl,p=m.localizer,b=(0,Ma.eventTimes)(a,u,p),w=b.start,v=b.end,C=(0,dr.getSlotAtX)(r,n.x,h,d.slots),R=d.getDateForSlot(C),I=(0,dr.pointInBox)(r,n);if(c==="RIGHT"){if(I){if(d.last<w)return this.reset();p.eq(p.startOf(v,"day"),v)?v=p.add(R,1,"day"):v=R}else if(p.inRange(w,d.first,d.last)||r.bottom<n.y&&+d.first>+w)v=p.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var z=u.end(a);v=p.merge(v,z),p.lt(v,w)&&(v=z)}else if(c==="LEFT"){if(I){if(d.first>v)return this.reset();w=R}else if(p.inRange(v,d.first,d.last)||r.top>n.y&&p.lt(d.last,v))w=p.add(d.first,-1,"milliseconds");else{this.reset();return}var ie=u.start(a);w=p.merge(w,ie),p.gt(w,v)&&(w=ie)}this.update(a,w,v)}},{key:"render",value:function(){var n=this.props,r=n.children,i=n.accessors,a=this.state.segment;return Ha.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,a&&Ha.default.createElement(_V.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[a],accessors:(0,Ua.default)((0,Ua.default)({},i),Ma.dragAccessors)})))}}])}(Ha.default.Component);bb.contextType=kV.DnDContext;Zl.default=bb;var Vn=zs.default;Object.defineProperty(Vu,"__esModule",{value:!0});Vu.default=RV;var Fa=Vn(Ur),AV=Vn(wu),EV=Vn(mi),CV=Vn(ui),VV=Vn(ro),wV=Vn(io),jc=Vn(D),SV=Vn(ha),IV=Vn(Yl),LV=Vn(Gl),PV=Vn(Zl),jV=sr,TV=di,BV=["selectable","elementProps","components"];function RV(t){var e=function(s){function n(){var r;(0,EV.default)(this,n);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return r=(0,VV.default)(this,n,[].concat(a)),r.defaultOnDragOver=function(m){m.preventDefault()},r.handleBeginAction=function(m,u,d){r.setState({event:m,action:u,direction:d});var h=r.props.onDragStart;h&&h({event:m,action:u,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(m){var u=r.state,d=u.action,h=u.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),m!=null)){m.event=h;var p=r.props,b=p.onEventDrop,w=p.onEventResize;d==="move"&&b&&b(m),d==="resize"&&w&&w(m)}},r.state={interacting:!1},r}return(0,wV.default)(n,s),(0,CV.default)(n,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,a=i.selectable,c=i.elementProps,m=i.components,u=(0,AV.default)(i,BV),d=this.state.interacting;delete u.onEventDrop,delete u.onEventResize,u.selectable=a?"ignoreEvents":!1,this.components=(0,jV.mergeComponents)(m,{eventWrapper:IV.default,eventContainerWrapper:LV.default,weekWrapper:PV.default});var h=this.props.onDropFromOutside?(0,Fa.default)((0,Fa.default)({},c),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):c;u.className=(0,SV.default)(u.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var p=this.getDnDContextValue();return jc.default.createElement(TV.DnDContext.Provider,{value:p},jc.default.createElement(t,Object.assign({},u,{elementProps:h,components:this.components})))}}])}(jc.default.Component);return e.defaultProps=(0,Fa.default)((0,Fa.default)({},t.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var UV=zs.default;Object.defineProperty(Cu,"__esModule",{value:!0});var Nb=Cu.default=void 0,HV=UV(Vu);Nb=Cu.default=HV.default;const pr={async getAllProcesses(){try{const t=Fe(se,"processes"),e=vt(t,is("order","asc")),s=await At(e);return s.empty?this.getDefaultProcesses():s.docs.map(n=>{const r=n.data();return{id:parseInt(n.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(t){return console.error("[Firestore]    :",t),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,s)=>({id:s+1,name:e,order:s,isDefault:!0}))},async createProcess(t,e){try{const s=Fe(se,"processes"),n=await At(s);let r=0;n.docs.forEach(m=>{const u=parseInt(m.id);!isNaN(u)&&u>r&&(r=u)});const i=r+1,a=we(se,"processes",String(i)),c=new Date().toISOString();return await ii(a,{name:t,order:e,isDefault:!1,createdAt:c,updatedAt:ns()}),console.log(" [Firestore]   :",i),{id:i,name:t,order:e,isDefault:!1,createdAt:c}}catch(s){throw console.error("[Firestore]   :",s),new Error(`  : ${s.message||"   "}`)}},async updateProcess(t,e){try{const s=we(se,"processes",String(t)),n=await It(s);if(!n.exists())throw new Error("   .");const r=n.data(),i={updatedAt:ns()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await Rt(s,i),console.log(" [Firestore]   :",t),{id:t,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(s){throw console.error("[Firestore]   :",s),new Error(`  : ${s.message||"   "}`)}},async deleteProcess(t){try{const e=we(se,"processes",String(t));await Us(e),console.log(" [Firestore]   :",t)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(t){try{const e=t.map((s,n)=>{const r=we(se,"processes",String(s));return Rt(r,{order:n,updatedAt:ns()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(t){const e=Fe(se,"processes"),s=vt(e,is("order","asc"));return dn(s,r=>{if(r.empty){t(pr.getDefaultProcesses());return}const i=r.docs.map(a=>{const c=a.data();return{id:parseInt(a.id)||0,name:c.name||"",order:c.order||0,isDefault:c.isDefault||!1}});t(i)})}},MV={getAllProcesses:()=>pr.getAllProcesses(),createProcess:(t,e)=>pr.createProcess(t,e),updateProcess:(t,e)=>pr.updateProcess(t,e),deleteProcess:t=>pr.deleteProcess(t),reorderProcesses:t=>pr.reorderProcesses(t),subscribeToProcesses:pr.subscribeToProcesses,getDefaultProcesses:pr.getDefaultProcesses},FV=Nb(iN),OV=vE;nt.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:t=>t<12?"":"",week:{dow:0,doy:1}});nt.locale("ko");const qV=oN(nt),ap=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],$V=at.memo(({onSave:t,onCancel:e,processList:s})=>{const[n,r]=D.useState(""),i=()=>{const u=window.innerWidth,d=window.innerHeight;return u>=768&&u<1024||u>=1024&&d>u},[a,c]=D.useState(i);D.useEffect(()=>{const u=()=>c(i());return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const m=a?"16px":"18px";return o.jsxDEV("div",{className:"w-full",onClick:u=>u.stopPropagation(),style:{padding:a?"2px 3px":"6px 0",minHeight:a?"28px":"32px"},children:[o.jsxDEV("input",{type:"text",list:"process-suggestions",value:n,onChange:u=>r(u.target.value),onBlur:()=>{n.trim()?t(n.trim()):e()},onKeyDown:u=>{u.stopPropagation(),u.key==="Enter"?n.trim()?t(n.trim()):e():u.key==="Escape"&&e()},onClick:u=>u.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:m,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),s&&o.jsxDEV("datalist",{id:"process-suggestions",children:s.map(u=>o.jsxDEV("option",{value:u},u,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),lp=t=>t,Oo={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},WV=at.memo(({date:t,label:e,filteredEvents:s,selectedDate:n,user:r,isMobileView:i})=>{const a=nt(t).format("YYYY-MM-DD"),c=Oo[a],m=!!Oo[a],u=n&&nt(t).isSame(n,"day"),d=s.filter(O=>nt(O.start).isSame(t,"day")),h=d.length,p=d.filter(O=>O.assignedTo&&O.assignedTo.includes((r==null?void 0:r.name)||"")).length,b=h-p,w=e.replace(/^0/,""),v=t.getDay()===0,C=t.getDay()===6;let R="#000000";m||v?R="#dc2626":C&&(R="#3b82f6");const I=nt(t).isSame(nt(),"day");let z="#d1d5db";m||v?z="#fecaca":C&&(z="#bfdbfe");const ie=w.length===2,te=i?{backgroundColor:"transparent",color:R,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:I?"700":"400",border:u?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:R,fontWeight:I?"700":"400",paddingLeft:ie?"0px":"4px",...I&&{backgroundColor:z,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return o.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?o.jsxDEV("span",{style:te,children:[o.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),h>0&&o.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:p}).map((O,A)=>o.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:b}).map((O,A)=>o.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{style:te,children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),c&&o.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:c},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),zV=at.memo(({event:t,user:e,filterProject:s,isEditing:n,editTitle:r,onEditTitleChange:i,onEditSave:a,onEditDelete:c,onEditCancel:m,onHoverDelete:u,onDeleteAction:d,processList:h})=>{const p=s&&s!=="all",b=t.assignedTo||[],[w,v]=D.useState(!1),C=at.useRef(null),R=()=>{const ye=window.innerWidth,Ie=window.innerHeight;return ye>=768&&ye<1024||ye>=1024&&Ie>ye},[I,z]=D.useState(R),[ie,te]=D.useState(!1);at.useRef(null),at.useRef(!1);const[O,A]=D.useState(r||""),x=at.useRef(n);D.useEffect(()=>{n&&!x.current&&r!==void 0&&A(r),x.current=n},[n,r]);const E=e!=null&&e.name?e.name.slice(-2):null,T=E&&["",""].includes(E),L=E&&["","",""].includes(E),P=(e==null?void 0:e.name)&&(b.includes(e.name)||b.includes("HV LAB")||b.includes("")&&L||b.includes("")&&T);D.useEffect(()=>{const ye=()=>{z(R())};return window.addEventListener("resize",ye),()=>window.removeEventListener("resize",ye)},[]);const k=ye=>{A(ye)},ke=()=>{O!=null&&O.trim()&&a&&(i&&i(O),a()),m&&m()},Re=ye=>{ye.stopPropagation(),(ye.key==="Enter"||ye.key==="Escape")&&ye.currentTarget.blur()};return I?o.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{te(!0),v(!0)},onMouseLeave:()=>{te(!1),v(!1)},style:{padding:p?"2px 3px":"1px 3px",minHeight:p?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[w&&p&&u&&!t.isASVisit&&!t.isExpectedPayment&&o.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:o.jsxDEV("button",{ref:C,onMouseDown:ye=>{ye.stopPropagation(),ye.preventDefault(),d&&d(),u()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:p?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!p&&!t.isASVisit&&t.projectName?o.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",lp(t.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):o.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!p&&b.length>0&&o.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:b.map((ye,Ie)=>{const rt=ye==="HV LAB"||ye===""&&T||ye===""&&L||ye===(e==null?void 0:e.name);return o.jsxDEV(at.Fragment,{children:[o.jsxDEV("span",{style:{fontWeight:rt?"bold":"normal"},children:ye},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),Ie<b.length-1&&""]},ye,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),n?o.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:O,onChange:ye=>k(ye.target.value),onBlur:ke,onKeyDown:Re,onClick:ye=>ye.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):o.jsxDEV("div",{style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:P?"underline":"none",textDecorationColor:P?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:t.title,children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),ie&&o.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[o.jsxDEV("div",{className:"font-semibold mb-1",children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),t.projectName&&o.jsxDEV("div",{className:"opacity-90",children:[": ",t.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),b.length>0&&o.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",b.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):o.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:p?"32px":"18px",padding:p?"6px 0":"0"},children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!p&&!t.isASVisit&&t.projectName&&o.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",lp(t.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),n?o.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:O,onChange:ye=>k(ye.target.value),onBlur:ke,onKeyDown:Re,onClick:ye=>ye.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:p?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):o.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:p?"18px":"12px",textDecoration:P?"underline":"none",textDecorationColor:P?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!p&&b.length>0&&o.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:b.map((ye,Ie)=>{const rt=ye==="HV LAB"||ye===""&&T||ye===""&&L||ye===(e==null?void 0:e.name);return o.jsxDEV(at.Fragment,{children:[o.jsxDEV("span",{className:rt?"font-bold":"",children:ye},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),Ie<b.length-1&&""]},ye,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),w&&p&&u&&!t.isASVisit&&!t.isExpectedPayment&&o.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:o.jsxDEV("button",{ref:C,onMouseDown:ye=>{ye.stopPropagation(),ye.preventDefault(),d&&d(),u()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),h&&n&&o.jsxDEV("datalist",{id:"process-suggestions-edit",children:h.map(ye=>o.jsxDEV("option",{value:ye},ye,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),KV=()=>{const{schedules:t,setSchedules:e,addSchedule:s,deleteSchedule:n,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:a,deleteScheduleFromAPI:c,asRequests:m,updateASRequestInAPI:u,loadASRequestsFromAPI:d,constructionPayments:h,updateConstructionPaymentInAPI:p}=Ir(),{user:b}=Rr(),w=Ql(),[v,C]=D.useState(!1);D.useEffect(()=>{const N=()=>{const U=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;C(U)};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]);const R=N=>!N||N==="-"?"":v?N:pm(N),I=b!=null&&b.name?b.name.slice(-2):null;console.log(" Current user:",b==null?void 0:b.name,"Short name:",I);const z=at.useRef(!1);D.useEffect(()=>{z.current||(z.current=!0,r().catch(N=>{console.error("Failed to load schedules:",N),ee.error("  ")}))},[r]);const[ie,te]=D.useState([]);D.useEffect(()=>{const N=async U=>{if((U.ctrlKey||U.metaKey)&&U.key==="z"){const Y=U.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(ie.length>0){U.preventDefault();const Q=ie[ie.length-1];try{const le=Q.type==="as_visit"||Q.type==="expected_payment"?"other":Q.type;await i({id:"",title:Q.originalTitle||Q.title,start:Q.start,end:Q.end,type:le,project:Q.originalProjectName||Q.projectName,attendees:Q.assignedTo||[],time:Q.time,description:Q.description}),te(he=>he.slice(0,-1)),ee.success(" ")}catch(le){console.error("  :",le),ee.error("  ")}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[ie,i]);const[O,A]=D.useState([]),[x,E]=D.useState(!1),[T,L]=D.useState(""),[P,k]=D.useState(null),[ke,Re]=D.useState(""),[ye,Ie]=D.useState(!1),[rt,Lt]=D.useState(null),[Ht,me]=D.useState(null),He=D.useCallback(async()=>{Ie(!0);try{const N=await MV.getAllProcesses();A(N)}catch(N){console.error("   :",N),A([])}finally{Ie(!1)}},[]);D.useEffect(()=>{He()},[He]);const Ge=D.useMemo(()=>O.length>0?O.map(N=>N.name):OV,[O]),xt=async()=>{if(T.trim())try{const N=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:T.trim()})});if(N.ok)L(""),He(),ee.success(" ");else{const U=await N.json();ee.error(U.error||"  ")}}catch(N){console.error("  :",N),ee.error("  ")}},fe=async()=>{if(!(!P||!ke.trim()))try{const N=await fetch(`/api/processes/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ke.trim()})});if(N.ok)k(null),Re(""),He(),ee.success(" ");else{const U=await N.json();ee.error(U.error||"  ")}}catch(N){console.error("  :",N),ee.error("  ")}},qe=async N=>{if(confirm("   ?"))try{const U=await fetch(`/api/processes/${N}`,{method:"DELETE"});if(U.ok)He(),ee.success(" ");else{const Y=await U.json();ee.error(Y.error||"  ")}}catch(U){console.error("  :",U),ee.error("  ")}},ze=N=>{Lt(N)},ft=(N,U)=>{N.preventDefault(),rt!==null&&rt!==U&&me(U)},tt=async()=>{if(rt!==null&&Ht!==null&&rt!==Ht){const N=[...O],[U]=N.splice(rt,1);N.splice(Ht,0,U),A(N);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:N.map(Q=>({id:Q.id}))})})).ok||(He(),ee.error("  "))}catch(Y){console.error("  :",Y),He(),ee.error("  ")}}Lt(null),me(null)},Bt=N=>{const U=w.findIndex(Y=>Y.name===N);return U>=0?ap[U%ap.length]:"#e8e2ea"},ds=w.map(N=>N.name),W=t.filter(N=>!N.asRequestId).filter(N=>(b==null?void 0:b.name)===""?N.project===""||ds.includes(N.project):!0).map(N=>{const U=w.find(pe=>pe.name===N.project);let Y=N.project===""?"[]":N.project;if(U&&N.project!==""){const pe=U.name.length>2?U.name.substring(0,2):U.name,gt=(U.location||"").match(/([A-Za-z]?\d+)/),ps=gt?gt[1]:"";Y=ps?`${pe}_${ps}`:pe}const Q=N.time,le=Q&&Q!=="-"?` - ${R(Q)}`:"",he=N.attendees||[];return{id:N.id,title:N.title+le,originalTitle:N.title,start:N.start,end:N.end,projectId:(U==null?void 0:U.id)||"",projectName:Y||"",originalProjectName:N.project||"",type:N.type||"other",phase:"",assignedTo:he,priority:"medium",allDay:!Q||Q==="-",color:Bt(N.project||""),isASVisit:!1,time:Q,description:N.description}}),Ce=m.filter(N=>N.scheduledVisitDate).filter(N=>(b==null?void 0:b.name)===""?ds.includes(N.project):!0).map(N=>{const U=N.scheduledVisitTime,Y=U&&U!=="-"?` - ${R(U)}`:"",Q=w.find(pe=>pe.name===N.project);let le=N.project;if(Q){const pe=Q.name.length>2?Q.name.substring(0,2):Q.name,gt=(Q.location||"").match(/([A-Za-z]?\d+)/),ps=gt?gt[1]:"";le=ps?`${pe}_${ps}`:pe}const he=`[AS] ${le}`;return{id:`as-${N.id}`,title:he+Y,originalTitle:he,start:N.scheduledVisitDate,end:N.scheduledVisitDate,projectId:(Q==null?void 0:Q.id)||"",projectName:le,originalProjectName:N.project,type:"as_visit",phase:"",assignedTo:N.assignedTo?Array.isArray(N.assignedTo)?N.assignedTo:N.assignedTo.split(",").map(pe=>pe.trim()):[],priority:"high",allDay:!U||U==="-",color:"#FEF3C7",isASVisit:!0,time:U,description:N.description}}),Me=(b==null?void 0:b.role)==="manager"?h.flatMap(N=>{var he,pe,ot,gt,ps,wt,St,es;const U=w.find(ks=>ks.name===N.project);if(!U){const ks=[],Et=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),Yt=new Set(N.payments.flatMap(cs=>{var Ft;return((Ft=cs.type)==null?void 0:Ft.split(", ").map(qt=>qt.trim()))||[]}));return!Yt.has("")&&((he=N.expectedPaymentDates)!=null&&he.contract)&&ks.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Et*.1).toLocaleString()}`}),!Yt.has("")&&((pe=N.expectedPaymentDates)!=null&&pe.start)&&ks.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Et*.4).toLocaleString()}`}),!Yt.has("")&&((ot=N.expectedPaymentDates)!=null&&ot.middle)&&ks.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Et*.4).toLocaleString()}`}),!Yt.has("")&&((gt=N.expectedPaymentDates)!=null&&gt.final)&&ks.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Et*.1).toLocaleString()}`}),ks}if(!U.startDate||!U.endDate)return[];const Y=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),Q=new Set(N.payments.flatMap(ks=>{var Et;return((Et=ks.type)==null?void 0:Et.split(", ").map(Yt=>Yt.trim()))||[]})),le=[];return!Q.has("")&&((ps=N.expectedPaymentDates)!=null&&ps.contract)&&le.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!Q.has("")&&((wt=N.expectedPaymentDates)!=null&&wt.start)&&le.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!Q.has("")&&((St=N.expectedPaymentDates)!=null&&St.middle)&&le.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!Q.has("")&&((es=N.expectedPaymentDates)!=null&&es.final)&&le.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),le}):[],Le=[...W,...Ce,...Me],$e=D.useCallback(N=>{if(!(b!=null&&b.name))return!1;const U=N.assignedTo||[],Y=b.name.slice(-2),Q=["",""].includes(Y),le=["","",""].includes(Y);return U.includes(b.name)||U.includes("HV LAB")||U.includes("")&&le||U.includes("")&&Q},[b==null?void 0:b.name]),bt=(N,U)=>{if(!U)return[...N].sort((le,he)=>{const pe=$e(le),ot=$e(he);return pe&&!ot?-1:!pe&&ot?1:le.start.getTime()-he.start.getTime()});const Y=new Map;N.forEach(le=>{const he=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||he){const pe=`single_${le.id}`;Y.set(pe,[le])}else{const pe=le.start.toISOString().split("T")[0],ot=[...le.assignedTo].sort().join(","),gt=`${pe}_${le.projectName}_${ot}`;Y.has(gt)||Y.set(gt,[]),Y.get(gt).push(le)}});const Q=[];return Y.forEach(le=>{if(le.length===1)Q.push(le[0]);else{const he=le[0],pe=le.map(St=>St.originalTitle||St.title),ot=[...new Set(pe)],gt=le.map(St=>{const es=St.originalTitle||St.title;return es.startsWith(he.projectName+" - ")?es.substring(he.projectName.length+3):es}),ps=[...new Set(gt)],wt={...he,id:le[0].id,title:ps.join(", "),originalTitle:ot.join(", "),description:le.map(St=>St.description||St.originalTitle||St.title).join(`
`),assignedTo:[...new Set(le.flatMap(St=>St.assignedTo))],mergedEventIds:le.map(St=>St.id)};Q.push(wt)}}),Q.sort((le,he)=>{const pe=$e(le),ot=$e(he);return pe&&!ot?-1:!pe&&ot?1:le.start.getTime()-he.start.getTime()})},[Ot,mt]=D.useState("month"),[j,$]=D.useState(new Date),[X,ge]=D.useState(!1),[ae,de]=D.useState(null),[Ee,Ke]=D.useState(null),st=`schedule_filterProject_${(b==null?void 0:b.id)||"guest"}`,[Ne,fs]=D.useState(()=>{const N=localStorage.getItem(st);return N||((b==null?void 0:b.name)===""&&w.length>0?w[0].name:"all")});D.useEffect(()=>{localStorage.setItem(st,Ne)},[Ne,st]),D.useCallback(()=>{document.body.classList.add("printing-schedule");const N=Ne==="all"?" ":Ne,U=nt(j).format("YYYY MM"),Y=document.title;document.title=`${N} - ${U} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[Ne,j]);const Pt=bt(Le,Ne==="all"),[it,ss]=D.useState(window.innerWidth<768?new Date:null),[V,oe]=D.useState(null),De=at.useRef(null),Be=at.useRef(!1),[ue,jt]=D.useState(null),Nt=at.useRef(!1),zt=at.useRef(!1);D.useEffect(()=>{const N=Q=>{Q.key==="Control"&&(zt.current=!0)},U=Q=>{Q.key==="Control"&&(zt.current=!1)},Y=()=>{zt.current=!1};return window.addEventListener("keydown",N),window.addEventListener("keyup",U),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",N),window.removeEventListener("keyup",U),window.removeEventListener("blur",Y)}},[]),D.useEffect(()=>{if(!V)return;let N=null;const U=he=>{he.preventDefault(),he.dataTransfer&&(he.dataTransfer.dropEffect="copy")},Y=he=>{he.preventDefault(),he.dataTransfer&&(he.dataTransfer.dropEffect="copy");const ot=he.target.closest(".rbc-day-bg");N&&N!==ot&&(N.style.backgroundColor=""),ot&&(ot.style.backgroundColor="rgba(59, 130, 246, 0.15)",N=ot)},Q=()=>{N&&(N.style.backgroundColor="",N=null)},le=he=>{he.preventDefault(),N&&(N.style.backgroundColor="",N=null)};return document.addEventListener("dragenter",U),document.addEventListener("dragover",Y),document.addEventListener("dragend",Q),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",U),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",Q),document.removeEventListener("drop",le),N&&(N.style.backgroundColor="")}},[V]);const[pt,Xt]=D.useState(null),[Jt,Ss]=D.useState(null),[fn,Ks]=D.useState(""),[pn,$r]=D.useState(!1),[wn,en]=D.useState(null),[Sn,Bs]=D.useState(!1),[Is,g]=D.useState(""),[B,S]=D.useState(null),[M,H]=D.useState({x:0,y:0}),[G,q]=D.useState({x:0,y:0}),[F,Z]=D.useState(!1),re=8;D.useEffect(()=>{if(!B)return;const N=Y=>{H({x:Y.clientX,y:Y.clientY});const Q=Math.abs(Y.clientX-G.x),le=Math.abs(Y.clientY-G.y);(Q>re||le>re)&&Z(!0)},U=()=>{S(null),Z(!1)};return window.addEventListener("mousemove",N),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",U)}},[B,G]);const Se=at.useRef(!1),Xe=D.useCallback(async({event:N,start:U,end:Y})=>{if(N.isASVisit||N.isExpectedPayment){ee.error("    ");return}const Q=U instanceof Date?U:new Date(U),le=Y instanceof Date?Y:new Date(Y);if(zt.current)try{const pe=N.mergedEventIds||[N.id],ot=t.filter(gt=>pe.includes(gt.id));for(const gt of ot)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:gt.title,start:Q,end:le,project:gt.project,attendees:gt.attendees||[],time:gt.time,priority:gt.priority||"medium"});ee.success(" ")}catch(pe){console.error("  :",pe),ee.error("  ")}else{const pe=N.mergedEventIds||[N.id];try{for(const ot of pe)await a(ot,{start:Q,end:le})}catch(ot){console.error("  :",ot),ee.error("  "),r()}}},[t,a,i,r]),lt=D.useCallback(({event:N,action:U})=>{var Q;if(N.isASVisit||N.isExpectedPayment||N.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const le of Y)if((Q=le.textContent)!=null&&Q.includes(N.originalTitle||N.title)){const he=le.getBoundingClientRect();q({x:he.left,y:he.top}),H({x:he.left,y:he.top});break}Z(!1),S(N)},[]),xe=D.useCallback(async(N,U,Y=!1)=>{if(Ne==="all"){ee.error("  ");return}const Q={id:"",title:N,start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(Q)}catch(le){console.error("  :",le),ee.error("  ")}},[Ne,i,b]),Ue=D.useCallback(({start:N})=>{const U=V||De.current;U&&Ne!=="all"&&(Be.current=!0,Nt.current=!0,requestAnimationFrame(()=>{Nt.current=!1}),Xt(null),Ss(null),Ks(""),xe(U,N),requestAnimationFrame(()=>{oe(null),De.current=null,Be.current=!1}))},[V,Ne,xe]),Qt=D.useCallback(()=>{const N=V||De.current;return N?{title:N}:null},[V]),ls=D.useCallback(async N=>{if(!N.trim()||!pt||Ne==="all"){Xt(null);return}const U=pt;Xt(null);const Y={id:"",title:N.trim(),start:U,end:U,type:"construction",project:Ne,location:"",attendees:b!=null&&b.name?[b.name]:[],description:""};try{await i(Y)}catch(Q){console.error("  :",Q),ee.error("  ")}},[pt,Ne,i,b]),tn=D.useCallback(()=>{Xt(null)},[]),Zt=D.useCallback(async()=>{var N;if(!Jt||!fn.trim()){Ss(null),Ks("");return}try{const U=((N=Jt.mergedEventIds)==null?void 0:N[0])||Jt.id;await a(U,{title:fn.trim()})}catch(U){console.error("  :",U),ee.error("  ")}Ss(null),Ks("")},[Jt,fn,a]),Qs=D.useCallback(async N=>{te(Y=>[...Y,N]);const U=N.mergedEventIds||[N.id];ee.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(U.map(Y=>c(Y)))}catch(Y){console.error("  :",Y),ee.error("  "),te(Q=>Q.slice(0,-1))}Ss(null),Ks("")},[c]),Ys=Ne==="all"?Pt:Pt.filter(N=>(N.originalProjectName||N.projectName)===Ne),Tt=at.useMemo(()=>{const N=Ne!=="all",U=new Map;Ys.forEach(Q=>{const le=nt(Q.start).format("YYYY-MM-DD");U.has(le)||U.set(le,[]),U.get(le).push(Q)});const Y=[];return U.forEach(Q=>{if(N)Q.forEach((le,he)=>{const pe=nt(le.start).startOf("day").add(he,"milliseconds").toDate();Y.push({...le,start:pe,allDay:!1})});else{const le=[],he=[];Q.forEach(pe=>{$e(pe)?le.push(pe):he.push(pe)}),le.forEach((pe,ot)=>{const gt=nt(pe.start).startOf("day").add(ot,"milliseconds").toDate();Y.push({...pe,start:gt,allDay:!1})}),he.forEach((pe,ot)=>{const gt=nt(pe.start).startOf("day").add(1e3+ot,"milliseconds").toDate();Y.push({...pe,start:gt,allDay:!1})})}}),Y.sort((Q,le)=>Q.start.getTime()-le.start.getTime())},[Ys,$e,Ne]),Pe=at.useMemo(()=>{if(pt&&Ne!=="all"){const N=nt(pt).format("YYYY-MM-DD"),U=Tt.filter(he=>nt(he.start).format("YYYY-MM-DD")===N),Y=U.length>0?Math.max(...U.map(he=>he.start.getTime())):nt(pt).startOf("day").valueOf(),Q=new Date(Y+1),le={id:"__inline_add__",title:"",start:Q,end:Q,projectId:"",projectName:Ne,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Tt,le]}return Tt},[Tt,pt,Ne]);D.useEffect(()=>{(b==null?void 0:b.name)===""&&w.length>0&&(Ne==="all"||!w.find(N=>N.name===Ne))&&fs(w[0].name)},[w,b]),D.useEffect(()=>{const N=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(pe=>{pe.style.display="none",pe.style.visibility="hidden",pe.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(pe=>{pe.style.display="none",pe.style.visibility="hidden",pe.style.opacity="0",pe.style.pointerEvents="none",pe.style.position="absolute",pe.style.left="-9999px",pe.style.top="-9999px",pe.style.zIndex="-1"})};N();const U=new MutationObserver(N),Y=document.querySelector(".rbc-calendar");Y&&U.observe(Y,{childList:!0,subtree:!0});const Q=new MutationObserver(N);return Q.observe(document.body,{childList:!0,subtree:!0}),()=>{U.disconnect(),Q.disconnect()}},[Ot,j]);const[ve,Ze]=D.useState({date:null,projectId:"",title:""}),ht=at.useRef(!1),ut=at.useRef(null),je=N=>{if(Se.current){Se.current=!1;return}if(N.id==="__inline_add__")return;ht.current=!0,ut.current&&clearTimeout(ut.current);const U=Ne!=="all",Y=window.innerWidth<768;if(U&&!Y&&!N.isASVisit&&!N.isExpectedPayment)Xt(null),Ss(N),Ks(N.originalTitle||N.title);else{const Q={...N,title:N.originalTitle||N.title};Ke(null),de(Q),ge(!0)}ut.current=setTimeout(()=>{ht.current=!1,ut.current=null},300)},We=N=>{const U=window.innerWidth,Y=U<768,Q=U>=768&&U<1024,le=Ne==="all";if(Nt.current)return;if(Y){if(N.start){ss(N.start);const pe=document.querySelector(".md\\:hidden.mt-3.bg-white");pe&&pe.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const he=N.action==="click"||N.action==="select";if(!(Q&&!he)){if(le){ht.current=!1,Ss(null),Ks(""),Xt(null),Ke(N),de(null),ge(!0);return}if(!ht.current){if(ue){xe(ue,N.start,!0);return}Ss(null),Ks(""),Xt(N.start)}}},kt=async()=>{if(!ve.projectId||!ve.title.trim()){alert("  ");return}const N=w.find(U=>U.id===ve.projectId);if(!(!N||!ve.date))try{await i({id:Date.now().toString(),title:ve.title,start:ve.date,end:ve.date,type:"other",project:N.name,location:"",attendees:[],description:""}),Ze({date:null,projectId:"",title:""}),ss(null)}catch(U){console.error("Failed to add schedule:",U),ee.error("  ")}},_s=N=>{if(N.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let U=N.color||"#E0E7FF",Y="#1f2937";if(N.isASVisit)U="#E8F5E9",Y="#1f2937";else{const Q=N.assignedTo&&N.assignedTo.includes("HV LAB"),le=N.assignedTo&&N.assignedTo.includes("")&&I&&["",""].includes(I),he=N.assignedTo&&N.assignedTo.includes("")&&I&&["","",""].includes(I);N.assignedTo&&N.assignedTo.includes((b==null?void 0:b.name)||"")||Q||le||he?(U="#FEF3C7",Y="#1f2937"):N.color||(U="#e8e2ea")}return{style:{backgroundColor:U,"--event-bg-color":U,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},Ds=at.useCallback(N=>{const U=nt(N).format("YYYY-MM-DD"),Y=!!Oo[U],Q=it&&nt(N).isSame(it,"day"),le=window.innerWidth<768;let he="";Q&&(he+="selected-date "),Y&&(he+="holiday-date ");const pe=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:he.trim(),style:pe}},[it]),[ct,Wr]=D.useState(window.innerWidth<768);D.useEffect(()=>{const N=()=>{Wr(window.innerWidth<768)};return window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]),D.useEffect(()=>{const N=()=>{const U=it||new Date;Ke({start:U,end:U}),de(null),ge(!0)};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[it]);const rr=at.useCallback(({date:N,label:U})=>o.jsxDEV(WV,{date:N,label:U,filteredEvents:Pe,selectedDate:it,user:b,isMobileView:ct},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[Pe,it,b,ct]),ir=at.useRef(fn);ir.current=fn;const ga=at.useCallback(N=>{Ks(N)},[]),lo=at.useCallback(()=>{Ss(null),Ks("")},[]),ya=at.useCallback(({event:N})=>{if(N.id==="__inline_add__")return o.jsxDEV($V,{onSave:ls,onCancel:tn,processList:Ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const U=(Jt==null?void 0:Jt.id)===N.id||(Jt==null?void 0:Jt.mergedEventIds)&&Jt.mergedEventIds.includes(N.id);return o.jsxDEV(zV,{event:N,user:b,filterProject:Ne,isEditing:U,editTitle:U?ir.current:void 0,onEditTitleChange:U?ga:void 0,onEditSave:U?Zt:void 0,onEditDelete:U?()=>Qs(N):void 0,onEditCancel:U?lo:void 0,onHoverDelete:()=>Qs(N),onDeleteAction:()=>{Se.current=!0},processList:Ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[b,Ne,Jt,Zt,Qs,ls,tn,ga,lo,Ge]),nc=({onNavigate:N})=>{const[U,Y]=at.useState(!1),[Q,le]=at.useState(nt(j).year()),[he,pe]=at.useState(nt(j).month()),ot=window.innerWidth<768,gt=()=>{le(nt(j).year()),pe(nt(j).month()),Y(!0)},ps=()=>{$(nt().year(Q).month(he).toDate()),Y(!1)};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${ot?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("div",{className:"flex items-center space-x-1",children:[o.jsxDEV("button",{onClick:()=>N("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),o.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:gt,children:[o.jsxDEV("span",{children:nt(j).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),o.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ne==="all"?" ":Ne]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>N("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center space-x-2",children:o.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ne,onChange:wt=>{fs(wt.target.value),jt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(b==null?void 0:b.name)!==""&&o.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),w.filter(wt=>wt.status!=="completed").map(wt=>o.jsxDEV("option",{value:wt.name,children:wt.name},wt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),U&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("button",{onClick:()=>le(Q-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),o.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[Q,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),o.jsxDEV("button",{onClick:()=>le(Q+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4",children:o.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(wt=>{const St=he===wt-1,es=nt().year()===Q&&nt().month()===wt-1;return o.jsxDEV("button",{onClick:()=>pe(wt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${St?"bg-gray-900 text-white":es?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[wt,""]},wt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[o.jsxDEV("button",{onClick:()=>{$(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),o.jsxDEV("button",{onClick:ps,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},rc=()=>null,ic=D.useMemo(()=>({toolbar:nc,event:ya,month:{dateHeader:rr,showMore:rc}}),[rr,ya]),or=at.useMemo(()=>{if(!it)return[];let N;if(ct)N=Pe.filter(Y=>nt(Y.start).isSame(it,"day"));else{const Y=nt(it).startOf("week"),Q=nt(it).endOf("week");N=Pe.filter(le=>{const he=nt(le.start);return he.isSameOrAfter(Y,"day")&&he.isSameOrBefore(Q,"day")})}const U=[...N].sort((Y,Q)=>{const le=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),he=Y.assignedTo&&Y.assignedTo.includes("")&&I&&["",""].includes(I),pe=Y.assignedTo&&Y.assignedTo.includes("")&&I&&["","",""].includes(I),ot=Y.assignedTo&&I&&Y.assignedTo.includes(I)||Y.assignedTo&&(b==null?void 0:b.name)&&Y.assignedTo.includes(b.name)||le||he||pe,gt=Q.assignedTo&&Q.assignedTo.includes("HV LAB"),ps=Q.assignedTo&&Q.assignedTo.includes("")&&I&&["",""].includes(I),wt=Q.assignedTo&&Q.assignedTo.includes("")&&I&&["","",""].includes(I),St=Q.assignedTo&&I&&Q.assignedTo.includes(I)||Q.assignedTo&&(b==null?void 0:b.name)&&Q.assignedTo.includes(b.name)||gt||ps||wt;return ot&&!St?-1:!ot&&St?1:new Date(Y.start).getTime()-new Date(Q.start).getTime()});return console.log("Sorted events:",U.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:b==null?void 0:b.name,userShort:I}))),U},[it,Pe,b,I,ct]);return D.useEffect(()=>{const U=setTimeout(()=>{const Y=ct?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),Q=document.querySelectorAll(".rbc-month-row"),le=[];Q.forEach((Et,Yt)=>{const cs=Et.querySelectorAll(".rbc-date-cell");let Ft=0;cs.forEach(qt=>{const yt=qt.querySelector("button");let Kt=yt==null?void 0:yt.textContent;if(!Kt){const bn=qt.querySelector("span");Kt=bn==null?void 0:bn.textContent}if(Kt&&!isNaN(parseInt(Kt))){const bn=nt(j).date(parseInt(Kt)),In=Pe.filter(pi=>nt(pi.start).isSame(bn,"day"));Ft=Math.max(Ft,In.length)}}),le.push(Ft)});const he=Ne&&Ne!=="all",pe=100,ot=he?60:18,gt=25,ps=Math.floor((pe-gt)/ot),wt=le.length,St=pe*wt,es=le.map(Et=>Et<=ps?pe:gt+Et*ot+10),ks=es.reduce((Et,Yt)=>Et+Yt,0);if(ks>St){const Et=es.map((Ft,qt)=>({index:qt,height:Ft,overflow:Ft>pe})),Yt=Et.filter(Ft=>Ft.overflow).reduce((Ft,qt)=>Ft+(qt.height-pe),0),cs=Et.filter(Ft=>!Ft.overflow);if(cs.length>0){const Ft=St-Yt-cs.length*pe,qt=Math.max(50,pe+Ft/cs.length);Q.forEach((yt,Kt)=>{const In=es[Kt]>pe?es[Kt]:qt;yt.style.height=`${In}px`,yt.style.minHeight=`${In}px`})}else{const Ft=St/ks;Q.forEach((qt,yt)=>{const Kt=Math.max(80,es[yt]*Ft);qt.style.height=`${Kt}px`,qt.style.minHeight=`${Kt}px`})}}else{const Et=es.reduce((qt,yt)=>qt+(yt>pe?yt:0),0),Yt=es.filter(qt=>qt<=pe).length,cs=St-Et,Ft=Yt>0?cs/Yt:pe;Q.forEach((qt,yt)=>{const Kt=es[yt]>pe?es[yt]:Ft;qt.style.height=`${Kt}px`,qt.style.minHeight=`${Kt}px`})}Y.forEach(Et=>{const Yt=Et.querySelector("button");let cs=Yt==null?void 0:Yt.textContent;if(!cs){const Kt=Et.querySelector("span");cs=Kt==null?void 0:Kt.textContent}if(!cs||isNaN(parseInt(cs)))return;const Ft=nt(j).date(parseInt(cs)),qt=Pe.filter(Kt=>nt(Kt.start).isSame(Ft,"day"));qt.length>0?Et.setAttribute("data-event-count",qt.length.toString()):Et.removeAttribute("data-event-count");const yt=Ft.clone().toDate();if(it&&nt(yt).isSame(it,"day")?Et.classList.add("selected-date"):Et.classList.remove("selected-date"),ct){const Kt=Et,bn=Kt._mobileClickHandler;bn&&Et.removeEventListener("click",bn);const In=pi=>{if(pi.target.closest(".rbc-event"))return;const hi=Ft.clone().toDate();ss(hi);const Nn=document.querySelector(".md\\:hidden.mt-3.bg-white");Nn&&Nn.scrollIntoView({behavior:"smooth",block:"nearest"})};Kt._mobileClickHandler=In,Et.addEventListener("click",In,!0),Et.style.cursor="pointer",Et.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(U),ct&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(Q=>{const le=Q,he=le._mobileClickHandler;he&&(Q.removeEventListener("click",he),delete le._mobileClickHandler)})}},[Pe,j,ct,it,Ne]),o.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[ve.date&&o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:o.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[o.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:nt(ve.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),o.jsxDEV("select",{value:ve.projectId,onChange:N=>Ze({...ve,projectId:N.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:w.filter(N=>N.status!=="completed").map(N=>o.jsxDEV("option",{value:N.id,children:N.name},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:ve.title,onChange:N=>Ze({...ve,title:N.target.value}),onKeyPress:N=>{N.key==="Enter"&&kt()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:kt,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Ze({date:null,projectId:"",title:""}),ss(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),o.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[o.jsxDEV("div",{className:"flex gap-3",children:[Ne!=="all"&&!ct&&o.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[o.jsxDEV("button",{onClick:()=>E(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[o.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),ue&&o.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[o.jsxDEV("span",{className:"font-medium",children:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),o.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex flex-col gap-0.5",children:Ge.map(N=>o.jsxDEV("div",{draggable:!0,onClick:()=>{jt(ue===N?null:N)},onDragStart:U=>{Be.current=!1,jt(null),oe(N),De.current=N,U.dataTransfer.setData("text/plain",N),U.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Be.current||(oe(null),De.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${ue===N?"bg-blue-500 text-white ring-2 ring-blue-300":V===N?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),o.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ne!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:o.jsxDEV(FV,{localizer:qV,events:Pe,startAccessor:"start",endAccessor:"end",view:Ot,onView:mt,date:j,onNavigate:$,onSelectEvent:je,onSelectSlot:We,onEventDrop:Ne!=="all"?Xe:void 0,onDragStart:Ne!=="all"?lt:void 0,onDropFromOutside:Ne!=="all"?Ue:void 0,dragFromOutsideItem:Ne!=="all"?Qt:void 0,draggableAccessor:N=>Ne!=="all"&&N.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:_s,dayPropGetter:Ds,components:ic,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:N=>`+${N} `}},`calendar-${Ne}-${(it==null?void 0:it.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),it&&o.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:ct?nt(it).format("MM DD (ddd)"):`${nt(it).startOf("week").format("MM DD")} - ${nt(it).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Oo[nt(it).format("YYYY-MM-DD")]&&o.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Oo[nt(it).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[Ne!=="all"&&o.jsxDEV("button",{onClick:()=>Bs(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),o.jsxDEV("button",{onClick:()=>{ss(null),en(null),Bs(!1),g("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),o.jsxDEV("div",{children:or.length===0?o.jsxDEV("div",{className:"p-4",children:Ne!=="all"&&Sn?o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("input",{type:"text",value:Is,onChange:N=>g(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&Is.trim()){const U=it||new Date,Y={id:"",title:Is.trim(),start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{Bs(!1),g("")}).catch(Q=>{console.error("  :",Q),ee.error("  ")})}else N.key==="Escape"&&(Bs(!1),g(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{if(Is.trim()){const N=it||new Date,U={id:"",title:Is.trim(),start:N,end:N,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{Bs(!1),g("")}).catch(Y=>{console.error("  :",Y),ee.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{Bs(!1),g("")},className:"p-2 text-gray-400 hover:text-gray-600",children:o.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):o.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):o.jsxDEV("div",{children:[(()=>{const N=or.reduce((Y,Q)=>{const le=nt(Q.start).format("YYYY-MM-DD");return Y[le]||(Y[le]=[]),Y[le].push(Q),Y},{});return Object.keys(N).sort().map(Y=>o.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!ct&&o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:o.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:nt(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),o.jsxDEV("div",{className:"divide-y divide-gray-100",children:N[Y].map(Q=>{const le=Q.assignedTo&&Q.assignedTo.includes("HV LAB"),he=Q.assignedTo&&Q.assignedTo.includes("")&&I&&["",""].includes(I),pe=Q.assignedTo&&Q.assignedTo.includes("")&&I&&["","",""].includes(I),gt=Q.assignedTo&&(Q.assignedTo.includes((b==null?void 0:b.name)||"")||I&&Q.assignedTo.includes(I))||le||he||pe,ps=!Q.color&&!gt,wt=!Q.isASVisit&&!Q.isExpectedPayment;return o.jsxDEV("div",{onClick:()=>{const St={...Q,title:Q.originalTitle||Q.title};je(St)},className:`p-3 cursor-pointer ${gt?"bg-yellow-50":""}`,style:ps?{backgroundColor:"#f3f0f5"}:void 0,children:o.jsxDEV("div",{className:"flex items-start gap-2",children:[o.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:gt?"#FEF3C7":Q.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[o.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:Q.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),Q.assignedTo&&Q.assignedTo.length>0&&o.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(ks=>Q.assignedTo.includes(ks))?"":Q.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),Q.projectName&&Ne==="all"&&o.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:Q.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),wt?o.jsxDEV("button",{onClick:St=>{St.stopPropagation(),en(Q)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:o.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):o.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},Q.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ne!=="all"&&Sn&&o.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("input",{type:"text",value:Is,onChange:N=>g(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&Is.trim()){const U=it||new Date,Y={id:"",title:Is.trim(),start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{Bs(!1),g("")}).catch(Q=>{console.error("  :",Q),ee.error("  ")})}else N.key==="Escape"&&(Bs(!1),g(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{if(Is.trim()){const N=it||new Date,U={id:"",title:Is.trim(),start:N,end:N,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{Bs(!1),g("")}).catch(Y=>{console.error("  :",Y),ee.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{Bs(!1),g("")},className:"p-2 text-gray-400 hover:text-gray-600",children:o.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),ct&&Ne!=="all"&&o.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[o.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:Ge.map(N=>o.jsxDEV("button",{onClick:async()=>{const U=it||new Date;if(Ne!=="all"){const Y={id:"",title:N,start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(Y)}catch(Q){console.error("  :",Q),ee.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),X&&o.jsxDEV(dy,{event:ae,slotInfo:Ee,defaultProjectName:Ne!=="all"?Ne:void 0,onClose:()=>{ge(!1),de(null),Ke(null)},onSave:async N=>{console.log(" Schedule.tsx onSave called with newEvent:",N);try{if(ae)if(ae.id.startsWith("as-")){const U=ae.id.replace("as-","");let Y="";N.assignedTo&&Array.isArray(N.assignedTo)&&N.assignedTo.length>0?Y=N.assignedTo.join(", "):ae.assignedTo&&Array.isArray(ae.assignedTo)?Y=ae.assignedTo.join(", "):typeof ae.assignedTo=="string"&&(Y=ae.assignedTo),await u(U,{project:N.title||ae.title,assignedTo:Y,scheduledVisitDate:N.start,scheduledVisitTime:N.time||ae.time}),await d(),ge(!1)}else if(ae.id.startsWith("payment-")){const U=ae.id.split("-"),Y=U[1],Q=U[2],le=h.find(he=>he.id===Y);if(le){const he={...le.expectedPaymentDates};he[Q]=N.start,await p(Y,{expectedPaymentDates:he})}}else{console.log(" Updating schedule with projectId:",N.projectId,"projectName:",N.projectName);let U=N.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(U=U.replace(Y,""),ae.mergedEventIds&&ae.mergedEventIds.length>0){console.log(" Updating merged schedules:",ae.mergedEventIds);const Q=(ae.originalTitle||ae.title).split(", "),le=U.split(", ");for(let he=0;he<ae.mergedEventIds.length;he++){const pe=ae.mergedEventIds[he],ot=le[he]||Q[he]||U;await a(pe,{title:ot.trim(),start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}}else await a(ae.id,{title:U,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}else{console.log(" Adding schedule with projectId:",N.projectId,"projectName:",N.projectName);const U={id:Date.now().toString(),title:N.title,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName||"",location:"",attendees:N.assignedTo||[],description:N.description||"",time:N.time||"-"};await i(U)}ge(!1)}catch(U){console.error("Failed to save schedule:",U),ee.error("  ")}},onDelete:async N=>{try{if(N.startsWith("payment-")){const U=N.split("-"),Y=U[1],Q=U[2],le=h.find(he=>he.id===Y);if(le){const he={...le.expectedPaymentDates};delete he[Q],await p(Y,{expectedPaymentDates:he})}}else if(N.startsWith("as-")){const U=N.replace("as-","");await u(U,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const U=Pt.find(Y=>Y.id===N);if(U!=null&&U.mergedEventIds&&U.mergedEventIds.length>0){console.log("Deleting merged schedules:",U.mergedEventIds);for(const Y of U.mergedEventIds)await c(Y)}else await c(N)}ge(!1)}catch(U){console.error("Failed to delete schedule:",U),ee.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),B&&F&&o.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:M.x-50,top:M.y-15,backgroundColor:B.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:B.originalTitle||B.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),wn&&o.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>en(null),children:o.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[o.jsxDEV("div",{className:"p-4 text-center",children:[o.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:o.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),o.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:wn.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex border-t border-gray-100",children:[o.jsxDEV("button",{onClick:()=>en(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),o.jsxDEV("button",{onClick:async()=>{try{const N=wn.mergedEventIds||[wn.id];await Promise.all(N.map(U=>c(U)))}catch(N){console.error("  :",N),ee.error(" ")}en(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),x&&o.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{E(!1),k(null),L("")},children:o.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{E(!1),k(null),L("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[o.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:T,onChange:N=>L(N.target.value),onKeyDown:N=>N.key==="Enter"&&xt(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),o.jsxDEV("button",{onClick:xt,disabled:!T.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),o.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:ye?o.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[o.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),o.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):O.length===0?o.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[o.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):o.jsxDEV("div",{className:"divide-y divide-gray-50",children:O.map((N,U)=>o.jsxDEV("div",{draggable:(P==null?void 0:P.id)!==N.id,onDragStart:()=>ze(U),onDragOver:Y=>ft(Y,U),onDragEnd:tt,onDragLeave:()=>me(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${rt===U?"opacity-50 bg-gray-100":""} ${Ht===U?"border-t-2 border-gray-400":""} ${(P==null?void 0:P.id)!==N.id?"cursor-grab active:cursor-grabbing":""}`,children:(P==null?void 0:P.id)===N.id?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("input",{type:"text",value:ke,onChange:Y=>Re(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&fe(),Y.key==="Escape"&&(k(null),Re(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),o.jsxDEV("button",{onClick:fe,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>{k(null),Re("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),o.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:U+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),o.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:N.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>{k(N),Re(N.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>qe(N.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),O.length>0&&o.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},QV=({projectName:t,onClose:e,type:s="cash"})=>{const n=s==="cash",r=n?"":"",i=n?"      .":"      .",[a,c]=D.useState({receiptDate:Mt(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),m=()=>{window.print()},u=h=>{const p=Number(h.replace(/,/g,""));return isNaN(p)?"":p.toLocaleString()},d=h=>{if(h===0)return"";const p=["","","",""],b=["","","",""],w=["","","","","","","","","",""];let v="",C=0;for(;h>0;){const R=h%1e4;if(R>0){let I="",z=R,ie=0;for(;z>0;){const te=z%10;te>0&&(I=w[te]+b[ie]+I),z=Math.floor(z/10),ie++}v=I+p[C]+v}h=Math.floor(h/1e4),C++}return v+""};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(us,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),o.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),o.jsxDEV("input",{type:"date",value:a.receiptDate,onChange:h=>c({...a,receiptDate:h.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.customerName,onChange:h=>c({...a,customerName:h.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:u(a.amount),onChange:h=>{const p=h.target.value.replace(/,/g,"");/^\d*$/.test(p)&&c({...a,amount:p})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),a.amount&&o.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(a.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.purpose,onChange:h=>c({...a,purpose:h.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.receivedBy,onChange:h=>c({...a,receivedBy:h.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),o.jsxDEV("button",{onClick:m,disabled:!a.customerName||!a.amount||!a.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsxDEV(hp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden print:block p-12",children:o.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[o.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:n?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-6 text-lg",children:[o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1 receipt-date",children:Mt(new Date(a.receiptDate),"yyyy MM dd",{locale:bs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:a.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(a.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:d(Number(a.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:a.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-12 text-center",children:[o.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("p",{className:"text-lg receipt-date",children:Mt(new Date(a.receiptDate),"yyyy MM dd",{locale:bs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",a.receivedBy," ",o.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),o.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},YV="HVLabImageDB",GV=1,Lr="paymentRecordImages";let Oa=null;const Tu=()=>new Promise((t,e)=>{if(Oa){t(Oa);return}const s=indexedDB.open(YV,GV);s.onerror=()=>{console.error("IndexedDB  :",s.error),e(s.error)},s.onsuccess=()=>{Oa=s.result,t(Oa)},s.onupgradeneeded=n=>{const r=n.target.result;r.objectStoreNames.contains(Lr)||r.createObjectStore(Lr,{keyPath:"id"})}}),XV=async()=>{try{const t=await Tu();return new Promise((e,s)=>{const i=t.transaction(Lr,"readonly").objectStore(Lr).getAll();i.onsuccess=()=>{const a={};i.result.forEach(c=>{a[c.id]=c.images}),e(a)},i.onerror=()=>{console.error("  :",i.error),s(i.error)}})}catch(t){console.error("IndexedDB , localStorage :",t);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},JV=async(t,e)=>{try{const s=await Tu();return new Promise((n,r)=>{const c=s.transaction(Lr,"readwrite").objectStore(Lr).put({id:t,images:e});c.onsuccess=()=>n(),c.onerror=()=>{console.error("  :",c.error),r(c.error)}})}catch(s){throw console.error("IndexedDB  :",s),s}},ZV=async t=>{try{const e=await Tu();return new Promise((s,n)=>{const r=e.transaction(Lr,"readwrite"),i=r.objectStore(Lr);i.clear(),Object.entries(t).forEach(([a,c])=>{i.put({id:a,images:c})}),r.oncomplete=()=>s(),r.onerror=()=>{console.error("  :",r.error),n(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},e1=async()=>{try{const t=localStorage.getItem("paymentRecordImages");if(t){const e=JSON.parse(t);Object.keys(e).length>0&&(await ZV(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(t){console.error(" :",t)}},qa=t=>{if(!t)return 0;try{const s=new Date(t).getTime();return isNaN(s)?0:s}catch{return 0}},cp=(t,e,s)=>{if(!t)return null;try{const n=new Date(t);return isNaN(n.getTime())?null:Mt(n,e,s)}catch{return null}},t1=()=>{const{payments:t,setPayments:e,loadPaymentsFromAPI:s,loadProjectsFromAPI:n,addPaymentToAPI:r,deletePaymentFromAPI:i,updatePaymentInAPI:a,updatePayment:c}=Ir(),{user:m}=Rr(),u=Ql(),[d,h]=D.useState(""),[p,b]=D.useState(null),[w,v]=D.useState(null),[C,R]=D.useState(!1),[I,z]=D.useState(!1),[ie,te]=D.useState(!1),[O,A]=D.useState(!1),[x,E]=D.useState(""),[T,L]=D.useState("form"),[P,k]=D.useState(!1),[ke,Re]=D.useState(!1),ye=D.useRef(null),[Ie,rt]=D.useState("pending"),[Lt,Ht]=D.useState("all"),[me,He]=D.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[Ge,xt]=D.useState(!1),[fe,qe]=D.useState(null),[ze,ft]=D.useState(!1),[tt,Bt]=D.useState(""),[ds,W]=D.useState(!1),Ce=D.useRef(!1),Me=D.useRef(!1),Le=D.useRef(null),$e=D.useRef(new Set),[bt,Ot]=D.useState([]),[mt,j]=D.useState([]),[$,X]=D.useState(null),[ge,ae]=D.useState([]),[de,Ee]=D.useState([]),[Ke,st]=D.useState(!1),[Ne,fs]=D.useState({}),[Pt,it]=D.useState(!1),ss=()=>{const g=localStorage.getItem("lastSelectedProject"),B=u.filter(S=>S.status!=="completed");return g&&B.some(S=>S.name===g)?g:B.length>0?B[0].name:""},[V,oe]=D.useState({project:"",date:Mt(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});D.useEffect(()=>{(async()=>{try{const B=await Yn.getAllContractors();Ot(B.map(S=>({id:S._id||S.id,rank:S.rank,companyName:S.companyName,name:S.name,process:S.process,contact:S.contact,accountNumber:S.accountNumber,bankName:S.bankName,notes:S.notes,createdAt:new Date(S.createdAt),updatedAt:new Date(S.updatedAt)})))}catch(B){console.error("Failed to load contractors:",B)}})()},[]),D.useEffect(()=>{Ht("all");const g=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);(async()=>{g&&(console.log("[]   - Firestore  "),await kf()),n().catch(M=>{console.error("Failed to load projects:",M)}),s().catch(M=>{console.error("Failed to load payments:",M)})})();const S=()=>{k(window.innerWidth<1024)};if(S(),window.addEventListener("resize",S),u.length>0&&!V.project&&!Me.current){const M=ss();M&&(oe(H=>({...H,project:M})),localStorage.setItem("lastSelectedProject",M))}return()=>window.removeEventListener("resize",S)},[]);const De=D.useRef(new Map);D.useEffect(()=>{console.log("[ ] Firestore  ...");const g=gn.subscribeToPayments(B=>{console.log("[ ]  :",B.length,""),B.forEach(q=>{const F=String(q.id),Z=De.current.get(F);Z&&Z!=="completed"&&q.status==="completed"&&($e.current.has(F)||ee.success(`: ${q.project_name||""} ${q.item_name||""}`.trim(),{duration:4e3}))});const S=new Map;B.forEach(q=>{S.set(String(q.id),q.status)}),De.current=S;const M=B.map(q=>({id:String(q.id),project:q.project_name||"",purpose:q.description,process:q.vendor_name,itemName:q.item_name||"",amount:q.amount,materialAmount:q.material_amount||0,laborAmount:q.labor_amount||0,originalMaterialAmount:q.original_material_amount||0,originalLaborAmount:q.original_labor_amount||0,applyTaxDeduction:q.apply_tax_deduction===1,includesVAT:q.includes_vat===1,quickText:q.quick_text||"",images:(()=>{if(!q.images)return[];if(Array.isArray(q.images))return q.images;try{const F=JSON.parse(q.images);return Array.isArray(F)?F:[]}catch{return[]}})(),category:q.request_type,status:q.status,urgency:"normal",requestedBy:q.requester_name,requestDate:new Date(q.request_date||q.created_at),approvalDate:q.approved_at?new Date(q.approved_at):void 0,bankInfo:{accountHolder:q.account_holder||"",bankName:q.bank_name||"",accountNumber:q.account_number||""},attachments:[],notes:q.notes||"",completionDate:q.paid_at?new Date(q.paid_at):void 0})),H=M.filter(q=>q.status==="pending").length,G=M.filter(q=>q.status==="completed").length;console.log("[ ] Zustand  :",M.length," (:",H,", :",G,")"),e(M)});return()=>{console.log("[ ] Firestore  "),g()}},[e]),D.useEffect(()=>{const g=async()=>{document.visibilityState==="visible"&&/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&(console.log("[]  - Firestore  "),await kf())};return document.addEventListener("visibilitychange",g),()=>{document.removeEventListener("visibilitychange",g)}},[]),D.useEffect(()=>{(async()=>{var M,H,G,q;if(Ce.current)return;const B=new URLSearchParams(window.location.search),S=B.get("complete")||B.get("c");if(S){if(!m){console.log("[ ]   -  ");return}Ce.current=!0,console.log("[ ]  :",S),window.history.replaceState({},"","/payments"),Me.current=!0,L("list"),rt("completed"),Ht("all"),oe(F=>({...F,project:""})),c(String(S),{status:"completed",completionDate:new Date}),$e.current.add(String(S)),setTimeout(()=>{$e.current.delete(String(S))},1e4),ee.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await a(String(S),{status:"completed"}),await s()}catch(F){console.error("[ ]  :",F),c(String(S),{status:"pending",completionDate:void 0}),rt("pending");let Z="  ";((M=F.response)==null?void 0:M.status)===401?Z=" .  ":((H=F.response)==null?void 0:H.status)===404?Z="     (ID: "+S+")":(q=(G=F.response)==null?void 0:G.data)!=null&&q.error?Z=F.response.data.error:F.message&&(Z+=": "+F.message),ee.error(Z)}}})()},[s,a,c,m]),D.useEffect(()=>{if(V.process){const g=new Set(t.filter(H=>{var G;return H.status==="completed"&&((G=H.bankInfo)==null?void 0:G.accountHolder)}).map(H=>H.bankInfo.accountHolder.trim().toLowerCase())),B=(H,G)=>{const q=H.toLowerCase(),F=G.toLowerCase();if(q.includes(F)||F.includes(q))return!0;const Z=q.split("/").map(Se=>Se.trim()),re=F.replace(/$/,"").trim();for(const Se of Z)if(Se===re||re.includes(Se)||Se.includes(re))return!0;return!1},M=bt.filter(H=>{if(!B(V.process,H.process))return!1;const q=H.accountNumber&&H.accountNumber.trim()!=="",F=H.name.trim().toLowerCase(),Z=g.has(F);return q||Z}).sort((H,G)=>{const q=H.accountNumber&&H.accountNumber.trim()!=="",F=G.accountNumber&&G.accountNumber.trim()!=="";return q&&!F?-1:!q&&F?1:0});j(M)}else j([])},[V.process,bt,t]),D.useEffect(()=>{if(V.process){const g=(M,H)=>{if(!H)return!1;const G=M.toLowerCase(),q=H.toLowerCase();if(G.includes(q)||q.includes(G))return!0;const F=G.split("/").map(re=>re.trim()),Z=q.replace(/$/,"").trim();for(const re of F)if(re===Z||Z.includes(re)||re.includes(Z))return!0;return!1},B=t.filter(M=>{var H,G,q;return M.status==="completed"&&M.process&&g(V.process,M.process)&&((H=M.bankInfo)==null?void 0:H.accountHolder)&&((G=M.bankInfo)==null?void 0:G.bankName)&&((q=M.bankInfo)==null?void 0:q.accountNumber)}),S=new Map;B.forEach(M=>{const H=`${M.bankInfo.accountHolder}_${M.bankInfo.bankName}_${M.bankInfo.accountNumber}`;S.has(H)||S.set(H,{accountHolder:M.bankInfo.accountHolder,bankName:M.bankInfo.bankName,accountNumber:M.bankInfo.accountNumber,itemName:M.itemName||"",amount:M.amount||0})}),ae(Array.from(S.values()))}else ae([])},[V.process,t]),D.useEffect(()=>{var B;const g=((B=V.accountHolder)==null?void 0:B.trim())||"";if(g.length>=1&&Ke){const S=[],M=new Set;bt.filter(H=>H.accountNumber&&H.accountNumber.trim()!=="").forEach(H=>{const G=H.name.trim(),q=G.toLowerCase(),F=g.toLowerCase();if(q.startsWith(F)&&!M.has(q)){M.add(q);const Z=t.find(re=>{var Se,Xe;return re.status==="completed"&&((Xe=(Se=re.bankInfo)==null?void 0:Se.accountHolder)==null?void 0:Xe.trim().toLowerCase())===q&&re.process});S.push({name:G,bankName:H.bankName||"",accountNumber:H.accountNumber||"",process:(Z==null?void 0:Z.process)||"",source:"contractor"})}}),t.filter(H=>{var G;return H.status==="completed"&&((G=H.bankInfo)==null?void 0:G.accountHolder)}).forEach(H=>{const G=H.bankInfo.accountHolder.trim(),q=G.toLowerCase(),F=g.toLowerCase();q.startsWith(F)&&!M.has(q)&&(M.add(q),S.push({name:G,bankName:H.bankInfo.bankName||"",accountNumber:H.bankInfo.accountNumber||"",process:H.process||"",source:"payment"}))}),Ee(S)}else Ee([])},[V.accountHolder,Ke,bt,t]);const Be=g=>{const B=g.split(`
`).map(F=>F.trim()).filter(F=>F),S={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},M=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],H=F=>{const Z=["","","","","","","",""];for(const re of Z)if(F.endsWith(re)&&F.length>re.length+1)return F.slice(0,-re.length);return F},G=F=>{if(!F||F.length<2||F.length>5||!/^[-]{2,5}$/.test(F)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(F)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(F))return!1;if(F.length>=2){const Se=F.charAt(0),Xe=F.substring(0,2);if(["","","","","","",""].includes(Xe)||M.includes(Se))return!0}return F.length>=2&&F.length<=4},q=B.some(F=>F.includes(" ")||F.includes(""));if(B.forEach((F,Z)=>{if(F.includes("")&&F.includes(":")){const re=F.match(/\s*:\s*(.+)/);re&&(S.itemName=re[1].trim())}if(F.includes("")&&F.includes(":")){const re=F.match(/\s*:\s*(.+)/);re&&(S.bankInfo.accountHolder=re[1].trim())}if(F.includes("")&&F.includes(":")){const re=F.match(/\s*:\s*(.+)/);re&&(S.bankInfo.bankName=re[1].trim())}if(F.includes("")&&F.includes(":")){const re=F.match(/\s*:\s*(.+)/);re&&(S.bankInfo.accountNumber=re[1].trim())}if(F.includes("")&&F.includes(":")){const re=F.match(/\s*:\s*([\d,]+)?/);re&&(S.amounts.total=parseInt(re[1].replace(/,/g,"")))}}),!q){let F=-1;if(B.forEach(Z=>{const re=Z.match(/\[([^\]]+)\]/);re&&!S.itemName&&(S.itemName=re[1].trim())}),B.forEach((Z,re)=>{if(Z.includes("")||Z.includes(" ")||Z.includes("()")){S.includeVat=!0;const Pe=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/),ve=Z.match(/(\d+)\s*\s*?/),Ze=Z.match(/([\d,]+)\s*/);if(Pe){const ht=parseInt(Pe[1])*1e4+parseInt(Pe[2])*1e3;S.amounts.total=ht}else if(ve){const ht=parseInt(ve[1])*1e4;S.amounts.total=ht}else if(Ze){const ht=parseInt(Ze[1].replace(/,/g,""));ht>=1e3&&(S.amounts.total=ht)}return}const Xe=Z.match(/=\s*([\d,.]+)\s*?/);let lt=null;if(Xe){const Pe=parseInt(Xe[1].replace(/[,.]/g,""));Pe>=1e3&&(S.amounts.total=Pe)}else{const Pe=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(Pe){const ve=parseInt(Pe[1])*1e4,Ze=parseInt(Pe[2])*1e3,ht=ve+Ze;Z.includes("")||Z.includes("")?S.amounts.material=ht:Z.includes("")||Z.includes("")?S.amounts.labor=ht:S.amounts.total||(S.amounts.total=ht),Z=Z.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),lt=Pe}else if(lt=Z.match(/(\d+)\s*\s*?/),lt){const ve=parseInt(lt[1])*1e4;Z.includes("")||Z.includes("")?S.amounts.material=ve:Z.includes("")||Z.includes("")?S.amounts.labor=ve:S.amounts.total||(S.amounts.total=ve),Z=Z.replace(/(\d+)\s*\s*?/g,"")}}Z.includes("/")&&Z.split("/").forEach(ve=>{const Ze=ve.trim();Ze.startsWith("[")||Ze.endsWith("]")||(/^[\d\-]+$/.test(Ze)&&Ze.replace(/\-/g,"").length>=10?S.bankInfo.accountNumber||(S.bankInfo.accountNumber=Ze):G(Ze)&&!S.bankInfo.accountHolder&&(S.bankInfo.accountHolder=Ze))});const xe=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{6}[\s\-]+\d{2}[\s\-]+\d{3}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,6}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let Ue="",Qt=-1;for(const Pe of xe){const ve=Z.match(Pe);if(ve&&!S.bankInfo.accountNumber){Ue=ve[0],Qt=ve.index||-1,S.bankInfo.accountNumber=ve[0].trim().replace(/\s+/g,"-");const ht=Z.substring(Qt+Ue.length).trim().split(/\s+/);for(const ut of ht){if(ut.startsWith("[")||ut.endsWith("]"))continue;const je=H(ut);if(G(je)){S.bankInfo.accountHolder=je;break}}if(!S.bankInfo.accountHolder&&re>0){const je=B[re-1].split(/\s+/);for(const We of je){if(We.startsWith("[")||We.endsWith("]"))continue;const kt=H(We);if(G(kt)){S.bankInfo.accountHolder=kt;break}}}if(!S.bankInfo.accountHolder&&re+1<B.length){const ut=B[re+1],je=ut.split(/\s+/);for(const We of je){if(We.startsWith("[")||We.endsWith("]"))continue;const kt=H(We);if(G(kt)){S.bankInfo.accountHolder=kt;break}}if(!S.bankInfo.accountHolder){const We=ut.match(/^([-]{2,6})/);if(We){const kt=H(We[1].trim());G(kt)&&(S.bankInfo.accountHolder=kt)}}}break}}const ls=Z.match(/[\d,]+/g);if(ls){const Pe=Ue?Ue.split(/[\s\-]+/).filter(Ze=>Ze):[],ve=Ue?Ue.replace(/[\s\-]/g,""):"";ls.forEach(Ze=>{const ht=parseInt(Ze.replace(/,/g,"")),ut=Ze.replace(/,/g,""),je=Pe.some(We=>We===ut||parseInt(We)===ht||ve.includes(ut));!S.bankInfo.accountNumber&&ut.length>=10&&ut.length<=20?(S.bankInfo.accountNumber=ut,Ue=ut):ht>=1e3&&!lt&&!je&&(Z.includes("")||Z.includes("")?S.amounts.material=ht:Z.includes("")||Z.includes("")?S.amounts.labor=ht:S.amounts.total||(S.amounts.total=ht))})}const tn={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},Zt=Object.keys(tn).sort((Pe,ve)=>ve.length-Pe.length);for(const Pe of Zt)if(Z.includes(Pe)){const ve=tn[Pe];S.bankInfo.bankName=ve,F=re;const Ze=new RegExp(`${Pe}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),ht=Z.match(Ze);if(ht){const ut=H(ht[1]);ut&&!/^\d+$/.test(ut)&&ut!==""&&(S.bankInfo.accountHolder=ut)}break}if(!S.bankInfo.bankName){const Pe=Z.match(/([-]+)(|)/);Pe&&(S.bankInfo.bankName=Pe[0])}const Qs=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const Pe of Qs){const ve=Z.match(Pe);if(ve&&!S.bankInfo.accountHolder){S.bankInfo.accountHolder=ve[0].trim();break}}const Ys=Z.match(/\(([-]{2,5})\)/);if(Ys&&!S.bankInfo.accountHolder){const Pe=Ys[1];G(Pe)&&!["","",""].includes(Pe)&&(S.bankInfo.accountHolder=Pe)}if(!S.bankInfo.accountHolder){const Pe=/[-]{2,6}/g,ve=Z.match(Pe);if(ve){const Ze=Z.match(/\d{10,}/)||Z.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),ht=Z.match(/||||/);ve.forEach(ut=>{const je=H(ut),We=g.split(`
`)[re];if(We&&We.includes(`[${ut}]`)||!G(je)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(je))return;const _s=Z.indexOf(ut);if(_s>0){const Ds=Z[_s-1];if(/[-]/.test(Ds))return}if(_s+ut.length<Z.length){const Ds=Z[_s+ut.length];if(/[-]/.test(Ds))return}if(!(Ys&&je===Ys[1])){if((Ze||ht)&&!S.bankInfo.accountHolder)S.bankInfo.accountHolder=je;else if(!S.bankInfo.accountHolder){const Ds=/||||/,ct=/\d{6,}/;(re>0&&(ct.test(B[re-1])||Ds.test(B[re-1]))||re<B.length-1&&(ct.test(B[re+1])||Ds.test(B[re+1]))||Ds.test(Z))&&(S.bankInfo.accountHolder=je)}}})}}const Tt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[Pe,ve]of Object.entries(Tt))if(Z.includes(Pe)){S.vendor=ve;break}if(re===0&&!S.itemName){const Pe=Z.replace(/[\[\]{}()<>]/g,"").trim();Pe&&!Pe.includes(" ")&&(G(Pe)||(S.itemName=Pe.substring(0,50)))}}),F>=0&&F+1<B.length){const Z=B[F+1],re=Z.trim();if(/^[-]{2,5}$/.test(re)&&G(re))S.bankInfo.accountHolder=re;else{const Se=Z.split(/\s+/);for(const Xe of Se){const lt=H(Xe);if(G(lt)){S.bankInfo.accountHolder=lt;break}}}}}if(S.itemName&&S.itemName.includes("")&&(S.vendor=""),S.itemName){const F=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Z=S.itemName.toLowerCase(),re=F.some(xe=>Z===xe.toLowerCase()||Z.startsWith(xe.toLowerCase()+" ")||Z.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Se=/^[\d\-\s]/.test(S.itemName),Xe=/^\d{2,}[\s\-]?\d+/.test(S.itemName.replace(/[-]/g,"").trim()),lt=S.bankInfo.accountHolder&&(S.itemName===S.bankInfo.accountHolder||S.itemName.includes(S.bankInfo.accountHolder));(re||Se||Xe||lt)&&(S.itemName=void 0)}return S},ue=async()=>{var g,B,S,M,H,G,q,F,Z,re,Se;try{const Xe=V.quickText;if(!Xe.trim())return;let lt=t;t.length===0&&(console.log("payments  ,  ..."),await s(),await new Promise(ve=>setTimeout(ve,100)),lt=Ir.getState().payments,console.log("payments  :",lt.length,""));const xe=Be(Xe);console.log("  :",xe);const Ue={project:V.project,date:V.date,quickText:V.quickText,quickImages:V.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};X(null),z(!1),te(!1);let Qt=0;xe.amounts.material&&(Qt+=xe.amounts.material),xe.amounts.labor&&(Qt+=xe.amounts.labor),xe.amounts.total&&!xe.amounts.material&&!xe.amounts.labor&&(Qt=xe.amounts.total),Qt>0&&(Ue.amount=Qt),xe.bankInfo.bankName&&(Ue.bankName=xe.bankInfo.bankName),xe.bankInfo.accountHolder&&(Ue.accountHolder=xe.bankInfo.accountHolder),xe.bankInfo.accountNumber&&(Ue.accountNumber=xe.bankInfo.accountNumber);const ls=ve=>ve?ve.replace(/[^0-9]/g,""):"",tn=(ve,Ze)=>{if(!ve||!Ze)return!1;const ht=ls(ve),ut=ls(Ze);if(!ht||!ut)return!1;const je=6;return ht.length<je||ut.length<je?ht===ut:ut.includes(ht)||ht.includes(ut)},Zt=ls(xe.bankInfo.accountNumber||""),Qs=xe.bankInfo.accountHolder||"";let Ys=!1;console.log("===    ==="),console.log(" :",xe.bankInfo.accountNumber),console.log(" :",Zt),console.log(" :",Qs),console.log(" :",bt.length),console.log("  :",lt.filter(ve=>ve.status==="completed").length);let Tt=bt.find(ve=>{const Ze=ls(ve.accountNumber||"");return Ze&&Ze===Zt});if(!Tt&&Zt&&(Tt=bt.find(ve=>{const Ze=ls(ve.accountNumber||"");return tn(Zt,Ze)})),Tt&&(Ys=!0),!Tt&&Qs&&(Tt=bt.find(ve=>ve.name===Qs),Tt)){console.log("  :",Tt.name);const ve=((g=Tt.accountNumber)==null?void 0:g.replace(/[-\s]/g,""))||"";Zt&&!tn(Zt,ve)?(console.log("    ( ) -  "),Ys=!1):Ys=!0}if(Tt&&(Tt.name&&(Ue.accountHolder=Tt.name,console.log("  :",Tt.name)),Tt.bankName?Ue.bankName=Tt.bankName:xe.bankInfo.bankName&&(Ue.bankName=xe.bankInfo.bankName),Ys&&(Ue.accountNumber=Tt.accountNumber||xe.bankInfo.accountNumber),X(Tt.id||Tt._id||null),Tt.process&&(Ue.process=Tt.process)),!Tt){let ve=!1;console.log("===     ==="),console.log("  payments :",lt.length,""),console.log(" :",Zt),console.log(" :",Qs);const Ze=lt.filter(We=>We.status==="completed");console.log(" :",Ze.length);const ht=[...new Set(Ze.map(We=>{var kt;return(kt=We.bankInfo)==null?void 0:kt.accountHolder}).filter(Boolean))];console.log("   ( 20):",ht.slice(0,20)),console.log("  ():",Zt);const ut=Ze.filter(We=>{var kt;return(kt=We.bankInfo)==null?void 0:kt.accountNumber}).map(We=>{var kt,_s,Ds;return{holder:(kt=We.bankInfo)==null?void 0:kt.accountHolder,account:(_s=We.bankInfo)==null?void 0:_s.accountNumber,clean:ls(((Ds=We.bankInfo)==null?void 0:Ds.accountNumber)||"")}}).filter(We=>We.clean.includes(Zt.substring(0,6))||Zt.includes(We.clean.substring(0,6)));console.log("  :",ut);let je=lt.find(We=>{var Ds;const kt=ls(((Ds=We.bankInfo)==null?void 0:Ds.accountNumber)||"");return kt&&kt===Zt&&We.status==="completed"});if(je&&console.log("   :",(B=je.bankInfo)==null?void 0:B.accountHolder,je.process),!je&&Zt&&(je=lt.find(We=>{var _s;const kt=ls(((_s=We.bankInfo)==null?void 0:_s.accountNumber)||"");return tn(Zt,kt)&&We.status==="completed"}),je&&console.log("   :",(S=je.bankInfo)==null?void 0:S.accountHolder,je.process)),je&&(ve=!0),!je&&Qs&&(je=lt.find(We=>{var kt;return((kt=We.bankInfo)==null?void 0:kt.accountHolder)===Qs&&We.status==="completed"}),je)){console.log("    :",(M=je.bankInfo)==null?void 0:M.accountHolder,":",je.process);const We=ls(((H=je.bankInfo)==null?void 0:H.accountNumber)||"");Zt&&!tn(Zt,We)?(console.log("    ( ) -  "),ve=!1):ve=!0}je?(console.log(" :",{accountHolder:(G=je.bankInfo)==null?void 0:G.accountHolder,accountNumber:(q=je.bankInfo)==null?void 0:q.accountNumber,bankName:(F=je.bankInfo)==null?void 0:F.bankName,process:je.process,status:je.status,paymentMatchedByAccountNumber:ve}),(Z=je.bankInfo)!=null&&Z.accountHolder&&(Ue.accountHolder=je.bankInfo.accountHolder,console.log("  :",je.bankInfo.accountHolder)),(re=je.bankInfo)!=null&&re.bankName?Ue.bankName=je.bankInfo.bankName:xe.bankInfo.bankName&&(Ue.bankName=xe.bankInfo.bankName),ve&&(Ue.accountNumber=((Se=je.bankInfo)==null?void 0:Se.accountNumber)||xe.bankInfo.accountNumber),je.process&&!Ue.process?(Ue.process=je.process,console.log("    :",je.process)):console.log("   - process:",je.process,"updatedFormData.process:",Ue.process)):console.log("  ")}if(xe.vendor&&(Ue.process=xe.vendor),!Ue.process){const ve=Xe.toLowerCase();for(const Ze of Ic)if(ve.includes(Ze.toLowerCase())){Ue.process=Ze;break}}xe.itemName&&(Ue.itemName=xe.itemName),oe(Ue),xe.includeVat&&(z(!0),te(!1));const Pe=[];if(xe.amounts.material||xe.amounts.labor||xe.amounts.total){const ve=[];xe.amounts.material&&ve.push(`: ${xe.amounts.material.toLocaleString()}`),xe.amounts.labor&&ve.push(`: ${xe.amounts.labor.toLocaleString()}`),xe.amounts.total&&!xe.amounts.material&&!xe.amounts.labor&&ve.push(`: ${xe.amounts.total.toLocaleString()}`),Pe.push(ve.join(", "))}if(xe.bankInfo.bankName||xe.bankInfo.accountHolder){const ve=[];xe.bankInfo.bankName&&ve.push(xe.bankInfo.bankName),xe.bankInfo.accountHolder&&ve.push(xe.bankInfo.accountHolder),xe.bankInfo.accountNumber&&ve.push(xe.bankInfo.accountNumber),ve.length>0&&Pe.push(`: ${ve.join(" ")}`)}xe.vendor&&Pe.push(`: ${xe.vendor}`),xe.includeVat&&Pe.push("  "),Pe.length>0?ee.success(`  !
${Pe.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):ee.info("  ...    .")}catch(Xe){console.error(" :",Xe),ee.error("   .")}};D.useEffect(()=>{(async()=>{try{await e1();const B=await XV();fs(B),it(!0)}catch(B){console.error("  :",B),it(!0)}})()},[]);const jt=D.useRef({});D.useEffect(()=>{Pt&&(Object.entries(Ne).forEach(([g,B])=>{JSON.stringify(jt.current[g])!==JSON.stringify(B)&&JV(g,B).catch(S=>{console.error("  :",S),ee.error("  ")})}),jt.current={...Ne})},[Ne,Pt]);const Nt=D.useCallback(async g=>{var M;const B=(M=g.clipboardData)==null?void 0:M.items;if(!B)return;let S=!1;for(let H=0;H<B.length;H++)if(B[H].type.indexOf("image")!==-1){S=!0;break}if(S){if(!p){const H=document.activeElement;(H==null?void 0:H.tagName)==="INPUT"||(H==null?void 0:H.tagName)==="TEXTAREA"||(H==null?void 0:H.classList.contains("form-input"))||ee.error("  ");return}for(let H=0;H<B.length;H++)if(B[H].type.indexOf("image")!==-1){g.preventDefault();const G=B[H].getAsFile();if(G){const q=new FileReader;q.onload=async F=>{var re;const Z=(re=F.target)==null?void 0:re.result;if(Z)try{const Se=t.find(xe=>xe.id===p),lt=[...(Se==null?void 0:Se.images)||Ne[p]||[],Z];await gn.updatePaymentImages(p,lt),fs(xe=>({...xe,[p]:lt})),await s(),ee.success(" ")}catch(Se){console.error("  :",Se),ee.error("  ")}},q.readAsDataURL(G)}}}},[p,t,Ne,s]);D.useEffect(()=>(document.addEventListener("paste",Nt),()=>document.removeEventListener("paste",Nt)),[Nt]);const pt=[...(m==null?void 0:m.name)===""?t.filter(g=>u.some(B=>B.name===g.project)):t].sort((g,B)=>new Date(B.requestDate).getTime()-new Date(g.requestDate).getTime()),Xt=pt.filter(g=>{var G,q,F;if(!g||!g.id)return!1;const B=d===""||((G=g.purpose)==null?void 0:G.toLowerCase().includes(d.toLowerCase()))||((q=g.itemName)==null?void 0:q.toLowerCase().includes(d.toLowerCase()))||((F=g.process)==null?void 0:F.toLowerCase().includes(d.toLowerCase())),S=Ie==="pending"?g.status!=="completed":g.status==="completed",M=Lt==="all"||!Lt||g.project===Lt,H=!me||Ie!=="completed"||g.requestedBy===(m==null?void 0:m.username);return B&&S&&M&&H}).sort((g,B)=>!g&&!B?0:g?B?Ie==="completed"?qa(B.completionDate)-qa(g.completionDate):qa(B.requestDate)-qa(g.requestDate):-1:1),Jt=g=>{const B=g.id||g._id||null;if($===B){X(null);const G=document.querySelector('input[placeholder=" "]');G&&setTimeout(()=>{G.focus()},100);return}X(B);const S=Fo(g.name);let M=g.bankName||"",H=g.accountNumber||"";if(H&&!M){const G=H.trim().split(/\s+/);if(G.length>=2){const q=G[0];(q.includes("")||q.includes("")||q.includes("")||q.includes("")||q.includes(""))&&(M=q,H=G.slice(1).join(""))}}oe(G=>({...G,accountHolder:S,bankName:M,accountNumber:H}))};Xt.reduce((g,B)=>{const S=B.materialAmount||0,M=B.laborAmount||0,H=B.amount||0;let G=S,q=M,F=0;return S===0&&M===0&&H>0?B.includesVAT?(G=Math.round(H/1.1),F=H-G):(G=H,F=0):B.includesVAT?(S>0&&(G=Math.round(S/1.1)),M>0&&(q=Math.round(M/1.1)),F=H-(G+q)):F=0,g.material+=G,g.labor+=q,g.vat+=F,g.total+=H,g},{material:0,labor:0,vat:0,total:0});const Ss=async()=>{var B,S,M;if(ds){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",m),console.log(" Form data:",V),!V.project){ee.error(" ");return}if(!V.itemName){ee.error(" ");return}const g=Number(V.amount)||0;if(g===0){ee.error(" ");return}W(!0);try{const H=ie?Math.round(g*.967):g,G=new Date;if(w){const q={project:V.project,requestDate:new Date(V.date),purpose:V.itemName,amount:H,category:"material",urgency:"normal",process:V.process,itemName:V.itemName,includesVAT:I,applyTaxDeduction:ie,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:V.accountHolder,bank:V.bankName,accountNumber:V.accountNumber,bankInfo:V.accountHolder||V.bankName||V.accountNumber?{accountHolder:V.accountHolder,bankName:V.bankName,accountNumber:V.accountNumber}:void 0,updatedAt:G};console.log(" Updating payment:",q),await a(w,q),ee.success(" "),v(null)}else{const q=V.project||"",F={id:`payment_${Date.now()}`,project:q,requestDate:new Date(V.date),requestedBy:(m==null?void 0:m.username)||"  ",purpose:V.itemName,amount:H,status:"pending",category:"material",urgency:"normal",process:V.process,itemName:V.itemName,includesVAT:I,applyTaxDeduction:ie,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:V.accountHolder,bank:V.bankName,accountNumber:V.accountNumber,bankInfo:V.accountHolder||V.bankName||V.accountNumber?{accountHolder:V.accountHolder,bankName:V.bankName,accountNumber:V.accountNumber}:void 0,quickText:V.quickText||"",images:V.quickImages,attachments:[],createdAt:G,updatedAt:G};console.log(" Creating payment:",F),console.log(" Images in payment:",((B=V.quickImages)==null?void 0:B.length)||0,"");const Z=await r(F);if(Le.current=Z,setTimeout(()=>{Le.current=null},1e4),ee.success(" "),V.accountHolder&&V.bankName&&V.accountNumber){const re=I||ie?"01074088864":"01089423283";try{await gn.sendTossPaymentSms({recipientPhone:re,accountHolder:V.accountHolder,bankName:V.bankName,accountNumber:V.accountNumber,amount:H,projectName:q,itemName:V.itemName,process:V.process,paymentId:Z}),ee.success("   ")}catch(Se){console.error("SMS  :",Se),ee.error("  : "+(((M=(S=Se.response)==null?void 0:S.data)==null?void 0:M.error)||Se.message||"   "))}}}oe(q=>({project:q.project,date:Mt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),z(!1),te(!1),X(null),window.innerWidth<768&&L("list")}catch(H){console.error(" Payment save error:",H),ee.error("  : "+H.message)}finally{W(!1)}},fn=g=>{var B,S,M,H;try{console.log("[handleEdit] Starting edit for payment:",g.id);const G=g.originalMaterialAmount!==void 0?g.originalMaterialAmount:g.materialAmount||0,q=g.originalLaborAmount!==void 0?g.originalLaborAmount:g.laborAmount||0,F={project:g.project||"",date:g.requestDate?Mt(new Date(g.requestDate),"yyyy-MM-dd"):Mt(new Date,"yyyy-MM-dd"),process:g.process||"",itemName:g.itemName||g.purpose||"",materialCost:G>0?G.toString():"",laborCost:q>0?q.toString():"",amount:((B=g.amount)==null?void 0:B.toString())||"",accountHolder:((S=g.bankInfo)==null?void 0:S.accountHolder)||"",bankName:((M=g.bankInfo)==null?void 0:M.bankName)||"",accountNumber:((H=g.bankInfo)==null?void 0:H.accountNumber)||"",images:g.attachments||[],quickText:g.quickText||"",quickImages:g.images||[]};console.log("[handleEdit] Setting form data:",F),oe(F),z(g.includesVAT||!1),te(g.applyTaxDeduction||!1),b(g.id),v(g.id),P&&L("form"),console.log("[handleEdit] Edit setup complete"),ee.success("  ")}catch(G){console.error("[handleEdit] Error:",G),ee.error("     ")}},Ks=async g=>{var B,S,M;try{const H=((B=g.bankInfo)==null?void 0:B.accountHolder)||g.accountHolder,G=((S=g.bankInfo)==null?void 0:S.bankName)||g.bank,q=((M=g.bankInfo)==null?void 0:M.accountNumber)||g.accountNumber;if(!H||!G||!q){ee.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${G}
: ${q}
: ${g.amount.toLocaleString()}`))return;const Z=q.replace(/[-\s]/g,""),re=DE[G]||G,Se=_E[G]||"004",Xe="",lt=`supertoss://send?amount=${g.amount}&bankCode=${Se}&bank=${encodeURIComponent(re)}&accountNo=${Z}&receiverName=${encodeURIComponent(Xe)}&toName=${encodeURIComponent(Xe)}`;let xe=!1;try{window.location.href=lt,xe=!0,ee.success("  ...",{duration:3e3}),setTimeout(()=>{const Ue=/iPhone|iPad|iPod/i.test(navigator.userAgent),Qt=/Android/i.test(navigator.userAgent);(Ue||Qt)&&ee(`      .

: 
: ${q}
: ${g.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(Ue){console.error("   :",Ue),ee(`   .

: 
: ${G}
: ${q}
: ${g.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(H){console.error(" :",H),ee.error(`   : ${H.message}`)}},pn=async g=>{const B=t.find(S=>S.id===g);if(B&&B.quickText){const S=localStorage.getItem("executionMemos"),M=S?JSON.parse(S):{};M[g]=B.quickText,localStorage.setItem("executionMemos",JSON.stringify(M))}c(g,{status:"completed",completionDate:new Date}),xt(!1),rt("completed"),$e.current.add(g),setTimeout(()=>{$e.current.delete(g)},1e4),ee.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await a(g,{status:"completed"})}catch(S){console.error(" API :",S),c(g,{status:"pending",completionDate:void 0}),rt("pending"),ee.error("   -  ")}},$r=async g=>{var M;if(!p){ee.error("  ");return}const S=Array.from(((M=g.target)==null?void 0:M.files)||[]).filter(H=>H.type.startsWith("image/"));if(S.length!==0){try{const H=await Promise.all(S.map(Z=>new Promise((re,Se)=>{const Xe=new FileReader;Xe.onload=lt=>{var Ue;const xe=(Ue=lt.target)==null?void 0:Ue.result;xe?re(xe):Se(new Error("  "))},Xe.onerror=()=>Se(new Error("FileReader ")),Xe.readAsDataURL(Z)}))),G=t.find(Z=>Z.id===p),F=[...(G==null?void 0:G.images)||Ne[p]||[],...H];await gn.updatePaymentImages(p,F),fs(Z=>({...Z,[p]:F})),await s(),ee.success(`${H.length}  `)}catch(H){console.error("  :",H),ee.error("  ")}g.target.value=""}},wn=async g=>{if(p)try{const B=t.find(H=>H.id===p),M=((B==null?void 0:B.images)||Ne[p]||[]).filter((H,G)=>G!==g);await gn.updatePaymentImages(p,M),fs(H=>({...H,[p]:M})),await s()}catch(B){console.error("  :",B),ee.error("  ")}},en=g=>{E(g),A(!0)},Sn=g=>{g.preventDefault(),R(!0)},Bs=g=>{g.preventDefault(),R(!1)},Is=async g=>{if(g.preventDefault(),R(!1),!p){ee.error("  ");return}const S=Array.from(g.dataTransfer.files).filter(M=>M.type.startsWith("image/"));if(S.length!==0)try{const M=await Promise.all(S.map(F=>new Promise((Z,re)=>{const Se=new FileReader;Se.onload=Xe=>{var xe;const lt=(xe=Xe.target)==null?void 0:xe.result;lt?Z(lt):re(new Error("  "))},Se.onerror=()=>re(new Error("FileReader ")),Se.readAsDataURL(F)}))),H=t.find(F=>F.id===p),q=[...(H==null?void 0:H.images)||Ne[p]||[],...M];await gn.updatePaymentImages(p,q),fs(F=>({...F,[p]:q})),await s(),ee.success(`${M.length}  `)}catch(M){console.error("  :",M),ee.error("  ")}};return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"lg:hidden mb-4",children:o.jsxDEV("select",{value:V.project,onChange:g=>{oe({...V,project:g.target.value}),g.target.value&&localStorage.setItem("lastSelectedProject",g.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(m==null?void 0:m.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2499,columnNumber:35},void 0),u.filter(g=>g.status!=="completed").map(g=>o.jsxDEV("option",{value:g.name,children:g.name},g.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2501,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2489,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2488,columnNumber:7},void 0),o.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:o.jsxDEV("nav",{className:"flex space-x-4",children:[o.jsxDEV("button",{onClick:()=>L("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${T==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2510,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>L("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${T==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2520,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>L("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${T==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2530,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2509,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2508,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2507,columnNumber:7},void 0),o.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[o.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${T!=="form"?"hidden md:block":""}`,children:o.jsxDEV("div",{className:"space-y-4",children:[o.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("select",{value:V.project,onChange:g=>{oe({...V,project:g.target.value}),g.target.value&&localStorage.setItem("lastSelectedProject",g.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(m==null?void 0:m.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2565,columnNumber:43},void 0),u.filter(g=>g.status!=="completed").map(g=>o.jsxDEV("option",{value:g.name,children:g.name},g.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2567,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2555,columnNumber:17},void 0),o.jsxDEV("select",{value:V.bankName,onChange:g=>oe({...V,bankName:g.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2575,columnNumber:19},void 0),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2576,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2577,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2578,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2579,columnNumber:19},void 0),o.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2580,columnNumber:19},void 0),o.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2581,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2582,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2583,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2584,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2585,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2586,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2587,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2570,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2554,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2553,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("textarea",{value:V.quickText,onChange:g=>oe({...V,quickText:g.target.value}),onPaste:g=>{var S;const B=(S=g.clipboardData)==null?void 0:S.items;if(B){for(let M=0;M<B.length;M++)if(B[M].type.indexOf("image")!==-1){g.preventDefault();const H=B[M].getAsFile();if(H){const G=new FileReader;G.onload=q=>{var Z;const F=(Z=q.target)==null?void 0:Z.result;oe(re=>({...re,quickImages:[...re.quickImages,F]}))},G.readAsDataURL(H)}break}}},onDragOver:g=>{g.preventDefault(),g.stopPropagation()},onDrop:g=>{g.preventDefault(),g.stopPropagation(),Array.from(g.dataTransfer.files).filter(M=>M.type.startsWith("image/")).forEach(M=>{const H=new FileReader;H.onload=G=>{var F;const q=(F=G.target)==null?void 0:F.result;oe(Z=>({...Z,quickImages:[...Z.quickImages,q]}))},H.readAsDataURL(M)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:P?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2594,columnNumber:15},void 0),V.quickImages.length>0&&o.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:V.quickImages.map((g,B)=>o.jsxDEV("div",{className:"relative group",children:[o.jsxDEV("img",{src:g,alt:` ${B+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2649,columnNumber:23},void 0),o.jsxDEV("button",{type:"button",onClick:()=>{oe(S=>({...S,quickImages:S.quickImages.filter((M,H)=>H!==B)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2654,columnNumber:23},void 0)]},B,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2648,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2646,columnNumber:17},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[o.jsxDEV("label",{className:"cursor-pointer",children:[o.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g=>{Array.from(g.target.files||[]).forEach(S=>{const M=new FileReader;M.onload=H=>{var q;const G=(q=H.target)==null?void 0:q.result;oe(F=>({...F,quickImages:[...F.quickImages,G]}))},M.readAsDataURL(S)}),g.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:19},void 0),o.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2694,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2672,columnNumber:17},void 0),o.jsxDEV("button",{type:"button",onClick:ue,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2698,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2593,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",V.date&&`(${Mt(new Date(V.date),"E",{locale:bs})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2711,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:V.date,onChange:g=>oe({...V,date:g.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2714,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2710,columnNumber:15},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2730,columnNumber:17},void 0),o.jsxDEV("button",{ref:ye,type:"button",onClick:()=>Re(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:V.process||o.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2731,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2729,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2709,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2744,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:V.itemName,onChange:g=>oe({...V,itemName:g.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2745,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2743,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2756,columnNumber:17},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("input",{type:"text",value:V.amount?Number(V.amount).toLocaleString():"",onChange:g=>{const B=g.target.value.replace(/[^0-9]/g,"");oe({...V,amount:B})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2758,columnNumber:19},void 0),o.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2769,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2755,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex items-center gap-4",children:[o.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:g=>g.preventDefault(),onClick:()=>{I||te(!1),z(!I)},children:[o.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${I?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:I&&o.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2787,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2786,columnNumber:19},void 0),o.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2789,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2775,columnNumber:17},void 0),o.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:g=>g.preventDefault(),onClick:()=>{ie||z(!1),te(!ie)},children:[o.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${ie?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:ie&&o.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2805,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2804,columnNumber:19},void 0),o.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2807,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2793,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2774,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2754,columnNumber:13},void 0),o.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(mt.length>0||ge.length>0&&!$)&&o.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[o.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${mt.length===0?"hidden":""}`,children:[o.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2823,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:mt.map(g=>{const B=g.id||g._id,S=$===B;return o.jsxDEV("button",{type:"button",onClick:()=>Jt(g),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${S?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[o.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Fo(g.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2839,columnNumber:29},void 0),o.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[g.bankName||""," ",g.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2842,columnNumber:29},void 0)]},B,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2829,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2824,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2820,columnNumber:19},void 0),o.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${ge.length===0||$?"hidden":""}`,children:[o.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2855,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:ge.map((g,B)=>o.jsxDEV("button",{type:"button",onClick:()=>{oe(S=>({...S,accountHolder:g.accountHolder,bankName:g.bankName,accountNumber:g.accountNumber})),ae([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[o.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:g.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2872,columnNumber:27},void 0),o.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[g.bankName," ",g.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2875,columnNumber:27},void 0)]},B,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2858,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2856,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2852,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2818,columnNumber:17},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2887,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:V.accountHolder,onChange:g=>oe({...V,accountHolder:g.target.value}),onFocus:()=>st(!0),onBlur:()=>setTimeout(()=>st(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2888,columnNumber:17},void 0),Ke&&de.length>0&&o.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:de.map((g,B)=>o.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:S=>S.preventDefault(),onClick:()=>{let S=g.bankName||"",M=g.accountNumber||"";const H=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],G={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const F of H)if(M.includes(F)){S||(S=G[F]||F),M=M.replace(F,"").trim();break}for(const F of H)if(S.includes(F)){const Z=G[F]||F,re=S.replace(F,"").trim();re&&/\d/.test(re)&&(M=re),S=Z;break}M=M.replace(/[^\d\-]/g,"").trim();const q=!V.process&&g.process?g.process:V.process;oe({...V,accountHolder:g.name,bankName:S||V.bankName,accountNumber:M||V.accountNumber,process:q}),st(!1)},children:[o.jsxDEV("div",{className:"flex flex-col",children:[o.jsxDEV("span",{className:"font-medium",children:g.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2993,columnNumber:27},void 0),g.process&&o.jsxDEV("span",{className:"text-xs text-blue-600",children:[": ",g.process]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2995,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2992,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500",children:g.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2998,columnNumber:25},void 0)]},`${g.name}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2901,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2899,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2886,columnNumber:15},void 0),o.jsxDEV("div",{className:"payment-bank-field",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3009,columnNumber:17},void 0),o.jsxDEV("select",{value:V.bankName,onChange:g=>oe({...V,bankName:g.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3015,columnNumber:19},void 0),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3016,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3017,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3018,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3019,columnNumber:19},void 0),o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3020,columnNumber:19},void 0),o.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3021,columnNumber:19},void 0),o.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3022,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3023,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3024,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3025,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3026,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3027,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3028,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3029,columnNumber:19},void 0),o.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3030,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3031,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3032,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3033,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3034,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3035,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3036,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3037,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3010,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3008,columnNumber:15},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3042,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:V.accountNumber,onChange:g=>oe({...V,accountNumber:g.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3043,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3041,columnNumber:15},void 0),o.jsxDEV("div",{className:"pt-2 border-t",children:o.jsxDEV("div",{className:"flex justify-between items-baseline",children:[o.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3054,columnNumber:19},void 0),o.jsxDEV("div",{className:"text-right",children:[(I||ie)&&o.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",I&&" ",ie&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3057,columnNumber:23},void 0),o.jsxDEV("span",{className:"font-semibold",children:[(()=>{const g=Number(V.amount)||0;let B=g;return ie&&(B=Math.round(g*.967)),B.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3061,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3055,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3053,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3052,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[w&&o.jsxDEV("button",{onClick:()=>{v(null),oe(g=>({project:g.project,date:Mt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),z(!1),te(!1),X(null),ee.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3080,columnNumber:19},void 0),o.jsxDEV("button",{onClick:g=>{console.log(" Payment button clicked!",g),console.log(" Button element:",g.currentTarget),console.log(" Form data:",V),Ss()},disabled:ds,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ds?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ds?"...":w?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3109,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3078,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2815,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2551,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:9},void 0),o.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${T!=="list"?"hidden md:flex":""}`,children:[o.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:o.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:o.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[o.jsxDEV("button",{onClick:()=>rt("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${Ie==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",o.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${Ie==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:pt.filter(g=>g&&g.id&&g.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3148,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3139,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{rt("completed"),oe(g=>({...g,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${Ie==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",o.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${Ie==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:pt.filter(g=>g&&g.id&&g.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3154,columnNumber:17},void 0),Ie==="completed"&&o.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[o.jsxDEV("input",{type:"checkbox",checked:me,onChange:g=>{He(g.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(g.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3176,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3138,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3137,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3136,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3191,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:Xt.length>0?o.jsxDEV("div",{className:"space-y-4",children:Xt.map(g=>{var q,F,Z;const B=g.amount||0,S=((q=g.bankInfo)==null?void 0:q.accountHolder)||g.accountHolder||"",M=((F=g.bankInfo)==null?void 0:F.bankName)||g.bank||"",H=((Z=g.bankInfo)==null?void 0:Z.accountNumber)||g.accountNumber||"",G=S&&M&&H?`${S} | ${M} ${H}`:" ";return o.jsxDEV("div",{onClick:()=>b(g.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${p===g.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[o.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-baseline gap-2",children:[g.process&&o.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",g.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3223,columnNumber:31},void 0),o.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:g.purpose||g.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3225,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3221,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:g.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3229,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3220,columnNumber:25},void 0),o.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[o.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[B.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3232,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[g.requestedBy||"-","  ",cp(g.requestDate,"MM/dd",{locale:bs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3235,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3231,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3219,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[o.jsxDEV("span",{className:"text-gray-400",children:[" ",(g.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3243,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3244,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-gray-400",children:[" ",(g.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3245,columnNumber:25},void 0),g.includesVAT&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3248,columnNumber:29},void 0),o.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3249,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3247,columnNumber:27},void 0),g.applyTaxDeduction&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3254,columnNumber:29},void 0),o.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3255,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3253,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3242,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[o.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:G},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3262,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[o.jsxDEV("button",{onClick:re=>{re.stopPropagation(),fn(g)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:o.jsxDEV(Hb,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3274,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3266,columnNumber:27},void 0),o.jsxDEV("button",{onClick:async re=>{if(re.stopPropagation(),window.confirm("  ?"))try{console.log("[]  - ID:",g.id,"Type:",typeof g.id),await i(String(g.id)),console.log("[]  - ID:",g.id),ee.success("")}catch(Se){console.error("[] :",Se),ee.error(" ")}},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:o.jsxDEV(si,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3294,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3276,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3265,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3261,columnNumber:23},void 0),Ie==="pending"&&(m==null?void 0:m.role)&&["manager","admin"].includes(m.role)&&o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("button",{onClick:re=>{if(re.stopPropagation(),g.status==="completed"){ee.info("   ");return}Ks(g)},disabled:g.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${g.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:g.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3303,columnNumber:27},void 0),o.jsxDEV("button",{onClick:re=>{re.stopPropagation(),pn(g.id)},disabled:g.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${g.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:g.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:re=>{g.status!=="completed"&&(re.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:re=>{g.status!=="completed"&&(re.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3321,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3302,columnNumber:25},void 0)]},g.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3209,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3195,columnNumber:15},void 0):o.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3352,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3193,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3132,columnNumber:9},void 0),o.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${T!=="image"?"hidden lg:flex":""}`,onDragOver:Sn,onDragLeave:Bs,onDrop:Is,children:[o.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:$r,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3368,columnNumber:11},void 0),P&&p&&T==="image"&&(()=>{const g=pt.find(B=>B.id===p);return g?o.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:o.jsxDEV("div",{className:"flex justify-between items-start",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:g.purpose||g.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3385,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[g.process||"-","  ",cp(g.requestDate,"yyyy.MM.dd",{locale:bs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3386,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3384,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(g.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3390,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3383,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3382,columnNumber:17},void 0):null})(),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:g=>{var S;const B=g.target;if(!B.closest("img")&&!B.closest("button")&&p){const M=pt.find(F=>F.id===p),H=(M==null?void 0:M.images)||[],G=Ne[p]||[];(H.length>0?H:G).length>0&&((S=document.getElementById("image-file-input"))==null||S.click())}},children:p?(()=>{const g=pt.find(H=>H.id===p),B=(g==null?void 0:g.images)||[],S=Ne[p]||[],M=B.length>0?B:S;return o.jsxDEV("div",{className:"h-full flex flex-col",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3426,columnNumber:21},void 0),o.jsxDEV("textarea",{value:(g==null?void 0:g.quickText)||(g==null?void 0:g.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3427,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3425,columnNumber:19},void 0),M.length>0&&o.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:M.map((H,G)=>o.jsxDEV("div",{className:"relative group",children:[o.jsxDEV("img",{src:H,alt:` ${G+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:q=>{q.stopPropagation(),en(H)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3441,columnNumber:27},void 0),o.jsxDEV("button",{onClick:q=>{q.stopPropagation(),wn(G)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:o.jsxDEV(us,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3457,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3450,columnNumber:27},void 0),o.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[G+1,"/",M.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3459,columnNumber:27},void 0)]},G,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3440,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3438,columnNumber:21},void 0),o.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${M.length>0?"":"flex-1"}`,onClick:H=>H.stopPropagation(),children:o.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${C?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${M.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[o.jsxDEV(el,{className:`mx-auto text-gray-400 mb-1 ${M.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3478,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:M.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3479,columnNumber:23},void 0),M.length===0&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3483,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3473,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3423,columnNumber:17},void 0)})():o.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:o.jsxDEV("div",{className:"text-center text-gray-400",children:[o.jsxDEV(Co,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3492,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3493,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3491,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3490,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3400,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3360,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2545,columnNumber:7},void 0),ke&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[o.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3508,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>Re(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(us,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3513,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3509,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3507,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[o.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Ic.map(g=>o.jsxDEV("button",{onClick:()=>{oe({...V,process:g}),Re(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${V.process===g?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:g},g,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3520,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3518,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{oe({...V,process:""}),Re(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3537,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3517,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3506,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3505,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>Re(!1),children:o.jsxDEV("div",{onClick:g=>g.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:ye.current?`${ye.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:ye.current?`${ye.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[o.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[o.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3561,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>Re(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(us,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3566,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3562,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3560,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-2",children:[o.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Ic.map(g=>o.jsxDEV("button",{onClick:()=>{oe({...V,process:g}),Re(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${V.process===g?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:g},g,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3573,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3571,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{oe({...V,process:""}),Re(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3590,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3570,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3552,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3551,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3503,columnNumber:9},void 0),O&&o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>A(!1),children:o.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[o.jsxDEV("button",{onClick:g=>{g.stopPropagation(),A(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:o.jsxDEV(us,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3619,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3612,columnNumber:13},void 0),o.jsxDEV("img",{src:x,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:g=>g.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3621,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3611,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3607,columnNumber:9},void 0),ze&&o.jsxDEV(QV,{projectName:tt,onClose:()=>ft(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3633,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2486,columnNumber:5},void 0)},Yr=t=>t?typeof t=="string"?t:t instanceof be?t.toDate().toISOString():new Date().toISOString():new Date().toISOString(),hn={async getSpaces(t){const e=Fe(se,"finish_check_spaces");let s;t?s=vt(e,Ts("project_id","==",t)):s=vt(e);const r=(await At(s)).docs.sort((a,c)=>(a.data().display_order||0)-(c.data().display_order||0)),i=[];for(const a of r){const c=a.data(),m=Fe(se,"finish_check_items"),u=vt(m,Ts("space_id","==",a.id)),h=(await At(u)).docs.sort((b,w)=>(b.data().display_order||0)-(w.data().display_order||0)),p=[];for(const b of h){const w=b.data(),v=Fe(se,"finish_check_images"),C=vt(v,Ts("item_id","==",b.id)),I=(await At(C)).docs.map(z=>({id:z.id,item_id:b.id,filename:z.data().filename||null,created_at:Yr(z.data().created_at)}));p.push({id:b.id,space_id:a.id,content:w.content||"",is_completed:w.is_completed||0,is_priority:w.is_priority||0,completed_at:w.completed_at?Yr(w.completed_at):null,display_order:w.display_order||0,created_at:Yr(w.created_at),updated_at:Yr(w.updated_at),images:I})}i.push({id:a.id,name:c.name||"",project_id:c.project_id||null,display_order:c.display_order||0,created_at:Yr(c.created_at),updated_at:Yr(c.updated_at),items:p})}return i},async createSpace(t,e){const s=Fe(se,"finish_check_spaces"),n=vt(s,Ts("project_id","==",e)),i=(await At(n)).docs.reduce((m,u)=>Math.max(m,u.data().display_order||0),0),a={name:t,project_id:e,display_order:i+1,created_at:ns(),updated_at:ns()};return{id:(await On(s,a)).id,name:t,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(t,e){const s=we(se,"finish_check_spaces",t);await Rt(s,{name:e,updated_at:ns()})},async deleteSpace(t){const e=Fe(se,"finish_check_items"),s=vt(e,Ts("space_id","==",t)),n=await At(s);for(const r of n.docs){const i=Fe(se,"finish_check_images"),a=vt(i,Ts("item_id","==",r.id)),c=await At(a);for(const m of c.docs)await Us(we(se,"finish_check_images",m.id));await Us(we(se,"finish_check_items",r.id))}await Us(we(se,"finish_check_spaces",t))},async createItem(t,e){const s=Fe(se,"finish_check_items"),n=vt(s,Ts("space_id","==",t)),i=(await At(n)).docs.reduce((m,u)=>Math.max(m,u.data().display_order||0),0),a={space_id:t,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:ns(),updated_at:ns()};return{id:(await On(s,a)).id,space_id:t,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(t,e){const s=we(se,"finish_check_items",t);await Rt(s,{content:e,updated_at:ns()})},async deleteItem(t){const e=Fe(se,"finish_check_images"),s=vt(e,Ts("item_id","==",t)),n=await At(s);for(const r of n.docs)await Us(we(se,"finish_check_images",r.id));await Us(we(se,"finish_check_items",t))},async toggleItem(t){const e=we(se,"finish_check_items",t),s=await It(e);if(!s.exists())throw new Error("   .");const n=s.data(),r=n.is_completed?0:1;return await Rt(e,{is_completed:r,completed_at:r?ns():null,updated_at:ns()}),{id:t,space_id:n.space_id,content:n.content,is_completed:r,is_priority:n.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:n.display_order||0,created_at:Yr(n.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(t){const e=we(se,"finish_check_items",t),s=await It(e);if(!s.exists())throw new Error("   .");const r=s.data().is_priority||0?0:1;return await Rt(e,{is_priority:r,updated_at:ns()}),{is_priority:r}},async getImageData(t){const e=we(se,"finish_check_images",t),s=await It(e);if(!s.exists())return null;const n=s.data();return{image_data:n.image_url||n.image_data||""}},async uploadImage(t,e,s){const n=Fe(se,"finish_check_images"),r={item_id:t,image_data:"",image_url:"",filename:s,created_at:ns()},i=await On(n,r);let a=e;if(Yi(e)){const c=await sy("finish_check",i.id,e);await Rt(i,{image_url:c,image_data:""}),a=c}else await Rt(i,{image_data:e});return{id:i.id,item_id:t,image_data:a,filename:s,created_at:new Date().toISOString()}},async deleteImage(t){const e=we(se,"finish_check_images",t),s=await It(e);if(s.exists()){const n=s.data();n.image_url&&await ny(n.image_url)}await Us(e)}},xn={getSpaces:t=>hn.getSpaces(t),createSpace:(t,e)=>hn.createSpace(t,e),updateSpace:(t,e)=>hn.updateSpace(String(t),e),deleteSpace:t=>hn.deleteSpace(String(t)),createItem:(t,e)=>hn.createItem(String(t),e),updateItem:(t,e)=>hn.updateItem(String(t),e),deleteItem:t=>hn.deleteItem(String(t)),toggleItem:t=>hn.toggleItem(String(t)),togglePriority:t=>hn.togglePriority(String(t)),getImageData:t=>hn.getImageData(String(t)),uploadImage:(t,e,s)=>hn.uploadImage(String(t),e,s),deleteImage:t=>hn.deleteImage(String(t))},s1=()=>{var it,ss;const{user:t}=Rr(),{loadProjectsFromAPI:e,projects:s}=Ir(),n=Ql(),[r,i]=D.useState([]),[a,c]=D.useState(!0),[m,u]=D.useState(null),[d,h]=D.useState([]),[p,b]=D.useState(!1),[w,v]=D.useState(""),[C,R]=D.useState(""),[I,z]=D.useState(null),[ie,te]=D.useState(null),[O,A]=D.useState(""),[x,E]=D.useState(null),[T,L]=D.useState(""),[P,k]=D.useState(null),[ke,Re]=D.useState(new Set),ye=D.useRef(null),[Ie,rt]=D.useState(window.innerWidth<768),[Lt,Ht]=D.useState(!1),[me,He]=D.useState(null),[Ge,xt]=D.useState(new Set),[fe,qe]=D.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[ze,ft]=D.useState(!1),[tt,Bt]=D.useState(!1),[ds,W]=D.useState(new Set);D.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(fe))},[fe]),D.useEffect(()=>{(async()=>{s.length===0&&await e(),c(!1)})();const oe=()=>{rt(window.innerWidth<768)};return window.addEventListener("resize",oe),()=>window.removeEventListener("resize",oe)},[]),D.useEffect(()=>{a||Ce()},[n,a]),D.useEffect(()=>{m!==null&&Me()},[m]),D.useEffect(()=>{m!==null&&(t!=null&&t.id)&&localStorage.setItem(`finishCheck_selectedProject_${t.id}`,m.toString())},[m,t==null?void 0:t.id]),D.useEffect(()=>{if(!Ie&&P){const V=async oe=>{var Be;const De=(Be=oe.clipboardData)==null?void 0:Be.items;if(De){for(let ue=0;ue<De.length;ue++)if(De[ue].type.indexOf("image")!==-1){oe.preventDefault();const jt=De[ue].getAsFile();jt&&await Ee(P,jt)}}};return document.addEventListener("paste",V),()=>document.removeEventListener("paste",V)}},[P,Ie]);const Ce=async()=>{try{const V=n.map(De=>({id:De.id,title:De.name}));i(V);const oe=t!=null&&t.id?localStorage.getItem(`finishCheck_selectedProject_${t.id}`):null;oe&&V.some(De=>De.id===Number(oe))?u(Number(oe)):V.length>0&&u(V[0].id)}catch(V){console.error("Failed to load projects:",V),ee.error("   ")}},Me=async()=>{try{d.length===0&&b(!0);const oe=(await xn.getSpaces(m||void 0)).map(De=>({...De,items:De.items.map(Be=>({...Be,images:Be.images||[]}))}));h(oe)}catch(V){console.error("Failed to load spaces:",V),ee.error("   ")}finally{b(!1)}},Le=async V=>{if(ds.has(Number(V)))return null;try{W(Be=>new Set(Be).add(Number(V)));const oe=await xn.getImageData(V),De=(oe==null?void 0:oe.image_data)||null;return h(Be=>Be.map(ue=>({...ue,items:ue.items.map(jt=>({...jt,images:jt.images.map(Nt=>String(Nt.id)===String(V)?{...Nt,image_data:De}:Nt)}))}))),De}catch(oe){return console.error("   :",oe),null}finally{W(oe=>{const De=new Set(oe);return De.delete(Number(V)),De})}},$e=async V=>{const oe=d.find(ue=>ue.items.some(jt=>jt.id===V)),De=oe==null?void 0:oe.items.find(ue=>ue.id===V);if(!De)return;const Be=De.images.filter(ue=>!ue.image_data);await Promise.all(Be.map(ue=>Le(ue.id)))},bt=async()=>{if(!tt){if(!w.trim()){ee.error("  ");return}if(!m){ee.error(" ");return}Bt(!0);try{const V=await xn.createSpace(w.trim(),m),oe={...V,items:V.items||[]};h([...d,oe]),v(""),ft(!1),ee.success(" ")}catch(V){console.error("Failed to add space:",V),ee.error("  ")}finally{Bt(!1)}}},Ot=async(V,oe)=>{if(!oe.trim()){ee.error("  ");return}try{await xn.updateSpace(V,oe.trim()),h(d.map(De=>String(De.id)===String(V)?{...De,name:oe.trim()}:De)),te(null),A(""),ee.success("  ")}catch(De){console.error("Failed to update space:",De),ee.error("  ")}},mt=V=>{He(V),xt(new Set)},j=async()=>{if(me!==null){if(Ge.size===0){ee.error("  ");return}try{await Promise.all(Array.from(Ge).map(V=>xn.deleteItem(V))),h(d.map(V=>String(V.id)===String(me)?{...V,items:V.items.filter(oe=>!Ge.has(oe.id))}:V)),ee.success(`${Ge.size}  `),He(null),xt(new Set)}catch(V){console.error("Failed to delete items:",V),ee.error("  ")}}},$=async()=>{if(me===null)return;const V=d.find(oe=>String(oe.id)===String(me));if(V&&confirm(`"${V.name}"  ?

        .`))try{await xn.deleteSpace(me),h(d.filter(oe=>String(oe.id)!==String(me))),ee.success(" "),He(null),xt(new Set)}catch(oe){console.error("Failed to delete space:",oe),ee.error("  ")}},X=async V=>{if(!C.trim()){ee.error("  ");return}const oe=-Date.now(),De={id:oe,space_id:V,content:C.trim(),is_checked:!1,is_priority:!1,images:[]};h(d.map(ue=>String(ue.id)===String(V)?{...ue,items:[...ue.items,De]}:ue));const Be=C.trim();R(""),z(null);try{const ue=await xn.createItem(V,Be);h(jt=>jt.map(Nt=>String(Nt.id)===String(V)?{...Nt,items:Nt.items.map(zt=>zt.id===oe?{...ue,images:[]}:zt)}:Nt))}catch(ue){console.error("Failed to add item:",ue),h(jt=>jt.map(Nt=>String(Nt.id)===String(V)?{...Nt,items:Nt.items.filter(zt=>zt.id!==oe)}:Nt)),ee.error("  ")}},ge=async V=>{try{const oe=await xn.toggleItem(V);h(d.map(De=>({...De,items:De.items.map(Be=>String(Be.id)===String(V)?{...Be,...oe}:Be)})))}catch(oe){console.error("Failed to toggle item:",oe),ee.error("   ")}},ae=async V=>{try{const oe=await xn.togglePriority(V);h(d.map(De=>({...De,items:De.items.map(Be=>String(Be.id)===String(V)?{...Be,is_priority:oe.is_priority}:Be)})))}catch(oe){console.error("Failed to toggle priority:",oe),ee.error("  ")}},de=V=>new Promise((oe,De)=>{const Be=new FileReader;Be.readAsDataURL(V),Be.onload=()=>oe(Be.result),Be.onerror=ue=>De(ue)}),Ee=async(V,oe)=>{var ue,jt;if(!["image/jpeg","image/png","image/webp"].includes(oe.type)){ee.error("JPEG, PNG, WebP    ");return}const Be=5*1024*1024;if(oe.size>Be){ee.error("  5MB  ");return}try{Re(pt=>new Set([...pt,Number(V)]));const Nt=await de(oe),zt=await xn.uploadImage(V,Nt,oe.name);h(d.map(pt=>({...pt,items:pt.items.map(Xt=>String(Xt.id)===String(V)?{...Xt,images:[...Xt.images,zt]}:Xt)}))),ee.success(" ")}catch(Nt){console.error("Failed to upload image:",Nt),ee.error(((jt=(ue=Nt.response)==null?void 0:ue.data)==null?void 0:jt.error)||"  ")}finally{Re(Nt=>{const zt=new Set(Nt);return zt.delete(Number(V)),zt})}},Ke=async(V,oe)=>{const De=oe.target.files;if(!(!De||De.length===0)){for(let Be=0;Be<De.length;Be++)await Ee(V,De[Be]);ye.current&&(ye.current.value="")}},st=async(V,oe)=>{if(confirm("  ?"))try{await xn.deleteImage(oe),h(d.map(De=>({...De,items:De.items.map(Be=>String(Be.id)===String(V)?{...Be,images:Be.images.filter(ue=>String(ue.id)!==String(oe))}:Be)}))),ee.success(" ")}catch(De){console.error("Failed to delete image:",De),ee.error("  ")}},Ne=async(V,oe)=>{V.preventDefault(),V.stopPropagation();const De=V.dataTransfer.files;if(!(!De||De.length===0))for(let Be=0;Be<De.length;Be++)De[Be].type.startsWith("image/")&&await Ee(oe,De[Be])},fs=V=>{V.preventDefault(),V.stopPropagation()};if(p)return o.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:o.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const Pt=P?d.flatMap(V=>V.items).find(V=>V.id===P):null;return o.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[o.jsxDEV("input",{ref:ye,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:V=>{P&&Ke(P,V)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),o.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:Ie?o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("div",{className:"flex-1",children:o.jsxDEV("select",{value:m||"",onChange:V=>{const oe=V.target.value?Number(V.target.value):null;u(oe)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(t==null?void 0:t.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(V=>o.jsxDEV("option",{value:V.id,children:V.title},V.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>qe(!fe),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${fe?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:fe?" ":" ",children:fe?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>ft(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:o.jsxDEV(Mi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),o.jsxDEV("select",{value:m||"",onChange:V=>{const oe=V.target.value?Number(V.target.value):null;u(oe)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(t==null?void 0:t.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(V=>o.jsxDEV("option",{value:V.id,children:V.title},V.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:w,onChange:V=>v(V.target.value),onKeyPress:V=>{V.key==="Enter"&&bt()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),o.jsxDEV("button",{onClick:bt,disabled:tt,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:o.jsxDEV(Mi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex items-end",children:o.jsxDEV("button",{onClick:()=>qe(!fe),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${fe?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:fe?" ":" ",children:fe?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?o.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):o.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((V,oe)=>{const De=V.items.filter(ue=>!ue.is_completed).sort((ue,jt)=>(jt.is_priority||0)-(ue.is_priority||0)),Be=V.items.filter(ue=>ue.is_completed);return fe&&De.length===0?null:o.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[ie===V.id?o.jsxDEV("div",{className:"flex gap-2 mb-4",children:[o.jsxDEV("input",{type:"text",value:O,onChange:ue=>A(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"?Ot(V.id,O):ue.key==="Escape"&&(te(null),A(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>Ot(V.id,O),className:"p-1 text-green-600 hover:text-green-700",children:o.jsxDEV(dp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{te(null),A("")},className:"p-1 text-gray-600 hover:text-gray-700",children:o.jsxDEV(us,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):o.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[o.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:oe+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),V.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500",children:[Be.length,"/",V.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:()=>{I===V.id?(z(null),R("")):z(V.id)},className:`p-1 transition-colors ${I===V.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:o.jsxDEV(Mi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{te(V.id),A(V.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:o.jsxDEV(Bc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>mt(V.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:o.jsxDEV(si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),I===V.id&&o.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:C,onChange:ue=>R(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"&&C.trim()&&X(V.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>X(V.id),disabled:!C.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),De.length>0&&o.jsxDEV("div",{className:"mb-4",children:o.jsxDEV("div",{className:"space-y-2",children:De.map(ue=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[o.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>ge(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),o.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!Ie&&P===ue.id?"font-semibold":""}`,onClick:async()=>{Ie||(k(ue.id),ue.images&&ue.images.length>0&&await $e(ue.id))},style:{cursor:Ie?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&o.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:async()=>{k(ue.id),Ie&&Ht(!0),ue.images&&ue.images.length>0&&await $e(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Co,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),o.jsxDEV("button",{onClick:()=>ae(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Ju,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!fe&&Be.length>0&&o.jsxDEV("div",{children:o.jsxDEV("div",{className:"space-y-2",children:Be.map(ue=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[o.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>ge(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),o.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!Ie&&P===ue.id?"font-semibold":""}`,onClick:async()=>{Ie||(k(ue.id),ue.images&&ue.images.length>0&&await $e(ue.id))},style:{cursor:Ie?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&o.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:async()=>{k(ue.id),Ie&&Ht(!0),ue.images&&ue.images.length>0&&await $e(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Co,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),o.jsxDEV("button",{onClick:()=>ae(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Ju,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!Ie&&P&&Pt&&o.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:o.jsxDEV(us,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Pt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>{var V;return(V=ye.current)==null?void 0:V.click()},disabled:ke.has(P),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsxDEV(el,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),ke.has(P)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:V=>Ne(V,P),onDragOver:fs,children:Pt.images.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[o.jsxDEV(Co,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),o.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):o.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Pt.images.map(V=>o.jsxDEV("div",{className:"relative group",children:[V.image_data?o.jsxDEV("img",{src:V.image_data,alt:V.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):o.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:o.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>st(P,V.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:o.jsxDEV(Zu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),V.filename&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:V.filename,children:V.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),Ie&&Lt&&P&&Pt&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:o.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Ht(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(us,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),o.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:Pt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>{var V;return(V=ye.current)==null?void 0:V.click()},disabled:ke.has(P),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[o.jsxDEV(el,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),ke.has(P)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:Pt.images.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[o.jsxDEV(Co,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):o.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Pt.images.map(V=>o.jsxDEV("div",{className:"relative",children:[V.image_data?o.jsxDEV("img",{src:V.image_data,alt:V.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):o.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:o.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>st(P,V.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:o.jsxDEV(Zu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),V.filename&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:V.filename,children:V.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),me!==null&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(it=d.find(V=>V.id===me))==null?void 0:it.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{He(null),xt(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(us,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-2",children:(ss=d.find(V=>V.id===me))==null?void 0:ss.items.map(V=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const oe=new Set(Ge);oe.has(V.id)?oe.delete(V.id):oe.add(V.id),xt(oe)},children:[o.jsxDEV("input",{type:"checkbox",checked:Ge.has(V.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),o.jsxDEV("span",{className:`flex-1 text-sm ${V.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:V.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[o.jsxDEV("button",{onClick:j,disabled:Ge.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",Ge.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),o.jsxDEV("button",{onClick:$,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>{He(null),xt(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),ze&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:o.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{ft(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(us,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4",children:[o.jsxDEV("div",{className:"mb-4",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:w,onChange:V=>v(V.target.value),onKeyPress:V=>{V.key==="Enter"&&w.trim()&&bt()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:()=>{ft(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),o.jsxDEV("button",{onClick:bt,disabled:!w.trim()||tt,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:tt?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function n1(){const[t,e]=D.useState([]),[s,n]=D.useState(!1),[r,i]=D.useState(null),[a,c]=D.useState(!1),[m,u]=D.useState(null),[d,h]=D.useState(""),[p,b]=D.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[w,v]=D.useState(!1);D.useEffect(()=>{C()},[]),D.useEffect(()=>{const x=()=>{R()};return window.addEventListener("headerAddButtonClick",x),()=>window.removeEventListener("headerAddButtonClick",x)},[]);const C=async()=>{var x,E;try{t.length===0&&n(!0),i(null);const T=await Yn.getAllContractors();e(T.map(L=>({id:L._id,rank:L.rank,companyName:L.companyName,name:L.name,position:L.position,process:L.process,contact:L.contact,accountNumber:L.accountNumber,notes:L.notes,createdAt:new Date(L.createdAt),updatedAt:new Date(L.updatedAt)})))}catch(T){console.error("Failed to load contractors:",T);const L=T instanceof Error&&((E=(x=T.response)==null?void 0:x.data)==null?void 0:E.message);i(L||"   .")}finally{n(!1)}},R=x=>{if(x){u(x);let E="",T=x.accountNumber||"";if(x.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const ke of k)if(x.accountNumber.startsWith(ke)){E=ke,T=x.accountNumber.substring(ke.length).trim();break}}let L=x.name,P=x.position||"";P||(P=Ba(x.name),L=Fo(x.name)),b({rank:x.rank||"",companyName:x.companyName||"",name:L,position:P,process:x.process,contact:x.contact||"",bankName:E,accountNumber:T,notes:x.notes||""})}else u(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});c(!0)},I=()=>{c(!1),u(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},z=async x=>{var T,L;if(x.preventDefault(),w)return;v(!0);const E=p.bankName&&p.accountNumber?`${p.bankName} ${p.accountNumber}`:p.accountNumber;try{const P={rank:p.rank,companyName:p.companyName,name:p.name,position:p.position,process:p.process,contact:p.contact,accountNumber:E,notes:p.notes};m?await Yn.updateContractor(m.id,P):await Yn.createContractor(P),await C(),I()}catch(P){console.error("Failed to save contractor:",P);const k=P instanceof Error&&((L=(T=P.response)==null?void 0:T.data)==null?void 0:L.message);alert(k||"  .")}finally{v(!1)}},ie=async x=>{var E,T;if(window.confirm("   ?"))try{await Yn.deleteContractor(x),await C()}catch(L){console.error("Failed to delete contractor:",L);const P=L instanceof Error&&((T=(E=L.response)==null?void 0:E.data)==null?void 0:T.message);alert(P||"  .")}},te=()=>"border-gray-200 text-gray-600 bg-gray-50",O=x=>x?x==="1"?1:x==="1()"?2:x==="2"?3:x==="2()"?4:x==="3"?5:x==="3()"?6:x===""?100:x===""?200:999:999,A=t.filter(x=>x.name.toLowerCase().includes(d.toLowerCase())||x.process.toLowerCase().includes(d.toLowerCase())||x.accountNumber.toLowerCase().includes(d.toLowerCase())||x.contact&&x.contact.toLowerCase().includes(d.toLowerCase())||x.rank&&x.rank.toLowerCase().includes(d.toLowerCase())||x.companyName&&x.companyName.toLowerCase().includes(d.toLowerCase())).sort((x,E)=>{const T=O(x.rank)-O(E.rank);if(T!==0)return T;const L=x.process.localeCompare(E.process,"ko");return L!==0?L:x.name.localeCompare(E.name,"ko")});return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"flex items-center justify-end",children:o.jsxDEV("button",{onClick:()=>R(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV(pp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),o.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:x=>h(x.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),o.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsxDEV("div",{className:"overflow-x-auto",children:o.jsxDEV("table",{className:"w-full",children:[o.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxDEV("tr",{children:[o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),o.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:s?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("div",{className:"space-y-4",children:[o.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),o.jsxDEV("button",{onClick:C,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):A.length===0?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):A.map(x=>o.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${te(x.rank)}`,children:x.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"font-medium text-gray-900",children:Fo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.position||Ba(x.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4",children:o.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:x.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsxDEV("button",{onClick:()=>R(x),className:"text-gray-600 hover:text-gray-900 mr-3",children:o.jsxDEV(Bc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),o.jsxDEV("button",{onClick:()=>ie(x.id),className:"text-red-600 hover:text-red-900",children:o.jsxDEV(si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),o.jsxDEV("div",{className:"md:hidden space-y-3",children:s?o.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?o.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[o.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),o.jsxDEV("button",{onClick:C,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):A.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):A.map(x=>o.jsxDEV("div",{className:"card p-3 space-y-2",children:[o.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[x.rank&&o.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${te(x.rank)}`,children:x.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),x.companyName&&o.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:x.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),o.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Fo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),o.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[o.jsxDEV("button",{onClick:()=>R(x),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:o.jsxDEV(Bc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),o.jsxDEV("button",{onClick:()=>ie(x.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:o.jsxDEV(si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),o.jsxDEV("div",{className:"space-y-1 text-xs",children:[(x.position||Ba(x.name))&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-900",children:x.position||Ba(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),x.contact&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-900",children:x.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),o.jsxDEV("span",{className:"text-gray-900 break-all",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),x.notes&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-600",children:x.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),a&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:o.jsxDEV("div",{className:"p-6",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:m?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),o.jsxDEV("button",{onClick:I,className:"text-gray-400 hover:text-gray-600",children:o.jsxDEV(us,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),o.jsxDEV("form",{onSubmit:z,className:"space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),o.jsxDEV("select",{value:p.rank,onChange:x=>b({...p,rank:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),o.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),o.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),o.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.companyName,onChange:x=>b({...p,companyName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",o.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),o.jsxDEV("input",{type:"text",required:!0,value:p.name,onChange:x=>b({...p,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.position,onChange:x=>b({...p,position:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",o.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),o.jsxDEV("input",{type:"text",required:!0,value:p.process,onChange:x=>b({...p,process:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.contact,onChange:x=>b({...p,contact:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),o.jsxDEV("select",{value:p.bankName,onChange:x=>b({...p,bankName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),o.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),o.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),o.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.accountNumber,onChange:x=>b({...p,accountNumber:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),o.jsxDEV("textarea",{value:p.notes,onChange:x=>b({...p,notes:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),o.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[o.jsxDEV("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),o.jsxDEV("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:w?" ...":m?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const r1=()=>{const[t,e]=D.useState([]),[s,n]=D.useState(null),[r,i]=D.useState(!1),a=D.useRef(null);D.useEffect(()=>(a.current=Xa.subscribeToQuoteInquiries(h=>{e(h),i(!1)}),i(!0),()=>{a.current&&a.current()}),[]);const c=async h=>{try{await Xa.markAsRead(h),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(p){console.error("Failed to mark as read:",p)}},m=h=>{n(h),h.isRead||c(h.id)},u=async(h,p)=>{if(p.stopPropagation(),!!confirm("  ?"))try{await Xa.deleteQuoteInquiry(h),(s==null?void 0:s.id)===h&&n(null),ee.success(" ")}catch(b){console.error("Failed to delete inquiry:",b),ee.error("  ")}},d=t.filter(h=>!h.isRead).length;return r?o.jsxDEV("div",{className:"flex items-center justify-center h-full",children:o.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):o.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[o.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${s?"hidden md:flex":"flex"}`,children:[o.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&o.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:t.length===0?o.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):o.jsxDEV("div",{className:"divide-y",children:t.map(h=>o.jsxDEV("div",{className:`relative group ${(s==null?void 0:s.id)===h.id?"bg-blue-50 border-l-4 border-blue-500":""} ${h.isRead?"":"bg-yellow-50"}`,children:o.jsxDEV("button",{onClick:()=>m(h),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[o.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("span",{className:"font-medium text-gray-900",children:h.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!h.isRead&&o.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("span",{className:"text-xs text-gray-500",children:Mt(new Date(h.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),o.jsxDEV("button",{onClick:p=>u(h.id,p),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:o.jsxDEV(si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),o.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[o.jsxDEV(ed,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),h.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),o.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),o.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${s?"flex flex-col":"hidden md:flex md:flex-col"}`,children:s?o.jsxDEV("div",{className:"h-full flex flex-col",children:[o.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:s.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>n(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),o.jsxDEV("div",{className:"text-sm text-gray-500",children:Mt(new Date(s.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[o.jsxDEV(Mb,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),o.jsxDEV("div",{className:"pl-6 space-y-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(ed,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),o.jsxDEV("span",{children:s.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(Fb,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),o.jsxDEV("span",{children:s.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),s.address&&o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(Ob,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),o.jsxDEV("span",{children:s.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(s.projectType||s.budget)&&o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[o.jsxDEV(qb,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),o.jsxDEV("div",{className:"pl-6 space-y-2",children:[s.projectType&&o.jsxDEV("div",{className:"text-gray-700",children:[o.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),s.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),s.budget&&o.jsxDEV("div",{className:"text-gray-700",children:[o.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),s.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),o.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:s.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):o.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},i1=()=>{const{login:t}=Rr(),[e,s]=D.useState(!1),{register:n,handleSubmit:r,setValue:i,formState:{errors:a}}=Eu(),c=async u=>{s(!0);try{await t(u.username,u.password)}finally{s(!1)}},m=u=>{i("username",u)};return o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:o.jsxDEV("div",{className:"max-w-md w-full",children:o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[o.jsxDEV("div",{className:"text-center mb-8",children:[o.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),o.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),o.jsxDEV("form",{onSubmit:r(c),className:"space-y-6",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),o.jsxDEV("input",{...n("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),a.username&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:a.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),o.jsxDEV("input",{...n("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),a.password&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:a.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),o.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?o.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV($b,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),o.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(u=>o.jsxDEV("button",{onClick:()=>m(u),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:u},u,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},o1=D.lazy(()=>$n(()=>import("./Drawings-eJMS0QKT.js"),__vite__mapDeps([0,1,2,3,4,5]))),a1=D.lazy(()=>$n(()=>import("./SiteLog-BSTVbAd0.js"),__vite__mapDeps([6,1,4,2,3,5]))),l1=D.lazy(()=>$n(()=>import("./AfterService-CzhePchp.js"),__vite__mapDeps([7,1,2,4,3,5]))),c1=D.lazy(()=>$n(()=>import("./AdditionalWork-FWCBaPCF.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),m1=D.lazy(()=>$n(()=>import("./ConstructionPayment-C6X4Mq8M.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),u1=D.lazy(()=>$n(()=>import("./WorkRequest-DXydq7wd.js"),__vite__mapDeps([11,1,2,4,3,5]))),d1=D.lazy(()=>$n(()=>import("./Specbook-CISeN5Fb.js"),__vite__mapDeps([12,1,2,3,4,5]))),f1=D.lazy(()=>$n(()=>import("./EstimatePreview-CAFPx8sq.js"),__vite__mapDeps([13,1,2,3,4,5]))),p1=D.lazy(()=>$n(()=>import("./ExecutionHistory-HDxWj51C.js"),__vite__mapDeps([14,1,4,2,3,5]))),h1=()=>o.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:35,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:34,columnNumber:3},void 0),g1=new Vb({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function y1(){const[t,e]=D.useState(!1);return D.useEffect(()=>{const s=XN({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),ee.loading("   ...",{duration:2e3}),setTimeout(()=>{s(!0).then(()=>{ee.dismiss(),ee.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(i,a){console.log(" Service Worker :",i),a&&setInterval(()=>{console.log("   ..."),a.update()},6e4)},onRegisterError(i){console.error(" Service Worker  :",i)}});YA();const n=async()=>{try{const a=await(await fetch("/version.json?t="+Date.now())).json(),c=localStorage.getItem("app_version");c&&c!==a.version?(console.log("   :",a.version),localStorage.setItem("app_version",a.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):c||localStorage.setItem("app_version",a.version)}catch(i){console.error("  :",i)}};setTimeout(n,5e3);const r=setInterval(n,3e4);return console.log(" Firestore   "),()=>{clearInterval(r)}},[]),o.jsxDEV(wb,{client:g1,children:o.jsxDEV(Ab,{children:o.jsxDEV(iA,{children:[o.jsxDEV(D.Suspense,{fallback:o.jsxDEV(h1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:137,columnNumber:31},this),children:o.jsxDEV(Eb,{children:[o.jsxDEV(Es,{path:"/login",element:o.jsxDEV(i1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:139,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:139,columnNumber:15},this),o.jsxDEV(Es,{path:"/",element:o.jsxDEV(QA,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:140,columnNumber:40},this),children:[o.jsxDEV(Es,{index:!0,element:o.jsxDEV(up,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:141,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:141,columnNumber:17},this),o.jsxDEV(Es,{path:"dashboard",element:o.jsxDEV(kE,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:142,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:142,columnNumber:17},this),o.jsxDEV(Es,{path:"projects",element:o.jsxDEV(IE,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:143,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:143,columnNumber:17},this),o.jsxDEV(Es,{path:"schedule",element:o.jsxDEV(KV,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:144,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:144,columnNumber:17},this),o.jsxDEV(Es,{path:"drawings",element:o.jsxDEV(o1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:145,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:145,columnNumber:17},this),o.jsxDEV(Es,{path:"site-log",element:o.jsxDEV(a1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:146,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:146,columnNumber:17},this),o.jsxDEV(Es,{path:"after-service",element:o.jsxDEV(l1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:147,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:147,columnNumber:17},this),o.jsxDEV(Es,{path:"additional-work",element:o.jsxDEV(c1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:148,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:148,columnNumber:17},this),o.jsxDEV(Es,{path:"construction-payment",element:o.jsxDEV(m1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:149,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:149,columnNumber:17},this),o.jsxDEV(Es,{path:"contractors",element:o.jsxDEV(n1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:150,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:150,columnNumber:17},this),o.jsxDEV(Es,{path:"work-request",element:o.jsxDEV(u1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:151,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:151,columnNumber:17},this),o.jsxDEV(Es,{path:"finish-check",element:o.jsxDEV(s1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:152,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:152,columnNumber:17},this),o.jsxDEV(Es,{path:"specbook",element:o.jsxDEV(d1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:153,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:153,columnNumber:17},this),o.jsxDEV(Es,{path:"estimate-preview",element:o.jsxDEV(f1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:154,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:154,columnNumber:17},this),o.jsxDEV(Es,{path:"execution-history",element:o.jsxDEV(p1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:155,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:155,columnNumber:17},this),o.jsxDEV(Es,{path:"payments",element:o.jsxDEV(t1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:156,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:156,columnNumber:17},this),o.jsxDEV(Es,{path:"quote-inquiry",element:o.jsxDEV(r1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:157,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:157,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:140,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:138,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:137,columnNumber:11},this),o.jsxDEV(GN,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:161,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:136,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:135,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:134,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(t){for(const e of t)e.update()});Sp(document.getElementById("root")).render(o.jsxDEV(D.StrictMode,{children:o.jsxDEV(y1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{Eu as A,bs as B,pm as C,OA as D,Vc as E,rA as F,k1 as G,Qe as H,JV as I,gn as J,e1 as K,XV as L,Ic as P,be as T,se as a,Us as b,ns as c,we as d,bl as e,um as f,It as g,Rr as h,Ql as i,o as j,Fe as k,dn as l,At as m,ry as n,is as o,Yi as p,vt as q,yl as r,ii as s,Nl as t,mm as u,Rt as v,Ts as w,On as x,Ir as y,ee as z};
