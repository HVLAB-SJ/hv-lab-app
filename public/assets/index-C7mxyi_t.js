const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-Cxr7bNd0.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-CYwhspq-.js","assets/AfterService-BWigL-nm.js","assets/AdditionalWork-CpusnoG_.js","assets/additionalWorkService-BKxM7B-X.js","assets/ConstructionPayment-DEMOrv-0.js","assets/WorkRequest-CRtev8Yy.js","assets/Specbook-CpvbPM1E.js","assets/EstimatePreview-CtITYSNU.js","assets/ExecutionHistory-DNjQXdD1.js"])))=>i.map(i=>d[i]);
var kx=Object.defineProperty;var Ex=(n,e,t)=>e in n?kx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Xf=(n,e,t)=>Ex(n,typeof e!="symbol"?e+"":e,t);import{r as E,b as Ax,u as Ig,d as Vx,N as Sg,e as zu,O as Cx,R as mt,f as ml,B as wx,h as Ix,i as Cn}from"./vendor-react-DN7YJcfR.js";import{a as Sx,c as ud,Q as Tx,b as Px}from"./vendor-data-DrLf5NIQ.js";import{B as Wu,X as vn,C as Tg,T as ki,a as Lx,b as Pg,W as jx,c as Rx,d as Ds,P as No,R as Bx,e as Ux,S as Lg,f as Hx,g as Mx,h as jg,i as Fx,U as pm,I as Ea,j as hm,k as Jf,l as Zf,m as ep,n as Ox,M as qx,o as $x,p as zx,L as Wx}from"./vendor-ui-D8A9iq7X.js";import{k as Ku,l as Jo,m as Zo,n as Kx,o as Gx,p as Ot,q as Qx,r as tp,s as Yx,t as lt}from"./vendor-date-DbWJ9m7c.js";import{c as Xx,p as Rg,l as Gc,s as ks,i as Jx,h as Zx,q as md,a as dd,m as fd,b as ev,d as Qc,o as Nc,e as tv,f as xc,r as pd,g as hd,j as gd,k as yd,n as bd,t as Bg,u as Ug,v as Hg,w as Mg,x as Fg,y as Og,z as qg,A as $g,B as zg,C as Wg,D as Kg,E as Gg,F as nv,G as sv,H as rv,I as iv,J as ov,K as av,L as lv}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var Qg={exports:{}},gm={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var n=E,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),w=Symbol.iterator,v="@@iterator";function C(x){if(x===null||typeof x!="object")return null;var L=w&&x[w]||x[v];return typeof L=="function"?L:null}var B=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function T(x){{for(var L=arguments.length,U=new Array(L>1?L-1:0),X=1;X<L;X++)U[X-1]=arguments[X];F("error",x,U)}}function F(x,L,U){{var X=B.ReactDebugCurrentFrame,G=X.getStackAddendum();G!==""&&(L+="%s",U=U.concat([G]));var Z=U.map(function(ie){return String(ie)});Z.unshift("Warning: "+L),Function.prototype.apply.call(console[x],console,Z)}}var re=!1,ee=!1,M=!1,A=!1,N=!1,V;V=Symbol.for("react.module.reference");function j(x){return!!(typeof x=="string"||typeof x=="function"||x===s||x===i||N||x===r||x===m||x===d||A||x===y||re||ee||M||typeof x=="object"&&x!==null&&(x.$$typeof===h||x.$$typeof===f||x.$$typeof===o||x.$$typeof===l||x.$$typeof===u||x.$$typeof===V||x.getModuleId!==void 0))}function S(x,L,U){var X=x.displayName;if(X)return X;var G=L.displayName||L.name||"";return G!==""?U+"("+G+")":U}function I(x){return x.displayName||"Context"}function k(x){if(x==null)return null;if(typeof x.tag=="number"&&T("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case s:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case l:var L=x;return I(L)+".Consumer";case o:var U=x;return I(U._context)+".Provider";case u:return S(x,x.render,"ForwardRef");case f:var X=x.displayName||null;return X!==null?X:k(x.type)||"Memo";case h:{var G=x,Z=G._payload,ie=G._init;try{return k(ie(Z))}catch{return null}}}return null}var De=Object.assign,qe=0,he,Ue,ht,zt,Ft,ae,$e;function me(){}me.__reactDisabledLog=!0;function Re(){{if(qe===0){he=console.log,Ue=console.info,ht=console.warn,zt=console.error,Ft=console.group,ae=console.groupCollapsed,$e=console.groupEnd;var x={configurable:!0,enumerable:!0,value:me,writable:!0};Object.defineProperties(console,{info:x,log:x,warn:x,error:x,group:x,groupCollapsed:x,groupEnd:x})}qe++}}function Qe(){{if(qe--,qe===0){var x={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:De({},x,{value:he}),info:De({},x,{value:Ue}),warn:De({},x,{value:ht}),error:De({},x,{value:zt}),group:De({},x,{value:Ft}),groupCollapsed:De({},x,{value:ae}),groupEnd:De({},x,{value:$e})})}qe<0&&T("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var vt=B.ReactCurrentDispatcher,at;function wt(x,L,U){{if(at===void 0)try{throw Error()}catch(G){var X=G.stack.trim().match(/\n( *(at )?)/);at=X&&X[1]||""}return`
`+at+x}}var ot=!1,ft;{var fn=typeof WeakMap=="function"?WeakMap:Map;ft=new fn}function K(x,L){if(!x||ot)return"";{var U=ft.get(x);if(U!==void 0)return U}var X;ot=!0;var G=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Z;Z=vt.current,vt.current=null,Re();try{if(L){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Ut){X=Ut}Reflect.construct(x,[],ie)}else{try{ie.call()}catch(Ut){X=Ut}x.call(ie.prototype)}}else{try{throw Error()}catch(Ut){X=Ut}x()}}catch(Ut){if(Ut&&X&&typeof Ut.stack=="string"){for(var Ce=Ut.stack.split(`
`),Je=X.stack.split(`
`),Fe=Ce.length-1,fe=Je.length-1;Fe>=1&&fe>=0&&Ce[Fe]!==Je[fe];)fe--;for(;Fe>=1&&fe>=0;Fe--,fe--)if(Ce[Fe]!==Je[fe]){if(Fe!==1||fe!==1)do if(Fe--,fe--,fe<0||Ce[Fe]!==Je[fe]){var We=`
`+Ce[Fe].replace(" at new "," at ");return x.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",x.displayName)),typeof x=="function"&&ft.set(x,We),We}while(Fe>=1&&fe>=0);break}}}finally{ot=!1,vt.current=Z,Qe(),Error.prepareStackTrace=G}var un=x?x.displayName||x.name:"",Kt=un?wt(un):"";return typeof x=="function"&&ft.set(x,Kt),Kt}function Pe(x,L,U){return K(x,!1)}function He(x){var L=x.prototype;return!!(L&&L.isReactComponent)}function Se(x,L,U){if(x==null)return"";if(typeof x=="function")return K(x,He(x));if(typeof x=="string")return wt(x);switch(x){case m:return wt("Suspense");case d:return wt("SuspenseList")}if(typeof x=="object")switch(x.$$typeof){case u:return Pe(x.render);case f:return Se(x.type,L,U);case h:{var X=x,G=X._payload,Z=X._init;try{return Se(Z(G),L,U)}catch{}}}return""}var Ye=Object.prototype.hasOwnProperty,It={},Wt=B.ReactDebugCurrentFrame;function dt(x){if(x){var L=x._owner,U=Se(x.type,x._source,L?L.type:null);Wt.setExtraStackFrame(U)}else Wt.setExtraStackFrame(null)}function P(x,L,U,X,G){{var Z=Function.call.bind(Ye);for(var ie in x)if(Z(x,ie)){var Ce=void 0;try{if(typeof x[ie]!="function"){var Je=Error((X||"React class")+": "+U+" type `"+ie+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof x[ie]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Je.name="Invariant Violation",Je}Ce=x[ie](L,ie,X,U,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Fe){Ce=Fe}Ce&&!(Ce instanceof Error)&&(dt(G),T("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",X||"React class",U,ie,typeof Ce),dt(null)),Ce instanceof Error&&!(Ce.message in It)&&(It[Ce.message]=!0,dt(G),T("Failed %s type: %s",U,Ce.message),dt(null))}}}var q=Array.isArray;function te(x){return q(x)}function Ne(x){{var L=typeof Symbol=="function"&&Symbol.toStringTag,U=L&&x[Symbol.toStringTag]||x.constructor.name||"Object";return U}}function ce(x){try{return de(x),!1}catch{return!0}}function de(x){return""+x}function Ie(x){if(ce(x))return T("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Ne(x)),de(x)}var ze=B.ReactCurrentOwner,et={key:!0,ref:!0,__self:!0,__source:!0},Ee,Un,Bt;Bt={};function ne(x){if(Ye.call(x,"ref")){var L=Object.getOwnPropertyDescriptor(x,"ref").get;if(L&&L.isReactWarning)return!1}return x.ref!==void 0}function Xe(x){if(Ye.call(x,"key")){var L=Object.getOwnPropertyDescriptor(x,"key").get;if(L&&L.isReactWarning)return!1}return x.key!==void 0}function O(x,L){if(typeof x.ref=="string"&&ze.current&&L&&ze.current.stateNode!==L){var U=k(ze.current.type);Bt[U]||(T('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(ze.current.type),x.ref),Bt[U]=!0)}}function xe(x,L){{var U=function(){Ee||(Ee=!0,T("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"key",{get:U,configurable:!0})}}function ke(x,L){{var U=function(){Un||(Un=!0,T("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"ref",{get:U,configurable:!0})}}var Le=function(x,L,U,X,G,Z,ie){var Ce={$$typeof:e,type:x,key:L,ref:U,props:ie,_owner:Z};return Ce._store={},Object.defineProperty(Ce._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Ce,"_self",{configurable:!1,enumerable:!1,writable:!1,value:X}),Object.defineProperty(Ce,"_source",{configurable:!1,enumerable:!1,writable:!1,value:G}),Object.freeze&&(Object.freeze(Ce.props),Object.freeze(Ce)),Ce};function ue(x,L,U,X,G){{var Z,ie={},Ce=null,Je=null;U!==void 0&&(Ie(U),Ce=""+U),Xe(L)&&(Ie(L.key),Ce=""+L.key),ne(L)&&(Je=L.ref,O(L,G));for(Z in L)Ye.call(L,Z)&&!et.hasOwnProperty(Z)&&(ie[Z]=L[Z]);if(x&&x.defaultProps){var Fe=x.defaultProps;for(Z in Fe)ie[Z]===void 0&&(ie[Z]=Fe[Z])}if(Ce||Je){var fe=typeof x=="function"?x.displayName||x.name||"Unknown":x;Ce&&xe(ie,fe),Je&&ke(ie,fe)}return Le(x,Ce,Je,G,X,ze.current,ie)}}var Dt=B.ReactCurrentOwner,xt=B.ReactDebugCurrentFrame;function Jt(x){if(x){var L=x._owner,U=Se(x.type,x._source,L?L.type:null);xt.setExtraStackFrame(U)}else xt.setExtraStackFrame(null)}var Et;Et=!1;function pn(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function on(){{if(Dt.current){var x=k(Dt.current.type);if(x)return`

Check the render method of \``+x+"`."}return""}}function Tn(x){{if(x!==void 0){var L=x.fileName.replace(/^.*[\\\/]/,""),U=x.lineNumber;return`

Check your code at `+L+":"+U+"."}return""}}var ds={};function Xn(x){{var L=on();if(!L){var U=typeof x=="string"?x:x.displayName||x.name;U&&(L=`

Check the top-level render call using <`+U+">.")}return L}}function fs(x,L){{if(!x._store||x._store.validated||x.key!=null)return;x._store.validated=!0;var U=Xn(L);if(ds[U])return;ds[U]=!0;var X="";x&&x._owner&&x._owner!==Dt.current&&(X=" It was passed a child from "+k(x._owner.type)+"."),Jt(x),T('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',U,X),Jt(null)}}function ri(x,L){{if(typeof x!="object")return;if(te(x))for(var U=0;U<x.length;U++){var X=x[U];pn(X)&&fs(X,L)}else if(pn(x))x._store&&(x._store.validated=!0);else if(x){var G=C(x);if(typeof G=="function"&&G!==x.entries)for(var Z=G.call(x),ie;!(ie=Z.next()).done;)pn(ie.value)&&fs(ie.value,L)}}}function Ls(x){{var L=x.type;if(L==null||typeof L=="string")return;var U;if(typeof L=="function")U=L.propTypes;else if(typeof L=="object"&&(L.$$typeof===u||L.$$typeof===f))U=L.propTypes;else return;if(U){var X=k(L);P(U,x.props,"prop",X,x)}else if(L.PropTypes!==void 0&&!Et){Et=!0;var G=k(L);T("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",G||"Unknown")}typeof L.getDefaultProps=="function"&&!L.getDefaultProps.isReactClassApproved&&T("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ns(x){{for(var L=Object.keys(x.props),U=0;U<L.length;U++){var X=L[U];if(X!=="children"&&X!=="key"){Jt(x),T("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",X),Jt(null);break}}x.ref!==null&&(Jt(x),T("Invalid attribute `ref` supplied to `React.Fragment`."),Jt(null))}}var D={};function Q(x,L,U,X,G,Z){{var ie=j(x);if(!ie){var Ce="";(x===void 0||typeof x=="object"&&x!==null&&Object.keys(x).length===0)&&(Ce+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Je=Tn(G);Je?Ce+=Je:Ce+=on();var Fe;x===null?Fe="null":te(x)?Fe="array":x!==void 0&&x.$$typeof===e?(Fe="<"+(k(x.type)||"Unknown")+" />",Ce=" Did you accidentally export a JSX literal instead of a component?"):Fe=typeof x,T("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Fe,Ce)}var fe=ue(x,L,U,G,Z);if(fe==null)return fe;if(ie){var We=L.children;if(We!==void 0)if(X)if(te(We)){for(var un=0;un<We.length;un++)ri(We[un],x);Object.freeze&&Object.freeze(We)}else T("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ri(We,x)}if(Ye.call(L,"key")){var Kt=k(x),Ut=Object.keys(L).filter(function(On){return On!=="key"}),jt=Ut.length>0?"{key: someKey, "+Ut.join(": ..., ")+": ...}":"{key: someKey}";if(!D[Kt+jt]){var Hn=Ut.length>0?"{"+Ut.join(": ..., ")+": ...}":"{}";T(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,jt,Kt,Hn,Kt),D[Kt+jt]=!0}}return x===s?ns(fe):Ls(fe),fe}}var R=Q;gm.Fragment=s,gm.jsxDEV=R})();Qg.exports=gm;var a=Qg.exports,Yg,np=Ax;{var sp=np.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Yg=function(n,e){sp.usingClientEntryPoint=!0;try{return np.createRoot(n,e)}finally{sp.usingClientEntryPoint=!1}}}const cv="modulepreload",uv=function(n){return"/"+n},rp={},Ys=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=uv(u),u in rp)return;rp[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":cv,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((h,y)=>{f.addEventListener("load",h),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let mv={data:""},dv=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||mv},fv=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,pv=/\/\*[^]*?\*\/|  +/g,ip=/\n+/g,wr=(n,e)=>{let t="",s="",r="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":s+=i[1]=="f"?wr(o,i):i+"{"+wr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=wr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=wr.p?wr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+s},Js={},Xg=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+Xg(n[t]);return e}return n},hv=(n,e,t,s,r)=>{let i=Xg(n),o=Js[i]||(Js[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!Js[o]){let u=i!==n?n:(m=>{let d,f,h=[{}];for(;d=fv.exec(m.replace(pv,""));)d[4]?h.shift():d[3]?(f=d[3].replace(ip," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(ip," ").trim();return h[0]})(n);Js[o]=wr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&Js.g?Js.g:null;return t&&(Js.g=Js[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(Js[o],e,s,l),o},gv=(n,e,t)=>n.reduce((s,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":wr(l,""):l===!1?"":l}return s+r+(o??"")},"");function Yc(n){let e=this||{},t=n.call?n(e.p):n;return hv(t.unshift?t.raw?gv(t,[].slice.call(arguments,1),e.p):t.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):t,dv(e.target),e.g,e.o,e.k)}let Jg,ym,bm;Yc.bind({g:1});let rr=Yc.bind({k:1});function yv(n,e,t,s){wr.p=e,Jg=n,ym=t,bm=s}function Wr(n,e){let t=this||{};return function(){let s=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:ym&&ym()},l),t.o=/ *go\d+/.test(u),l.className=Yc.apply(t,s)+(u?" "+u:"");let m=n;return n[0]&&(m=l.as||n,delete l.as),bm&&m[0]&&bm(l),Jg(m,l)}return r}}var bv=n=>typeof n=="function",vc=(n,e)=>bv(n)?n(e):n,Nv=(()=>{let n=0;return()=>(++n).toString()})(),Zg=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),xv=20,Nd="default",ey=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:s}=e;return ey(n,{type:n.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...n,toasts:n.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},ec=[],ty={toasts:[],pausedAt:void 0,settings:{toastLimit:xv}},Ms={},ny=(n,e=Nd)=>{Ms[e]=ey(Ms[e]||ty,n),ec.forEach(([t,s])=>{t===e&&s(Ms[e])})},sy=n=>Object.keys(Ms).forEach(e=>ny(n,e)),vv=n=>Object.keys(Ms).find(e=>Ms[e].toasts.some(t=>t.id===n)),Xc=(n=Nd)=>e=>{ny(e,n)},_v={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Dv=(n={},e=Nd)=>{let[t,s]=E.useState(Ms[e]||ty),r=E.useRef(Ms[e]);E.useEffect(()=>(r.current!==Ms[e]&&s(Ms[e]),ec.push([e,s]),()=>{let o=ec.findIndex(([l])=>l===e);o>-1&&ec.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((l=n[o.type])==null?void 0:l.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((u=n[o.type])==null?void 0:u.duration)||(n==null?void 0:n.duration)||_v[o.type],style:{...n.style,...(m=n[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},kv=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Nv()}),dl=n=>(e,t)=>{let s=kv(e,n,t);return Xc(s.toasterId||vv(s.id))({type:2,toast:s}),s.id},wn=(n,e)=>dl("blank")(n,e);wn.error=dl("error");wn.success=dl("success");wn.loading=dl("loading");wn.custom=dl("custom");wn.dismiss=(n,e)=>{let t={type:3,toastId:n};e?Xc(e)(t):sy(t)};wn.dismissAll=n=>wn.dismiss(void 0,n);wn.remove=(n,e)=>{let t={type:4,toastId:n};e?Xc(e)(t):sy(t)};wn.removeAll=n=>wn.remove(void 0,n);wn.promise=(n,e,t)=>{let s=wn.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(r=>{let i=e.success?vc(e.success,r):void 0;return i?wn.success(i,{id:s,...t,...t==null?void 0:t.success}):wn.dismiss(s),r}).catch(r=>{let i=e.error?vc(e.error,r):void 0;i?wn.error(i,{id:s,...t,...t==null?void 0:t.error}):wn.dismiss(s)}),n};var Ev=1e3,Av=(n,e="default")=>{let{toasts:t,pausedAt:s}=Dv(n,e),r=E.useRef(new Map).current,i=E.useCallback((f,h=Ev)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},h);r.set(f,y)},[]);E.useEffect(()=>{if(s)return;let f=Date.now(),h=t.map(y=>{if(y.duration===1/0)return;let w=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(w<0){y.visible&&wn.dismiss(y.id);return}return setTimeout(()=>wn.dismiss(y.id,e),w)});return()=>{h.forEach(y=>y&&clearTimeout(y))}},[t,s,e]);let o=E.useCallback(Xc(e),[e]),l=E.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=E.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),m=E.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),d=E.useCallback((f,h)=>{let{reverseOrder:y=!1,gutter:w=8,defaultPosition:v}=h||{},C=t.filter(F=>(F.position||v)===(f.position||v)&&F.height),B=C.findIndex(F=>F.id===f.id),T=C.filter((F,re)=>re<B&&F.visible).length;return C.filter(F=>F.visible).slice(...y?[T+1]:[0,T]).reduce((F,re)=>F+(re.height||0)+w,0)},[t]);return E.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},Vv=rr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Cv=rr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,wv=rr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Iv=Wr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Vv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Cv} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${wv} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Sv=rr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Tv=Wr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${Sv} 1s linear infinite;
`,Pv=rr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Lv=rr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,jv=Wr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Pv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Lv} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Rv=Wr("div")`
  position: absolute;
`,Bv=Wr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Uv=rr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Hv=Wr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Uv} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Mv=({toast:n})=>{let{icon:e,type:t,iconTheme:s}=n;return e!==void 0?typeof e=="string"?E.createElement(Hv,null,e):e:t==="blank"?null:E.createElement(Bv,null,E.createElement(Tv,{...s}),t!=="loading"&&E.createElement(Rv,null,t==="error"?E.createElement(Iv,{...s}):E.createElement(jv,{...s})))},Fv=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Ov=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,qv="0%{opacity:0;} 100%{opacity:1;}",$v="0%{opacity:1;} 100%{opacity:0;}",zv=Wr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Wv=Wr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Kv=(n,e)=>{let t=n.includes("top")?1:-1,[s,r]=Zg()?[qv,$v]:[Fv(t),Ov(t)];return{animation:e?`${rr(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${rr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Gv=E.memo(({toast:n,position:e,style:t,children:s})=>{let r=n.height?Kv(n.position||e||"top-center",n.visible):{opacity:0},i=E.createElement(Mv,{toast:n}),o=E.createElement(Wv,{...n.ariaProps},vc(n.message,n));return E.createElement(zv,{className:n.className,style:{...r,...t,...n.style}},typeof s=="function"?s({icon:i,message:o}):E.createElement(E.Fragment,null,i,o))});yv(E.createElement);var Qv=({id:n,className:e,style:t,onHeightUpdate:s,children:r})=>{let i=E.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;s(n,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,s]);return E.createElement("div",{ref:i,className:e,style:t},r)},Yv=(n,e)=>{let t=n.includes("top"),s=t?{top:0}:{bottom:0},r=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Zg()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...s,...r}},Xv=Yc`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Tl=16,Jv=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:s,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=Av(t,i);return E.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Tl,left:Tl,right:Tl,bottom:Tl,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,h=m.calculateOffset(d,{reverseOrder:n,gutter:s,defaultPosition:e}),y=Yv(f,h);return E.createElement(Qv,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?Xv:"",style:y},d.type==="custom"?vc(d.message,d):r?r(d):E.createElement(Gv,{toast:d,position:f}))}))},oe=wn;const Ws=Object.create(null);Ws.open="0";Ws.close="1";Ws.ping="2";Ws.pong="3";Ws.message="4";Ws.upgrade="5";Ws.noop="6";const tc=Object.create(null);Object.keys(Ws).forEach(n=>{tc[Ws[n]]=n});const Nm={type:"error",data:"parser error"},ry=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",iy=typeof ArrayBuffer=="function",oy=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,xd=({type:n,data:e},t,s)=>ry&&e instanceof Blob?t?s(e):op(e,s):iy&&(e instanceof ArrayBuffer||oy(e))?t?s(e):op(new Blob([e]),s):s(Ws[n]+(e||"")),op=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function ap(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let Gu;function Zv(n,e){if(ry&&n.data instanceof Blob)return n.data.arrayBuffer().then(ap).then(e);if(iy&&(n.data instanceof ArrayBuffer||oy(n.data)))return e(ap(n.data));xd(n,!1,t=>{Gu||(Gu=new TextEncoder),e(Gu.encode(t))})}const lp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Aa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<lp.length;n++)Aa[lp.charCodeAt(n)]=n;const e_=n=>{let e=n.length*.75,t=n.length,s,r=0,i,o,l,u;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(s=0;s<t;s+=4)i=Aa[n.charCodeAt(s)],o=Aa[n.charCodeAt(s+1)],l=Aa[n.charCodeAt(s+2)],u=Aa[n.charCodeAt(s+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},t_=typeof ArrayBuffer=="function",vd=(n,e)=>{if(typeof n!="string")return{type:"message",data:ay(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:n_(n.substring(1),e)}:tc[t]?n.length>1?{type:tc[t],data:n.substring(1)}:{type:tc[t]}:Nm},n_=(n,e)=>{if(t_){const t=e_(n);return ay(t,e)}else return{base64:!0,data:n}},ay=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},ly="",s_=(n,e)=>{const t=n.length,s=new Array(t);let r=0;n.forEach((i,o)=>{xd(i,!1,l=>{s[o]=l,++r===t&&e(s.join(ly))})})},r_=(n,e)=>{const t=n.split(ly),s=[];for(let r=0;r<t.length;r++){const i=vd(t[r],e);if(s.push(i),i.type==="error")break}return s};function i_(){return new TransformStream({transform(n,e){Zv(n,t=>{const s=t.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let Qu;function Pl(n){return n.reduce((e,t)=>e+t.length,0)}function Ll(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)t[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function o_(n,e){Qu||(Qu=new TextDecoder);const t=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(s===0){if(Pl(t)<1)break;const u=Ll(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(Pl(t)<2)break;const u=Ll(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),s=3}else if(s===2){if(Pl(t)<8)break;const u=Ll(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(Nm);break}r=d*Math.pow(2,32)+m.getUint32(4),s=3}else{if(Pl(t)<r)break;const u=Ll(t,r);l.enqueue(vd(i?u:Qu.decode(u),e)),s=0}if(r===0||r>n){l.enqueue(Nm);break}}}})}const cy=4;function _n(n){if(n)return a_(n)}function a_(n){for(var e in _n.prototype)n[e]=_n.prototype[e];return n}_n.prototype.on=_n.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};_n.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};_n.prototype.off=_n.prototype.removeListener=_n.prototype.removeAllListeners=_n.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<t.length;r++)if(s=t[r],s===e||s.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};_n.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,r=t.length;s<r;++s)t[s].apply(this,e)}return this};_n.prototype.emitReserved=_n.prototype.emit;_n.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};_n.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Jc=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ps=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),l_="arraybuffer";function uy(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const c_=ps.setTimeout,u_=ps.clearTimeout;function Zc(n,e){e.useNativeTimers?(n.setTimeoutFn=c_.bind(ps),n.clearTimeoutFn=u_.bind(ps)):(n.setTimeoutFn=ps.setTimeout.bind(ps),n.clearTimeoutFn=ps.clearTimeout.bind(ps))}const m_=1.33;function d_(n){return typeof n=="string"?f_(n):Math.ceil((n.byteLength||n.size)*m_)}function f_(n){let e=0,t=0;for(let s=0,r=n.length;s<r;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function my(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function p_(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function h_(n){let e={},t=n.split("&");for(let s=0,r=t.length;s<r;s++){let i=t[s].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class g_ extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class _d extends _n{constructor(e){super(),this.writable=!1,Zc(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new g_(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=vd(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=p_(e);return t.length?"?"+t:""}}class y_ extends _d{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};r_(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,s_(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=my()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let dy=!1;try{dy=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const b_=dy;function N_(){}class x_ extends y_{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}let xo=class nc extends _n{constructor(e,t,s){super(),this.createRequest=e,Zc(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=uy(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=nc.requestsCount++,nc.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=N_,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete nc.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};xo.requestsCount=0;xo.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",cp);else if(typeof addEventListener=="function"){const n="onpagehide"in ps?"pagehide":"unload";addEventListener(n,cp,!1)}}function cp(){for(let n in xo.requests)xo.requests.hasOwnProperty(n)&&xo.requests[n].abort()}const v_=function(){const n=fy({xdomain:!1});return n&&n.responseType!==null}();class __ extends x_{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=v_&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new xo(fy,this.uri(),e)}}function fy(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||b_))return new XMLHttpRequest}catch{}if(!e)try{return new ps[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const py=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class D_ extends _d{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=py?{}:uy(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;xd(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&Jc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=my()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Yu=ps.WebSocket||ps.MozWebSocket;class k_ extends D_{createSocket(e,t,s){return py?new Yu(e,t,s):t?new Yu(e,t):new Yu(e)}doWrite(e,t){this.ws.send(t)}}class E_ extends _d{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=o_(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),r=i_();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;this._writer.write(s).then(()=>{r&&Jc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const A_={websocket:k_,webtransport:E_,polling:__},V_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,C_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function xm(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let r=V_.exec(n||""),i={},o=14;for(;o--;)i[C_[o]]=r[o]||"";return t!=-1&&s!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=w_(i,i.path),i.queryKey=I_(i,i.query),i}function w_(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function I_(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(t[r]=i)}),t}const vm=typeof addEventListener=="function"&&typeof removeEventListener=="function",sc=[];vm&&addEventListener("offline",()=>{sc.forEach(n=>n())},!1);class Pr extends _n{constructor(e,t){if(super(),this.binaryType=l_,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=xm(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=xm(t.host).host);Zc(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=h_(this.opts.query)),vm&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},sc.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=cy,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Pr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Pr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(t+=d_(r)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Jc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,r){if(typeof t=="function"&&(r=t,t=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:e,data:t,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(Pr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),vm&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=sc.indexOf(this._offlineEventListener);s!==-1&&sc.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Pr.protocol=cy;class S_ extends Pr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;Pr.priorWebsocketSuccess=!1;const r=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!s)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Pr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){s||(s=!0,d(),t.close(),t=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let T_=class extends S_{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>A_[r]).filter(r=>!!r)),super(e,s)}};function P_(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=xm(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+e,s.href=s.protocol+"://"+i+(t&&t.port===s.port?"":":"+s.port),s}const L_=typeof ArrayBuffer=="function",j_=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,hy=Object.prototype.toString,R_=typeof Blob=="function"||typeof Blob<"u"&&hy.call(Blob)==="[object BlobConstructor]",B_=typeof File=="function"||typeof File<"u"&&hy.call(File)==="[object FileConstructor]";function Dd(n){return L_&&(n instanceof ArrayBuffer||j_(n))||R_&&n instanceof Blob||B_&&n instanceof File}function rc(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(rc(n[t]))return!0;return!1}if(Dd(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return rc(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&rc(n[t]))return!0;return!1}function U_(n){const e=[],t=n.data,s=n;return s.data=_m(t,e),s.attachments=e.length,{packet:s,buffers:e}}function _m(n,e){if(!n)return n;if(Dd(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=_m(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=_m(n[s],e));return t}return n}function H_(n,e){return n.data=Dm(n.data,e),delete n.attachments,n}function Dm(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=Dm(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=Dm(n[t],e));return n}const M_=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],F_=5;var kt;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(kt||(kt={}));class O_{constructor(e){this.replacer=e}encode(e){return(e.type===kt.EVENT||e.type===kt.ACK)&&rc(e)?this.encodeAsBinary({type:e.type===kt.EVENT?kt.BINARY_EVENT:kt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===kt.BINARY_EVENT||e.type===kt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=U_(e),s=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(s),r}}function up(n){return Object.prototype.toString.call(n)==="[object Object]"}class kd extends _n{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===kt.BINARY_EVENT;s||t.type===kt.BINARY_ACK?(t.type=s?kt.EVENT:kt.ACK,this.reconstructor=new q_(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Dd(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(kt[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===kt.BINARY_EVENT||s.type===kt.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(i,t)}else s.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(kd.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case kt.CONNECT:return up(t);case kt.DISCONNECT:return t===void 0;case kt.CONNECT_ERROR:return typeof t=="string"||up(t);case kt.EVENT:case kt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&M_.indexOf(t[0])===-1);case kt.ACK:case kt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class q_{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=H_(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const $_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:kd,Encoder:O_,get PacketType(){return kt},protocol:F_},Symbol.toStringTag,{value:"Module"}));function vs(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const z_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class gy extends _n{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[vs(e,"open",this.onopen.bind(this)),vs(e,"packet",this.onpacket.bind(this)),vs(e,"error",this.onerror.bind(this)),vs(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,r,i;if(z_.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:kt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((s,r)=>{const i=(o,l)=>o?r(o):s(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:kt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case kt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case kt.EVENT:case kt.BINARY_EVENT:this.onevent(e);break;case kt.ACK:case kt.BINARY_ACK:this.onack(e);break;case kt.DISCONNECT:this.ondisconnect();break;case kt.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...r){s||(s=!0,t.packet({type:kt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:kt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function Bo(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Bo.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};Bo.prototype.reset=function(){this.attempts=0};Bo.prototype.setMin=function(n){this.ms=n};Bo.prototype.setMax=function(n){this.max=n};Bo.prototype.setJitter=function(n){this.jitter=n};class km extends _n{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Zc(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Bo({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||$_;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new T_(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=vs(t,"open",function(){s.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=vs(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(vs(e,"ping",this.onping.bind(this)),vs(e,"data",this.ondata.bind(this)),vs(e,"error",this.onerror.bind(this)),vs(e,"close",this.onclose.bind(this)),vs(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Jc(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new gy(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const ea={};function Pa(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=P_(n,e.path||"/socket.io"),s=t.source,r=t.id,i=t.path,o=ea[r]&&i in ea[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new km(s,e):(ea[r]||(ea[r]=new km(s,e)),u=ea[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Pa,{Manager:km,Socket:gy,io:Pa,connect:Pa});function W_(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=n;let l,u,m;const d=async(h=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await Ys(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const y=()=>{h=!0,l==null||l.addEventListener("controlling",w=>{w.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",w=>{typeof w.isUpdate>"u"?typeof w.isExternal<"u"?w.isExternal?y():!h&&(s==null||s()):w.isExternal?window.location.reload():!h&&(s==null||s()):w.isUpdate||s==null||s()}),l.addEventListener("waiting",y),l.addEventListener("externalwaiting",y)}l.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}const K_=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},G_=K_(),we=Sx.create({baseURL:G_,headers:{"Content-Type":"application/json"}});we.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers.Authorization=`Bearer ${e}`),n},n=>Promise.reject(n));we.interceptors.response.use(n=>n,n=>{var e,t,s;return((e=n.response)==null?void 0:e.status)===401&&!((s=(t=n.config)==null?void 0:t.url)!=null&&s.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(n)});const Q_=10*60*1e3,Y_=ud((n,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<Q_){console.log("[SpecbookStore]   , ");return}n({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const s=await we.get("/specbook/library/meta");n({libraryItems:s.data,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",s.data.length," ")}catch(s){console.error("[SpecbookStore]   :",s),n({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const s=await we.get("/specbook/categories");n({categories:s.data,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",s.data.length,"")}catch(s){console.error("[SpecbookStore]   :",s)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:s}=e();await Promise.all([t(),s()])},getLibraryItems:(t,s)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),s&&s.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return s.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:s}=e();return s.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const o=(await we.get(`/specbook/project/${t}/meta`)).data;return n(l=>{const u=new Map(l.projectItemsCache);return u.set(t,o),{projectItemsCache:u}}),o}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{n(s=>{const r=new Map(s.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?n(s=>({libraryItems:[t,...s.libraryItems]})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?n(s=>({libraryItems:s.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,s,r)=>{s?n(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&n(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),yy=E.createContext(void 0);function X_({children:n}){const[e,t]=E.useState(null),[s,r]=E.useState(!0),i=Ig(),o=Y_(f=>f.preloadAll);E.useEffect(()=>{l()},[]);const l=async()=>{var f;try{const h=localStorage.getItem("token");if(!h){r(!1);return}we.defaults.headers.common.Authorization=`Bearer ${h}`;const y=await we.get("/auth/me");y.data.success&&(t(y.data.user),o())}catch(h){if(((f=h.response)==null?void 0:f.status)===401)localStorage.removeItem("token"),delete we.defaults.headers.common.Authorization;else{const w=localStorage.getItem("user");if(w)try{t(JSON.parse(w))}catch{}}}finally{r(!1)}},u=async(f,h)=>{var y,w;try{const v=await we.post("/auth/login",{username:f,password:h}),{token:C,user:B}=v.data;localStorage.setItem("token",C),localStorage.setItem("user",JSON.stringify(B)),we.defaults.headers.common.Authorization=`Bearer ${C}`,t(B),o(),oe.success(`${B.name}, !`);const T=sessionStorage.getItem("redirectAfterLogin");T?(sessionStorage.removeItem("redirectAfterLogin"),i(T)):i("/")}catch(v){const C=v;throw oe.error(((w=(y=C.response)==null?void 0:y.data)==null?void 0:w.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete we.defaults.headers.common.Authorization,t(null),i("/login"),oe.success("")},d=f=>{t(f)};return a.jsxDEV(yy.Provider,{value:{user:e,loading:s,login:u,logout:m,updateUser:d},children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:122,columnNumber:5},this)}function Kr(){const n=E.useContext(yy);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const J_={};function Z_(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const Ka=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(s){return Ka(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return Ka(s)(t)}}}},eD=(n,e)=>(t,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:C=>C,version:0,merge:(C,B)=>({...B,...C}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return n((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...C)},s,r);const d=Ka(i.serialize),f=()=>{const C=i.partialize({...s()});let B;const T=d({state:C,version:i.version}).then(F=>m.setItem(i.name,F)).catch(F=>{B=F});if(B)throw B;return T},h=r.setState;r.setState=(C,B)=>{h(C,B),f()};const y=n((...C)=>{t(...C),f()},s,r);let w;const v=()=>{var C;if(!m)return;o=!1,l.forEach(T=>T(s()));const B=((C=i.onRehydrateStorage)==null?void 0:C.call(i,s()))||void 0;return Ka(m.getItem.bind(m))(i.name).then(T=>{if(T)return i.deserialize(T)}).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return i.migrate(T.state,T.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return T.state}).then(T=>{var F;return w=i.merge(T,(F=s())!=null?F:y),t(w,!0),f()}).then(()=>{B==null||B(w,void 0),o=!0,u.forEach(T=>T(w))}).catch(T=>{B==null||B(void 0,T)})};return r.persist={setOptions:C=>{i={...i,...C},C.getStorage&&(m=C.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:C=>(l.add(C),()=>{l.delete(C)}),onFinishHydration:C=>(u.add(C),()=>{u.delete(C)})},v(),w||y},tD=(n,e)=>(t,s,r)=>{let i={storage:Z_(()=>localStorage),partialize:v=>v,version:0,merge:(v,C)=>({...C,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},s,r);const d=()=>{const v=i.partialize({...s()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,C)=>{f(v,C),d()};const h=n((...v)=>{t(...v),d()},s,r);r.getInitialState=()=>h;let y;const w=()=>{var v,C;if(!m)return;o=!1,l.forEach(T=>{var F;return T((F=s())!=null?F:h)});const B=((C=i.onRehydrateStorage)==null?void 0:C.call(i,(v=s())!=null?v:h))||void 0;return Ka(m.getItem.bind(m))(i.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return[!0,i.migrate(T.state,T.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var F;const[re,ee]=T;if(y=i.merge(ee,(F=s())!=null?F:h),t(y,!0),re)return d()}).then(()=>{B==null||B(y,void 0),y=s(),o=!0,u.forEach(T=>T(y))}).catch(T=>{B==null||B(void 0,T)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||w(),y||h},nD=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((J_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),eD(n,e)):tD(n,e),by=nD,Ny=ud()(by((n,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const s={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};n(r=>({notifications:[s,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{n(s=>({notifications:s.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{n(t=>({notifications:t.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},deleteNotification:t=>{n(s=>{const r=s.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:s.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAll:()=>{n({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:n=>({notifications:n.notifications,unreadCount:n.unreadCount})}));var sD={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},rD=function(e,t,s){var r,i=sD[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?r+" ":r+" ":r},iD={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},oD={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},aD={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},lD={date:Ku({formats:iD,defaultWidth:"full"}),time:Ku({formats:oD,defaultWidth:"full"}),dateTime:Ku({formats:aD,defaultWidth:"full"})},cD={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},uD=function(e,t,s,r){return cD[e]},mD={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},dD={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},fD={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},pD={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},hD={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},gD={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},yD=function(e,t){var s=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(s);case"date":return s+"";default:return s+""}},bD={ordinalNumber:yD,era:Jo({values:mD,defaultWidth:"wide"}),quarter:Jo({values:dD,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Jo({values:fD,defaultWidth:"wide"}),day:Jo({values:pD,defaultWidth:"wide"}),dayPeriod:Jo({values:hD,defaultWidth:"wide",formattingValues:gD,defaultFormattingWidth:"wide"})},ND=/^(\d+)(|)?/i,xD=/\d+/i,vD={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},_D={any:[/^(bc|)/i,/^(ad|)/i]},DD={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},kD={any:[/1/i,/2/i,/3/i,/4/i]},ED={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},AD={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},VD={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},CD={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},wD={any:/^(am|pm|||||||)/i},ID={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},SD={ordinalNumber:Kx({matchPattern:ND,parsePattern:xD,valueCallback:function(e){return parseInt(e,10)}}),era:Zo({matchPatterns:vD,defaultMatchWidth:"wide",parsePatterns:_D,defaultParseWidth:"any"}),quarter:Zo({matchPatterns:DD,defaultMatchWidth:"wide",parsePatterns:kD,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Zo({matchPatterns:ED,defaultMatchWidth:"wide",parsePatterns:AD,defaultParseWidth:"any"}),day:Zo({matchPatterns:VD,defaultMatchWidth:"wide",parsePatterns:CD,defaultParseWidth:"any"}),dayPeriod:Zo({matchPatterns:wD,defaultMatchWidth:"any",parsePatterns:ID,defaultParseWidth:"any"})},xn={code:"ko",formatDistance:rD,formatLong:lD,formatRelative:uD,localize:bD,match:SD,options:{weekStartsOn:0,firstWeekContainsDate:1}};const TD=({isOpen:n,onClose:e})=>{const t=Ig(),{notifications:s,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=Ny();if(!n)return null;const m=h=>{switch(h){case"payment":return a.jsxDEV(Rx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(jx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(Pg,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(Lx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(Wu,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(t(h.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(Wu,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vn,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),s.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(Tg,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(ki,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(Wu,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:s.map(h=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:m(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Gx(new Date(h.createdAt),{addSuffix:!0,locale:xn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:y=>{y.stopPropagation(),l(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(vn,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},PD=()=>{};var mp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},LD=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},vy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,m=u?n[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let h=(l&15)<<2|m>>6,y=m&63;u||(y=64,o||(h=64)),s.push(t[d],t[f],t[h],t[y])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(xy(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):LD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const m=r<n.length?t[n.charAt(r)]:64;++r;const f=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new jD;const h=i<<2|l>>4;if(s.push(h),m!==64){const y=l<<4&240|m>>2;if(s.push(y),f!==64){const w=m<<6&192|f;s.push(w)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class jD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RD=function(n){const e=xy(n);return vy.encodeByteArray(e,!0)},_c=function(n){return RD(n).replace(/\./g,"")},BD=function(n){try{return vy.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=()=>_y().__FIREBASE_DEFAULTS__,HD=()=>{if(typeof process>"u"||typeof mp>"u")return;const n=mp.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},MD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&BD(n[1]);return e&&JSON.parse(e)},Ed=()=>{try{return PD()||UD()||HD()||MD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},FD=n=>{var e,t;return(t=(e=Ed())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Dy=n=>{const e=FD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},ky=()=>{var n;return(n=Ed())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ey(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[_c(JSON.stringify(t)),_c(JSON.stringify(o)),""].join(".")}const La={};function qD(){const n={prod:[],emulator:[]};for(const e of Object.keys(La))La[e]?n.emulator.push(e):n.prod.push(e);return n}function $D(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let dp=!1;function Vy(n,e){if(typeof window>"u"||typeof document>"u"||!eu(window.location.host)||La[n]===e||La[n]||dp)return;La[n]=e;function t(h){return`__firebase__banner__${h}`}const s="__firebase__banner",i=qD().prod.length>0;function o(){const h=document.getElementById(s);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function u(h,y){h.setAttribute("width","24"),h.setAttribute("id",y),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function m(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{dp=!0,o()},h}function d(h,y){h.setAttribute("id",y),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=$D(s),y=t("text"),w=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),C=document.getElementById(v)||document.createElement("a"),B=t("preprendIcon"),T=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const F=h.element;l(F),d(C,v);const re=m();u(T,B),F.append(T,w,C,re),document.body.appendChild(F)}i?(w.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Cy(){var e;const n=(e=Ed())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wy(){return!Cy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Iy(){return!Cy()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Sy(){try{return typeof indexedDB=="object"}catch{return!1}}function zD(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD="FirebaseError";class Pi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=WD,Object.setPrototypeOf(this,Pi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ty.prototype.create)}}class Ty{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?KD(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new Pi(r,l,s)}}function KD(n,e){return n.replace(GD,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const GD=/\{\$([^}]+)}/g;function kc(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(fp(i)&&fp(o)){if(!kc(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function fp(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(n){return n&&n._delegate?n._delegate:n}class _o{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new OD;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(XD(e))try{this.getOrInitializeService({instanceIdentifier:ci})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=ci){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ci){return this.instances.has(e)}getOptions(e=ci){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:YD(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ci){return this.component?this.component.multipleInstances?e:ci:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YD(n){return n===ci?void 0:n}function XD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new QD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ct||(Ct={}));const ZD={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},ek=Ct.INFO,tk={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},nk=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=tk[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Py{constructor(e){this.name=e,this._logLevel=ek,this._logHandler=nk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ZD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const sk=(n,e)=>e.some(t=>n instanceof t);let pp,hp;function rk(){return pp||(pp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ik(){return hp||(hp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ly=new WeakMap,Em=new WeakMap,jy=new WeakMap,Xu=new WeakMap,Ad=new WeakMap;function ok(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Lr(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Ly.set(t,n)}).catch(()=>{}),Ad.set(e,n),e}function ak(n){if(Em.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Em.set(n,e)}let Am={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Em.get(n);if(e==="objectStoreNames")return n.objectStoreNames||jy.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Lr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function lk(n){Am=n(Am)}function ck(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Ju(this),e,...t);return jy.set(s,e.sort?e.sort():[e]),Lr(s)}:ik().includes(n)?function(...e){return n.apply(Ju(this),e),Lr(Ly.get(this))}:function(...e){return Lr(n.apply(Ju(this),e))}}function uk(n){return typeof n=="function"?ck(n):(n instanceof IDBTransaction&&ak(n),sk(n,rk())?new Proxy(n,Am):n)}function Lr(n){if(n instanceof IDBRequest)return ok(n);if(Xu.has(n))return Xu.get(n);const e=uk(n);return e!==n&&(Xu.set(n,e),Ad.set(e,n)),e}const Ju=n=>Ad.get(n);function mk(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),l=Lr(o);return s&&o.addEventListener("upgradeneeded",u=>{s(Lr(o.result),u.oldVersion,u.newVersion,Lr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const dk=["get","getKey","getAll","getAllKeys","count"],fk=["put","add","delete","clear"],Zu=new Map;function gp(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Zu.get(e))return Zu.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=fk.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||dk.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return s&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return Zu.set(e,i),i}lk(n=>({...n,get:(e,t,s)=>gp(e,t)||n.get(e,t,s),has:(e,t)=>!!gp(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(hk(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function hk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Vm="@firebase/app",yp="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=new Py("@firebase/app"),gk="@firebase/app-compat",yk="@firebase/analytics-compat",bk="@firebase/analytics",Nk="@firebase/app-check-compat",xk="@firebase/app-check",vk="@firebase/auth",_k="@firebase/auth-compat",Dk="@firebase/database",kk="@firebase/data-connect",Ek="@firebase/database-compat",Ak="@firebase/functions",Vk="@firebase/functions-compat",Ck="@firebase/installations",wk="@firebase/installations-compat",Ik="@firebase/messaging",Sk="@firebase/messaging-compat",Tk="@firebase/performance",Pk="@firebase/performance-compat",Lk="@firebase/remote-config",jk="@firebase/remote-config-compat",Rk="@firebase/storage",Bk="@firebase/storage-compat",Uk="@firebase/firestore",Hk="@firebase/ai",Mk="@firebase/firestore-compat",Fk="firebase",Ok="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="[DEFAULT]",qk={[Vm]:"fire-core",[gk]:"fire-core-compat",[bk]:"fire-analytics",[yk]:"fire-analytics-compat",[xk]:"fire-app-check",[Nk]:"fire-app-check-compat",[vk]:"fire-auth",[_k]:"fire-auth-compat",[Dk]:"fire-rtdb",[kk]:"fire-data-connect",[Ek]:"fire-rtdb-compat",[Ak]:"fire-fn",[Vk]:"fire-fn-compat",[Ck]:"fire-iid",[wk]:"fire-iid-compat",[Ik]:"fire-fcm",[Sk]:"fire-fcm-compat",[Tk]:"fire-perf",[Pk]:"fire-perf-compat",[Lk]:"fire-rc",[jk]:"fire-rc-compat",[Rk]:"fire-gcs",[Bk]:"fire-gcs-compat",[Uk]:"fire-fst",[Mk]:"fire-fst-compat",[Hk]:"fire-vertex","fire-js":"fire-js",[Fk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ec=new Map,$k=new Map,wm=new Map;function bp(n,e){try{n.container.addComponent(e)}catch(t){ir.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ga(n){const e=n.name;if(wm.has(e))return ir.debug(`There were multiple attempts to register component ${e}.`),!1;wm.set(e,n);for(const t of Ec.values())bp(t,n);for(const t of $k.values())bp(t,n);return!0}function Ry(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function By(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jr=new Ty("app","Firebase",zk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new _o("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=Ok;function Hy(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Cm,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw jr.create("bad-app-name",{appName:String(r)});if(t||(t=ky()),!t)throw jr.create("no-options");const i=Ec.get(r);if(i){if(kc(t,i.options)&&kc(s,i.config))return i;throw jr.create("duplicate-app",{appName:r})}const o=new JD(r);for(const u of wm.values())o.addComponent(u);const l=new Wk(t,s,o);return Ec.set(r,l),l}function My(n=Cm){const e=Ec.get(n);if(!e&&n===Cm&&ky())return Hy();if(!e)throw jr.create("no-app",{appName:n});return e}function Rr(n,e,t){let s=qk[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ir.warn(o.join(" "));return}Ga(new _o(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="firebase-heartbeat-database",Gk=1,Qa="firebase-heartbeat-store";let em=null;function Fy(){return em||(em=mk(Kk,Gk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Qa)}catch(t){console.warn(t)}}}}).catch(n=>{throw jr.create("idb-open",{originalErrorMessage:n.message})})),em}async function Qk(n){try{const t=(await Fy()).transaction(Qa),s=await t.objectStore(Qa).get(Oy(n));return await t.done,s}catch(e){if(e instanceof Pi)ir.warn(e.message);else{const t=jr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ir.warn(t.message)}}}async function Np(n,e){try{const s=(await Fy()).transaction(Qa,"readwrite");await s.objectStore(Qa).put(e,Oy(n)),await s.done}catch(t){if(t instanceof Pi)ir.warn(t.message);else{const s=jr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ir.warn(s.message)}}}function Oy(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk=1024,Xk=30;class Jk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new eE(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=xp();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>Xk){const o=tE(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){ir.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=xp(),{heartbeatsToSend:s,unsentEntries:r}=Zk(this._heartbeatsCache.heartbeats),i=_c(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ir.warn(t),""}}}function xp(){return new Date().toISOString().substring(0,10)}function Zk(n,e=Yk){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),vp(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),vp(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class eE{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Sy()?zD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Qk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Np(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Np(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function vp(n){return _c(JSON.stringify({version:2,heartbeats:n})).length}function tE(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(n){Ga(new _o("platform-logger",e=>new pk(e),"PRIVATE")),Ga(new _o("heartbeat",e=>new Jk(e),"PRIVATE")),Rr(Vm,yp,n),Rr(Vm,yp,"esm2020"),Rr("fire-js","")}nE("");var sE="firebase",rE="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rr(sE,rE,"app");var _p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Br,qy;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,N){function V(){}V.prototype=N.prototype,A.F=N.prototype,A.prototype=new V,A.prototype.constructor=A,A.D=function(j,S,I){for(var k=Array(arguments.length-2),De=2;De<arguments.length;De++)k[De-2]=arguments[De];return N.prototype[S].apply(j,k)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(A,N,V){V||(V=0);const j=Array(16);if(typeof N=="string")for(var S=0;S<16;++S)j[S]=N.charCodeAt(V++)|N.charCodeAt(V++)<<8|N.charCodeAt(V++)<<16|N.charCodeAt(V++)<<24;else for(S=0;S<16;++S)j[S]=N[V++]|N[V++]<<8|N[V++]<<16|N[V++]<<24;N=A.g[0],V=A.g[1],S=A.g[2];let I=A.g[3],k;k=N+(I^V&(S^I))+j[0]+3614090360&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[1]+3905402710&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[2]+606105819&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[3]+3250441966&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(I^V&(S^I))+j[4]+4118548399&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[5]+1200080426&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[6]+2821735955&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[7]+4249261313&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(I^V&(S^I))+j[8]+1770035416&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[9]+2336552879&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[10]+4294925233&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[11]+2304563134&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(I^V&(S^I))+j[12]+1804603682&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[13]+4254626195&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[14]+2792965006&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[15]+1236535329&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(S^I&(V^S))+j[1]+4129170786&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[6]+3225465664&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[11]+643717713&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[0]+3921069994&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(S^I&(V^S))+j[5]+3593408605&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[10]+38016083&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[15]+3634488961&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[4]+3889429448&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(S^I&(V^S))+j[9]+568446438&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[14]+3275163606&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[3]+4107603335&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[8]+1163531501&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(S^I&(V^S))+j[13]+2850285829&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[2]+4243563512&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[7]+1735328473&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[12]+2368359562&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(V^S^I)+j[5]+4294588738&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[8]+2272392833&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[11]+1839030562&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[14]+4259657740&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(V^S^I)+j[1]+2763975236&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[4]+1272893353&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[7]+4139469664&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[10]+3200236656&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(V^S^I)+j[13]+681279174&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[0]+3936430074&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[3]+3572445317&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[6]+76029189&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(V^S^I)+j[9]+3654602809&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[12]+3873151461&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[15]+530742520&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[2]+3299628645&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(S^(V|~I))+j[0]+4096336452&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[7]+1126891415&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[14]+2878612391&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[5]+4237533241&4294967295,V=S+(k<<21&4294967295|k>>>11),k=N+(S^(V|~I))+j[12]+1700485571&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[3]+2399980690&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[10]+4293915773&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[1]+2240044497&4294967295,V=S+(k<<21&4294967295|k>>>11),k=N+(S^(V|~I))+j[8]+1873313359&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[15]+4264355552&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[6]+2734768916&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[13]+1309151649&4294967295,V=S+(k<<21&4294967295|k>>>11),k=N+(S^(V|~I))+j[4]+4149444226&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[11]+3174756917&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[2]+718787259&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[9]+3951481745&4294967295,A.g[0]=A.g[0]+N&4294967295,A.g[1]=A.g[1]+(S+(k<<21&4294967295|k>>>11))&4294967295,A.g[2]=A.g[2]+S&4294967295,A.g[3]=A.g[3]+I&4294967295}s.prototype.v=function(A,N){N===void 0&&(N=A.length);const V=N-this.blockSize,j=this.C;let S=this.h,I=0;for(;I<N;){if(S==0)for(;I<=V;)r(this,A,I),I+=this.blockSize;if(typeof A=="string"){for(;I<N;)if(j[S++]=A.charCodeAt(I++),S==this.blockSize){r(this,j),S=0;break}}else for(;I<N;)if(j[S++]=A[I++],S==this.blockSize){r(this,j),S=0;break}}this.h=S,this.o+=N},s.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var N=1;N<A.length-8;++N)A[N]=0;N=this.o*8;for(var V=A.length-8;V<A.length;++V)A[V]=N&255,N/=256;for(this.v(A),A=Array(16),N=0,V=0;V<4;++V)for(let j=0;j<32;j+=8)A[N++]=this.g[V]>>>j&255;return A};function i(A,N){var V=l;return Object.prototype.hasOwnProperty.call(V,A)?V[A]:V[A]=N(A)}function o(A,N){this.h=N;const V=[];let j=!0;for(let S=A.length-1;S>=0;S--){const I=A[S]|0;j&&I==N||(V[S]=I,j=!1)}this.g=V}var l={};function u(A){return-128<=A&&A<128?i(A,function(N){return new o([N|0],N<0?-1:0)}):new o([A|0],A<0?-1:0)}function m(A){if(isNaN(A)||!isFinite(A))return f;if(A<0)return C(m(-A));const N=[];let V=1;for(let j=0;A>=V;j++)N[j]=A/V|0,V*=4294967296;return new o(N,0)}function d(A,N){if(A.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(A.charAt(0)=="-")return C(d(A.substring(1),N));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const V=m(Math.pow(N,8));let j=f;for(let I=0;I<A.length;I+=8){var S=Math.min(8,A.length-I);const k=parseInt(A.substring(I,I+S),N);S<8?(S=m(Math.pow(N,S)),j=j.j(S).add(m(k))):(j=j.j(V),j=j.add(m(k)))}return j}var f=u(0),h=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(v(this))return-C(this).m();let A=0,N=1;for(let V=0;V<this.g.length;V++){const j=this.i(V);A+=(j>=0?j:4294967296+j)*N,N*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(w(this))return"0";if(v(this))return"-"+C(this).toString(A);const N=m(Math.pow(A,6));var V=this;let j="";for(;;){const S=re(V,N).g;V=B(V,S.j(N));let I=((V.g.length>0?V.g[0]:V.h)>>>0).toString(A);if(V=S,w(V))return I+j;for(;I.length<6;)I="0"+I;j=I+j}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function w(A){if(A.h!=0)return!1;for(let N=0;N<A.g.length;N++)if(A.g[N]!=0)return!1;return!0}function v(A){return A.h==-1}n.l=function(A){return A=B(this,A),v(A)?-1:w(A)?0:1};function C(A){const N=A.g.length,V=[];for(let j=0;j<N;j++)V[j]=~A.g[j];return new o(V,~A.h).add(h)}n.abs=function(){return v(this)?C(this):this},n.add=function(A){const N=Math.max(this.g.length,A.g.length),V=[];let j=0;for(let S=0;S<=N;S++){let I=j+(this.i(S)&65535)+(A.i(S)&65535),k=(I>>>16)+(this.i(S)>>>16)+(A.i(S)>>>16);j=k>>>16,I&=65535,k&=65535,V[S]=k<<16|I}return new o(V,V[V.length-1]&-2147483648?-1:0)};function B(A,N){return A.add(C(N))}n.j=function(A){if(w(this)||w(A))return f;if(v(this))return v(A)?C(this).j(C(A)):C(C(this).j(A));if(v(A))return C(this.j(C(A)));if(this.l(y)<0&&A.l(y)<0)return m(this.m()*A.m());const N=this.g.length+A.g.length,V=[];for(var j=0;j<2*N;j++)V[j]=0;for(j=0;j<this.g.length;j++)for(let S=0;S<A.g.length;S++){const I=this.i(j)>>>16,k=this.i(j)&65535,De=A.i(S)>>>16,qe=A.i(S)&65535;V[2*j+2*S]+=k*qe,T(V,2*j+2*S),V[2*j+2*S+1]+=I*qe,T(V,2*j+2*S+1),V[2*j+2*S+1]+=k*De,T(V,2*j+2*S+1),V[2*j+2*S+2]+=I*De,T(V,2*j+2*S+2)}for(A=0;A<N;A++)V[A]=V[2*A+1]<<16|V[2*A];for(A=N;A<2*N;A++)V[A]=0;return new o(V,0)};function T(A,N){for(;(A[N]&65535)!=A[N];)A[N+1]+=A[N]>>>16,A[N]&=65535,N++}function F(A,N){this.g=A,this.h=N}function re(A,N){if(w(N))throw Error("division by zero");if(w(A))return new F(f,f);if(v(A))return N=re(C(A),N),new F(C(N.g),C(N.h));if(v(N))return N=re(A,C(N)),new F(C(N.g),N.h);if(A.g.length>30){if(v(A)||v(N))throw Error("slowDivide_ only works with positive integers.");for(var V=h,j=N;j.l(A)<=0;)V=ee(V),j=ee(j);var S=M(V,1),I=M(j,1);for(j=M(j,2),V=M(V,2);!w(j);){var k=I.add(j);k.l(A)<=0&&(S=S.add(V),I=k),j=M(j,1),V=M(V,1)}return N=B(A,S.j(N)),new F(S,N)}for(S=f;A.l(N)>=0;){for(V=Math.max(1,Math.floor(A.m()/N.m())),j=Math.ceil(Math.log(V)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),I=m(V),k=I.j(N);v(k)||k.l(A)>0;)V-=j,I=m(V),k=I.j(N);w(I)&&(I=h),S=S.add(I),A=B(A,k)}return new F(S,A)}n.B=function(A){return re(this,A).h},n.and=function(A){const N=Math.max(this.g.length,A.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)&A.i(j);return new o(V,this.h&A.h)},n.or=function(A){const N=Math.max(this.g.length,A.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)|A.i(j);return new o(V,this.h|A.h)},n.xor=function(A){const N=Math.max(this.g.length,A.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)^A.i(j);return new o(V,this.h^A.h)};function ee(A){const N=A.g.length+1,V=[];for(let j=0;j<N;j++)V[j]=A.i(j)<<1|A.i(j-1)>>>31;return new o(V,A.h)}function M(A,N){const V=N>>5;N%=32;const j=A.g.length-V,S=[];for(let I=0;I<j;I++)S[I]=N>0?A.i(I+V)>>>N|A.i(I+V+1)<<32-N:A.i(I+V);return new o(S,A.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,qy=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,Br=o}).apply(typeof _p<"u"?_p:typeof self<"u"?self:typeof window<"u"?window:{});var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $y,Va,zy,ic,Im,Wy,Ky,Gy;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof jl=="object"&&jl];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=t(this);function r(c,p){if(p)e:{var g=s;c=c.split(".");for(var _=0;_<c.length-1;_++){var z=c[_];if(!(z in g))break e;g=g[z]}c=c[c.length-1],_=g[c],p=p(_),p!=_&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(p){var g=[],_;for(_ in p)Object.prototype.hasOwnProperty.call(p,_)&&g.push([_,p[_]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function u(c,p,g){return c.call.apply(c.bind,arguments)}function m(c,p,g){return m=u,m.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var _=g.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(_,z,J){for(var _e=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)_e[pt-2]=arguments[pt];return p.prototype[z].apply(_,_e)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const p=c.length;if(p>0){const g=Array(p);for(let _=0;_<p;_++)g[_]=c[_];return g}return[]}function w(c,p){for(let _=1;_<arguments.length;_++){const z=arguments[_];var g=typeof z;if(g=g!="object"?g:z?Array.isArray(z)?"array":g:"null",g=="array"||g=="object"&&typeof z.length=="number"){g=c.length||0;const J=z.length||0;c.length=g+J;for(let _e=0;_e<J;_e++)c[g+_e]=z[_e]}else c.push(z)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function C(c){o.setTimeout(()=>{throw c},0)}function B(){var c=A;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class T{constructor(){this.h=this.g=null}add(p,g){const _=F.get();_.set(p,g),this.h?this.h.next=_:this.g=_,this.h=_}}var F=new v(()=>new re,c=>c.reset());class re{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,M=!1,A=new T,N=()=>{const c=Promise.resolve(void 0);ee=()=>{c.then(V)}};function V(){for(var c;c=B();){try{c.h.call(c.g)}catch(g){C(g)}var p=F;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function De(c,p){S.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(De,S),De.prototype.init=function(c,p){const g=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var qe="closure_listenable_"+(Math.random()*1e6|0),he=0;function Ue(c,p,g,_,z){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!_,this.ha=z,this.key=++he,this.da=this.fa=!1}function ht(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function zt(c,p,g){for(const _ in c)p.call(g,c[_],_,c)}function Ft(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function ae(c){const p={};for(const g in c)p[g]=c[g];return p}const $e="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(c,p){let g,_;for(let z=1;z<arguments.length;z++){_=arguments[z];for(g in _)c[g]=_[g];for(let J=0;J<$e.length;J++)g=$e[J],Object.prototype.hasOwnProperty.call(_,g)&&(c[g]=_[g])}}function Re(c){this.src=c,this.g={},this.h=0}Re.prototype.add=function(c,p,g,_,z){const J=c.toString();c=this.g[J],c||(c=this.g[J]=[],this.h++);const _e=vt(c,p,_,z);return _e>-1?(p=c[_e],g||(p.fa=!1)):(p=new Ue(p,this.src,J,!!_,z),p.fa=g,c.push(p)),p};function Qe(c,p){const g=p.type;if(g in c.g){var _=c.g[g],z=Array.prototype.indexOf.call(_,p,void 0),J;(J=z>=0)&&Array.prototype.splice.call(_,z,1),J&&(ht(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function vt(c,p,g,_){for(let z=0;z<c.length;++z){const J=c[z];if(!J.da&&J.listener==p&&J.capture==!!g&&J.ha==_)return z}return-1}var at="closure_lm_"+(Math.random()*1e6|0),wt={};function ot(c,p,g,_,z){if(Array.isArray(p)){for(let J=0;J<p.length;J++)ot(c,p[J],g,_,z);return null}return g=Wt(g),c&&c[qe]?c.J(p,g,l(_)?!!_.capture:!1,z):ft(c,p,g,!1,_,z)}function ft(c,p,g,_,z,J){if(!p)throw Error("Invalid event type");const _e=l(z)?!!z.capture:!!z;let pt=Ye(c);if(pt||(c[at]=pt=new Re(c)),g=pt.add(p,g,_,_e,J),g.proxy)return g;if(_=fn(),g.proxy=_,_.src=c,_.listener=g,c.addEventListener)I||(z=_e),z===void 0&&(z=!1),c.addEventListener(p.toString(),_,z);else if(c.attachEvent)c.attachEvent(He(p.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return g}function fn(){function c(g){return p.call(c.src,c.listener,g)}const p=Se;return c}function K(c,p,g,_,z){if(Array.isArray(p))for(var J=0;J<p.length;J++)K(c,p[J],g,_,z);else _=l(_)?!!_.capture:!!_,g=Wt(g),c&&c[qe]?(c=c.i,J=String(p).toString(),J in c.g&&(p=c.g[J],g=vt(p,g,_,z),g>-1&&(ht(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[J],c.h--)))):c&&(c=Ye(c))&&(p=c.g[p.toString()],c=-1,p&&(c=vt(p,g,_,z)),(g=c>-1?p[c]:null)&&Pe(g))}function Pe(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[qe])Qe(p.i,c);else{var g=c.type,_=c.proxy;p.removeEventListener?p.removeEventListener(g,_,c.capture):p.detachEvent?p.detachEvent(He(g),_):p.addListener&&p.removeListener&&p.removeListener(_),(g=Ye(p))?(Qe(g,c),g.h==0&&(g.src=null,p[at]=null)):ht(c)}}}function He(c){return c in wt?wt[c]:wt[c]="on"+c}function Se(c,p){if(c.da)c=!0;else{p=new De(p,this);const g=c.listener,_=c.ha||c.src;c.fa&&Pe(c),c=g.call(_,p)}return c}function Ye(c){return c=c[at],c instanceof Re?c:null}var It="__closure_events_fn_"+(Math.random()*1e9>>>0);function Wt(c){return typeof c=="function"?c:(c[It]||(c[It]=function(p){return c.handleEvent(p)}),c[It])}function dt(){j.call(this),this.i=new Re(this),this.M=this,this.G=null}f(dt,j),dt.prototype[qe]=!0,dt.prototype.removeEventListener=function(c,p,g,_){K(this,c,p,g,_)};function P(c,p){var g,_=c.G;if(_)for(g=[];_;_=_.G)g.push(_);if(c=c.M,_=p.type||p,typeof p=="string")p=new S(p,c);else if(p instanceof S)p.target=p.target||c;else{var z=p;p=new S(_,c),me(p,z)}z=!0;let J,_e;if(g)for(_e=g.length-1;_e>=0;_e--)J=p.g=g[_e],z=q(J,_,!0,p)&&z;if(J=p.g=c,z=q(J,_,!0,p)&&z,z=q(J,_,!1,p)&&z,g)for(_e=0;_e<g.length;_e++)J=p.g=g[_e],z=q(J,_,!1,p)&&z}dt.prototype.N=function(){if(dt.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let _=0;_<g.length;_++)ht(g[_]);delete c.g[p],c.h--}}this.G=null},dt.prototype.J=function(c,p,g,_){return this.i.add(String(c),p,!1,g,_)},dt.prototype.K=function(c,p,g,_){return this.i.add(String(c),p,!0,g,_)};function q(c,p,g,_){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let z=!0;for(let J=0;J<p.length;++J){const _e=p[J];if(_e&&!_e.da&&_e.capture==g){const pt=_e.listener,Vn=_e.ha||_e.src;_e.fa&&Qe(c.i,_e),z=pt.call(Vn,_)!==!1&&z}}return z&&!_.defaultPrevented}function te(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function Ne(c){c.g=te(()=>{c.g=null,c.i&&(c.i=!1,Ne(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ce extends j{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Ne(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(c){j.call(this),this.h=c,this.g={}}f(de,j);var Ie=[];function ze(c){zt(c.g,function(p,g){this.g.hasOwnProperty(g)&&Pe(p)},c),c.g={}}de.prototype.N=function(){de.Z.N.call(this),ze(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var et=o.JSON.stringify,Ee=o.JSON.parse,Un=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Bt(){}function ne(){}var Xe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function O(){S.call(this,"d")}f(O,S);function xe(){S.call(this,"c")}f(xe,S);var ke={},Le=null;function ue(){return Le=Le||new dt}ke.Ia="serverreachability";function Dt(c){S.call(this,ke.Ia,c)}f(Dt,S);function xt(c){const p=ue();P(p,new Dt(p))}ke.STAT_EVENT="statevent";function Jt(c,p){S.call(this,ke.STAT_EVENT,c),this.stat=p}f(Jt,S);function Et(c){const p=ue();P(p,new Jt(p,c))}ke.Ja="timingevent";function pn(c,p){S.call(this,ke.Ja,c),this.size=p}f(pn,S);function on(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function Tn(){this.g=!0}Tn.prototype.ua=function(){this.g=!1};function ds(c,p,g,_,z,J){c.info(function(){if(c.g)if(J){var _e="",pt=J.split("&");for(let Xt=0;Xt<pt.length;Xt++){var Vn=pt[Xt].split("=");if(Vn.length>1){const Pn=Vn[0];Vn=Vn[1];const Rs=Pn.split("_");_e=Rs.length>=2&&Rs[1]=="type"?_e+(Pn+"="+Vn+"&"):_e+(Pn+"=redacted&")}}}else _e=null;else _e=J;return"XMLHTTP REQ ("+_+") [attempt "+z+"]: "+p+`
`+g+`
`+_e})}function Xn(c,p,g,_,z,J,_e){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+z+"]: "+p+`
`+g+`
`+J+" "+_e})}function fs(c,p,g,_){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Ls(c,g)+(_?" "+_:"")})}function ri(c,p){c.info(function(){return"TIMEOUT: "+p})}Tn.prototype.info=function(){};function Ls(c,p){if(!c.g)return p;if(!p)return null;try{const J=JSON.parse(p);if(J){for(c=0;c<J.length;c++)if(Array.isArray(J[c])){var g=J[c];if(!(g.length<2)){var _=g[1];if(Array.isArray(_)&&!(_.length<1)){var z=_[0];if(z!="noop"&&z!="stop"&&z!="close")for(let _e=1;_e<_.length;_e++)_[_e]=""}}}}return et(J)}catch{return p}}var ns={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},D={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Q;function R(){}f(R,Bt),R.prototype.g=function(){return new XMLHttpRequest},Q=new R;function x(c){return encodeURIComponent(String(c))}function L(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function U(c,p,g,_){this.j=c,this.i=p,this.l=g,this.S=_||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var G={},Z={};function ie(c,p,g){c.M=1,c.A=Mi(Zt(p)),c.u=g,c.R=!0,Ce(c,null)}function Ce(c,p){c.F=Date.now(),We(c),c.B=Zt(c.A);var g=c.B,_=c.S;Array.isArray(_)||(_=[String(_)]),le(g.i,"t",_),c.C=0,g=c.j.L,c.h=new X,c.g=Kf(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ce(m(c.Y,c,c.g),c.P)),p=c.V,g=c.g,_=c.ba;var z="readystatechange";Array.isArray(z)||(z&&(Ie[0]=z.toString()),z=Ie);for(let J=0;J<z.length;J++){const _e=ot(g,z[J],_||p.handleEvent,!1,p.h||p);if(!_e)break;p.g[_e.key]=_e}p=c.J?ae(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),xt(),ds(c.i,c.v,c.B,c.l,c.S,c.u)}U.prototype.ba=function(c){c=c.target;const p=this.O;p&&xs(c)==3?p.j():this.Y(c)},U.prototype.Y=function(c){try{if(c==this.g)e:{const pt=xs(this.g),Vn=this.g.ya(),Xt=this.g.ca();if(!(pt<3)&&(pt!=3||this.g&&(this.h.h||this.g.la()||Rf(this.g)))){this.K||pt!=4||Vn==7||(Vn==8||Xt<=0?xt(3):xt(2)),Kt(this);var p=this.g.ca();this.X=p;var g=Je(this);if(this.o=p==200,Xn(this.i,this.v,this.B,this.l,this.S,pt,p),this.o){if(this.U&&!this.L){t:{if(this.g){var _,z=this.g;if((_=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_)){var J=_;break t}}J=null}if(c=J)fs(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Hn(this,c);else{this.o=!1,this.m=3,Et(12),jt(this),Ut(this);break e}}if(this.R){c=!0;let Pn;for(;!this.K&&this.C<g.length;)if(Pn=fe(this,g),Pn==Z){pt==4&&(this.m=4,Et(14),c=!1),fs(this.i,this.l,null,"[Incomplete Response]");break}else if(Pn==G){this.m=4,Et(15),fs(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else fs(this.i,this.l,Pn,null),Hn(this,Pn);if(Fe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||g.length!=0||this.h.h||(this.m=1,Et(16),c=!1),this.o=this.o&&c,!c)fs(this.i,this.l,g,"[Invalid Chunked Response]"),jt(this),Ut(this);else if(g.length>0&&!this.W){this.W=!0;var _e=this.j;_e.g==this&&_e.aa&&!_e.P&&(_e.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),qu(_e),_e.P=!0,Et(11))}}else fs(this.i,this.l,g,null),Hn(this,g);pt==4&&jt(this),this.o&&!this.K&&(pt==4?qf(this.j,this):(this.o=!1,We(this)))}else _x(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Et(12)):(this.m=0,Et(13)),jt(this),Ut(this)}}}catch{}finally{}};function Je(c){if(!Fe(c))return c.g.la();const p=Rf(c.g);if(p==="")return"";let g="";const _=p.length,z=xs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return jt(c),Ut(c),"";c.h.i=new o.TextDecoder}for(let J=0;J<_;J++)c.h.h=!0,g+=c.h.i.decode(p[J],{stream:!(z&&J==_-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function Fe(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function fe(c,p){var g=c.C,_=p.indexOf(`
`,g);return _==-1?Z:(g=Number(p.substring(g,_)),isNaN(g)?G:(_+=1,_+g>p.length?Z:(p=p.slice(_,_+g),c.C=_+g,p)))}U.prototype.cancel=function(){this.K=!0,jt(this)};function We(c){c.T=Date.now()+c.H,un(c,c.H)}function un(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=on(m(c.aa,c),p)}function Kt(c){c.D&&(o.clearTimeout(c.D),c.D=null)}U.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(ri(this.i,this.B),this.M!=2&&(xt(),Et(17)),jt(this),this.m=2,Ut(this)):un(this,this.T-c)};function Ut(c){c.j.I==0||c.K||qf(c.j,c)}function jt(c){Kt(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,ze(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Hn(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Ze(g.h,c))){if(!c.L&&Ze(g.h,c)&&g.I==3){try{var _=g.Ba.g.parse(p)}catch{_=null}if(Array.isArray(_)&&_.length==3){var z=_;if(z[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)wl(g),Vl(g);else break e;Ou(g),Et(18)}}else g.xa=z[1],0<g.xa-g.K&&z[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=on(m(g.Va,g),6e3));Ve(g.h)<=1&&g.ta&&(g.ta=void 0)}else ii(g,11)}else if((c.L||g.g==c)&&wl(g),!k(p))for(z=g.Ba.g.parse(p),p=0;p<z.length;p++){let Xt=z[p];const Pn=Xt[0];if(!(Pn<=g.K))if(g.K=Pn,Xt=Xt[1],g.I==2)if(Xt[0]=="c"){g.M=Xt[1],g.ba=Xt[2];const Rs=Xt[3];Rs!=null&&(g.ka=Rs,g.j.info("VER="+g.ka));const oi=Xt[4];oi!=null&&(g.za=oi,g.j.info("SVER="+g.za));const yr=Xt[5];yr!=null&&typeof yr=="number"&&yr>0&&(_=1.5*yr,g.O=_,g.j.info("backChannelRequestTimeoutMs_="+_)),_=g;const br=c.g;if(br){const Sl=br.g?br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sl){var J=_.h;J.g||Sl.indexOf("spdy")==-1&&Sl.indexOf("quic")==-1&&Sl.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(tt(J,J.h),J.h=null))}if(_.G){const $u=br.g?br.g.getResponseHeader("X-HTTP-Session-Id"):null;$u&&(_.wa=$u,Nt(_.J,_.G,$u))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),_=g;var _e=c;if(_.na=Wf(_,_.L?_.ba:null,_.W),_e.L){nt(_.h,_e);var pt=_e,Vn=_.O;Vn&&(pt.H=Vn),pt.D&&(Kt(pt),We(pt)),_.g=_e}else Ff(_);g.i.length>0&&Cl(g)}else Xt[0]!="stop"&&Xt[0]!="close"||ii(g,7);else g.I==3&&(Xt[0]=="stop"||Xt[0]=="close"?Xt[0]=="stop"?ii(g,7):Fu(g):Xt[0]!="noop"&&g.l&&g.l.qa(Xt),g.A=0)}}xt(4)}catch{}}var On=class{constructor(c,p){this.g=c,this.map=p}};function Gt(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ke(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ve(c){return c.h?1:c.g?c.g.size:0}function Ze(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function tt(c,p){c.g?c.g.add(p):c.h=p}function nt(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}Gt.prototype.cancel=function(){if(this.i=Oe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Oe(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return y(c.i)}var st=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function St(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const _=c[g].indexOf("=");let z,J=null;_>=0?(z=c[g].substring(0,_),J=c[g].substring(_+1)):z=c[g],p(z,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function an(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof an?(this.l=c.l,bs(this,c.j),this.o=c.o,this.g=c.g,fr(this,c.u),this.h=c.h,Go(this,ye(c.i)),this.m=c.m):c&&(p=String(c).match(st))?(this.l=!1,bs(this,p[1]||"",!0),this.o=pr(p[2]||""),this.g=pr(p[3]||"",!0),fr(this,p[4]),this.h=pr(p[5]||"",!0),Go(this,p[6]||"",!0),this.m=pr(p[7]||"")):(this.l=!1,this.i=new gr(null,this.l))}an.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(hr(p,Qo,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(hr(p,Qo,!0),"@"),c.push(x(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(hr(g,g.charAt(0)=="/"?Bu:Al,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",hr(g,Hu)),c.join("")},an.prototype.resolve=function(c){const p=Zt(this);let g=!!c.j;g?bs(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var _=c.h;if(g)fr(p,c.u);else if(g=!!c.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var z=p.h.lastIndexOf("/");z!=-1&&(_=p.h.slice(0,z+1)+_)}if(z=_,z==".."||z==".")_="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){_=z.lastIndexOf("/",0)==0,z=z.split("/");const J=[];for(let _e=0;_e<z.length;){const pt=z[_e++];pt=="."?_&&_e==z.length&&J.push(""):pt==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),_&&_e==z.length&&J.push("")):(J.push(pt),_=!0)}_=J.join("/")}else _=z}return g?p.h=_:g=c.i.toString()!=="",g?Go(p,ye(c.i)):g=!!c.m,g&&(p.m=c.m),p};function Zt(c){return new an(c)}function bs(c,p,g){c.j=g?pr(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function fr(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Go(c,p,g){p instanceof gr?(c.i=p,ut(c.i,c.l)):(g||(p=hr(p,Uu)),c.i=new gr(p,c.l))}function Nt(c,p,g){c.i.set(p,g)}function Mi(c){return Nt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function pr(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function hr(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,El),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function El(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Qo=/[#\/\?@]/g,Al=/[#\?:]/g,Bu=/[#\?]/g,Uu=/[#\?@]/g,Hu=/#/g;function gr(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function b(c){c.g||(c.g=new Map,c.h=0,c.i&&St(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}n=gr.prototype,n.add=function(c,p){b(this),this.i=null,c=ge(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function H(c,p){b(c),p=ge(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Y(c,p){return b(c),p=ge(c,p),c.g.has(p)}n.forEach=function(c,p){b(this),this.g.forEach(function(g,_){g.forEach(function(z){c.call(p,z,_,this)},this)},this)};function W(c,p){b(c);let g=[];if(typeof p=="string")Y(c,p)&&(g=g.concat(c.g.get(ge(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}n.set=function(c,p){return b(this),this.i=null,c=ge(this,c),Y(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},n.get=function(c,p){return c?(c=W(this,c),c.length>0?String(c[0]):p):p};function le(c,p,g){H(c,p),g.length>0&&(c.i=null,c.g.set(ge(c,p),y(g)),c.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let _=0;_<p.length;_++){var g=p[_];const z=x(g);g=W(this,g);for(let J=0;J<g.length;J++){let _e=z;g[J]!==""&&(_e+="="+x(g[J])),c.push(_e)}}return this.i=c.join("&")};function ye(c){const p=new gr;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function ge(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function ut(c,p){p&&!c.j&&(b(c),c.i=null,c.g.forEach(function(g,_){const z=_.toLowerCase();_!=z&&(H(this,_),le(this,z,g))},c)),c.j=p}function gt(c,p){const g=new Tn;if(o.Image){const _=new Image;_.onload=d(Tt,g,"TestLoadImage: loaded",!0,p,_),_.onerror=d(Tt,g,"TestLoadImage: error",!1,p,_),_.onabort=d(Tt,g,"TestLoadImage: abort",!1,p,_),_.ontimeout=d(Tt,g,"TestLoadImage: timeout",!1,p,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else p(!1)}function gn(c,p){const g=new Tn,_=new AbortController,z=setTimeout(()=>{_.abort(),Tt(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:_.signal}).then(J=>{clearTimeout(z),J.ok?Tt(g,"TestPingServer: ok",!0,p):Tt(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(z),Tt(g,"TestPingServer: error",!1,p)})}function Tt(c,p,g,_,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),_(g)}catch{}}function Pt(){this.g=new Un}function ln(c){this.i=c.Sb||null,this.h=c.ab||!1}f(ln,Bt),ln.prototype.g=function(){return new An(this.i,this.h)};function An(c,p){dt.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(An,dt),n=An.prototype,n.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,hn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,tn(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,hn(this)),this.g&&(this.readyState=3,hn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;At(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function At(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?tn(this):hn(this),this.readyState==3&&At(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,tn(this))},n.Na=function(c){this.g&&(this.response=c,tn(this))},n.ga=function(){this.g&&tn(this)};function tn(c){c.readyState=4,c.l=null,c.j=null,c.B=null,hn(c)}n.setRequestHeader=function(c,p){this.A.append(c,p)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function hn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(An.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Qt(c){let p="";return zt(c,function(g,_){p+=_,p+=":",p+=g,p+=`\r
`}),p}function Yt(c,p,g){e:{for(_ in g){var _=!1;break e}_=!0}_||(g=Qt(g),typeof c=="string"?g!=null&&x(g):Nt(c,p,g))}function yt(c){dt.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(yt,dt);var en=/^https?$/i,Ns=["POST","PUT"];n=yt.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,p,g,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Q.g(),this.g.onreadystatechange=h(m(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(J){js(this,J);return}if(c=g||"",g=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var z in _)g.set(z,_[z]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const J of _.keys())g.set(J,_.get(J));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(g.keys()).find(J=>J.toLowerCase()=="content-type"),z=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Ns,p,void 0)>=0)||_||z||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,_e]of g)this.g.setRequestHeader(J,_e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(J){js(this,J)}};function js(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,Fi(c),Oi(c)}function Fi(c){c.A||(c.A=!0,P(c,"complete"),P(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,P(this,"complete"),P(this,"abort"),Oi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Oi(this,!0)),yt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Mu(this):this.Xa())},n.Xa=function(){Mu(this)};function Mu(c){if(c.h&&typeof i<"u"){if(c.v&&xs(c)==4)setTimeout(c.Ca.bind(c),0);else if(P(c,"readystatechange"),xs(c)==4){c.h=!1;try{const J=c.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var _;if(_=J===0){let _e=String(c.D).match(st)[1]||null;!_e&&o.self&&o.self.location&&(_e=o.self.location.protocol.slice(0,-1)),_=!en.test(_e?_e.toLowerCase():"")}g=_}if(g)P(c,"complete"),P(c,"success");else{c.o=6;try{var z=xs(c)>2?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.ca()+"]",Fi(c)}}finally{Oi(c)}}}}function Oi(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||P(c,"ready");try{g.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function xs(c){return c.g?c.g.readyState:0}n.ca=function(){try{return xs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Ee(p)}};function Rf(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function _x(c){const p={};c=(c.g&&xs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(k(c[_]))continue;var g=L(c[_]);const z=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const J=p[z]||[];p[z]=J,J.push(g)}Ft(p,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yo(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function Bf(c){this.za=0,this.i=[],this.j=new Tn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Yo("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Yo("baseRetryDelayMs",5e3,c),this.Za=Yo("retryDelaySeedMs",1e4,c),this.Ta=Yo("forwardChannelMaxRetries",2,c),this.va=Yo("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Gt(c&&c.concurrentRequestLimit),this.Ba=new Pt,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Bf.prototype,n.ka=8,n.I=1,n.connect=function(c,p,g,_){Et(0),this.W=c,this.H=p||{},g&&_!==void 0&&(this.H.OSID=g,this.H.OAID=_),this.F=this.X,this.J=Wf(this,null,this.W),Cl(this)};function Fu(c){if(Uf(c),c.I==3){var p=c.V++,g=Zt(c.J);if(Nt(g,"SID",c.M),Nt(g,"RID",p),Nt(g,"TYPE","terminate"),Xo(c,g),p=new U(c,c.j,p),p.M=2,p.A=Mi(Zt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=Kf(p.j,null),p.g.ea(p.A)),p.F=Date.now(),We(p)}zf(c)}function Vl(c){c.g&&(qu(c),c.g.cancel(),c.g=null)}function Uf(c){Vl(c),c.v&&(o.clearTimeout(c.v),c.v=null),wl(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Cl(c){if(!Ke(c.h)&&!c.m){c.m=!0;var p=c.Ea;ee||N(),M||(ee(),M=!0),A.add(p,c),c.D=0}}function Dx(c,p){return Ve(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=on(m(c.Ea,c,p),$f(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const z=new U(this,this.j,c);let J=this.o;if(this.U&&(J?(J=ae(J),me(J,this.U)):J=this.U),this.u!==null||this.R||(z.J=J,J=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var _=this.i[g];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(p+=_,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=Mf(this,z,p),g=Zt(this.J),Nt(g,"RID",c),Nt(g,"CVER",22),this.G&&Nt(g,"X-HTTP-Session-Id",this.G),Xo(this,g),J&&(this.R?p="headers="+x(Qt(J))+"&"+p:this.u&&Yt(g,this.u,J)),tt(this.h,z),this.Ra&&Nt(g,"TYPE","init"),this.S?(Nt(g,"$req",p),Nt(g,"SID","null"),z.U=!0,ie(z,g,null)):ie(z,g,p),this.I=2}}else this.I==3&&(c?Hf(this,c):this.i.length==0||Ke(this.h)||Hf(this))};function Hf(c,p){var g;p?g=p.l:g=c.V++;const _=Zt(c.J);Nt(_,"SID",c.M),Nt(_,"RID",g),Nt(_,"AID",c.K),Xo(c,_),c.u&&c.o&&Yt(_,c.u,c.o),g=new U(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=Mf(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),tt(c.h,g),ie(g,_,p)}function Xo(c,p){c.H&&zt(c.H,function(g,_){Nt(p,_,g)}),c.l&&zt({},function(g,_){Nt(p,_,g)})}function Mf(c,p,g){g=Math.min(c.i.length,g);const _=c.l?m(c.l.Ka,c.l,c):null;e:{var z=c.i;let pt=-1;for(;;){const Vn=["count="+g];pt==-1?g>0?(pt=z[0].g,Vn.push("ofs="+pt)):pt=0:Vn.push("ofs="+pt);let Xt=!0;for(let Pn=0;Pn<g;Pn++){var J=z[Pn].g;const Rs=z[Pn].map;if(J-=pt,J<0)pt=Math.max(0,z[Pn].g-100),Xt=!1;else try{J="req"+J+"_"||"";try{var _e=Rs instanceof Map?Rs:Object.entries(Rs);for(const[oi,yr]of _e){let br=yr;l(yr)&&(br=et(yr)),Vn.push(J+oi+"="+encodeURIComponent(br))}}catch(oi){throw Vn.push(J+"type="+encodeURIComponent("_badmap")),oi}}catch{_&&_(Rs)}}if(Xt){_e=Vn.join("&");break e}}_e=void 0}return c=c.i.splice(0,g),p.G=c,_e}function Ff(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;ee||N(),M||(ee(),M=!0),A.add(p,c),c.A=0}}function Ou(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=on(m(c.Da,c),$f(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,Of(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=on(m(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Et(10),Vl(this),Of(this))};function qu(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Of(c){c.g=new U(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=Zt(c.na);Nt(p,"RID","rpc"),Nt(p,"SID",c.M),Nt(p,"AID",c.K),Nt(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&Nt(p,"TO",c.ia),Nt(p,"TYPE","xmlhttp"),Xo(c,p),c.u&&c.o&&Yt(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Mi(Zt(p)),g.u=null,g.R=!0,Ce(g,c)}n.Va=function(){this.C!=null&&(this.C=null,Vl(this),Ou(this),Et(19))};function wl(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function qf(c,p){var g=null;if(c.g==p){wl(c),qu(c),c.g=null;var _=2}else if(Ze(c.h,p))g=p.G,nt(c.h,p),_=1;else return;if(c.I!=0){if(p.o)if(_==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var z=c.D;_=ue(),P(_,new pn(_,g)),Cl(c)}else Ff(c);else if(z=p.m,z==3||z==0&&p.X>0||!(_==1&&Dx(c,p)||_==2&&Ou(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),z){case 1:ii(c,5);break;case 4:ii(c,10);break;case 3:ii(c,6);break;default:ii(c,2)}}}function $f(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ii(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.bb,c),_=c.Ua;const z=!_;_=new an(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||bs(_,"https"),Mi(_),z?gt(_.toString(),g):gn(_.toString(),g)}else Et(2);c.I=0,c.l&&c.l.pa(p),zf(c),Uf(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function zf(c){if(c.I=0,c.ja=[],c.l){const p=Oe(c.h);(p.length!=0||c.i.length!=0)&&(w(c.ja,p),w(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function Wf(c,p,g){var _=g instanceof an?Zt(g):new an(g);if(_.g!="")p&&(_.g=p+"."+_.g),fr(_,_.u);else{var z=o.location;_=z.protocol,p=p?p+"."+z.hostname:z.hostname,z=+z.port;const J=new an(null);_&&bs(J,_),p&&(J.g=p),z&&fr(J,z),g&&(J.h=g),_=J}return g=c.G,p=c.wa,g&&p&&Nt(_,g,p),Nt(_,"VER",c.ka),Xo(c,_),_}function Kf(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new yt(new ln({ab:g})):new yt(c.ma),p.Fa(c.L),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gf(){}n=Gf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Il(){}Il.prototype.g=function(c,p){return new as(c,p)};function as(c,p){dt.call(this),this.g=new Bf(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new qi(this)}f(as,dt),as.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},as.prototype.close=function(){Fu(this.g)},as.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=et(c),c=g);p.i.push(new On(p.Ya++,c)),p.I==3&&Cl(p)},as.prototype.N=function(){this.g.l=null,delete this.j,Fu(this.g),delete this.g,as.Z.N.call(this)};function Qf(c){O.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Qf,O);function Yf(){xe.call(this),this.status=1}f(Yf,xe);function qi(c){this.g=c}f(qi,Gf),qi.prototype.ra=function(){P(this.g,"a")},qi.prototype.qa=function(c){P(this.g,new Qf(c))},qi.prototype.pa=function(c){P(this.g,new Yf)},qi.prototype.oa=function(){P(this.g,"b")},Il.prototype.createWebChannel=Il.prototype.g,as.prototype.send=as.prototype.o,as.prototype.open=as.prototype.m,as.prototype.close=as.prototype.close,Gy=function(){return new Il},Ky=function(){return ue()},Wy=ke,Im={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ns.NO_ERROR=0,ns.TIMEOUT=8,ns.HTTP_ERROR=6,ic=ns,D.COMPLETE="complete",zy=D,ne.EventType=Xe,Xe.OPEN="a",Xe.CLOSE="b",Xe.ERROR="c",Xe.MESSAGE="d",dt.prototype.listen=dt.prototype.J,Va=ne,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,$y=yt}).apply(typeof jl<"u"?jl:typeof self<"u"?self:typeof window<"u"?window:{});const Dp="@firebase/firestore",kp="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mn.UNAUTHENTICATED=new Mn(null),Mn.GOOGLE_CREDENTIALS=new Mn("google-credentials-uid"),Mn.FIRST_PARTY=new Mn("first-party-uid"),Mn.MOCK_USER=new Mn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uo="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=new Py("@firebase/firestore");function uo(){return Ei.logLevel}function pe(n,...e){if(Ei.logLevel<=Ct.DEBUG){const t=e.map(Vd);Ei.debug(`Firestore (${Uo}): ${n}`,...t)}}function Zn(n,...e){if(Ei.logLevel<=Ct.ERROR){const t=e.map(Vd);Ei.error(`Firestore (${Uo}): ${n}`,...t)}}function Ai(n,...e){if(Ei.logLevel<=Ct.WARN){const t=e.map(Vd);Ei.warn(`Firestore (${Uo}): ${n}`,...t)}}function Vd(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,Qy(n,s,t)}function Qy(n,e,t){let s=`FIRESTORE (${Uo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Zn(s),new Error(s)}function Me(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||Qy(e,r,s)}function it(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ve extends Pi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Mn.UNAUTHENTICATED))}shutdown(){}}class oE{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class aE{constructor(e){this.t=e,this.currentUser=Mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Me(this.o===void 0,42304);let s=this.i;const r=u=>this.i!==s?(s=this.i,t(u)):Promise.resolve();let i=new qs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new qs,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new qs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Me(typeof s.accessToken=="string",31837,{l:s}),new Yy(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string",2055,{h:e}),new Mn(e)}}class lE{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Mn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class cE{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new lE(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Mn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ep{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uE{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,By(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Me(this.o===void 0,3512);const s=i=>{i.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ep(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Me(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Ep(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=mE(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function rt(n,e){return n<e?-1:n>e?1:0}function Sm(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return tm(r)===tm(i)?rt(r,i):tm(r)?1:-1}return rt(n.length,e.length)}const dE=55296,fE=57343;function tm(n){const e=n.charCodeAt(0);return e>=dE&&e<=fE}function Do(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}function Xy(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="__name__";class Us{constructor(e,t,s){t===void 0?t=0:t>e.length&&Te(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Te(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Us.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Us?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=Us.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return rt(e.length,t.length)}static compareSegments(e,t){const s=Us.isNumericId(e),r=Us.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Us.extractNumericId(e).compare(Us.extractNumericId(t)):Sm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Br.fromString(e.substring(4,e.length-2))}}class Rt extends Us{construct(e,t,s){return new Rt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new ve(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new Rt(t)}static emptyPath(){return new Rt([])}}const pE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class cn extends Us{construct(e,t,s){return new cn(e,t,s)}static isValidIdentifier(e){return pE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ap}static keyField(){return new cn([Ap])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new ve(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new ve(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new ve(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(s+=l,r++):(i(),r++)}if(i(),o)throw new ve(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new cn(t)}static emptyPath(){return new cn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(Rt.fromString(e))}static fromName(e){return new Ae(Rt.fromString(e).popFirst(5))}static empty(){return new Ae(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new Rt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jy(n,e,t){if(!t)throw new ve(se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hE(n,e,t,s){if(e===!0&&s===!0)throw new ve(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Vp(n){if(!Ae.isDocumentKey(n))throw new ve(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Cp(n){if(Ae.isDocumentKey(n))throw new ve(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Zy(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function tu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Te(12329,{type:typeof n})}function es(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ve(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tu(n);throw new ve(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(n,e){const t={typeString:n};return e&&(t.value=e),t}function fl(n,e){if(!Zy(n))throw new ve(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const o=n[s];if(r&&typeof o!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new ve(se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp=-62135596800,Ip=1e6;class be{static now(){return be.fromMillis(Date.now())}static fromDate(e){return be.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*Ip);return new be(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ve(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ve(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<wp)throw new ve(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ve(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ip}_compareTo(e){return this.seconds===e.seconds?rt(this.nanoseconds,e.nanoseconds):rt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fl(e,be._jsonSchema))return new be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wp;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:Dn("string",be._jsonSchemaVersion),seconds:Dn("number"),nanoseconds:Dn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{static fromTimestamp(e){return new Ge(e)}static min(){return new Ge(new be(0,0))}static max(){return new Ge(new be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=-1;class Ac{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}}function Tm(n){return n.fields.find(e=>e.kind===2)}function ui(n){return n.fields.filter(e=>e.kind!==2)}Ac.UNKNOWN_ID=-1;class oc{constructor(e,t){this.fieldPath=e,this.kind=t}}class Xa{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Xa(0,ms.min())}}function gE(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=Ge.fromTimestamp(s===1e9?new be(t+1,0):new be(t,s));return new ms(r,Ae.empty(),e)}function eb(n){return new ms(n.readTime,n.key,Ya)}class ms{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new ms(Ge.min(),Ae.empty(),Ya)}static max(){return new ms(Ge.max(),Ae.empty(),Ya)}}function wd(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ae.comparator(n.documentKey,e.documentKey),t!==0?t:rt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Li(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==tb)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):$.reject(t)}static resolve(e){return new $((t,s)=>{t(e)})}static reject(e){return new $((t,s)=>{s(e)})}static waitFor(e){return new $((t,s)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>s(u))}),o=!0,i===r&&t()})}static or(e){let t=$.resolve(!1);for(const s of e)t=t.next(r=>r?$.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new $((s,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&s(o)},d=>r(d))}})}static doWhile(e,t){return new $((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls="SimpleDb";class nu{static open(e,t,s,r){try{return new nu(t,e.transaction(r,s))}catch(i){throw new ja(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new qs,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ja(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const r=Id(s.target.error);this.S.reject(new ja(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe(ls,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new bE(t)}}class Ur{static delete(e){return pe(ls,"Removing database:",e),di(_y().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Sy())return!1;if(Ur.F())return!0;const e=Dc(),t=Ur.M(e),s=0<t&&t<10,r=sb(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,Ur.M(Dc())===12.2&&Zn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe(ls,"Opening database:",this.name),this.db=await new Promise((t,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;t(o)},r.onblocked=()=>{s(new ja(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new ve(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new ve(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new ja(e,o))},r.onupgradeneeded=i=>{pe(ls,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,r.transaction,i.oldVersion,this.version).next(()=>{pe(ls,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,r){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=nu.open(this.db,e,i?"readonly":"readwrite",s),u=r(l).next(m=>(l.C(),m)).catch(m=>(l.abort(m),$.reject(m))).toPromise();return u.catch(()=>{}),await l.D,u}catch(l){const u=l,m=u.name!=="FirebaseError"&&o<3;if(pe(ls,"Transaction failed with error:",u.message,"Retrying:",m),this.close(),!m)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sb(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class yE{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return di(this.U.delete())}}class ja extends ve{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Gr(n){return n.name==="IndexedDbTransactionError"}class bE{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(pe(ls,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(pe(ls,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),di(s)}add(e){return pe(ls,"ADD",this.store.name,e,e),di(this.store.add(e))}get(e){return di(this.store.get(e)).next(t=>(t===void 0&&(t=null),pe(ls,"GET",this.store.name,e,t),t))}delete(e){return pe(ls,"DELETE",this.store.name,e),di(this.store.delete(e))}count(){return pe(ls,"COUNT",this.store.name),di(this.store.count())}J(e,t){const s=this.options(e,t),r=s.index?this.store.index(s.index):this.store;if(typeof r.getAll=="function"){const i=r.getAll(s.range);return new $((o,l)=>{i.onerror=u=>{l(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(s),o=[];return this.H(i,(l,u)=>{o.push(u)}).next(()=>o)}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new $((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Z(e,t){pe(ls,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const r=this.cursor(s);return this.H(r,(i,o,l)=>l.delete())}ee(e,t){let s;t?s=e:(s={},t=e);const r=this.cursor(s);return this.H(r,t)}te(e){const t=this.cursor({});return new $((s,r)=>{t.onerror=i=>{const o=Id(i.target.error);r(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}H(e,t){const s=[];return new $((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new yE(l),m=t(l.primaryKey,l.value,u);if(m instanceof $){const d=m.catch(f=>(u.done(),$.reject(f)));s.push(d)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}}).next(()=>$.waitFor(s))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function di(n){return new $((e,t)=>{n.onsuccess=s=>{const r=s.target.result;e(r)},n.onerror=s=>{const r=Id(s.target.error);t(r)}})}let Sp=!1;function Id(n){const e=Ur.M(Dc());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new ve("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Sp||(Sp=!0,setTimeout(()=>{throw s},0)),s}}return n}const Ra="IndexBackfiller";class NE{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe(Ra,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();pe(Ra,`Documents written: ${t}`)}catch(t){Gr(t)?pe(Ra,"Ignoring IndexedDB error during index backfill: ",t):await Li(t)}await this.re(6e4)})}}class xE{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const s=new Set;let r=t,i=!0;return $.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return pe(Ra,`Processing collection: ${o}`),this.oe(e,o,r).next(l=>{r-=l,s.add(o)});i=!1})).next(()=>t-r)}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(r,i)).next(l=>(pe(Ra,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}_e(e,t){let s=e;return t.changes.forEach((r,i)=>{const o=eb(i);wd(o,s)>0&&(s=o)}),new ms(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gs.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi=-1;function su(n){return n==null}function Ja(n){return n===0&&1/n==-1/0}function vE(n){return typeof n=="number"&&Number.isInteger(n)&&!Ja(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc="";function Qn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tp(e)),e=_E(n.get(t),e);return Tp(e)}function _E(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case Vc:t+="";break;default:t+=i}}return t}function Tp(n){return n+Vc+""}function Fs(n){const e=n.length;if(Me(e>=2,64408,{path:n}),e===2)return Me(n.charAt(0)===Vc&&n.charAt(1)==="",56145,{path:n}),Rt.emptyPath();const t=e-2,s=[];let r="";for(let i=0;i<e;){const o=n.indexOf(Vc,i);switch((o<0||o>t)&&Te(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(i,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),s.push(u);break;case"":r+=n.substring(i,o),r+="\0";break;case"":r+=n.substring(i,o+1);break;default:Te(61167,{path:n})}i=o+2}return new Rt(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi="remoteDocuments",pl="owner",$i="owner",Za="mutationQueues",DE="userId",_s="mutations",Pp="batchId",gi="userMutationsIndex",Lp=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(n,e){return[n,Qn(e)]}function rb(n,e,t){return[n,Qn(e),t]}const kE={},ko="documentMutations",Cc="remoteDocumentsV14",EE=["prefixPath","collectionGroup","readTime","documentId"],lc="documentKeyIndex",AE=["prefixPath","collectionGroup","documentId"],ib="collectionGroupIndex",VE=["collectionGroup","readTime","prefixPath","documentId"],el="remoteDocumentGlobal",Pm="remoteDocumentGlobalKey",Eo="targets",ob="queryTargetsIndex",CE=["canonicalId","targetId"],Ao="targetDocuments",wE=["targetId","path"],Sd="documentTargetsIndex",IE=["path","targetId"],wc="targetGlobalKey",Ni="targetGlobal",tl="collectionParents",SE=["collectionId","parent"],Vo="clientMetadata",TE="clientId",ru="bundles",PE="bundleId",iu="namedQueries",LE="name",Td="indexConfiguration",jE="indexId",Lm="collectionGroupIndex",RE="collectionGroup",Ba="indexState",BE=["indexId","uid"],ab="sequenceNumberIndex",UE=["uid","sequenceNumber"],Ua="indexEntries",HE=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],lb="documentKeyIndex",ME=["indexId","uid","orderedDocumentKey"],ou="documentOverlays",FE=["userId","collectionPath","documentId"],jm="collectionPathOverlayIndex",OE=["userId","collectionPath","largestBatchId"],cb="collectionGroupOverlayIndex",qE=["userId","collectionGroup","largestBatchId"],Pd="globals",$E="name",ub=[Za,_s,ko,mi,Eo,pl,Ni,Ao,Vo,el,tl,ru,iu],zE=[...ub,ou],mb=[Za,_s,ko,Cc,Eo,pl,Ni,Ao,Vo,el,tl,ru,iu,ou],db=mb,Ld=[...db,Td,Ba,Ua],WE=Ld,fb=[...Ld,Pd],KE=fb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm extends nb{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Sn(n,e){const t=it(n);return Ur.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jp(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qr(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function pb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,t){this.comparator=e,this.root=t||Fn.EMPTY}insert(e,t){return new rn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(e){return new rn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rl(this.root,e,this.comparator,!0)}}class Rl{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fn{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??Fn.RED,this.left=r??Fn.EMPTY,this.right=i??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new Fn(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Fn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new Fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.comparator=e,this.data=new rn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Rp(this.data.getIterator())}getIteratorFrom(e){return new Rp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof $t)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new $t(this.comparator);return t.data=e,t}}class Rp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function zi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this.fields=e,e.sort(cn.comparator)}static empty(){return new os([])}unionWith(e){let t=new $t(cn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new os(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new hb("Invalid base64 string: "+i):i}}(e);return new En(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new En(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}En.EMPTY_BYTE_STRING=new En("");const GE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function or(n){if(Me(!!n,39018),typeof n=="string"){let e=0;const t=GE.exec(n);if(Me(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:sn(n.seconds),nanos:sn(n.nanos)}}function sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ar(n){return typeof n=="string"?En.fromBase64String(n):En.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="server_timestamp",yb="__type__",bb="__previous_value__",Nb="__local_write_time__";function jd(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[yb])==null?void 0:s.stringValue)===gb}function au(n){const e=n.mapValue.fields[bb];return jd(e)?au(e):e}function nl(n){const e=or(n.mapValue.fields[Nb].timestampValue);return new be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e,t,s,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const Ic="(default)";class Vi{constructor(e,t){this.projectId=e,this.database=t||Ic}static empty(){return new Vi("","")}get isDefaultDatabase(){return this.database===Ic}isEqual(e){return e instanceof Vi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd="__type__",xb="__max__",Tr={mapValue:{fields:{__type__:{stringValue:xb}}}},Bd="__vector__",Co="value",cc={nullValue:"NULL_VALUE"};function Mr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jd(n)?4:vb(n)?9007199254740991:lu(n)?10:11:Te(28295,{value:n})}function Ks(n,e){if(n===e)return!0;const t=Mr(n);if(t!==Mr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return nl(n).isEqual(nl(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=or(r.timestampValue),l=or(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return ar(r.bytesValue).isEqual(ar(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return sn(r.geoPointValue.latitude)===sn(i.geoPointValue.latitude)&&sn(r.geoPointValue.longitude)===sn(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return sn(r.integerValue)===sn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=sn(r.doubleValue),l=sn(i.doubleValue);return o===l?Ja(o)===Ja(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return Do(n.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(jp(o)!==jp(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Ks(o[u],l[u])))return!1;return!0}(n,e);default:return Te(52216,{left:n})}}function sl(n,e){return(n.values||[]).find(t=>Ks(t,e))!==void 0}function Fr(n,e){if(n===e)return 0;const t=Mr(n),s=Mr(e);if(t!==s)return rt(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return rt(n.booleanValue,e.booleanValue);case 2:return function(i,o){const l=sn(i.integerValue||i.doubleValue),u=sn(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(n,e);case 3:return Bp(n.timestampValue,e.timestampValue);case 4:return Bp(nl(n),nl(e));case 5:return Sm(n.stringValue,e.stringValue);case 6:return function(i,o){const l=ar(i),u=ar(o);return l.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=rt(l[m],u[m]);if(d!==0)return d}return rt(l.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const l=rt(sn(i.latitude),sn(o.latitude));return l!==0?l:rt(sn(i.longitude),sn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Up(n.arrayValue,e.arrayValue);case 10:return function(i,o){var h,y,w,v;const l=i.fields||{},u=o.fields||{},m=(h=l[Co])==null?void 0:h.arrayValue,d=(y=u[Co])==null?void 0:y.arrayValue,f=rt(((w=m==null?void 0:m.values)==null?void 0:w.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:Up(m,d)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Tr.mapValue&&o===Tr.mapValue)return 0;if(i===Tr.mapValue)return 1;if(o===Tr.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const h=Sm(u[f],d[f]);if(h!==0)return h;const y=Fr(l[u[f]],m[d[f]]);if(y!==0)return y}return rt(u.length,d.length)}(n.mapValue,e.mapValue);default:throw Te(23264,{he:t})}}function Bp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return rt(n,e);const t=or(n),s=or(e),r=rt(t.seconds,s.seconds);return r!==0?r:rt(t.nanos,s.nanos)}function Up(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Fr(t[r],s[r]);if(i)return i}return rt(t.length,s.length)}function wo(n){return Bm(n)}function Bm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=or(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ar(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ae.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=Bm(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${Bm(t.fields[o])}`;return r+"}"}(n.mapValue):Te(61005,{value:n})}function uc(n){switch(Mr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=au(n);return e?16+uc(e):16;case 5:return 2*n.stringValue.length;case 6:return ar(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+uc(i),0)}(n.arrayValue);case 10:case 11:return function(s){let r=0;return Qr(s.fields,(i,o)=>{r+=i.length+uc(o)}),r}(n.mapValue);default:throw Te(13486,{value:n})}}function rl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Um(n){return!!n&&"integerValue"in n}function il(n){return!!n&&"arrayValue"in n}function Hp(n){return!!n&&"nullValue"in n}function Mp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function mc(n){return!!n&&"mapValue"in n}function lu(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Rd])==null?void 0:s.stringValue)===Bd}function Ha(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Qr(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=Ha(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ha(n.arrayValue.values[t]);return e}return{...n}}function vb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===xb}const _b={mapValue:{fields:{[Rd]:{stringValue:Bd},[Co]:{arrayValue:{}}}}};function YE(n){return"nullValue"in n?cc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?rl(Vi.empty(),Ae.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?lu(n)?_b:{mapValue:{}}:Te(35942,{value:n})}function XE(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?rl(Vi.empty(),Ae.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?_b:"mapValue"in n?lu(n)?{mapValue:{}}:Tr:Te(61959,{value:n})}function Fp(n,e){const t=Fr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Op(n,e){const t=Fr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.value=e}static empty(){return new Wn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!mc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ha(t)}setAll(e){let t=cn.emptyPath(),s={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,s,r),s={},r=[],t=l.popLast()}o?s[l.lastSegment()]=Ha(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());mc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];mc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Qr(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Wn(Ha(this.value))}}function Db(n){const e=[];return Qr(n.fields,(t,s)=>{const r=new cn([t]);if(mc(s)){const i=Db(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new os(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,t,s,r,i,o,l){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new mn(e,0,Ge.min(),Ge.min(),Ge.min(),Wn.empty(),0)}static newFoundDocument(e,t,s,r){return new mn(e,1,t,Ge.min(),s,r,0)}static newNoDocument(e,t){return new mn(e,2,t,Ge.min(),Ge.min(),Wn.empty(),0)}static newUnknownDocument(e,t){return new mn(e,3,t,Ge.min(),Ge.min(),Wn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,t){this.position=e,this.inclusive=t}}function qp(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=Ae.comparator(Ae.fromName(o.referenceValue),t.key):s=Fr(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function $p(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,t="asc"){this.field=e,this.dir=t}}function JE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{}class _t extends kb{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new ZE(e,t,s):t==="array-contains"?new nA(e,s):t==="in"?new Ib(e,s):t==="not-in"?new sA(e,s):t==="array-contains-any"?new rA(e,s):new _t(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new eA(e,s):new tA(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Fr(t,this.value)):t!==null&&Mr(this.value)===Mr(t)&&this.matchesComparison(Fr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qt extends kb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new qt(e,t)}matches(e){return So(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function So(n){return n.op==="and"}function Hm(n){return n.op==="or"}function Ud(n){return Eb(n)&&So(n)}function Eb(n){for(const e of n.filters)if(e instanceof qt)return!1;return!0}function Mm(n){if(n instanceof _t)return n.field.canonicalString()+n.op.toString()+wo(n.value);if(Ud(n))return n.filters.map(e=>Mm(e)).join(",");{const e=n.filters.map(t=>Mm(t)).join(",");return`${n.op}(${e})`}}function Ab(n,e){return n instanceof _t?function(s,r){return r instanceof _t&&s.op===r.op&&s.field.isEqual(r.field)&&Ks(s.value,r.value)}(n,e):n instanceof qt?function(s,r){return r instanceof qt&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,l)=>i&&Ab(o,r.filters[l]),!0):!1}(n,e):void Te(19439)}function Vb(n,e){const t=n.filters.concat(e);return qt.create(t,n.op)}function Cb(n){return n instanceof _t?function(t){return`${t.field.canonicalString()} ${t.op} ${wo(t.value)}`}(n):n instanceof qt?function(t){return t.op.toString()+" {"+t.getFilters().map(Cb).join(" ,")+"}"}(n):"Filter"}class ZE extends _t{constructor(e,t,s){super(e,t,s),this.key=Ae.fromName(s.referenceValue)}matches(e){const t=Ae.comparator(e.key,this.key);return this.matchesComparison(t)}}class eA extends _t{constructor(e,t){super(e,"in",t),this.keys=wb("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class tA extends _t{constructor(e,t){super(e,"not-in",t),this.keys=wb("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function wb(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(s=>Ae.fromName(s.referenceValue))}class nA extends _t{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return il(t)&&sl(t.arrayValue,this.value)}}class Ib extends _t{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&sl(this.value.arrayValue,t)}}class sA extends _t{constructor(e,t){super(e,"not-in",t)}matches(e){if(sl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!sl(this.value.arrayValue,t)}}class rA extends _t{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!il(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>sl(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e,t=null,s=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function Fm(n,e=null,t=[],s=[],r=null,i=null,o=null){return new iA(n,e,t,s,r,i,o)}function Ci(n){const e=it(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>Mm(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),su(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>wo(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>wo(s)).join(",")),e.Te=t}return e.Te}function hl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!JE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ab(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!$p(n.startAt,e.startAt)&&$p(n.endAt,e.endAt)}function Sc(n){return Ae.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Tc(n,e){return n.filters.filter(t=>t instanceof _t&&t.field.isEqual(e))}function zp(n,e,t){let s=cc,r=!0;for(const i of Tc(n,e)){let o=cc,l=!0;switch(i.op){case"<":case"<=":o=YE(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=cc}Fp({value:s,inclusive:r},{value:o,inclusive:l})<0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Fp({value:s,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}function Wp(n,e,t){let s=Tr,r=!0;for(const i of Tc(n,e)){let o=Tr,l=!0;switch(i.op){case">=":case">":o=XE(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Tr}Op({value:s,inclusive:r},{value:o,inclusive:l})>0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Op({value:s,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e,t=null,s=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function oA(n,e,t,s,r,i,o,l){return new Ho(n,e,t,s,r,i,o,l)}function gl(n){return new Ho(n)}function Kp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Sb(n){return n.collectionGroup!==null}function Ma(n){const e=it(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new $t(cn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ol(i,s))}),t.has(cn.keyField().canonicalString())||e.Ie.push(new ol(cn.keyField(),s))}return e.Ie}function ys(n){const e=it(n);return e.Ee||(e.Ee=aA(e,Ma(n))),e.Ee}function aA(n,e){if(n.limitType==="F")return Fm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new ol(r.field,i)});const t=n.endAt?new Io(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Io(n.startAt.position,n.startAt.inclusive):null;return Fm(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Om(n,e){const t=n.filters.concat([e]);return new Ho(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function qm(n,e,t){return new Ho(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function cu(n,e){return hl(ys(n),ys(e))&&n.limitType===e.limitType}function Tb(n){return`${Ci(ys(n))}|lt:${n.limitType}`}function mo(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>Cb(r)).join(", ")}]`),su(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>wo(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>wo(r)).join(",")),`Target(${s})`}(ys(n))}; limitType=${n.limitType})`}function yl(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Ae.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of Ma(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(o,l,u){const m=qp(o,l,u);return o.inclusive?m<=0:m<0}(s.startAt,Ma(s),r)||s.endAt&&!function(o,l,u){const m=qp(o,l,u);return o.inclusive?m>=0:m>0}(s.endAt,Ma(s),r))}(n,e)}function lA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Pb(n){return(e,t)=>{let s=!1;for(const r of Ma(n)){const i=cA(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function cA(n,e,t){const s=n.field.isKeyField()?Ae.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Fr(u,m):Te(42886)}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Te(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Qr(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return pb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=new rn(Ae.comparator);function us(){return uA}const Lb=new rn(Ae.comparator);function Ca(...n){let e=Lb;for(const t of n)e=e.insert(t.key,t);return e}function jb(n){let e=Lb;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Os(){return Fa()}function Rb(){return Fa()}function Fa(){return new cr(n=>n.toString(),(n,e)=>n.isEqual(e))}const mA=new rn(Ae.comparator),dA=new $t(Ae.comparator);function bt(...n){let e=dA;for(const t of n)e=e.add(t);return e}const fA=new $t(rt);function pA(){return fA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ja(e)?"-0":e}}function Bb(n){return{integerValue:""+n}}function hA(n,e){return vE(e)?Bb(e):Hd(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(){this._=void 0}}function gA(n,e,t){return n instanceof al?function(r,i){const o={fields:{[yb]:{stringValue:gb},[Nb]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&jd(i)&&(i=au(i)),i&&(o.fields[bb]=i),{mapValue:o}}(t,e):n instanceof To?Hb(n,e):n instanceof Po?Mb(n,e):function(r,i){const o=Ub(r,i),l=Gp(o)+Gp(r.Ae);return Um(o)&&Um(r.Ae)?Bb(l):Hd(r.serializer,l)}(n,e)}function yA(n,e,t){return n instanceof To?Hb(n,e):n instanceof Po?Mb(n,e):t}function Ub(n,e){return n instanceof ll?function(s){return Um(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class al extends uu{}class To extends uu{constructor(e){super(),this.elements=e}}function Hb(n,e){const t=Fb(e);for(const s of n.elements)t.some(r=>Ks(r,s))||t.push(s);return{arrayValue:{values:t}}}class Po extends uu{constructor(e){super(),this.elements=e}}function Mb(n,e){let t=Fb(e);for(const s of n.elements)t=t.filter(r=>!Ks(r,s));return{arrayValue:{values:t}}}class ll extends uu{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Gp(n){return sn(n.integerValue||n.doubleValue)}function Fb(n){return il(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t){this.field=e,this.transform=t}}function NA(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof To&&r instanceof To||s instanceof Po&&r instanceof Po?Do(s.elements,r.elements,Ks):s instanceof ll&&r instanceof ll?Ks(s.Ae,r.Ae):s instanceof al&&r instanceof al}(n.transform,e.transform)}class xA{constructor(e,t){this.version=e,this.transformResults=t}}class Kn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kn}static exists(e){return new Kn(void 0,e)}static updateTime(e){return new Kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class mu{}function Ob(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new du(n.key,Kn.none()):new Mo(n.key,n.data,Kn.none());{const t=n.data,s=Wn.empty();let r=new $t(cn.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new ur(n.key,s,new os(r.toArray()),Kn.none())}}function vA(n,e,t){n instanceof Mo?function(r,i,o){const l=r.value.clone(),u=Yp(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ur?function(r,i,o){if(!dc(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Yp(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(qb(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Oa(n,e,t,s){return n instanceof Mo?function(i,o,l,u){if(!dc(i.precondition,o))return l;const m=i.value.clone(),d=Xp(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(n,e,t,s):n instanceof ur?function(i,o,l,u){if(!dc(i.precondition,o))return l;const m=Xp(i.fieldTransforms,u,o),d=o.data;return d.setAll(qb(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(i,o,l){return dc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function _A(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=Ub(s.transform,r||null);i!=null&&(t===null&&(t=Wn.empty()),t.set(s.field,i))}return t||null}function Qp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&Do(s,r,(i,o)=>NA(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Mo extends mu{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ur extends mu{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function qb(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function Yp(n,e,t){const s=new Map;Me(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,l=e.data.field(i.field);s.set(i.field,yA(o,l,t[r]))}return s}function Xp(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,gA(i,o,e))}return s}class du extends mu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $b extends mu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&vA(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Oa(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Oa(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=Rb();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=Ob(o,l);u!==null&&s.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Ge.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),bt())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,(t,s)=>Qp(t,s))&&Do(this.baseMutations,e.baseMutations,(t,s)=>Qp(t,s))}}class Fd{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){Me(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return mA}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Fd(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bn,Vt;function kA(n){switch(n){case se.OK:return Te(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Te(15467,{code:n})}}function zb(n){if(n===void 0)return Zn("GRPC error has no .code"),se.UNKNOWN;switch(n){case bn.OK:return se.OK;case bn.CANCELLED:return se.CANCELLED;case bn.UNKNOWN:return se.UNKNOWN;case bn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case bn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case bn.INTERNAL:return se.INTERNAL;case bn.UNAVAILABLE:return se.UNAVAILABLE;case bn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case bn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case bn.NOT_FOUND:return se.NOT_FOUND;case bn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case bn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case bn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case bn.ABORTED:return se.ABORTED;case bn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case bn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case bn.DATA_LOSS:return se.DATA_LOSS;default:return Te(39323,{code:n})}}(Vt=bn||(bn={}))[Vt.OK=0]="OK",Vt[Vt.CANCELLED=1]="CANCELLED",Vt[Vt.UNKNOWN=2]="UNKNOWN",Vt[Vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vt[Vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vt[Vt.NOT_FOUND=5]="NOT_FOUND",Vt[Vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vt[Vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vt[Vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vt[Vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vt[Vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vt[Vt.ABORTED=10]="ABORTED",Vt[Vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vt[Vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vt[Vt.INTERNAL=13]="INTERNAL",Vt[Vt.UNAVAILABLE=14]="UNAVAILABLE",Vt[Vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=new Br([4294967295,4294967295],0);function Jp(n){const e=EA().encode(n),t=new qy;return t.update(e),new Uint8Array(t.digest())}function Zp(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Br([t,s],0),new Br([r,i],0)]}class qd{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new wa(`Invalid padding: ${t}`);if(s<0)throw new wa(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new wa(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new wa(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Br.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(Br.fromNumber(s)));return r.compare(AA)===1&&(r=new Br([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Jp(e),[s,r]=Zp(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new qd(i,r,t);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Jp(e),[s,r]=Zp(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class wa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,bl.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new fu(Ge.min(),r,new rn(rt),us(),bt())}}class bl{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new bl(s,t,bt(),bt(),bt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class Wb{constructor(e,t){this.targetId=e,this.Ce=t}}class Kb{constructor(e,t,s=En.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class eh{constructor(){this.ve=0,this.Fe=th(),this.Me=En.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=bt(),t=bt(),s=bt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Te(38017,{changeType:i})}}),new bl(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=th()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Me(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class VA{constructor(e){this.Ge=e,this.ze=new Map,this.je=us(),this.Je=Bl(),this.He=Bl(),this.Ye=new rn(rt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((s,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(Sc(i))if(s===0){const o=new Ae(i.path);this.et(t,o,mn.newNoDocument(o,Ge.min()))}else Me(s===1,20013,{expectedCount:s});else{const o=this._t(t);if(o!==s){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=ar(s).toUint8Array()}catch(u){if(u instanceof hb)return Ai("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new qd(o,r,i)}catch(u){return Ai(u instanceof wa?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&Sc(l.target)){const u=new Ae(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,mn.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let s=bt();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new fu(e,t,this.Ye,this.je,s);return this.je=us(),this.Je=Bl(),this.He=Bl(),this.Ye=new rn(rt),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new eh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new $t(rt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new $t(rt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new eh),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Bl(){return new rn(Ae.comparator)}function th(){return new rn(Ae.comparator)}const CA={asc:"ASCENDING",desc:"DESCENDING"},wA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IA={and:"AND",or:"OR"};class SA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $m(n,e){return n.useProto3Json||su(e)?e:{value:e}}function Lo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function TA(n,e){return Lo(n,e.toTimestamp())}function ts(n){return Me(!!n,49232),Ge.fromTimestamp(function(t){const s=or(t);return new be(s.seconds,s.nanos)}(n))}function $d(n,e){return zm(n,e).canonicalString()}function zm(n,e){const t=function(r){return new Rt(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Qb(n){const e=Rt.fromString(n);return Me(rN(e),10190,{key:e.toString()}),e}function Pc(n,e){return $d(n.databaseId,e.path)}function xi(n,e){const t=Qb(e);if(t.get(1)!==n.databaseId.projectId)throw new ve(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ve(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ae(Jb(t))}function Yb(n,e){return $d(n.databaseId,e)}function Xb(n){const e=Qb(n);return e.length===4?Rt.emptyPath():Jb(e)}function Wm(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Jb(n){return Me(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function nh(n,e,t){return{name:Pc(n,e),fields:t.value.mapValue.fields}}function PA(n,e,t){const s=xi(n,e.name),r=ts(e.updateTime),i=e.createTime?ts(e.createTime):Ge.min(),o=new Wn({mapValue:{fields:e.fields}}),l=mn.newFoundDocument(s,r,i,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function LA(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Te(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Me(d===void 0||typeof d=="string",58123),En.fromBase64String(d||"")):(Me(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),En.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?se.UNKNOWN:zb(m.code);return new ve(d,m.message||"")}(o);t=new Kb(s,r,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=xi(n,s.document.name),i=ts(s.document.updateTime),o=s.document.createTime?ts(s.document.createTime):Ge.min(),l=new Wn({mapValue:{fields:s.document.fields}}),u=mn.newFoundDocument(r,i,o,l),m=s.targetIds||[],d=s.removedTargetIds||[];t=new fc(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=xi(n,s.document),i=s.readTime?ts(s.readTime):Ge.min(),o=mn.newNoDocument(r,i),l=s.removedTargetIds||[];t=new fc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=xi(n,s.document),i=s.removedTargetIds||[];t=new fc([],i,r,null)}else{if(!("filter"in e))return Te(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new DA(r,i),l=s.targetId;t=new Wb(l,o)}}return t}function Lc(n,e){let t;if(e instanceof Mo)t={update:nh(n,e.key,e.value)};else if(e instanceof du)t={delete:Pc(n,e.key)};else if(e instanceof ur)t={update:nh(n,e.key,e.data),updateMask:MA(e.fieldMask)};else{if(!(e instanceof $b))return Te(16599,{Vt:e.type});t={verify:Pc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const l=o.transform;if(l instanceof al)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof To)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Po)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ll)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Te(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:TA(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Te(27497)}(n,e.precondition)),t}function Km(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Kn.updateTime(ts(i.updateTime)):i.exists!==void 0?Kn.exists(i.exists):Kn.none()}(e.currentDocument):Kn.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(o,l){let u=null;if("setToServerValue"in l)Me(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new al;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];u=new To(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];u=new Po(d)}else"increment"in l?u=new ll(o,l.increment):Te(16584,{proto:l});const m=cn.fromServerFormat(l.fieldPath);return new bA(m,u)}(n,r)):[];if(e.update){e.update.name;const r=xi(n,e.update.name),i=new Wn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const m=u.fieldPaths||[];return new os(m.map(d=>cn.fromServerFormat(d)))}(e.updateMask);return new ur(r,i,o,t,s)}return new Mo(r,i,t,s)}if(e.delete){const r=xi(n,e.delete);return new du(r,t)}if(e.verify){const r=xi(n,e.verify);return new $b(r,t)}return Te(1463,{proto:e})}function jA(n,e){return n&&n.length>0?(Me(e!==void 0,14353),n.map(t=>function(r,i){let o=r.updateTime?ts(r.updateTime):ts(i);return o.isEqual(Ge.min())&&(o=ts(i)),new xA(o,r.transformResults||[])}(t,e))):[]}function Zb(n,e){return{documents:[Yb(n,e.path)]}}function eN(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Yb(n,r);const i=function(m){if(m.length!==0)return sN(qt.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(h){return{field:fo(h.field),direction:BA(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=$m(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function tN(n){let e=Xb(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){Me(s===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const h=nN(f);return h instanceof qt&&Ud(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(h=>function(w){return new ol(po(w.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(h))}(t.orderBy));let l=null;t.limit&&(l=function(f){let h;return h=typeof f=="object"?f.value:f,su(h)?null:h}(t.limit));let u=null;t.startAt&&(u=function(f){const h=!!f.before,y=f.values||[];return new Io(y,h)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const h=!f.before,y=f.values||[];return new Io(y,h)}(t.endAt)),oA(e,r,o,i,l,"F",u,m)}function RA(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function nN(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=po(t.unaryFilter.field);return _t.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=po(t.unaryFilter.field);return _t.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=po(t.unaryFilter.field);return _t.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=po(t.unaryFilter.field);return _t.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(n):n.fieldFilter!==void 0?function(t){return _t.create(po(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return qt.create(t.compositeFilter.filters.map(s=>nN(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(t.compositeFilter.op))}(n):Te(30097,{filter:n})}function BA(n){return CA[n]}function UA(n){return wA[n]}function HA(n){return IA[n]}function fo(n){return{fieldPath:n.canonicalString()}}function po(n){return cn.fromServerFormat(n.fieldPath)}function sN(n){return n instanceof _t?function(t){if(t.op==="=="){if(Mp(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NAN"}};if(Hp(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Mp(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NOT_NAN"}};if(Hp(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fo(t.field),op:UA(t.op),value:t.value}}}(n):n instanceof qt?function(t){const s=t.getFilters().map(r=>sN(r));return s.length===1?s[0]:{compositeFilter:{op:HA(t.op),filters:s}}}(n):Te(54877,{filter:n})}function MA(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function rN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,t,s,r,i=Ge.min(),o=Ge.min(),l=En.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new nr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new nr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e){this.yt=e}}function FA(n,e){let t;if(e.document)t=PA(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Ae.fromSegments(e.noDocument.path),r=Ii(e.noDocument.readTime);t=mn.newNoDocument(s,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Te(56709);{const s=Ae.fromSegments(e.unknownDocument.path),r=Ii(e.unknownDocument.version);t=mn.newUnknownDocument(s,r)}}return e.readTime&&t.setReadTime(function(r){const i=new be(r[0],r[1]);return Ge.fromTimestamp(i)}(e.readTime)),t}function sh(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:jc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(i,o){return{name:Pc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Lo(i,o.version.toTimestamp()),createTime:Lo(i,o.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:wi(e.version)};else{if(!e.isUnknownDocument())return Te(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:wi(e.version)}}return s}function jc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function wi(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ii(n){const e=new be(n.seconds,n.nanoseconds);return Ge.fromTimestamp(e)}function fi(n,e){const t=(e.baseMutations||[]).map(i=>Km(n.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>Km(n.yt,i)),r=be.fromMillis(e.localWriteTimeMs);return new Md(e.batchId,r,t,s)}function Ia(n){const e=Ii(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ii(n.lastLimboFreeSnapshotVersion):Ge.min();let s;return s=function(i){return i.documents!==void 0}(n.query)?function(i){const o=i.documents.length;return Me(o===1,1966,{count:o}),ys(gl(Xb(i.documents[0])))}(n.query):function(i){return ys(tN(i))}(n.query),new nr(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,En.fromBase64String(n.resumeToken))}function oN(n,e){const t=wi(e.snapshotVersion),s=wi(e.lastLimboFreeSnapshotVersion);let r;r=Sc(e.target)?Zb(n.yt,e.target):eN(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ci(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function aN(n){const e=tN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?qm(e,e.limit,"L"):e}function nm(n,e){return new Od(e.largestBatchId,Km(n.yt,e.overlayMutation))}function rh(n,e){const t=e.path.lastSegment();return[n,Qn(e.path.popLast()),t]}function ih(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:wi(s.readTime),documentKey:Qn(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{getBundleMetadata(e,t){return oh(e).get(t).next(s=>{if(s)return function(i){return{id:i.bundleId,createTime:Ii(i.createTime),version:i.version}}(s)})}saveBundleMetadata(e,t){return oh(e).put(function(r){return{bundleId:r.id,createTime:wi(ts(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return ah(e).get(t).next(s=>{if(s)return function(i){return{name:i.name,query:aN(i.bundledQuery),readTime:Ii(i.readTime)}}(s)})}saveNamedQuery(e,t){return ah(e).put(function(r){return{name:r.name,readTime:wi(ts(r.readTime)),bundledQuery:r.bundledQuery}}(t))}}function oh(n){return Sn(n,ru)}function ah(n){return Sn(n,iu)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new pu(e,s)}getOverlay(e,t){return ta(e).get(rh(this.userId,t)).next(s=>s?nm(this.serializer,s):null)}getOverlays(e,t){const s=Os();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){const r=[];return s.forEach((i,o)=>{const l=new Od(t,o);r.push(this.St(e,l))}),$.waitFor(r)}removeOverlaysForBatchId(e,t,s){const r=new Set;t.forEach(o=>r.add(Qn(o.getCollectionPath())));const i=[];return r.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(ta(e).Z(jm,l))}),$.waitFor(i)}getOverlaysForCollection(e,t,s){const r=Os(),i=Qn(t),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ta(e).J(jm,o).next(l=>{for(const u of l){const m=nm(this.serializer,u);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,s,r){const i=Os();let o;const l=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ta(e).ee({index:cb,range:l},(u,m,d)=>{const f=nm(this.serializer,m);i.size()<r||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}St(e,t){return ta(e).put(function(r,i,o){const[l,u,m]=rh(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:m,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Lc(r.yt,o.mutation)}}(this.serializer,this.userId,t))}}function ta(n){return Sn(n,ou)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{bt(e){return Sn(e,Pd)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const s=t==null?void 0:t.value;return s?En.fromUint8Array(s):En.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(sn(e.integerValue));else if("doubleValue"in e){const s=sn(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),Ja(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=or(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ar(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?vb(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):lu(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Te(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const r of Object.keys(s))this.Ot(r,t),this.Ct(s[r],t)}kt(e,t){var o,l;const s=e.fields||{};this.Ft(t,53);const r=Co,i=((l=(o=s[r].arrayValue)==null?void 0:o.values)==null?void 0:l.length)||0;this.Ft(t,15),t.Mt(sn(i)),this.Ot(r,t),this.Ct(s[r],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const r of s)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ae.fromName(e).path.forEach(s=>{this.Ft(t,60),this.Ut(s,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}pi.Kt=new pi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi=255;function $A(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function lh(n){const e=64-function(s){let r=0;for(let i=0;i<8;++i){const o=$A(255&s[i]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(e/8)}class zA{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),s=lh(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),s=lh(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Wi),this.sn(255)}_n(){this.an(Wi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let r=1;r<t.length;++r)t[r]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Wi?(this.sn(Wi),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Wi?(this.an(Wi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class WA{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class KA{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class na{constructor(){this.cn=new zA,this.ln=new WA(this.cn),this.hn=new KA(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,t,s,r){this.Tn=e,this.In=t,this.En=s,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new hi(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:pc(this.En),directionalValue:pc(this.dn),orderedDocumentKey:pc(t),documentKey:s.path.toArray()}}Vn(e,t,s){const r=this.Rn(e,t,s);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Nr(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=ch(n.En,e.En),t!==0?t:(t=ch(n.dn,e.dn),t!==0?t:Ae.comparator(n.In,e.In)))}function ch(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function pc(n){return Iy()?function(t){let s="";for(let r=0;r<t.length;r++)s+=String.fromCharCode(t[r]);return s}(n):n}function uh(n){return typeof n!="string"?n:function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(n)}class mh{constructor(e){this.mn=new $t((t,s)=>cn.comparator(t.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(Me(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Tm(e);if(t!==void 0&&!this.wn(t))return!1;const s=ui(e);let r=new Set,i=0,o=0;for(;i<s.length&&this.wn(s[i]);++i)r=r.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=s[i];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new $t(cn.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new oc(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new oc(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new oc(s.field,s.dir==="asc"?0:1)));return new Ac(Ac.UNKNOWN_ID,this.collectionId,t,Xa.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lN(n){var t,s;if(Me(n instanceof _t||n instanceof qt,20012),n instanceof _t){if(n instanceof Ib){const r=((s=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:s.map(i=>_t.create(n.field,"==",i)))||[];return qt.create(r,"or")}return n}const e=n.filters.map(r=>lN(r));return qt.create(e,n.op)}function GA(n){if(n.getFilters().length===0)return[];const e=Ym(lN(n));return Me(cN(e),7391),Gm(e)||Qm(e)?[e]:e.getFilters()}function Gm(n){return n instanceof _t}function Qm(n){return n instanceof qt&&Ud(n)}function cN(n){return Gm(n)||Qm(n)||function(t){if(t instanceof qt&&Hm(t)){for(const s of t.getFilters())if(!Gm(s)&&!Qm(s))return!1;return!0}return!1}(n)}function Ym(n){if(Me(n instanceof _t||n instanceof qt,34018),n instanceof _t)return n;if(n.filters.length===1)return Ym(n.filters[0]);const e=n.filters.map(s=>Ym(s));let t=qt.create(e,n.op);return t=Rc(t),cN(t)?t:(Me(t instanceof qt,64498),Me(So(t),40251),Me(t.filters.length>1,57927),t.filters.reduce((s,r)=>zd(s,r)))}function zd(n,e){let t;return Me(n instanceof _t||n instanceof qt,38388),Me(e instanceof _t||e instanceof qt,25473),t=n instanceof _t?e instanceof _t?function(r,i){return qt.create([r,i],"and")}(n,e):dh(n,e):e instanceof _t?dh(e,n):function(r,i){if(Me(r.filters.length>0&&i.filters.length>0,48005),So(r)&&So(i))return Vb(r,i.getFilters());const o=Hm(r)?r:i,l=Hm(r)?i:r,u=o.filters.map(m=>zd(m,l));return qt.create(u,"or")}(n,e),Rc(t)}function dh(n,e){if(So(e))return Vb(e,n.getFilters());{const t=e.filters.map(s=>zd(n,s));return qt.create(t,"or")}}function Rc(n){if(Me(n instanceof _t||n instanceof qt,11850),n instanceof _t)return n;const e=n.getFilters();if(e.length===1)return Rc(e[0]);if(Eb(n))return n;const t=e.map(r=>Rc(r)),s=[];return t.forEach(r=>{r instanceof _t?s.push(r):r instanceof qt&&(r.op===n.op?s.push(...r.filters):s.push(r))}),s.length===1?s[0]:qt.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(){this.Cn=new Wd}addToCollectionParentIndex(e,t){return this.Cn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(ms.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(ms.min())}updateCollectionGroup(e,t,s){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class Wd{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new $t(Rt.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new $t(Rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh="IndexedDbIndexManager",Ul=new Uint8Array(0);class YA{constructor(e,t){this.databaseId=t,this.vn=new Wd,this.Fn=new cr(s=>Ci(s),(s,r)=>hl(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:s,parent:Qn(r)};return ph(e).put(i)}return $.resolve()}getCollectionParents(e,t){const s=[],r=IDBKeyRange.bound([t,""],[Xy(t),""],!1,!0);return ph(e).J(r).next(i=>{for(const o of i){if(o.collectionId!==t)break;s.push(Fs(o.parent))}return s})}addFieldIndex(e,t){const s=sa(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete r.indexId;const i=s.add(r);if(t.indexState){const o=Gi(e);return i.next(l=>{o.put(ih(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const s=sa(e),r=Gi(e),i=Ki(e);return s.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=sa(e),s=Ki(e),r=Gi(e);return t.Z().next(()=>s.Z()).next(()=>r.Z())}createTargetIndexes(e,t){return $.forEach(this.Mn(t),s=>this.getIndexType(e,s).next(r=>{if(r===0||r===1){const i=new mh(s).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const s=Ki(e);let r=!0;const i=new Map;return $.forEach(this.Mn(t),o=>this.xn(e,o).next(l=>{r&&(r=!!l),i.set(o,l)})).next(()=>{if(r){let o=bt();const l=[];return $.forEach(i,(u,m)=>{pe(fh,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(re=>`${re.fieldPath}:${re.kind}`).join(",")}`}(u)} to execute ${Ci(t)}`);const d=function(F,re){const ee=Tm(re);if(ee===void 0)return null;for(const M of Tc(F,ee.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(m,u),f=function(F,re){const ee=new Map;for(const M of ui(re))for(const A of Tc(F,M.fieldPath))switch(A.op){case"==":case"in":ee.set(M.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return ee.set(M.fieldPath.canonicalString(),A.value),Array.from(ee.values())}return null}(m,u),h=function(F,re){const ee=[];let M=!0;for(const A of ui(re)){const N=A.kind===0?zp(F,A.fieldPath,F.startAt):Wp(F,A.fieldPath,F.startAt);ee.push(N.value),M&&(M=N.inclusive)}return new Io(ee,M)}(m,u),y=function(F,re){const ee=[];let M=!0;for(const A of ui(re)){const N=A.kind===0?Wp(F,A.fieldPath,F.endAt):zp(F,A.fieldPath,F.endAt);ee.push(N.value),M&&(M=N.inclusive)}return new Io(ee,M)}(m,u),w=this.On(u,m,h),v=this.On(u,m,y),C=this.Nn(u,m,f),B=this.Bn(u.indexId,d,w,h.inclusive,v,y.inclusive,C);return $.forEach(B,T=>s.Y(T,t.limit).next(F=>{F.forEach(re=>{const ee=Ae.fromSegments(re.documentKey);o.has(ee)||(o=o.add(ee),l.push(ee))})}))}).next(()=>l)}return $.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=GA(qt.create(e.filters,"and")).map(s=>Fm(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,s,r,i,o,l){const u=(t!=null?t.length:1)*Math.max(s.length,i.length),m=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const h=t?this.Ln(t[f/m]):Ul,y=this.kn(e,h,s[f%m],r),w=this.qn(e,h,i[f%m],o),v=l.map(C=>this.kn(e,h,C,!0));d.push(...this.createRange(y,w,v))}return d}kn(e,t,s,r){const i=new hi(e,Ae.empty(),t,s);return r?i:i.An()}qn(e,t,s,r){const i=new hi(e,Ae.empty(),t,s);return r?i.An():i}xn(e,t){const s=new mh(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const l of i)s.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let s=2;const r=this.Mn(t);return $.forEach(r,i=>this.xn(e,i).next(o=>{o?s!==0&&o.fields.length<function(u){let m=new $t(cn.comparator),d=!1;for(const f of u.filters)for(const h of f.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?d=!0:m=m.add(h.field));for(const f of u.orderBy)f.field.isKeyField()||(m=m.add(f.field));return m.size+(d?1:0)}(i)&&(s=1):s=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&s===2?1:s)}Qn(e,t){const s=new na;for(const r of ui(e)){const i=t.data.field(r.fieldPath);if(i==null)return null;const o=s.Pn(r.kind);pi.Kt.Dt(i,o)}return s.un()}Ln(e){const t=new na;return pi.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new na;return pi.Kt.Dt(rl(this.databaseId,t),s.Pn(function(i){const o=ui(i);return o.length===0?0:o[o.length-1].kind}(e))),s.un()}Nn(e,t,s){if(s===null)return[];let r=[];r.push(new na);let i=0;for(const o of ui(e)){const l=s[i++];for(const u of r)if(this.Un(t,o.fieldPath)&&il(l))r=this.Kn(r,o,l);else{const m=u.Pn(o.kind);pi.Kt.Dt(l,m)}}return this.Wn(r)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of r){const u=new na;u.seed(l.un()),pi.Kt.Dt(o,u.Pn(t.kind)),i.push(u)}return i}Un(e,t){return!!e.filters.find(s=>s instanceof _t&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,t){const s=sa(e),r=Gi(e);return(t?s.J(Lm,IDBKeyRange.bound(t,t)):s.J()).next(i=>{const o=[];return $.forEach(i,l=>r.get([l.indexId,this.uid]).next(u=>{o.push(function(d,f){const h=f?new Xa(f.sequenceNumber,new ms(Ii(f.readTime),new Ae(Fs(f.documentKey)),f.largestBatchId)):Xa.empty(),y=d.fields.map(([w,v])=>new oc(cn.fromServerFormat(w),v));return new Ac(d.indexId,d.collectionGroup,y,h)}(l,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:rt(s.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const r=sa(e),i=Gi(e);return this.Gn(e).next(o=>r.J(Lm,IDBKeyRange.bound(t,t)).next(l=>$.forEach(l,u=>i.put(ih(u.indexId,this.uid,o,s)))))}updateIndexEntries(e,t){const s=new Map;return $.forEach(t,(r,i)=>{const o=s.get(r.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(s.set(r.collectionGroup,l),$.forEach(l,u=>this.zn(e,r,u).next(m=>{const d=this.jn(i,u);return m.isEqual(d)?$.resolve():this.Jn(e,i,u,m,d)}))))})}Hn(e,t,s,r){return Ki(e).put(r.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,r){return Ki(e).delete(r.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const r=Ki(e);let i=new $t(Nr);return r.ee({index:lb,range:IDBKeyRange.only([s.indexId,this.uid,pc(this.$n(s,t))])},(o,l)=>{i=i.add(new hi(s.indexId,t,uh(l.arrayValue),uh(l.directionalValue)))}).next(()=>i)}jn(e,t){let s=new $t(Nr);const r=this.Qn(t,e);if(r==null)return s;const i=Tm(t);if(i!=null){const o=e.data.field(i.fieldPath);if(il(o))for(const l of o.arrayValue.values||[])s=s.add(new hi(t.indexId,e.key,this.Ln(l),r))}else s=s.add(new hi(t.indexId,e.key,Ul,r));return s}Jn(e,t,s,r,i){pe(fh,"Updating index entries for document '%s'",t.key);const o=[];return function(u,m,d,f,h){const y=u.getIterator(),w=m.getIterator();let v=zi(y),C=zi(w);for(;v||C;){let B=!1,T=!1;if(v&&C){const F=d(v,C);F<0?T=!0:F>0&&(B=!0)}else v!=null?T=!0:B=!0;B?(f(C),C=zi(w)):T?(h(v),v=zi(y)):(v=zi(y),C=zi(w))}}(r,i,Nr,l=>{o.push(this.Hn(e,t,s,l))},l=>{o.push(this.Yn(e,t,s,l))}),$.waitFor(o)}Gn(e){let t=1;return Gi(e).ee({index:ab,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((o,l)=>Nr(o,l)).filter((o,l,u)=>!l||Nr(o,u[l-1])!==0);const r=[];r.push(e);for(const o of s){const l=Nr(o,e),u=Nr(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Ul,Ae.empty()),u=r[o+1].Vn(this.uid,Ul,Ae.empty());i.push(IDBKeyRange.bound(l,u))}return i}Zn(e,t){return Nr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(hh)}getMinOffset(e,t){return $.mapArray(this.Mn(t),s=>this.xn(e,s).next(r=>r||Te(44426))).next(hh)}}function ph(n){return Sn(n,tl)}function Ki(n){return Sn(n,Ua)}function sa(n){return Sn(n,Td)}function Gi(n){return Sn(n,Ba)}function hh(n){Me(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const r=n[s].indexState.offset;wd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ms(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uN=41943040;class zn{static withCacheSize(e){return new zn(e,zn.DEFAULT_COLLECTION_PERCENTILE,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(n,e,t){const s=n.store(_s),r=n.store(ko),i=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=s.ee({range:o},(d,f,h)=>(l++,h.delete()));i.push(u.next(()=>{Me(l===1,47070,{batchId:t.batchId})}));const m=[];for(const d of t.mutations){const f=rb(e,d.key.path,t.batchId);i.push(r.delete(f)),m.push(d.key)}return $.waitFor(i).next(()=>m)}function Bc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Te(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zn.DEFAULT_COLLECTION_PERCENTILE=10,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zn.DEFAULT=new zn(uN,zn.DEFAULT_COLLECTION_PERCENTILE,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zn.DISABLED=new zn(-1,0,0);class hu{constructor(e,t,s,r){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=r,this.Xn={}}static wt(e,t,s,r){Me(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new hu(i,t,s,r)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xr(e).ee({index:gi,range:s},(r,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,s,r){const i=ho(e),o=xr(e);return o.add({}).next(l=>{Me(typeof l=="number",49019);const u=new Md(l,t,s,r),m=function(y,w,v){const C=v.baseMutations.map(T=>Lc(y.yt,T)),B=v.mutations.map(T=>Lc(y.yt,T));return{userId:w,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:C,mutations:B}}(this.serializer,this.userId,u),d=[];let f=new $t((h,y)=>rt(h.canonicalString(),y.canonicalString()));for(const h of r){const y=rb(this.userId,h.key.path,l);f=f.add(h.key.path.popLast()),d.push(o.put(m)),d.push(i.put(y,kE))}return f.forEach(h=>{d.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Xn[l]=u.keys()}),$.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return xr(e).get(t).next(s=>s?(Me(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),fi(this.serializer,s)):null)}er(e,t){return this.Xn[t]?$.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const r=s.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return xr(e).ee({index:gi,range:r},(o,l,u)=>{l.userId===this.userId&&(Me(l.batchId>=s,47524,{tr:s}),i=fi(this.serializer,l)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=bi;return xr(e).ee({index:gi,range:t,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,bi],[this.userId,Number.POSITIVE_INFINITY]);return xr(e).J(gi,t).next(s=>s.map(r=>fi(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=ac(this.userId,t.path),r=IDBKeyRange.lowerBound(s),i=[];return ho(e).ee({range:r},(o,l,u)=>{const[m,d,f]=o,h=Fs(d);if(m===this.userId&&t.path.isEqual(h))return xr(e).get(f).next(y=>{if(!y)throw Te(61480,{nr:o,batchId:f});Me(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),i.push(fi(this.serializer,y))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new $t(rt);const r=[];return t.forEach(i=>{const o=ac(this.userId,i.path),l=IDBKeyRange.lowerBound(o),u=ho(e).ee({range:l},(m,d,f)=>{const[h,y,w]=m,v=Fs(y);h===this.userId&&i.path.isEqual(v)?s=s.add(w):f.done()});r.push(u)}),$.waitFor(r).next(()=>this.rr(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1,i=ac(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new $t(rt);return ho(e).ee({range:o},(u,m,d)=>{const[f,h,y]=u,w=Fs(h);f===this.userId&&s.isPrefixOf(w)?w.length===r&&(l=l.add(y)):d.done()}).next(()=>this.rr(e,l))}rr(e,t){const s=[],r=[];return t.forEach(i=>{r.push(xr(e).get(i).next(o=>{if(o===null)throw Te(35274,{batchId:i});Me(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),s.push(fi(this.serializer,o))}))}),$.waitFor(r).next(()=>s)}removeMutationBatch(e,t){return mN(e.le,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),$.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return $.resolve();const s=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return ho(e).ee({range:s},(i,o,l)=>{if(i[0]===this.userId){const u=Fs(i[1]);r.push(u)}else l.done()}).next(()=>{Me(r.length===0,56720,{sr:r.map(i=>i.canonicalString())})})})}containsKey(e,t){return dN(e,this.userId,t)}_r(e){return fN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:bi,lastStreamToken:""})}}function dN(n,e,t){const s=ac(e,t.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return ho(n).ee({range:i,X:!0},(l,u,m)=>{const[d,f,h]=l;d===e&&f===r&&(o=!0),m.done()}).next(()=>o)}function xr(n){return Sn(n,_s)}function ho(n){return Sn(n,ko)}function fN(n){return Sn(n,Za)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Si(0)}static cr(){return new Si(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const s=new Si(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>Ge.fromTimestamp(new be(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.lr(e).next(r=>(r.highestListenSequenceNumber=t,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Qi(e).delete(t.targetId)).next(()=>this.lr(e)).next(s=>(Me(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s)))}removeTargets(e,t,s){let r=0;const i=[];return Qi(e).ee((o,l)=>{const u=Ia(l);u.sequenceNumber<=t&&s.get(u.targetId)===null&&(r++,i.push(this.removeTargetData(e,u)))}).next(()=>$.waitFor(i)).next(()=>r)}forEachTarget(e,t){return Qi(e).ee((s,r)=>{const i=Ia(r);t(i)})}lr(e){return yh(e).get(wc).next(t=>(Me(t!==null,2888),t))}hr(e,t){return yh(e).put(wc,t)}Pr(e,t){return Qi(e).put(oN(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const s=Ci(t),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return Qi(e).ee({range:r,index:ob},(o,l,u)=>{const m=Ia(l);hl(t,m.target)&&(i=m,u.done())}).next(()=>i)}addMatchingKeys(e,t,s){const r=[],i=Ir(e);return t.forEach(o=>{const l=Qn(o.path);r.push(i.put({targetId:s,path:l})),r.push(this.referenceDelegate.addReference(e,s,o))}),$.waitFor(r)}removeMatchingKeys(e,t,s){const r=Ir(e);return $.forEach(t,i=>{const o=Qn(i.path);return $.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,t){const s=Ir(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),r=Ir(e);let i=bt();return r.ee({range:s,X:!0},(o,l,u)=>{const m=Fs(o[1]),d=new Ae(m);i=i.add(d)}).next(()=>i)}containsKey(e,t){const s=Qn(t.path),r=IDBKeyRange.bound([s],[Xy(s)],!1,!0);let i=0;return Ir(e).ee({index:Sd,X:!0,range:r},([o,l],u,m)=>{o!==0&&(i++,m.done())}).next(()=>i>0)}At(e,t){return Qi(e).get(t).next(s=>s?Ia(s):null)}}function Qi(n){return Sn(n,Eo)}function yh(n){return Sn(n,Ni)}function Ir(n){return Sn(n,Ao)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh="LruGarbageCollector",JA=1048576;function Nh([n,e],[t,s]){const r=rt(n,t);return r===0?rt(e,s):r}class ZA{constructor(e){this.Ir=e,this.buffer=new $t(Nh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Nh(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class pN{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(bh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Gr(t)?pe(bh,"Ignoring IndexedDB error during garbage collection: ",t):await Li(t)}await this.Vr(3e5)})}}class eV{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return $.resolve(gs.ce);const s=new ZA(t);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(gh)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gh):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(s=f,l=Date.now(),this.removeTargets(e,s,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(m=Date.now(),uo()<=Ct.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function hN(n,e){return new eV(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e,t){this.db=e,this.garbageCollector=hN(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(s,r)=>t(r))}addReference(e,t,s){return Hl(e,s)}removeReference(e,t,s){return Hl(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Hl(e,t)}br(e,t){return function(r,i){let o=!1;return fN(r).te(l=>dN(r,l,i).next(u=>(u&&(o=!0),$.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,(o,l)=>{if(l<=t){const u=this.br(e,o).next(m=>{if(!m)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,Ge.min()),Ir(e).delete(function(f){return[0,Qn(f.path)]}(o))))});r.push(u)}}).next(()=>$.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Hl(e,t)}Sr(e,t){const s=Ir(e);let r,i=gs.ce;return s.ee({index:Sd},([o,l],{path:u,sequenceNumber:m})=>{o===0?(i!==gs.ce&&t(new Ae(Fs(r)),i),i=m,r=u):i=gs.ce}).next(()=>{i!==gs.ce&&t(new Ae(Fs(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Hl(n,e){return Ir(n).put(function(s,r){return{targetId:0,path:Qn(s.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(){this.changes=new cr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?$.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return ai(e).put(s)}removeEntry(e,t,s){return ai(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],jc(o),l[l.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.Dr(e,s)))}getEntry(e,t){let s=mn.newInvalidDocument(t);return ai(e).ee({index:lc,range:IDBKeyRange.only(ra(t))},(r,i)=>{s=this.Cr(t,i)}).next(()=>s)}vr(e,t){let s={size:0,document:mn.newInvalidDocument(t)};return ai(e).ee({index:lc,range:IDBKeyRange.only(ra(t))},(r,i)=>{s={document:this.Cr(t,i),size:Bc(i)}}).next(()=>s)}getEntries(e,t){let s=us();return this.Fr(e,t,(r,i)=>{const o=this.Cr(r,i);s=s.insert(r,o)}).next(()=>s)}Mr(e,t){let s=us(),r=new rn(Ae.comparator);return this.Fr(e,t,(i,o)=>{const l=this.Cr(i,o);s=s.insert(i,l),r=r.insert(i,Bc(o))}).next(()=>({documents:s,Or:r}))}Fr(e,t,s){if(t.isEmpty())return $.resolve();let r=new $t(_h);t.forEach(u=>r=r.add(u));const i=IDBKeyRange.bound(ra(r.first()),ra(r.last())),o=r.getIterator();let l=o.getNext();return ai(e).ee({index:lc,range:i},(u,m,d)=>{const f=Ae.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;l&&_h(l,f)<0;)s(l,null),l=o.getNext();l&&l.isEqual(f)&&(s(l,m),l=o.hasNext()?o.getNext():null),l?d.j(ra(l)):d.done()}).next(()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,s,r,i){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),jc(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ai(e).J(IDBKeyRange.bound(l,u,!0)).next(m=>{i==null||i.incrementDocumentReadCount(m.length);let d=us();for(const f of m){const h=this.Cr(Ae.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);h.isFoundDocument()&&(yl(t,h)||r.has(h.key))&&(d=d.insert(h.key,h))}return d})}getAllFromCollectionGroup(e,t,s,r){let i=us();const o=vh(t,s),l=vh(t,ms.max());return ai(e).ee({index:ib,range:IDBKeyRange.bound(o,l,!0)},(u,m,d)=>{const f=this.Cr(Ae.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);i=i.insert(f.key,f),i.size===r&&d.done()}).next(()=>i)}newChangeBuffer(e){return new sV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return xh(e).get(Pm).next(t=>(Me(!!t,20021),t))}Dr(e,t){return xh(e).put(Pm,t)}Cr(e,t){if(t){const s=FA(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Ge.min())))return s}return mn.newInvalidDocument(e)}}function yN(n){return new nV(n)}class sV extends gN{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new cr(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const t=[];let s=0,r=new $t((i,o)=>rt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const u=sh(this.Nr.serializer,o);r=r.add(i.path.popLast());const m=Bc(u);s+=m-l.size,t.push(this.Nr.addEntry(e,i,u))}else if(s-=l.size,this.trackRemovals){const u=sh(this.Nr.serializer,o.convertToNoDocument(Ge.min()));t.push(this.Nr.addEntry(e,i,u))}}),r.forEach(i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Nr.updateMetadata(e,s)),$.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:s,Or:r})=>(r.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function xh(n){return Sn(n,el)}function ai(n){return Sn(n,Cc)}function ra(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function vh(n,e){const t=e.documentKey.path.toArray();return[n,jc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function _h(n,e){const t=n.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<t.length-2&&i<s.length-2;++i)if(r=rt(t[i],s[i]),r)return r;return r=rt(t.length,s.length),r||(r=rt(t[t.length-2],s[s.length-2]),r||rt(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&Oa(s.mutation,r,os.empty(),be.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,bt()).next(()=>s))}getLocalViewOfDocuments(e,t,s=bt()){const r=Os();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=Ca();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=Os();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,bt()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,s,r){let i=us();const o=Fa(),l=function(){return Fa()}();return t.forEach((u,m)=>{const d=s.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof ur)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),Oa(d.mutation,m,d.mutation.getFieldMask(),be.now())):o.set(m.key,os.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new rV(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const s=Fa();let r=new rn((o,l)=>o-l),i=bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=s.get(u)||os.empty();d=l.applyToLocalView(m,d),s.set(u,d);const f=(r.get(l.batchId)||bt()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=Rb();d.forEach(h=>{if(!i.has(h)){const y=Ob(t.get(h),s.get(h));y!==null&&f.set(h,y),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(o){return Ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):$.resolve(Os());let l=Ya,u=i;return o.next(m=>$.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{u=u.insert(d,h)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,bt())).next(d=>({batchId:l,changes:jb(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ae(t)).next(s=>{let r=Ca();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=Ca();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const m=function(f,h){return new Ho(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,s,r).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,mn.newInvalidDocument(d)))});let l=Ca();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&Oa(d.mutation,m,os.empty(),be.now()),yl(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:ts(r.createTime)}}(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:aN(r.bundledQuery),readTime:ts(r.readTime)}}(t)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(){this.overlays=new rn(Ae.comparator),this.qr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Os();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.St(e,t,i)}),$.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),$.resolve()}getOverlaysForCollection(e,t,s){const r=Os(),i=t.length+1,o=new Ae(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>s&&r.set(u.getKey(),u)}return $.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new rn((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>s){let d=i.get(m.largestBatchId);d===null&&(d=Os(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=Os(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return $.resolve(l)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Od(t,s));let i=this.qr.get(t);i===void 0&&(i=bt(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(){this.sessionToken=En.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(){this.Qr=new $t(jn.$r),this.Ur=new $t(jn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new jn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Gr(new jn(e,t))}zr(e,t){e.forEach(s=>this.removeReference(s,t))}jr(e){const t=new Ae(new Rt([])),s=new jn(t,e),r=new jn(t,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ae(new Rt([])),s=new jn(t,e),r=new jn(t,e+1);let i=bt();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new jn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class jn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ae.comparator(e.key,t.key)||rt(e.Yr,t.Yr)}static Kr(e,t){return rt(e.Yr,t.Yr)||Ae.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new $t(jn.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Md(i,t,s,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new jn(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,t){return $.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?bi:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new jn(t,0),r=new jn(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new $t(rt);return t.forEach(r=>{const i=new jn(r,0),o=new jn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{s=s.add(l.Yr)})}),$.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;Ae.isDocumentKey(i)||(i=i.child(""));const o=new jn(new Ae(i),0);let l=new $t(rt);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!s.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),$.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Me(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return $.forEach(t.mutations,r=>{const i=new jn(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,t){const s=new jn(t,0),r=this.Zr.firstAfterOrEqual(s);return $.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e){this.ri=e,this.docs=function(){return new rn(Ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return $.resolve(s?s.document.mutableCopy():mn.newInvalidDocument(t))}getEntries(e,t){let s=us();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():mn.newInvalidDocument(r))}),$.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=us();const o=t.path,l=new Ae(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||wd(eb(d),s)<=0||(r.has(d.key)||yl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,t,s,r){Te(9500)}ii(e,t){return $.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new uV(this)}getSize(e){return $.resolve(this.size)}}class uV extends gN{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),$.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e){this.persistence=e,this.si=new cr(t=>Ci(t),hl),this.lastRemoteSnapshotVersion=Ge.min(),this.highestTargetId=0,this.oi=0,this._i=new Kd,this.targetCount=0,this.ai=Si.ur()}forEachTarget(e,t){return this.si.forEach((s,r)=>t(r)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),$.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Si(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Pr(t),$.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&s.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),$.waitFor(i).next(()=>r)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return $.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),$.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return $.resolve(s)}containsKey(e,t){return $.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,t){this.ui={},this.overlays={},this.ci=new gs(0),this.li=!1,this.li=!0,this.hi=new aV,this.referenceDelegate=e(this),this.Pi=new mV(this),this.indexManager=new QA,this.remoteDocumentCache=function(r){return new cV(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new iN(t),this.Ii=new iV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new oV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new lV(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){pe("MemoryPersistence","Starting transaction:",e);const r=new dV(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return $.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,t)))}}class dV extends nb{constructor(e){super(),this.currentSequenceNumber=e}}class gu{constructor(e){this.persistence=e,this.Ri=new Kd,this.Vi=null}static mi(e){return new gu(e)}get fi(){if(this.Vi)return this.Vi;throw Te(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),$.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,s=>{const r=Ae.fromPath(s);return this.gi(e,r).next(i=>{i||t.removeEntry(r,Ge.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return $.or([()=>$.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Uc{constructor(e,t){this.persistence=e,this.pi=new cr(s=>Qn(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=hN(this,t)}static mi(e,t){return new Uc(e,t)}Ei(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}pr(e,t){return $.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?$.resolve():t(r)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(s++,i.removeEntry(o,Ge.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=uc(e.data.value)),t}br(e,t,s){return $.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return $.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e){this.serializer=e}k(e,t,s,r){const i=new nu("createOrUpgrade",t);s<1&&r>=1&&(function(u){u.createObjectStore(pl)}(e),function(u){u.createObjectStore(Za,{keyPath:DE}),u.createObjectStore(_s,{keyPath:Pp,autoIncrement:!0}).createIndex(gi,Lp,{unique:!0}),u.createObjectStore(ko)}(e),Dh(e),function(u){u.createObjectStore(mi)}(e));let o=$.resolve();return s<3&&r>=3&&(s!==0&&(function(u){u.deleteObjectStore(Ao),u.deleteObjectStore(Eo),u.deleteObjectStore(Ni)}(e),Dh(e)),o=o.next(()=>function(u){const m=u.store(Ni),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ge.min().toTimestamp(),targetCount:0};return m.put(wc,d)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(u,m){return m.store(_s).J().next(f=>{u.deleteObjectStore(_s),u.createObjectStore(_s,{keyPath:Pp,autoIncrement:!0}).createIndex(gi,Lp,{unique:!0});const h=m.store(_s),y=f.map(w=>h.put(w));return $.waitFor(y)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore(Vo,{keyPath:TE})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.yi(i))),s<6&&r>=6&&(o=o.next(()=>(function(u){u.createObjectStore(el)}(e),this.wi(i)))),s<7&&r>=7&&(o=o.next(()=>this.Si(i))),s<8&&r>=8&&(o=o.next(()=>this.bi(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Di(i))),s<11&&r>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(ru,{keyPath:PE})})(e),function(u){u.createObjectStore(iu,{keyPath:LE})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(u){const m=u.createObjectStore(ou,{keyPath:FE});m.createIndex(jm,OE,{unique:!1}),m.createIndex(cb,qE,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(u){const m=u.createObjectStore(Cc,{keyPath:EE});m.createIndex(lc,AE),m.createIndex(ib,VE)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(mi))),s<14&&r>=14&&(o=o.next(()=>this.Fi(e,i))),s<15&&r>=15&&(o=o.next(()=>function(u){u.createObjectStore(Td,{keyPath:jE,autoIncrement:!0}).createIndex(Lm,RE,{unique:!1}),u.createObjectStore(Ba,{keyPath:BE}).createIndex(ab,UE,{unique:!1}),u.createObjectStore(Ua,{keyPath:HE}).createIndex(lb,ME,{unique:!1})}(e))),s<16&&r>=16&&(o=o.next(()=>{t.objectStore(Ba).clear()}).next(()=>{t.objectStore(Ua).clear()})),s<17&&r>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(Pd,{keyPath:$E})})(e)})),s<18&&r>=18&&Iy()&&(o=o.next(()=>{t.objectStore(Ba).clear()}).next(()=>{t.objectStore(Ua).clear()})),o}wi(e){let t=0;return e.store(mi).ee((s,r)=>{t+=Bc(r)}).next(()=>{const s={byteSize:t};return e.store(el).put(Pm,s)})}yi(e){const t=e.store(Za),s=e.store(_s);return t.J().next(r=>$.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,bi],[i.userId,i.lastAcknowledgedBatchId]);return s.J(gi,o).next(l=>$.forEach(l,u=>{Me(u.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const m=fi(this.serializer,u);return mN(e,i.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(Ao),s=e.store(mi);return e.store(Ni).get(wc).next(r=>{const i=[];return s.ee((o,l)=>{const u=new Rt(o),m=function(f){return[0,Qn(f)]}(u);i.push(t.get(m).next(d=>d?$.resolve():(f=>t.put({targetId:0,path:Qn(f),sequenceNumber:r.highestListenSequenceNumber}))(u)))}).next(()=>$.waitFor(i))})}bi(e,t){e.createObjectStore(tl,{keyPath:SE});const s=t.store(tl),r=new Wd,i=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return s.put({collectionId:l,parent:Qn(u)})}};return t.store(mi).ee({X:!0},(o,l)=>{const u=new Rt(o);return i(u.popLast())}).next(()=>t.store(ko).ee({X:!0},([o,l,u],m)=>{const d=Fs(l);return i(d.popLast())}))}Di(e){const t=e.store(Eo);return t.ee((s,r)=>{const i=Ia(r),o=oN(this.serializer,i);return t.put(o)})}Ci(e,t){const s=t.store(mi),r=[];return s.ee((i,o)=>{const l=t.store(Cc),u=function(f){return f.document?new Ae(Rt.fromString(f.document.name).popFirst(5)):f.noDocument?Ae.fromSegments(f.noDocument.path):f.unknownDocument?Ae.fromSegments(f.unknownDocument.path):Te(36783)}(o).path.toArray(),m={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(m))}).next(()=>$.waitFor(r))}Fi(e,t){const s=t.store(_s),r=yN(this.serializer),i=new Gd(gu.mi,this.serializer.yt);return s.J().next(o=>{const l=new Map;return o.forEach(u=>{let m=l.get(u.userId)??bt();fi(this.serializer,u).keys().forEach(d=>m=m.add(d)),l.set(u.userId,m)}),$.forEach(l,(u,m)=>{const d=new Mn(m),f=pu.wt(this.serializer,d),h=i.getIndexManager(d),y=hu.wt(d,this.serializer,h,i.referenceDelegate);return new bN(r,y,f,h).recalculateAndSaveOverlaysForDocumentKeys(new Rm(t,gs.ce),u).next()})})}}function Dh(n){n.createObjectStore(Ao,{keyPath:wE}).createIndex(Sd,IE,{unique:!0}),n.createObjectStore(Eo,{keyPath:"targetId"}).createIndex(ob,CE,{unique:!0}),n.createObjectStore(Ni)}const vr="IndexedDbPersistence",sm=18e5,rm=5e3,im="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",pV="main";class Qd{constructor(e,t,s,r,i,o,l,u,m,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=i,this.window=o,this.document=l,this.xi=m,this.Oi=d,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=h=>Promise.resolve(),!Qd.v())throw new ve(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new tV(this,r),this.$i=t+pV,this.serializer=new iN(u),this.Ui=new Ur(this.$i,this.Ni,new fV(this.serializer)),this.hi=new qA,this.Pi=new XA(this.referenceDelegate,this.serializer),this.remoteDocumentCache=yN(this.serializer),this.Ii=new OA,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&Zn(vr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ve(se.FAILED_PRECONDITION,im);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new gs(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ml(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(Gr(e))return pe(vr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(vr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ia(e).get($i).next(t=>$.resolve(this.es(t)))}ts(e){return Ml(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,sm)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const s=Sn(t,Vo);return s.J().next(r=>{const i=this.ss(r,sm),o=r.filter(l=>i.indexOf(l)===-1);return $.forEach(o,l=>s.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):ia(e).get($i).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,rm)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ve(se.FAILED_PRECONDITION,im);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ml(e).J().next(s=>this.ss(s,rm).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&pe(vr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[pl,Vo],e=>{const t=new Rm(e,gs.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Ml(e).J().next(t=>this.ss(t,sm).map(s=>s.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return hu.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new YA(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return pu.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){pe(vr,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",i=function(u){return u===18?KE:u===17?fb:u===16?WE:u===15?Ld:u===14?db:u===13?mb:u===12?zE:u===11?ub:void Te(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,r,i,l=>(o=new Rm(l,this.ci?this.ci.next():gs.ce),t==="readwrite-primary"?this.Hi(o).next(u=>!!u||this.Yi(o)).next(u=>{if(!u)throw Zn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new ve(se.FAILED_PRECONDITION,tb);return s(o)}).next(u=>this.Xi(o).next(()=>u)):this.Is(o).next(()=>s(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Is(e){return ia(e).get($i).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,rm)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ve(se.FAILED_PRECONDITION,im)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ia(e).put($i,t)}static v(){return Ur.v()}Zi(e){const t=ia(e);return t.get($i).next(s=>this.es(s)?(pe(vr,"Releasing primary lease."),t.delete($i)):$.resolve())}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Zn(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;wy()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const s=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return pe(vr,`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return Zn(vr,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Zn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ia(n){return Sn(n,pl)}function Ml(n){return Sn(n,Vo)}function hV(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=bt(),r=bt();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Yd(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return wy()?8:sb(Dc())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new gV;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,s,r){return s.documentReadCount<this.fs?(uo()<=Ct.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",mo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(uo()<=Ct.DEBUG&&pe("QueryEngine","Query:",mo(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(uo()<=Ct.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",mo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ys(t))):$.resolve())}ys(e,t){if(Kp(t))return $.resolve(null);let s=ys(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=qm(t,null,"F"),s=ys(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=bt(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,qm(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,s,r){return Kp(t)||r.isEqual(Ge.min())?$.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,s,r)?$.resolve(null):(uo()<=Ct.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),mo(t)),this.vs(e,o,t,gE(r,Ya)).next(l=>l))})}Ds(e,t){let s=new $t(Pb(e));return t.forEach((r,i)=>{yl(e,i)&&(s=s.add(i))}),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return uo()<=Ct.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",mo(t)),this.ps.getDocumentsMatchingQuery(e,t,ms.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd="LocalStore",yV=3e8;class bV{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new rn(rt),this.xs=new cr(i=>Ci(i),hl),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bN(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function xN(n,e,t,s){return new bV(n,e,t,s)}async function vN(n,e){const t=it(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],l=[];let u=bt();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(s,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function NV(n,e){const t=it(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,h=f.keys();let y=$.resolve();return h.forEach(w=>{y=y.next(()=>d.getEntry(u,w)).next(v=>{const C=m.docVersions.get(w);Me(C!==null,48541),v.version.compareTo(C)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let u=bt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}function _N(n){const e=it(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function xV(n,e){const t=it(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(En.EMPTY_BYTE_STRING,Ge.min()).withLastLimboFreeSnapshotVersion(Ge.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(f,y),function(v,C,B){return v.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=yV?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(h,y,d)&&l.push(t.Pi.updateTargetData(i,y))});let u=us(),m=bt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(vV(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!s.isEqual(Ge.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));l.push(d)}return $.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function vV(n,e,t){let s=bt(),r=bt();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=us();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(Ge.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):pe(Xd,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function _V(n,e){const t=it(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=bi),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function DV(n,e){const t=it(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.Pi.getTargetData(s,e).next(i=>i?(r=i,$.resolve(r)):t.Pi.allocateTargetId(s).next(o=>(r=new nr(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s})}async function Xm(n,e,t){const s=it(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Gr(o))throw o;pe(Xd,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function kh(n,e,t){const s=it(n);let r=Ge.min(),i=bt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=it(u),h=f.xs.get(d);return h!==void 0?$.resolve(f.Ms.get(h)):f.Pi.getTargetData(m,d)}(s,o,ys(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,t?r:Ge.min(),t?i:bt())).next(l=>(kV(s,lA(e),l),{documents:l,Qs:i})))}function kV(n,e,t){let s=n.Os.get(e)||Ge.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.Os.set(e,s)}class Eh{constructor(){this.activeTargetIds=pA()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DN{constructor(){this.Mo=new Eh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Eh,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EV{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah="ConnectivityMonitor";class Vh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(Ah,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(Ah,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fl=null;function Jm(){return Fl===null?Fl=function(){return 268435456+Math.round(2147483648*Math.random())}():Fl++,"0x"+Fl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="RestConnection",AV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class VV{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Ic?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const o=Jm(),l=this.zo(e,t.toUriEncodedString());pe(om,`Sending RPC '${e}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=eu(m);return this.Jo(e,l,u,s,d).then(f=>(pe(om,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Ai(om,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",s),f})}Ho(e,t,s,r,i,o){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Uo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const s=AV[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn="WebChannelConnection";class wV extends VV{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const o=Jm();return new Promise((l,u)=>{const m=new $y;m.setWithCredentials(!0),m.listenOnce(zy.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case ic.NO_ERROR:const f=m.getResponseJson();pe(qn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case ic.TIMEOUT:pe(qn,`RPC '${e}' ${o} timed out`),u(new ve(se.DEADLINE_EXCEEDED,"Request time out"));break;case ic.HTTP_ERROR:const h=m.getStatus();if(pe(qn,`RPC '${e}' ${o} failed with status:`,h,"response text:",m.getResponseText()),h>0){let y=m.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y==null?void 0:y.error;if(w&&w.status&&w.message){const v=function(B){const T=B.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(T)>=0?T:se.UNKNOWN}(w.status);u(new ve(v,w.message))}else u(new ve(se.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new ve(se.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{pe(qn,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);pe(qn,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,s,15)})}T_(e,t,s){const r=Jm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Gy(),l=Ky(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,s),u.encodeInitMessageHeaders=!0;const d=i.join("");pe(qn,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let h=!1,y=!1;const w=new CV({Yo:C=>{y?pe(qn,`Not sending because RPC '${e}' stream ${r} is closed:`,C):(h||(pe(qn,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),pe(qn,`RPC '${e}' stream ${r} sending:`,C),f.send(C))},Zo:()=>f.close()}),v=(C,B,T)=>{C.listen(B,F=>{try{T(F)}catch(re){setTimeout(()=>{throw re},0)}})};return v(f,Va.EventType.OPEN,()=>{y||(pe(qn,`RPC '${e}' stream ${r} transport opened.`),w.o_())}),v(f,Va.EventType.CLOSE,()=>{y||(y=!0,pe(qn,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(f))}),v(f,Va.EventType.ERROR,C=>{y||(y=!0,Ai(qn,`RPC '${e}' stream ${r} transport errored. Name:`,C.name,"Message:",C.message),w.a_(new ve(se.UNAVAILABLE,"The operation could not be completed")))}),v(f,Va.EventType.MESSAGE,C=>{var B;if(!y){const T=C.data[0];Me(!!T,16349);const F=T,re=(F==null?void 0:F.error)||((B=F[0])==null?void 0:B.error);if(re){pe(qn,`RPC '${e}' stream ${r} received error:`,re);const ee=re.status;let M=function(V){const j=bn[V];if(j!==void 0)return zb(j)}(ee),A=re.message;M===void 0&&(M=se.INTERNAL,A="Unknown error status: "+ee+" with message "+re.message),y=!0,w.a_(new ve(M,A)),f.close()}else pe(qn,`RPC '${e}' stream ${r} received:`,T),w.u_(T)}}),v(l,Wy.STAT_EVENT,C=>{C.stat===Im.PROXY?pe(qn,`RPC '${e}' stream ${r} detected buffering proxy`):C.stat===Im.NOPROXY&&pe(qn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IV(){return typeof window<"u"?window:null}function hc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(n){return new SA(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="PersistentStream";class EN{constructor(e,t,s,r,i,o,l,u){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new kN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(Zn(t.toString()),Zn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===t&&this.G_(s,r)},s=>{e(()=>{const r=new ve(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return pe(Ch,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(pe(Ch,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SV extends EN{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=LA(this.serializer,e),s=function(i){if(!("targetChange"in i))return Ge.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ge.min():o.readTime?ts(o.readTime):Ge.min()}(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Wm(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=Sc(u)?{documents:Zb(i,u)}:{query:eN(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Gb(i,o.resumeToken);const m=$m(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(Ge.min())>0){l.readTime=Lo(i,o.snapshotVersion.toTimestamp());const m=$m(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const s=RA(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Wm(this.serializer),t.removeTarget=e,this.q_(t)}}class TV extends EN{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Me(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Me(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=jA(e.writeResults,e.commitTime),s=ts(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Wm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>Lc(this.serializer,s))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{}class LV extends PV{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ve(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,zm(t,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ve(se.UNKNOWN,i.toString())})}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,zm(t,s),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ve(se.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class jV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zn(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="RemoteStore";class RV{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{ji(this)&&(pe(Ti,"Restarting streams for network reachability change."),await async function(u){const m=it(u);m.Ea.add(4),await Nl(m),m.Ra.set("Unknown"),m.Ea.delete(4),await bu(m)}(this))})}),this.Ra=new jV(s,r)}}async function bu(n){if(ji(n))for(const e of n.da)await e(!0)}async function Nl(n){for(const e of n.da)await e(!1)}function AN(n,e){const t=it(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),tf(t)?ef(t):Fo(t).O_()&&Zd(t,e))}function Jd(n,e){const t=it(n),s=Fo(t);t.Ia.delete(e),s.O_()&&VN(t,e),t.Ia.size===0&&(s.O_()?s.L_():ji(t)&&t.Ra.set("Unknown"))}function Zd(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ge.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Fo(n).Y_(e)}function VN(n,e){n.Va.Ue(e),Fo(n).Z_(e)}function ef(n){n.Va=new VA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Fo(n).start(),n.Ra.ua()}function tf(n){return ji(n)&&!Fo(n).x_()&&n.Ia.size>0}function ji(n){return it(n).Ea.size===0}function CN(n){n.Va=void 0}async function BV(n){n.Ra.set("Online")}async function UV(n){n.Ia.forEach((e,t)=>{Zd(n,e)})}async function HV(n,e){CN(n),tf(n)?(n.Ra.ha(e),ef(n)):n.Ra.set("Unknown")}async function MV(n,e,t){if(n.Ra.set("Online"),e instanceof Kb&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(n,e)}catch(s){pe(Ti,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Hc(n,s)}else if(e instanceof fc?n.Va.Ze(e):e instanceof Wb?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ge.min()))try{const s=await _N(n.localStore);t.compareTo(s)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(En.EMPTY_BYTE_STRING,d.snapshotVersion)),VN(i,u);const f=new nr(d.target,u,m,d.sequenceNumber);Zd(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(s){pe(Ti,"Failed to raise snapshot:",s),await Hc(n,s)}}async function Hc(n,e,t){if(!Gr(e))throw e;n.Ea.add(1),await Nl(n),n.Ra.set("Offline"),t||(t=()=>_N(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{pe(Ti,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await bu(n)})}function wN(n,e){return e().catch(t=>Hc(n,t,e))}async function xl(n){const e=it(n),t=Or(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:bi;for(;FV(e);)try{const r=await _V(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,OV(e,r)}catch(r){await Hc(e,r)}IN(e)&&SN(e)}function FV(n){return ji(n)&&n.Ta.length<10}function OV(n,e){n.Ta.push(e);const t=Or(n);t.O_()&&t.X_&&t.ea(e.mutations)}function IN(n){return ji(n)&&!Or(n).x_()&&n.Ta.length>0}function SN(n){Or(n).start()}async function qV(n){Or(n).ra()}async function $V(n){const e=Or(n);for(const t of n.Ta)e.ea(t.mutations)}async function zV(n,e,t){const s=n.Ta.shift(),r=Fd.from(s,e,t);await wN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await xl(n)}async function WV(n,e){e&&Or(n).X_&&await async function(s,r){if(function(o){return kA(o)&&o!==se.ABORTED}(r.code)){const i=s.Ta.shift();Or(s).B_(),await wN(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await xl(s)}}(n,e),IN(n)&&SN(n)}async function wh(n,e){const t=it(n);t.asyncQueue.verifyOperationInProgress(),pe(Ti,"RemoteStore received new credentials");const s=ji(t);t.Ea.add(3),await Nl(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await bu(t)}async function KV(n,e){const t=it(n);e?(t.Ea.delete(2),await bu(t)):e||(t.Ea.add(2),await Nl(t),t.Ra.set("Unknown"))}function Fo(n){return n.ma||(n.ma=function(t,s,r){const i=it(t);return i.sa(),new SV(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:BV.bind(null,n),t_:UV.bind(null,n),r_:HV.bind(null,n),H_:MV.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),tf(n)?ef(n):n.Ra.set("Unknown")):(await n.ma.stop(),CN(n))})),n.ma}function Or(n){return n.fa||(n.fa=function(t,s,r){const i=it(t);return i.sa(),new TV(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:qV.bind(null,n),r_:WV.bind(null,n),ta:$V.bind(null,n),na:zV.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await xl(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(Ti,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,l=new nf(e,t,o,r,i);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ve(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sf(n,e){if(Zn("AsyncQueue",`${e}: ${n}`),Gr(n))return new ve(se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{static emptySet(e){return new vo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ae.comparator(t.key,s.key):(t,s)=>Ae.comparator(t.key,s.key),this.keyedMap=Ca(),this.sortedSet=new rn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof vo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new vo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(){this.ga=new rn(Ae.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Te(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,s)=>{e.push(s)}),e}}class jo{constructor(e,t,s,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new jo(e,t,vo.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class QV{constructor(){this.queries=Sh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=it(t),i=r.queries;r.queries=Sh(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(s)})})(this,new ve(se.ABORTED,"Firestore shutting down"))}}function Sh(){return new cr(n=>Tb(n),cu)}async function rf(n,e){const t=it(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new GV,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=sf(o,`Initialization of query '${mo(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&af(t)}async function of(n,e){const t=it(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function YV(n,e){const t=it(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(s=!0);o.wa=r}}s&&af(t)}function XV(n,e,t){const s=it(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function af(n){n.Ca.forEach(e=>{e.next()})}var Zm,Th;(Th=Zm||(Zm={})).Ma="default",Th.Cache="cache";class lf{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new jo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=jo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e){this.key=e}}class PN{constructor(e){this.key=e}}class JV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=bt(),this.mutatedKeys=bt(),this.eu=Pb(e),this.tu=new vo(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new Ih,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),y=yl(this.query,f)?f:null,w=!!h&&this.mutatedKeys.has(h.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let C=!1;h&&y?h.data.isEqual(y.data)?w!==v&&(s.track({type:3,doc:y}),C=!0):this.su(h,y)||(s.track({type:2,doc:y}),C=!0,(u&&this.eu(y,u)>0||m&&this.eu(y,m)<0)&&(l=!0)):!h&&y?(s.track({type:0,doc:y}),C=!0):h&&!y&&(s.track({type:1,doc:h}),C=!0,(u||m)&&(l=!0)),C&&(y?(o=o.add(y),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:o,iu:s,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(y,w){const v=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Rt:C})}};return v(y)-v(w)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(s),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new jo(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ih,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=bt(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const t=[];return e.forEach(s=>{this.Xa.has(s)||t.push(new PN(s))}),this.Xa.forEach(s=>{e.has(s)||t.push(new TN(s))}),t}cu(e){this.Ya=e.Qs,this.Xa=bt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return jo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const cf="SyncEngine";class ZV{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class e1{constructor(e){this.key=e,this.hu=!1}}class t1{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new cr(l=>Tb(l),cu),this.Iu=new Map,this.Eu=new Set,this.du=new rn(Ae.comparator),this.Au=new Map,this.Ru=new Kd,this.Vu={},this.mu=new Map,this.fu=Si.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function n1(n,e,t=!0){const s=HN(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await LN(s,e,t,!0),r}async function s1(n,e){const t=HN(n);await LN(t,e,!0,!1)}async function LN(n,e,t,s){const r=await DV(n.localStore,ys(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let l;return s&&(l=await r1(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&AN(n.remoteStore,r),l}async function r1(n,e,t,s,r){n.pu=(f,h,y)=>async function(v,C,B,T){let F=C.view.ru(B);F.Cs&&(F=await kh(v.localStore,C.query,!1).then(({documents:A})=>C.view.ru(A,F)));const re=T&&T.targetChanges.get(C.targetId),ee=T&&T.targetMismatches.get(C.targetId)!=null,M=C.view.applyChanges(F,v.isPrimaryClient,re,ee);return Lh(v,C.targetId,M.au),M.snapshot}(n,f,h,y);const i=await kh(n.localStore,e,!0),o=new JV(e,i.Qs),l=o.ru(i.documents),u=bl.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),m=o.applyChanges(l,n.isPrimaryClient,u);Lh(n,t,m.au);const d=new ZV(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function i1(n,e,t){const s=it(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!cu(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Xm(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),t&&Jd(s.remoteStore,r.targetId),ed(s,r.targetId)}).catch(Li)):(ed(s,r.targetId),await Xm(s.localStore,r.targetId,!0))}async function o1(n,e){const t=it(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Jd(t.remoteStore,s.targetId))}async function a1(n,e,t){const s=MN(n);try{const r=await function(o,l){const u=it(o),m=be.now(),d=l.reduce((y,w)=>y.add(w.key),bt());let f,h;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let w=us(),v=bt();return u.Ns.getEntries(y,d).next(C=>{w=C,w.forEach((B,T)=>{T.isValidDocument()||(v=v.add(B))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,w)).next(C=>{f=C;const B=[];for(const T of l){const F=_A(T,f.get(T.key).overlayedDocument);F!=null&&B.push(new ur(T.key,F,Db(F.value.mapValue),Kn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,m,B,l)}).next(C=>{h=C;const B=C.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(y,C.batchId,B)})}).then(()=>({batchId:h.batchId,changes:jb(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new rn(rt)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(s,r.batchId,t),await vl(s,r.changes),await xl(s.remoteStore)}catch(r){const i=sf(r,"Failed to persist write");t.reject(i)}}async function jN(n,e){const t=it(n);try{const s=await xV(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Me(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Me(o.hu,14607):r.removedDocuments.size>0&&(Me(o.hu,42227),o.hu=!1))}),await vl(t,s,e)}catch(s){await Li(s)}}function Ph(n,e,t){const s=it(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=it(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(l)&&(m=!0)}),m&&af(u)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function l1(n,e,t){const s=it(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new rn(Ae.comparator);o=o.insert(i,mn.newNoDocument(i,Ge.min()));const l=bt().add(i),u=new fu(Ge.min(),new Map,new rn(rt),o,l);await jN(s,u),s.du=s.du.remove(i),s.Au.delete(e),uf(s)}else await Xm(s.localStore,e,!1).then(()=>ed(s,e,t)).catch(Li)}async function c1(n,e){const t=it(n),s=e.batch.batchId;try{const r=await NV(t.localStore,e);BN(t,s,null),RN(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await vl(t,r)}catch(r){await Li(r)}}async function u1(n,e,t){const s=it(n);try{const r=await function(o,l){const u=it(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Me(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(s.localStore,e);BN(s,e,t),RN(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await vl(s,r)}catch(r){await Li(r)}}function RN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function BN(n,e,t){const s=it(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function ed(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(s=>{n.Ru.containsKey(s)||UN(n,s)})}function UN(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Jd(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),uf(n))}function Lh(n,e,t){for(const s of t)s instanceof TN?(n.Ru.addReference(s.key,e),m1(n,s)):s instanceof PN?(pe(cf,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||UN(n,s.key)):Te(19791,{wu:s})}function m1(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(pe(cf,"New document in limbo: "+t),n.Eu.add(s),uf(n))}function uf(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ae(Rt.fromString(e)),s=n.fu.next();n.Au.set(s,new e1(t)),n.du=n.du.insert(t,s),AN(n.remoteStore,new nr(ys(gl(t.path)),s,"TargetPurposeLimboResolution",gs.ce))}}async function vl(n,e,t){const s=it(n),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((l,u)=>{o.push(s.pu(u,e,t).then(m=>{var d;if((m||t)&&s.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=Yd.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(u,m){const d=it(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>$.forEach(m,h=>$.forEach(h.Es,y=>d.persistence.referenceDelegate.addReference(f,h.targetId,y)).next(()=>$.forEach(h.ds,y=>d.persistence.referenceDelegate.removeReference(f,h.targetId,y)))))}catch(f){if(!Gr(f))throw f;pe(Xd,"Failed to update sequence numbers: "+f)}for(const f of m){const h=f.targetId;if(!f.fromCache){const y=d.Ms.get(h),w=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(w);d.Ms=d.Ms.insert(h,v)}}}(s.localStore,i))}async function d1(n,e){const t=it(n);if(!t.currentUser.isEqual(e)){pe(cf,"User change. New user:",e.toKey());const s=await vN(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new ve(se.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await vl(t,s.Ls)}}function f1(n,e){const t=it(n),s=t.Au.get(e);if(s&&s.hu)return bt().add(s.key);{let r=bt();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function HN(n){const e=it(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=jN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=f1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=l1.bind(null,e),e.Pu.H_=YV.bind(null,e.eventManager),e.Pu.yu=XV.bind(null,e.eventManager),e}function MN(n){const e=it(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=c1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=u1.bind(null,e),e}class cl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return xN(this.persistence,new NN,e.initialUser,this.serializer)}Cu(e){return new Gd(gu.mi,this.serializer)}Du(e){return new DN}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cl.provider={build:()=>new cl};class p1 extends cl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Me(this.persistence.referenceDelegate instanceof Uc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new pN(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?zn.withCacheSize(this.cacheSizeBytes):zn.DEFAULT;return new Gd(s=>Uc.mi(s,t),this.serializer)}}class h1 extends cl{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await MN(this.xu.syncEngine),await xl(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return xN(this.persistence,new NN,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new pN(s,e.asyncQueue,t)}Mu(e,t){const s=new xE(t,this.persistence);return new NE(e.asyncQueue,s)}Cu(e){const t=hV(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?zn.withCacheSize(this.cacheSizeBytes):zn.DEFAULT;return new Qd(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,IV(),hc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new DN}}class Mc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Ph(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=d1.bind(null,this.syncEngine),await KV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new QV}()}createDatastore(e){const t=yu(e.databaseInfo.databaseId),s=function(i){return new wV(i)}(e.databaseInfo);return function(i,o,l,u){return new LV(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,o,l){return new RV(s,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>Ph(this.syncEngine,t,0),function(){return Vh.v()?new Vh:new EV}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new t1(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=it(r);pe(Ti,"RemoteStore shutting down."),i.Ea.add(5),await Nl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Mc.provider={build:()=>new Mc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr="FirestoreClient";class g1{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=Mn.UNAUTHENTICATED,this.clientId=Cd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{pe(qr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(pe(qr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=sf(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function am(n,e){n.asyncQueue.verifyOperationInProgress(),pe(qr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await vN(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function jh(n,e){n.asyncQueue.verifyOperationInProgress();const t=await y1(n);pe(qr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>wh(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,r)=>wh(e.remoteStore,r)),n._onlineComponents=e}async function y1(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(qr,"Using user provided OfflineComponentProvider");try{await am(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Ai("Error using user provided cache. Falling back to memory cache: "+t),await am(n,new cl)}}else pe(qr,"Using default OfflineComponentProvider"),await am(n,new p1(void 0));return n._offlineComponents}async function FN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(qr,"Using user provided OnlineComponentProvider"),await jh(n,n._uninitializedComponentsProvider._online)):(pe(qr,"Using default OnlineComponentProvider"),await jh(n,new Mc))),n._onlineComponents}function b1(n){return FN(n).then(e=>e.syncEngine)}async function Fc(n){const e=await FN(n),t=e.eventManager;return t.onListen=n1.bind(null,e.syncEngine),t.onUnlisten=i1.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=s1.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=o1.bind(null,e.syncEngine),t}function N1(n,e,t={}){const s=new qs;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new mf({next:h=>{d.Nu(),o.enqueueAndForget(()=>of(i,f));const y=h.docs.has(l);!y&&h.fromCache?m.reject(new ve(se.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&h.fromCache&&u&&u.source==="server"?m.reject(new ve(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new lf(gl(l.path),d,{includeMetadataChanges:!0,qa:!0});return rf(i,f)}(await Fc(n),n.asyncQueue,e,t,s)),s.promise}function x1(n,e,t={}){const s=new qs;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new mf({next:h=>{d.Nu(),o.enqueueAndForget(()=>of(i,f)),h.fromCache&&u.source==="server"?m.reject(new ve(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new lf(l,d,{includeMetadataChanges:!0,qa:!0});return rf(i,f)}(await Fc(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ON(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN="firestore.googleapis.com",Bh=!0;class Uh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ve(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qN,this.ssl=Bh}else this.host=e.host,this.ssl=e.ssl??Bh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=uN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<JA)throw new ve(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ON(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ve(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ve(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ve(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nu{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ve(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ve(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new iE;switch(s.type){case"firstParty":return new cE(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ve(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=Rh.get(t);s&&(pe("ComponentProvider","Removing Datastore"),Rh.delete(t),s.terminate())}(this),Promise.resolve()}}function v1(n,e,t,s={}){var m;n=es(n,Nu);const r=eu(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(Ey(`https://${l}`),Vy("Firestore",!0)),i.host!==qN&&i.host!==l&&Ai("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:s};if(!kc(u,o)&&(n._setSettings(u),s.mockUserToken)){let d,f;if(typeof s.mockUserToken=="string")d=s.mockUserToken,f=Mn.MOCK_USER;else{d=Ay(s.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const h=s.mockUserToken.sub||s.mockUserToken.user_id;if(!h)throw new ve(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Mn(h)}n._authCredentials=new oE(new Yy(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Yr(this.firestore,e,this._query)}}class dn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dn(this.firestore,e,this._key)}toJSON(){return{type:dn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(fl(t,dn._jsonSchema))return new dn(e,s||null,new Ae(Rt.fromString(t.referencePath)))}}dn._jsonSchemaVersion="firestore/documentReference/1.0",dn._jsonSchema={type:Dn("string",dn._jsonSchemaVersion),referencePath:Dn("string")};class Hr extends Yr{constructor(e,t,s){super(e,t,gl(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dn(this.firestore,null,new Ae(e))}withConverter(e){return new Hr(this.firestore,e,this._path)}}function Mt(n,e,...t){if(n=Ss(n),Jy("collection","path",e),n instanceof Nu){const s=Rt.fromString(e,...t);return Cp(s),new Hr(n,null,s)}{if(!(n instanceof dn||n instanceof Hr))throw new ve(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Rt.fromString(e,...t));return Cp(s),new Hr(n.firestore,null,s)}}function Lt(n,e,...t){if(n=Ss(n),arguments.length===1&&(e=Cd.newId()),Jy("doc","path",e),n instanceof Nu){const s=Rt.fromString(e,...t);return Vp(s),new dn(n,null,new Ae(s))}{if(!(n instanceof dn||n instanceof Hr))throw new ve(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Rt.fromString(e,...t));return Vp(s),new dn(n.firestore,n instanceof Hr?n.converter:null,new Ae(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh="AsyncQueue";class Mh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new kN(this,"async_queue_retry"),this._c=()=>{const s=hc();s&&pe(Hh,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=hc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=hc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new qs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Gr(e))throw e;pe(Hh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Zn("INTERNAL UNHANDLED ERROR: ",Fh(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=nf.createAndSchedule(this,e,t,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Te(47125,{Pc:Fh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Fh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oh(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}class Gs extends Nu{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new Mh,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Mh(e),this._firestoreClient=void 0,await e}}}function _1(n,e){const t=typeof n=="object"?n:My(),s=typeof n=="string"?n:Ic,r=Ry(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Dy("firestore");i&&v1(r,...i)}return r}function xu(n){if(n._terminated)throw new ve(se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||$N(n),n._firestoreClient}function $N(n){var s,r,i;const e=n._freezeSettings(),t=function(l,u,m,d){return new QE(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,ON(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new g1(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(n._componentsProvider))}function D1(n,e){Ai("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return k1(n,Mc.provider,{build:s=>new h1(s,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function k1(n,e,t){if((n=es(n,Gs))._firestoreClient||n._terminated)throw new ve(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ve(se.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},$N(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hs(En.fromBase64String(e))}catch(t){throw new ve(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new hs(En.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:hs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fl(e,hs._jsonSchema))return hs.fromBase64String(e.bytes)}}hs._jsonSchemaVersion="firestore/bytes/1.0",hs._jsonSchema={type:Dn("string",hs._jsonSchemaVersion),bytes:Dn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ve(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ve(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ve(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return rt(this._lat,e._lat)||rt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$s._jsonSchemaVersion}}static fromJSON(e){if(fl(e,$s._jsonSchema))return new $s(e.latitude,e.longitude)}}$s._jsonSchemaVersion="firestore/geoPoint/1.0",$s._jsonSchema={type:Dn("string",$s._jsonSchemaVersion),latitude:Dn("number"),longitude:Dn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:zs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fl(e,zs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new zs(e.vectorValues);throw new ve(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zs._jsonSchemaVersion="firestore/vectorValue/1.0",zs._jsonSchema={type:Dn("string",zs._jsonSchemaVersion),vectorValues:Dn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1=/^__.*__$/;class A1{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ur(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mo(e,this.data,t,this.fieldTransforms)}}class zN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ur(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function WN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ac:n})}}class ff{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ff({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Oc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(WN(this.Ac)&&E1.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class V1{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||yu(e)}Cc(e,t,s,r=!1){return new ff({Ac:e,methodName:t,Dc:s,path:cn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _u(n){const e=n._freezeSettings(),t=yu(n._databaseId);return new V1(n._databaseId,!!e.ignoreUndefinedProperties,t)}function KN(n,e,t,s,r,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);pf("Data must be an object, but it was:",o,s);const l=GN(s,o);let u,m;if(i.merge)u=new os(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=td(e,f,t);if(!o.contains(h))throw new ve(se.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);YN(d,h)||d.push(h)}u=new os(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new A1(new Wn(l),u,m)}class Du extends df{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Du}}function C1(n,e,t,s){const r=n.Cc(1,e,t);pf("Data must be an object, but it was:",r,s);const i=[],o=Wn.empty();Qr(s,(u,m)=>{const d=hf(e,u,t);m=Ss(m);const f=r.yc(d);if(m instanceof Du)i.push(d);else{const h=_l(m,f);h!=null&&(i.push(d),o.set(d,h))}});const l=new os(i);return new zN(o,l,r.fieldTransforms)}function w1(n,e,t,s,r,i){const o=n.Cc(1,e,t),l=[td(e,s,t)],u=[r];if(i.length%2!=0)throw new ve(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(td(e,i[h])),u.push(i[h+1]);const m=[],d=Wn.empty();for(let h=l.length-1;h>=0;--h)if(!YN(m,l[h])){const y=l[h];let w=u[h];w=Ss(w);const v=o.yc(y);if(w instanceof Du)m.push(y);else{const C=_l(w,v);C!=null&&(m.push(y),d.set(y,C))}}const f=new os(m);return new zN(d,f,o.fieldTransforms)}function I1(n,e,t,s=!1){return _l(t,n.Cc(s?4:3,e))}function _l(n,e){if(QN(n=Ss(n)))return pf("Unsupported field value:",e,n),GN(n,e);if(n instanceof df)return function(s,r){if(!WN(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const l of s){let u=_l(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=Ss(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return hA(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=be.fromDate(s);return{timestampValue:Lo(r.serializer,i)}}if(s instanceof be){const i=new be(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Lo(r.serializer,i)}}if(s instanceof $s)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof hs)return{bytesValue:Gb(r.serializer,s._byteString)};if(s instanceof dn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$d(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof zs)return function(o,l){return{mapValue:{fields:{[Rd]:{stringValue:Bd},[Co]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return Hd(l.serializer,m)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${tu(s)}`)}(n,e)}function GN(n,e){const t={};return pb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qr(n,(s,r)=>{const i=_l(r,e.mc(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function QN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof be||n instanceof $s||n instanceof hs||n instanceof dn||n instanceof df||n instanceof zs)}function pf(n,e,t){if(!QN(t)||!Zy(t)){const s=tu(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function td(n,e,t){if((e=Ss(e))instanceof vu)return e._internalPath;if(typeof e=="string")return hf(n,e);throw Oc("Field path arguments must be of type string or ",n,!1,void 0,t)}const S1=new RegExp("[~\\*/\\[\\]]");function hf(n,e,t){if(e.search(S1)>=0)throw Oc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vu(...e.split("."))._internalPath}catch{throw Oc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Oc(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${s}`),o&&(u+=` in document ${r}`),u+=")"),new ve(se.INVALID_ARGUMENT,l+n+u)}function YN(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new T1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ku("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class T1 extends XN{data(){return super.data()}}function ku(n,e){return typeof e=="string"?hf(n,e):e instanceof vu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ve(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gf{}class ZN extends gf{}function In(n,e,...t){let s=[];e instanceof gf&&s.push(e),s=s.concat(t),function(i){const o=i.filter(u=>u instanceof yf).length,l=i.filter(u=>u instanceof Eu).length;if(o>1||o>0&&l>0)throw new ve(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class Eu extends ZN{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Eu(e,t,s)}_apply(e){const t=this._parse(e);return e0(e._query,t),new Yr(e.firestore,e.converter,Om(e._query,t))}_parse(e){const t=_u(e.firestore);return function(i,o,l,u,m,d,f){let h;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ve(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){$h(f,d);const w=[];for(const v of f)w.push(qh(u,i,v));h={arrayValue:{values:w}}}else h=qh(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||$h(f,d),h=I1(l,o,f,d==="in"||d==="not-in");return _t.create(m,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function nd(n,e,t){const s=e,r=ku("where",n);return Eu._create(r,s,t)}class yf extends gf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new yf(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:qt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)e0(o,u),o=Om(o,u)}(e._query,t),new Yr(e.firestore,e.converter,Om(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class bf extends ZN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new bf(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new ve(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ve(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ol(i,o)}(e._query,this._field,this._direction);return new Yr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Ho(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Rn(n,e="asc"){const t=e,s=ku("orderBy",n);return bf._create(s,t)}function qh(n,e,t){if(typeof(t=Ss(t))=="string"){if(t==="")throw new ve(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sb(e)&&t.indexOf("/")!==-1)throw new ve(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Rt.fromString(t));if(!Ae.isDocumentKey(s))throw new ve(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return rl(n,new Ae(s))}if(t instanceof dn)return rl(n,t._key);throw new ve(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tu(t)}.`)}function $h(n,e){if(!Array.isArray(n)||n.length===0)throw new ve(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function e0(n,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ve(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ve(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class P1{convertValue(e,t="none"){switch(Mr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ar(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Qr(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertVectorValue(e){var s,r,i;const t=(i=(r=(s=e.fields)==null?void 0:s[Co].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>sn(o.doubleValue));return new zs(t)}convertGeoPoint(e){return new $s(sn(e.latitude),sn(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=au(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(nl(e));default:return null}}convertTimestamp(e){const t=or(e);return new be(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Rt.fromString(e);Me(rN(s),9688,{name:e});const r=new Vi(s.get(1),s.get(3)),i=new Ae(s.popFirst(5));return r.isEqual(t)||Zn(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(n,e,t){let s;return s=n?n.toFirestore(e):e,s}class Sa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vi extends XN{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new gc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(ku("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ve(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=vi._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}vi._jsonSchemaVersion="firestore/documentSnapshot/1.0",vi._jsonSchema={type:Dn("string",vi._jsonSchemaVersion),bundleSource:Dn("string","DocumentSnapshot"),bundleName:Dn("string"),bundle:Dn("string")};class gc extends vi{data(e={}){return super.data(e)}}class _i{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Sa(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new gc(this._firestore,this._userDataWriter,s.key,s,new Sa(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ve(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new gc(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Sa(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new gc(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Sa(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:L1(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ve(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=_i._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Cd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function L1(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(n){n=es(n,dn);const e=es(n.firestore,Gs);return N1(xu(e),n._key).then(t=>n0(e,n,t))}_i._jsonSchemaVersion="firestore/querySnapshot/1.0",_i._jsonSchema={type:Dn("string",_i._jsonSchemaVersion),bundleSource:Dn("string","QuerySnapshot"),bundleName:Dn("string"),bundle:Dn("string")};class Nf extends P1{constructor(e){super(),this.firestore=e}convertBytes(e){return new hs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,t)}}function Gn(n){n=es(n,Yr);const e=es(n.firestore,Gs),t=xu(e),s=new Nf(e);return JN(n._query),x1(t,n._query).then(r=>new _i(e,s,n,r))}function xf(n,e,t){n=es(n,dn);const s=es(n.firestore,Gs),r=t0(n.converter,e);return Au(s,[KN(_u(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Kn.none())])}function ws(n,e,t,...s){n=es(n,dn);const r=es(n.firestore,Gs),i=_u(r);let o;return o=typeof(e=Ss(e))=="string"||e instanceof vu?w1(i,"updateDoc",n._key,e,t,s):C1(i,"updateDoc",n._key,e),Au(r,[o.toMutation(n._key,Kn.exists(!0))])}function Xr(n){return Au(es(n.firestore,Gs),[new du(n._key,Kn.none())])}function Oo(n,e){const t=es(n.firestore,Gs),s=Lt(n),r=t0(n.converter,e);return Au(t,[KN(_u(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,Kn.exists(!1))]).then(()=>s)}function lr(n,...e){var u,m,d;n=Ss(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Oh(e[s])||(t=e[s++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Oh(e[s])){const f=e[s];e[s]=(u=f.next)==null?void 0:u.bind(f),e[s+1]=(m=f.error)==null?void 0:m.bind(f),e[s+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(n instanceof dn)o=es(n.firestore,Gs),l=gl(n._key.path),i={next:f=>{e[s]&&e[s](n0(o,n,f))},error:e[s+1],complete:e[s+2]};else{const f=es(n,Yr);o=es(f.firestore,Gs),l=f._query;const h=new Nf(o);i={next:y=>{e[s]&&e[s](new _i(o,h,f,y))},error:e[s+1],complete:e[s+2]},JN(n._query)}return function(h,y,w,v){const C=new mf(v),B=new lf(y,C,w);return h.asyncQueue.enqueueAndForget(async()=>rf(await Fc(h),B)),()=>{C.Nu(),h.asyncQueue.enqueueAndForget(async()=>of(await Fc(h),B))}}(xu(o),l,r,i)}function Au(n,e){return function(s,r){const i=new qs;return s.asyncQueue.enqueueAndForget(async()=>a1(await b1(s),r,i)),i.promise}(xu(n),e)}function n0(n,e,t){const s=t.docs.get(e._key),r=new Nf(n);return new vi(n,r,e._key,s,new Sa(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){Uo=r})(Uy),Ga(new _o("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new Gs(new aE(s.getProvider("auth-internal")),new uE(o,s.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ve(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vi(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Rr(Dp,kp,e),Rr(Dp,kp,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0="firebasestorage.googleapis.com",j1="storageBucket",R1=2*60*1e3,B1=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs extends Pi{constructor(e,t,s=0){super(lm(e),`Firebase Storage: ${t} (${lm(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Xs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Qs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Qs||(Qs={}));function lm(n){return"storage/"+n}function U1(){const n="An unknown error occurred, please check the error payload for server response.";return new Xs(Qs.UNKNOWN,n)}function H1(){return new Xs(Qs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function M1(){return new Xs(Qs.CANCELED,"User canceled the upload/download.")}function F1(n){return new Xs(Qs.INVALID_URL,"Invalid URL '"+n+"'.")}function O1(n){return new Xs(Qs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function zh(n){return new Xs(Qs.INVALID_ARGUMENT,n)}function r0(){return new Xs(Qs.APP_DELETED,"The Firebase app was deleted.")}function q1(n){return new Xs(Qs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Is.makeFromUrl(e,t)}catch{return new Is(e,"")}if(s.path==="")return s;throw O1(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(re){re.path_=decodeURIComponent(re.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),w={bucket:1,path:3},v=t===s0?"(?:storage.googleapis.com|storage.cloud.google.com)":t,C="([^?#]*)",B=new RegExp(`^https?://${v}/${r}/${C}`,"i"),F=[{regex:l,indices:u,postModify:i},{regex:y,indices:w,postModify:m},{regex:B,indices:{bucket:1,path:2},postModify:m}];for(let re=0;re<F.length;re++){const ee=F[re],M=ee.regex.exec(e);if(M){const A=M[ee.indices.bucket];let N=M[ee.indices.path];N||(N=""),s=new Is(A,N),ee.postModify(s);break}}if(s==null)throw F1(e);return s}}class $1{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(n,e,t){let s=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...C){m||(m=!0,e.apply(null,C))}function f(C){r=setTimeout(()=>{r=null,n(y,u())},C)}function h(){i&&clearTimeout(i)}function y(C,...B){if(m){h();return}if(C){h(),d.call(null,C,...B);return}if(u()||o){h(),d.call(null,C,...B);return}s<64&&(s*=2);let F;l===1?(l=2,F=0):F=(s+Math.random())*1e3,f(F)}let w=!1;function v(C){w||(w=!0,h(),!m&&(r!==null?(C||(l=2),clearTimeout(r),f(0)):C||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function W1(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1(n){return n!==void 0}function Wh(n,e,t,s){if(s<e)throw zh(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw zh(`Invalid value for '${n}'. Expected ${t} or less.`)}function G1(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var qc;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(qc||(qc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,t,s,r,i,o,l,u,m,d,f,h=!0,y=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,v)=>{this.resolve_=w,this.reject_=v,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Ol(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===qc.NO_ERROR,u=i.getStatus();if(!l||Q1(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===qc.ABORT;s(!1,new Ol(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;s(!0,new Ol(m,i))})},t=(s,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());K1(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=U1();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?r0():M1();o(u)}else{const u=H1();o(u)}};this.canceled_?t(!1,new Ol(!1,null,!0)):this.backoffId_=z1(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&W1(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ol{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function X1(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function J1(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Z1(n,e){e&&(n["X-Firebase-GMPID"]=e)}function eC(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function tC(n,e,t,s,r,i,o=!0,l=!1){const u=G1(n.urlParams),m=n.url+u,d=Object.assign({},n.headers);return Z1(d,e),X1(d,t),J1(d,i),eC(d,s),new Y1(m,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function sC(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t){this._service=e,t instanceof Is?this._location=t:this._location=Is.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $c(e,t)}get root(){const e=new Is(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sC(this._location.path)}get storage(){return this._service}get parent(){const e=nC(this._location.path);if(e===null)return null;const t=new Is(this._location.bucket,e);return new $c(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw q1(e)}}function Kh(n,e){const t=e==null?void 0:e[j1];return t==null?null:Is.makeFromBucketSpec(t,n)}function rC(n,e,t,s={}){n.host=`${e}:${t}`;const r=eu(e);r&&(Ey(`https://${n.host}/b`),Vy("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:Ay(i,n.app.options.projectId))}class iC{constructor(e,t,s,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=s0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=R1,this._maxUploadRetryTime=B1,this._requests=new Set,r!=null?this._bucket=Is.makeFromBucketSpec(r,this._host):this._bucket=Kh(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Is.makeFromBucketSpec(this._url,e):this._bucket=Kh(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Wh("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Wh("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(By(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $c(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new $1(r0());{const o=tC(e,this._appId,s,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const Gh="@firebase/storage",Qh="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0="storage";function oC(n=My(),e){n=Ss(n);const s=Ry(n,i0).getImmediate({identifier:e}),r=Dy("storage");return r&&aC(s,...r),s}function aC(n,e,t,s={}){rC(n,e,t,s)}function lC(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new iC(t,s,r,e,Uy)}function cC(){Ga(new _o(i0,lC,"PUBLIC").setMultipleInstances(!0)),Rr(Gh,Qh,""),Rr(Gh,Qh,"esm2020")}cC();const uC={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},o0=Hy(uC),je=_1(o0);oC(o0);D1(je).catch(n=>{n.code==="failed-precondition"?console.warn(" :     "):n.code==="unimplemented"&&console.warn(" :   ")});const Yi="work_requests",oa=n=>{const e=n.data();return{_id:n.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof be?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof be?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Xi={getAllWorkRequests:async()=>{const n=In(Mt(je,Yi),Rn("createdAt","desc"));return(await Gn(n)).docs.map(oa)},getWorkRequestById:async n=>{const e=Lt(je,Yi,n),t=await Bn(e);return t.exists()?oa(t):null},createWorkRequest:async n=>{const e=be.now(),t={project:n.project,requestType:n.requestType,description:n.description,requestDate:n.requestDate instanceof Date?be.fromDate(n.requestDate):n.requestDate,dueDate:n.dueDate instanceof Date?be.fromDate(n.dueDate):n.dueDate,requestedBy:n.requestedBy,assignedTo:n.assignedTo,status:n.status||"pending",priority:n.priority||"medium",notes:n.notes||"",createdAt:e,updatedAt:e},s=await Oo(Mt(je,Yi),t),r=await Bn(s);return oa(r)},updateWorkRequest:async(n,e)=>{const t=Lt(je,Yi,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.requestType!==void 0&&(s.requestType=e.requestType),e.description!==void 0&&(s.description=e.description),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(s.dueDate=e.dueDate instanceof Date?be.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(s.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.status!==void 0&&(s.status=e.status),e.priority!==void 0&&(s.priority=e.priority),e.notes!==void 0&&(s.notes=e.notes),e.completedDate!==void 0&&(s.completedDate=e.completedDate instanceof Date?be.fromDate(e.completedDate):e.completedDate),await ws(t,s);const r=await Bn(t);return oa(r)},deleteWorkRequest:async n=>{const e=Lt(je,Yi,n);await Xr(e)},subscribeToWorkRequests:n=>{const e=In(Mt(je,Yi),Rn("createdAt","desc"));return lr(e,t=>{const s=t.docs.map(oa);n(s)})}},mC=!0,ct=()=>mC,aa={getAllWorkRequests:async()=>(await we.get("/workrequests")).data,getWorkRequestById:async n=>(await we.get(`/workrequests/${n}`)).data,createWorkRequest:async n=>{const e={project:n.project,requestType:n.requestType,description:n.description,requestDate:n.requestDate instanceof Date?n.requestDate.toISOString():n.requestDate,dueDate:n.dueDate instanceof Date?n.dueDate.toISOString():n.dueDate,requestedBy:n.requestedBy,assignedTo:n.assignedTo,priority:n.priority||"medium",status:n.status||"pending",notes:n.notes||""};return console.log("[workRequestService.createWorkRequest] Sending to backend:",e),(await we.post("/workrequests",e)).data},updateWorkRequest:async(n,e)=>{const t={};return e.project!==void 0&&(t.project=e.project),e.requestType!==void 0&&(t.requestType=e.requestType),e.description!==void 0&&(t.description=e.description),e.requestDate!==void 0&&(t.requestDate=e.requestDate instanceof Date?e.requestDate.toISOString():e.requestDate),e.dueDate!==void 0&&(t.dueDate=e.dueDate instanceof Date?e.dueDate.toISOString():e.dueDate),e.requestedBy!==void 0&&(t.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(t.assignedTo=e.assignedTo),e.priority!==void 0&&(t.priority=e.priority),e.status!==void 0&&(t.status=e.status),e.notes!==void 0&&(t.notes=e.notes),e.completedDate!==void 0&&(t.completedDate=e.completedDate instanceof Date?e.completedDate.toISOString():e.completedDate),(await we.put(`/workrequests/${n}`,t)).data},deleteWorkRequest:async n=>{await we.delete(`/workrequests/${n}`)}},dC={getAllWorkRequests:async()=>ct()?(console.log("[workRequestService] Using Firestore"),Xi.getAllWorkRequests()):(console.log("[workRequestService] Using Railway API"),aa.getAllWorkRequests()),getWorkRequestById:async n=>{if(ct()){const e=await Xi.getWorkRequestById(n);if(!e)throw new Error("Work request not found");return e}return aa.getWorkRequestById(n)},createWorkRequest:async n=>ct()?Xi.createWorkRequest(n):aa.createWorkRequest(n),updateWorkRequest:async(n,e)=>ct()?Xi.updateWorkRequest(n,e):aa.updateWorkRequest(n,e),deleteWorkRequest:async n=>ct()?Xi.deleteWorkRequest(n):aa.deleteWorkRequest(n),subscribeToWorkRequests:Xi.subscribeToWorkRequests},Ht={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function YI(n,e){const t=Mt(je,n);return(await Oo(t,{...e,createdAt:be.now(),updatedAt:be.now()})).id}let Di=new Map,go=null;async function _r(){if(!(Di.size>0))return go||(go=(async()=>{try{const n=Mt(je,Ht.PROJECTS);(await Gn(n)).docs.forEach(t=>{const s=t.data();Di.set(t.id,{name:s.name||"",color:s.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",Di.size,"")}catch(n){throw console.error("[paymentFirestoreService]    :",n),go=null,n}})(),go)}function la(n){const e=Di.get(String(n.projectId))||{name:"",color:"#4A90E2"};return!e.name&&n.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:n.id,projectId:n.projectId,cacheSize:Di.size,cacheKeys:Array.from(Di.keys()).slice(0,5),vendorName:n.vendorName}),{id:n.id,project_id:n.projectId,project_name:e.name,project_color:e.color,user_id:n.userId||0,requester_name:"",approved_by:n.approvedBy||void 0,request_type:n.requestType||"material",vendor_name:n.vendorName||"",description:n.description||"",amount:n.amount||0,account_holder:n.accountHolder||"",bank_name:n.bankName||"",account_number:n.accountNumber||"",item_name:n.itemName||"",material_amount:n.materialAmount||0,labor_amount:n.laborAmount||0,original_material_amount:n.originalMaterialAmount||0,original_labor_amount:n.originalLaborAmount||0,apply_tax_deduction:n.applyTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,quick_text:n.quickText||"",images:n.images?JSON.stringify(n.images):"[]",notes:n.notes||"",status:n.status||"pending",created_at:n.createdAt||"",updated_at:n.updatedAt||"",paid_at:n.paidAt||void 0}}function Yh(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.request_type!==void 0&&(e.requestType=n.request_type),n.category!==void 0&&(e.requestType=n.category),n.vendor_name!==void 0&&(e.vendorName=n.vendor_name),n.process!==void 0&&(e.vendorName=n.process),n.description!==void 0&&(e.description=n.description),n.purpose!==void 0&&(e.description=n.purpose),n.amount!==void 0&&(e.amount=n.amount),n.account_holder!==void 0&&(e.accountHolder=n.account_holder),n.bank_name!==void 0&&(e.bankName=n.bank_name),n.account_number!==void 0&&(e.accountNumber=n.account_number),n.notes!==void 0&&(e.notes=n.notes),n.itemName!==void 0&&(e.itemName=n.itemName),n.item_name!==void 0&&(e.itemName=n.item_name),n.materialAmount!==void 0&&(e.materialAmount=n.materialAmount),n.laborAmount!==void 0&&(e.laborAmount=n.laborAmount),n.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=n.originalMaterialAmount),n.originalLaborAmount!==void 0&&(e.originalLaborAmount=n.originalLaborAmount),n.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=n.applyTaxDeduction),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),n.quickText!==void 0&&(e.quickText=n.quickText),n.images!==void 0&&(e.images=Array.isArray(n.images)?n.images:[]),n.status!==void 0&&(e.status=n.status),e}const ss={getAllPayments:async()=>{await _r();const n=Mt(je,Ht.PAYMENTS),e=In(n,Rn("id","desc"));return(await Gn(e)).docs.map(s=>{const r=s.data();return la({...r,id:parseInt(s.id)||r.id})})},getPaymentById:async n=>{await _r();const e=Lt(je,Ht.PAYMENTS,n),t=await Bn(e);if(t.exists()){const s=t.data();return la({...s,id:parseInt(t.id)||s.id})}return null},createPayment:async n=>{var m;await _r();const e=Mt(je,Ht.PAYMENTS),t=await Gn(e);let s=0;t.docs.forEach(d=>{const f=parseInt(d.id);!isNaN(f)&&f>s&&(s=f)});const r=s+1,i=Yh(n),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:i.images||[],imageCount:((m=i.images)==null?void 0:m.length)||0},u=Lt(je,Ht.PAYMENTS,String(r));return await xf(u,l),la(l)},updatePayment:async(n,e)=>{await _r();const t=Lt(je,Ht.PAYMENTS,n),s=Yh(e);await ws(t,{...s,updatedAt:new Date().toISOString()});const r=await ss.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(n,e)=>{await _r();const t=Lt(je,Ht.PAYMENTS,n),s=new Date().toISOString(),r={status:e,updatedAt:s};e==="completed"&&(r.paidAt=s),await ws(t,r);const i=await ss.getPaymentById(n);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(n,e,t)=>{await _r();const s=Lt(je,Ht.PAYMENTS,n);await ws(s,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await ss.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(n,e)=>{const t=Lt(je,Ht.PAYMENTS,n);return await ws(t,{images:e,imageCount:e.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:e}},deletePayment:async n=>{const e=Lt(je,Ht.PAYMENTS,n);await Xr(e)},subscribeToPayments:n=>{let e=null;return _r().then(()=>{const t=Mt(je,Ht.PAYMENTS),s=In(t,Rn("id","desc"));e=lr(s,r=>{const i=r.docs.map(o=>{const l=o.data();return la({...l,id:parseInt(o.id)||l.id})});n(i)})}).catch(t=>{console.error("[paymentFirestoreService]       :",t)}),()=>{e&&e()}},getPaymentsByProject:async n=>{await _r();const e=Mt(je,Ht.PAYMENTS),t=In(e,nd("projectId","==",n),Rn("id","desc"));return(await Gn(t)).docs.map(r=>{const i=r.data();return la({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{Di.clear(),go=null}},Dr={getAllPayments:async()=>(await we.get("/payments")).data,getPaymentById:async n=>(await we.get(`/payments/${n}`)).data,createPayment:async n=>{var s,r,i;const e={project_id:n.projectId,request_type:n.category,vendor_name:n.process||"",description:n.purpose||"",amount:n.amount,account_holder:((s=n.bankInfo)==null?void 0:s.accountHolder)||"",bank_name:((r=n.bankInfo)==null?void 0:r.bankName)||"",account_number:((i=n.bankInfo)==null?void 0:i.accountNumber)||"",notes:n.notes||"",itemName:n.itemName||"",materialAmount:n.materialAmount??n.amount,laborAmount:n.laborAmount??0,originalMaterialAmount:n.originalMaterialAmount||0,originalLaborAmount:n.originalLaborAmount||0,applyTaxDeduction:n.applyTaxDeduction||!1,includesVAT:n.includesVAT||!1,quickText:n.quickText||"",images:n.images||[]};return console.log("[paymentService.createPayment] Sending to backend:",e),(await we.post("/payments",e)).data},updatePayment:async(n,e)=>{const t={};return e.projectId!==void 0&&(t.project=e.projectId),e.purpose!==void 0&&(t.description=e.purpose),e.amount!==void 0&&(t.amount=e.amount),e.process!==void 0&&(t.vendor_name=e.process),e.category!==void 0&&(t.request_type=e.category),e.itemName!==void 0&&(t.itemName=e.itemName),e.materialAmount!==void 0&&(t.materialAmount=e.materialAmount),e.laborAmount!==void 0&&(t.laborAmount=e.laborAmount),e.originalMaterialAmount!==void 0&&(t.originalMaterialAmount=e.originalMaterialAmount),e.originalLaborAmount!==void 0&&(t.originalLaborAmount=e.originalLaborAmount),e.applyTaxDeduction!==void 0&&(t.applyTaxDeduction=e.applyTaxDeduction),e.includesVAT!==void 0&&(t.includesVAT=e.includesVAT),e.notes!==void 0&&(t.notes=e.notes),e.requestDate!==void 0&&(t.requestDate=e.requestDate),e.bankInfo!==void 0&&(e.bankInfo.accountHolder&&(t.account_holder=e.bankInfo.accountHolder),e.bankInfo.bankName&&(t.bank_name=e.bankInfo.bankName),e.bankInfo.accountNumber&&(t.account_number=e.bankInfo.accountNumber)),(await we.put(`/payments/${n}`,t)).data},updatePaymentStatus:async(n,e)=>(await we.put(`/payments/${n}/status`,{status:e})).data,updatePaymentAmounts:async(n,e,t)=>(await we.patch(`/payments/${n}/amounts`,{materialAmount:e,laborAmount:t})).data,updatePaymentImages:async(n,e)=>(await we.put(`/payments/${n}/images`,{images:e})).data,deletePayment:async n=>{await we.delete(`/payments/${n}`)}},Es={getAllPayments:async()=>ct()?(console.log("[paymentService] Using Firestore"),ss.getAllPayments()):(console.log("[paymentService] Using Railway API"),Dr.getAllPayments()),getPaymentById:async n=>{if(ct()){const e=await ss.getPaymentById(n);if(!e)throw new Error("Payment not found");return e}return Dr.getPaymentById(n)},createPayment:async n=>ct()?ss.createPayment(n):Dr.createPayment(n),updatePayment:async(n,e)=>ct()?ss.updatePayment(n,e):Dr.updatePayment(n,e),updatePaymentStatus:async(n,e)=>ct()?ss.updatePaymentStatus(n,e):Dr.updatePaymentStatus(n,e),updatePaymentAmounts:async(n,e,t)=>ct()?ss.updatePaymentAmounts(n,e,t):Dr.updatePaymentAmounts(n,e,t),updatePaymentImages:async(n,e)=>ct()?ss.updatePaymentImages(n,e):Dr.updatePaymentImages(n,e),deletePayment:async n=>ct()?ss.deletePayment(n):Dr.deletePayment(n),subscribeToPayments:ss.subscribeToPayments,getPaymentsByProject:ss.getPaymentsByProject,clearProjectsCache:ss.clearProjectsCache},Ji="as_requests",ca=n=>{const e=n.data();return{_id:n.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof be?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof be?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Zi={getAllASRequests:async()=>{const n=In(Mt(je,Ji),Rn("createdAt","desc"));return(await Gn(n)).docs.map(ca)},getASRequestById:async n=>{const e=Lt(je,Ji,n),t=await Bn(e);return t.exists()?ca(t):null},createASRequest:async n=>{const e=be.now(),t={project:n.project,client:n.client,requestDate:n.requestDate instanceof Date?be.fromDate(n.requestDate):n.requestDate,siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,status:n.status||"pending",notes:n.notes||"",createdAt:e,updatedAt:e};n.scheduledVisitDate&&(t.scheduledVisitDate=n.scheduledVisitDate instanceof Date?be.fromDate(n.scheduledVisitDate):n.scheduledVisitDate),n.scheduledVisitTime&&(t.scheduledVisitTime=n.scheduledVisitTime),n.assignedTo&&(t.assignedTo=n.assignedTo);const s=await Oo(Mt(je,Ji),t),r=await Bn(s);return ca(r)},updateASRequest:async(n,e)=>{const t=Lt(je,Ji,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(s.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(s.entrancePassword=e.entrancePassword),e.description!==void 0&&(s.description=e.description),e.scheduledVisitDate!==void 0&&(s.scheduledVisitDate=e.scheduledVisitDate instanceof Date?be.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(s.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.completionDate!==void 0&&(s.completionDate=e.completionDate instanceof Date?be.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(s.notes=e.notes),e.status!==void 0&&(s.status=e.status),await ws(t,s);const r=await Bn(t);return ca(r)},deleteASRequest:async n=>{const e=Lt(je,Ji,n);await Xr(e)},subscribeToASRequests:n=>{const e=In(Mt(je,Ji),Rn("createdAt","desc"));return lr(e,t=>{const s=t.docs.map(ca);n(s)})}},ua={getAllASRequests:async()=>(await we.get("/as-requests")).data,getASRequestById:async n=>(await we.get(`/as-requests/${n}`)).data,createASRequest:async n=>(await we.post("/as-requests",n)).data,updateASRequest:async(n,e)=>(await we.put(`/as-requests/${n}`,e)).data,deleteASRequest:async n=>{await we.delete(`/as-requests/${n}`)}},Ta={getAllASRequests:async()=>ct()?(console.log("[asRequestService] Using Firestore"),Zi.getAllASRequests()):(console.log("[asRequestService] Using Railway API"),ua.getAllASRequests()),getASRequestById:async n=>{if(ct()){const e=await Zi.getASRequestById(n);if(!e)throw new Error("AS Request not found");return e}return ua.getASRequestById(n)},createASRequest:async n=>ct()?Zi.createASRequest(n):ua.createASRequest(n),updateASRequest:async(n,e)=>ct()?Zi.updateASRequest(n,e):ua.updateASRequest(n,e),deleteASRequest:async n=>ct()?Zi.deleteASRequest(n):ua.deleteASRequest(n),subscribeToASRequests:Zi.subscribeToASRequests};function ma(n){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:n.id,id:parseInt(n.id)||0,name:n.name,client:{name:n.client||"",phone:"",address:n.address||""},location:{address:n.address||""},startDate:n.startDate||"",endDate:n.endDate||"",status:e[n.status]||"planning",budget:0,actualCost:0,manager:{_id:String(n.managerId||""),name:n.managerName||n.manager||"",username:n.managerUsername||""},fieldManagers:[],workers:[],colorCode:n.color||"#4A90E2",progress:0,description:n.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:n.createdAt||"",updatedAt:n.updatedAt||"",meetingNotes:n.meetingNotes||[],customerRequests:n.customerRequests||[],entrancePassword:n.entrancePassword||"",sitePassword:n.sitePassword||""}}function Xh(n){var t,s,r,i,o,l,u,m;const e={};if(n.name!==void 0&&(e.name=n.name),n.client!==void 0&&(e.client=typeof n.client=="string"?n.client:((t=n.client)==null?void 0:t.name)||""),n.location!==void 0&&(e.address=typeof n.location=="string"?n.location:((s=n.location)==null?void 0:s.address)||""),n.address!==void 0&&(e.address=n.address),n.startDate!==void 0&&(e.startDate=typeof n.startDate=="string"?n.startDate:((o=(i=(r=n.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),n.endDate!==void 0&&(e.endDate=typeof n.endDate=="string"?n.endDate:((m=(u=(l=n.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),n.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[n.status]||"planning"}return n.description!==void 0&&(e.description=n.description),n.manager!==void 0&&(e.manager=n.manager),n.meetingNotes!==void 0&&(e.meetingNotes=n.meetingNotes),n.customerRequests!==void 0&&(e.customerRequests=n.customerRequests),n.entrancePassword!==void 0&&(e.entrancePassword=n.entrancePassword),n.sitePassword!==void 0&&(e.sitePassword=n.sitePassword),n.color!==void 0&&(e.color=n.color),n.colorCode!==void 0&&(e.color=n.colorCode),e}const Vr={getAllProjects:async()=>{const n=Mt(je,Ht.PROJECTS),e=In(n,Rn("id","desc"));return(await Gn(e)).docs.map(s=>{const r=s.data();return ma({...r,id:s.id})})},getProjectById:async n=>{const e=Lt(je,Ht.PROJECTS,n),t=await Bn(e);if(t.exists()){const s=t.data();return ma({...s,id:t.id})}return null},createProject:async n=>{const e=Mt(je,Ht.PROJECTS),t=await Gn(e);let s=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>s&&(s=d)});const r=String(s+1),i=Xh(n),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Lt(je,Ht.PROJECTS,r);return await xf(u,l),ma(l)},updateProject:async(n,e)=>{const t=Lt(je,Ht.PROJECTS,n),s=Xh(e);await ws(t,{...s,updatedAt:new Date().toISOString()});const r=await Vr.getProjectById(n);if(!r)throw new Error("Project not found after update");return r},deleteProject:async n=>{const e=Lt(je,Ht.PROJECTS,n);await Xr(e)},subscribeToProjects:n=>{const e=Mt(je,Ht.PROJECTS),t=In(e,Rn("id","desc"));return lr(t,s=>{const r=s.docs.map(i=>{const o=i.data();return ma({...o,id:i.id})});n(r)})},subscribeToProject:(n,e)=>{const t=Lt(je,Ht.PROJECTS,n);return lr(t,s=>{if(s.exists()){const r=s.data();e(ma({...r,id:s.id}))}else e(null)})}},da={getAllProjects:async()=>(await we.get("/projects")).data,getProjectById:async n=>(await we.get(`/projects/${n}`)).data,createProject:async n=>{const e={name:n.name,client:typeof n.client=="string"?n.client:n.client.name,location:typeof n.location=="string"?n.location:n.location.address,status:n.status||"planning",manager:n.manager,description:n.description||""};if(n.startDate){const s=typeof n.startDate=="string"?new Date(n.startDate):n.startDate;e.startDate=s.toISOString().split("T")[0]}if(n.endDate){const s=typeof n.endDate=="string"?new Date(n.endDate):n.endDate;e.endDate=s.toISOString().split("T")[0]}return console.log("[projectService.createProject] Sending to backend:",e),(await we.post("/projects",e)).data},updateProject:async(n,e)=>{var s;const t={};if(e.name!==void 0&&(t.name=e.name),e.client!==void 0&&(t.client=typeof e.client=="string"?e.client:e.client.name),e.location!==void 0&&(t.location=typeof e.location=="string"?e.location:e.location.address),e.startDate!==void 0)if(typeof e.startDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.startDate))t.startDate=e.startDate;else{const r=typeof e.startDate=="string"?new Date(e.startDate):e.startDate;t.startDate=r.toISOString().split("T")[0]}if(e.endDate!==void 0)if(typeof e.endDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.endDate))t.endDate=e.endDate;else{const r=typeof e.endDate=="string"?new Date(e.endDate):e.endDate;t.endDate=r.toISOString().split("T")[0]}e.status!==void 0&&(t.status=e.status),e.manager!==void 0&&(t.manager=e.manager),e.description!==void 0&&(t.description=e.description),e.meetingNotes!==void 0&&(t.meetingNotes=e.meetingNotes),e.customerRequests!==void 0&&(t.customerRequests=e.customerRequests),e.entrancePassword!==void 0&&(t.entrancePassword=e.entrancePassword),e.sitePassword!==void 0&&(t.sitePassword=e.sitePassword),console.log("[projectService.updateProject] Sending to backend:",t);try{return(await we.put(`/projects/${n}`,t)).data}catch(r){const i=r;throw console.error("[projectService.updateProject] Error:",r),console.error("[projectService.updateProject] Error response:",(s=i.response)==null?void 0:s.data),r}},deleteProject:async n=>{await we.delete(`/projects/${n}`)}},bo={getAllProjects:async()=>ct()?(console.log("[projectService] Using Firestore"),Vr.getAllProjects()):(console.log("[projectService] Using Railway API"),da.getAllProjects()),getProjectById:async n=>{if(ct()){const e=await Vr.getProjectById(n);if(!e)throw new Error("Project not found");return e}return da.getProjectById(n)},createProject:async n=>ct()?Vr.createProject(n):da.createProject(n),updateProject:async(n,e)=>ct()?Vr.updateProject(n,e):da.updateProject(n,e),deleteProject:async n=>ct()?Vr.deleteProject(n):da.deleteProject(n),subscribeToProjects:Vr.subscribeToProjects,subscribeToProject:Vr.subscribeToProject},fC=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://api.hvlab.app"}return window.location.origin},pC=fC();class hC{constructor(){Xf(this,"socket",null)}connect(e){return this.socket=Pa(pC,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var s;(s=this.socket)==null||s.on(e,t)}emit(e,t){var s;(s=this.socket)==null||s.emit(e,t)}off(e,t){var s;(s=this.socket)==null||s.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const Cr=new hC,gC=()=>{var ae,$e;const{user:n,logout:e,loading:t}=Kr(),[s,r]=E.useState(!1),[i,o]=E.useState(!1),[l,u]=E.useState(!1),m=Vx(),{unreadCount:d}=Ny(),[f,h]=E.useState(0),[y,w]=E.useState(0),[v,C]=E.useState(0),[B,T]=E.useState(0),[F,re]=E.useState(!1),[ee,M]=E.useState(0),[A,N]=E.useState(!1),V=E.useRef(0),j=E.useRef(null),S=80,I=E.useCallback(me=>{if(window.scrollY>0)return!1;let Re=me;for(;Re&&Re!==document.body;){const vt=window.getComputedStyle(Re).overflowY;if((vt==="auto"||vt==="scroll")&&Re.scrollTop>0)return!1;Re=Re.parentElement}return!0},[]),k=E.useCallback(me=>{if(window.innerWidth>=768)return;const Re=me.target;I(Re)&&(V.current=me.touches[0].clientY,re(!0))},[I]),De=E.useCallback(me=>{if(!F||A)return;const Re=me.target;if(!I(Re)){re(!1),M(0);return}const vt=me.touches[0].clientY-V.current;if(vt>0){const at=Math.min(vt*.5,120);M(at)}else re(!1),M(0)},[F,A,I]),qe=E.useCallback(()=>{F&&(ee>=S&&!A?(N(!0),M(50),setTimeout(()=>{window.location.reload()},300)):M(0),re(!1))},[F,ee,A]);if(E.useEffect(()=>{u(!1)},[m.pathname]),E.useEffect(()=>{const me=Re=>{u(Re.detail.isOpen)};return window.addEventListener("mobileFormStateChange",me),()=>window.removeEventListener("mobileFormStateChange",me)},[]),E.useEffect(()=>{const me=()=>{T(Re=>Math.max(0,Re-1))};return window.addEventListener("quoteInquiryRead",me),()=>window.removeEventListener("quoteInquiryRead",me)},[]),E.useEffect(()=>{const me=()=>{w(Re=>Math.max(0,Re-1))};return window.addEventListener("paymentCompleted",me),()=>window.removeEventListener("paymentCompleted",me)},[]),E.useEffect(()=>{const me=Cr.getSocket();if(!me||!n)return;const Re=async()=>{try{const[Qe,vt]=await Promise.all([Es.getAllPayments(),bo.getAllProjects()]);let at=Qe;if(n.name===""){const wt=vt.map(ot=>ot.name);at=Qe.filter(ot=>wt.includes(ot.project))}w(at.filter(wt=>wt.status==="pending").length)}catch(Qe){console.error("Failed to refresh payment count:",Qe)}};return me.on("payment:refresh",Re),()=>{me.off("payment:refresh",Re)}},[n]),E.useEffect(()=>{if(!n)return;const me=async()=>{try{const[Qe,vt,at,wt]=await Promise.all([dC.getAllWorkRequests(),Es.getAllPayments(),Ta.getAllASRequests(),bo.getAllProjects()]);h(Qe.filter(ft=>ft.assignedTo===n.name&&ft.status==="pending").length);let ot=vt;if(n.name===""){const ft=wt.map(fn=>fn.name);ot=vt.filter(fn=>ft.includes(fn.project))}if(w(ot.filter(ft=>ft.status==="pending").length),C(at.filter(ft=>ft.status==="in-progress").length),n.role==="admin"||n.role==="manager")try{const fn=(await we.get("/quote-inquiries")).data.filter(K=>!K.isRead).length;T(fn)}catch(ft){console.error("Failed to load quote inquiry count:",ft)}}catch(Qe){console.error("Failed to load badge counts:",Qe)}};me();const Re=setInterval(me,3e4);return()=>clearInterval(Re)},[n]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!n){const me=window.location.pathname+window.location.search;return me&&me!=="/login"&&me!=="/"&&sessionStorage.setItem("redirectAfterLogin",me),a.jsxDEV(Sg,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const he=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...B>0&&{badge:B}},{name:"",href:"/contractors"}],Ue=he.filter(me=>!me.roles||me.roles.includes((n==null?void 0:n.role)||"")),ht=((ae=he.find(me=>me.href===m.pathname))==null?void 0:ae.name)||"",Ft=(()=>{const me=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(me)?()=>{const Qe=new CustomEvent("headerAddButtonClick");window.dispatchEvent(Qe)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Ds("fixed inset-0 z-40 lg:hidden",s?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Ue.map(me=>a.jsxDEV(zu,{to:me.href,className:({isActive:Re})=>Ds("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Re?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Ue.map(me=>a.jsxDEV(zu,{to:me.href,className:({isActive:Re})=>Ds("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Re?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),ht&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:ht},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ft&&a.jsxDEV("button",{onClick:Ft,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(vn,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV(No,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:n==null?void 0:n.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:n==null?void 0:n.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:($e=n==null?void 0:n.name)==null?void 0:$e.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:Ue.map(me=>a.jsxDEV(zu,{to:me.href,className:({isActive:Re})=>Ds("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Re?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:De,onTouchEnd:qe,children:[ee>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:ee,transition:F?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Ds("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",A&&"animate-spin"),style:{transform:`rotate(${A?0:ee*2}deg)`,opacity:Math.min(ee/S,1)},children:a.jsxDEV(Bx,{className:Ds("w-5 h-5",ee>=S?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:ee>0?`translateY(${ee}px)`:"none",transition:F?"none":"transform 0.2s ease-out"},children:a.jsxDEV(Cx,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(TD,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},yC=n=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,s=n==="emergency"?5:3;let r=0;const i=()=>{if(r>=s)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=n==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<s&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},bC=n=>{if("vibrate"in navigator){const e=n==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},NC=(n,e)=>{yC(n),bC(n),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},xC=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",eo="schedules",fa=n=>{const e=n.data();return{_id:n.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof be?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof be?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof be?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},to={getAllSchedules:async()=>{const n=In(Mt(je,eo),Rn("startDate","desc"));return(await Gn(n)).docs.map(fa)},getScheduleById:async n=>{const e=Lt(je,eo,n),t=await Bn(e);return t.exists()?fa(t):null},createSchedule:async n=>{const e=be.now(),t={project:typeof n.project=="string"?{_id:n.project,name:n.project}:n.project,title:n.title,type:n.type||"other",phase:n.phase||"",startDate:n.startDate instanceof Date?be.fromDate(n.startDate):n.startDate,endDate:n.endDate instanceof Date?be.fromDate(n.endDate):n.endDate,allDay:n.allDay??!0,assignedTo:n.assignedTo||[],description:n.description||"",location:n.location||"",priority:n.priority||"medium",progress:n.progress??0,isCompleted:n.isCompleted??!1,time:n.time||"",asRequestId:n.asRequestId||null,createdAt:e,updatedAt:e},s=await Oo(Mt(je,eo),t),r=await Bn(s);return fa(r)},updateSchedule:async(n,e)=>{const t=Lt(je,eo,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(s.title=e.title),e.type!==void 0&&(s.type=e.type),e.phase!==void 0&&(s.phase=e.phase),e.startDate!==void 0&&(s.startDate=e.startDate instanceof Date?be.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(s.endDate=e.endDate instanceof Date?be.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(s.allDay=e.allDay),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.description!==void 0&&(s.description=e.description),e.location!==void 0&&(s.location=e.location),e.priority!==void 0&&(s.priority=e.priority),e.progress!==void 0&&(s.progress=e.progress),e.isCompleted!==void 0&&(s.isCompleted=e.isCompleted,e.isCompleted&&(s.completedAt=be.now())),e.time!==void 0&&(s.time=e.time),await ws(t,s);const r=await Bn(t);return fa(r)},deleteSchedule:async n=>{const e=Lt(je,eo,n);await Xr(e)},subscribeToSchedules:n=>{const e=In(Mt(je,eo),Rn("startDate","desc"));return lr(e,t=>{const s=t.docs.map(fa);n(s)})}},pa={getAllSchedules:async()=>(await we.get("/schedules")).data,getScheduleById:async n=>(await we.get(`/schedules/${n}`)).data,createSchedule:async n=>(await we.post("/schedules",{project:n.project,title:n.title,type:n.type||"other",phase:n.phase||"",startDate:n.startDate,endDate:n.endDate,allDay:n.allDay!==void 0?n.allDay:!0,assignedTo:n.assignedTo||[],description:n.description,location:n.location,priority:n.priority||"medium",progress:n.progress||0,isCompleted:n.isCompleted||!1,asRequestId:n.asRequestId,time:n.time})).data,updateSchedule:async(n,e)=>(await we.put(`/schedules/${n}`,e)).data,deleteSchedule:async n=>{await we.delete(`/schedules/${n}`)}},ql={getAllSchedules:async()=>ct()?(console.log("[scheduleService] Using Firestore"),to.getAllSchedules()):(console.log("[scheduleService] Using Railway API"),pa.getAllSchedules()),getScheduleById:async n=>{if(ct()){const e=await to.getScheduleById(n);if(!e)throw new Error("Schedule not found");return e}return pa.getScheduleById(n)},createSchedule:async n=>ct()?to.createSchedule(n):pa.createSchedule(n),updateSchedule:async(n,e)=>ct()?to.updateSchedule(n,e):pa.updateSchedule(n,e),deleteSchedule:async n=>ct()?to.deleteSchedule(n):pa.deleteSchedule(n),subscribeToSchedules:to.subscribeToSchedules},no="contractors",ha=n=>{const e=n.data();return{_id:n.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},so={getAllContractors:async()=>{const n=In(Mt(je,no),Rn("name","asc"));return(await Gn(n)).docs.map(ha)},getContractorById:async n=>{const e=Lt(je,no,n),t=await Bn(e);return t.exists()?ha(t):null},createContractor:async n=>{const e=be.now(),t={rank:n.rank||"",companyName:n.companyName||"",name:n.name,position:n.position||"",process:n.process,contact:n.contact||"",accountNumber:n.accountNumber,notes:n.notes||"",createdAt:e,updatedAt:e},s=await Oo(Mt(je,no),t),r=await Bn(s);return ha(r)},updateContractor:async(n,e)=>{const t=Lt(je,no,n),s={updatedAt:be.now()};e.rank!==void 0&&(s.rank=e.rank),e.companyName!==void 0&&(s.companyName=e.companyName),e.name!==void 0&&(s.name=e.name),e.position!==void 0&&(s.position=e.position),e.process!==void 0&&(s.process=e.process),e.contact!==void 0&&(s.contact=e.contact),e.accountNumber!==void 0&&(s.accountNumber=e.accountNumber),e.notes!==void 0&&(s.notes=e.notes),await ws(t,s);const r=await Bn(t);return ha(r)},deleteContractor:async n=>{const e=Lt(je,no,n);await Xr(e)},subscribeToContractors:n=>{const e=In(Mt(je,no),Rn("name","asc"));return lr(e,t=>{const s=t.docs.map(ha);n(s)})}},ga={getAllContractors:async()=>(await we.get("/contractors")).data,getContractorById:async n=>(await we.get(`/contractors/${n}`)).data,createContractor:async n=>(await we.post("/contractors",n)).data,updateContractor:async(n,e)=>(await we.put(`/contractors/${n}`,e)).data,deleteContractor:async n=>{await we.delete(`/contractors/${n}`)}},sr={getAllContractors:async()=>ct()?(console.log("[contractorService] Using Firestore"),so.getAllContractors()):(console.log("[contractorService] Using Railway API"),ga.getAllContractors()),getContractorById:async n=>{if(ct()){const e=await so.getContractorById(n);if(!e)throw new Error("Contractor not found");return e}return ga.getContractorById(n)},createContractor:async n=>ct()?so.createContractor(n):ga.createContractor(n),updateContractor:async(n,e)=>ct()?so.updateContractor(n,e):ga.updateContractor(n,e),deleteContractor:async n=>ct()?so.deleteContractor(n):ga.deleteContractor(n),subscribeToContractors:so.subscribeToContractors},ro="construction_payments",ya=n=>{const e=n.data(),t=(e.payments||[]).map(r=>({types:r.types||[],amount:r.amount||0,date:r.date instanceof be?r.date.toDate().toISOString():r.date||"",method:r.method||"",notes:r.notes||""})),s={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(s.contract=e.expectedPaymentDates.contract instanceof be?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(s.start=e.expectedPaymentDates.start instanceof be?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(s.middle=e.expectedPaymentDates.middle instanceof be?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(s.final=e.expectedPaymentDates.final instanceof be?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:n.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:t,expectedPaymentDates:s,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},io={getAllConstructionPayments:async()=>{const n=In(Mt(je,ro),Rn("createdAt","desc"));return(await Gn(n)).docs.map(ya)},getConstructionPaymentById:async n=>{const e=Lt(je,ro,n),t=await Bn(e);return t.exists()?ya(t):null},createConstructionPayment:async n=>{const e=be.now(),t=(n.payments||[]).map(l=>({types:l.types,amount:l.amount,date:l.date instanceof Date?be.fromDate(l.date):l.date,method:l.method,notes:l.notes||""})),s={};n.expectedPaymentDates&&(n.expectedPaymentDates.contract&&(s.contract=n.expectedPaymentDates.contract instanceof Date?be.fromDate(n.expectedPaymentDates.contract):n.expectedPaymentDates.contract),n.expectedPaymentDates.start&&(s.start=n.expectedPaymentDates.start instanceof Date?be.fromDate(n.expectedPaymentDates.start):n.expectedPaymentDates.start),n.expectedPaymentDates.middle&&(s.middle=n.expectedPaymentDates.middle instanceof Date?be.fromDate(n.expectedPaymentDates.middle):n.expectedPaymentDates.middle),n.expectedPaymentDates.final&&(s.final=n.expectedPaymentDates.final instanceof Date?be.fromDate(n.expectedPaymentDates.final):n.expectedPaymentDates.final));const r={project:n.project,client:n.client,totalAmount:n.totalAmount,vatType:n.vatType,vatPercentage:n.vatPercentage,vatAmount:n.vatAmount,payments:t,expectedPaymentDates:s,createdAt:e,updatedAt:e},i=await Oo(Mt(je,ro),r),o=await Bn(i);return ya(o)},updateConstructionPayment:async(n,e)=>{const t=Lt(je,ro,n),s={updatedAt:be.now()};if(e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.totalAmount!==void 0&&(s.totalAmount=e.totalAmount),e.vatType!==void 0&&(s.vatType=e.vatType),e.vatPercentage!==void 0&&(s.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(s.vatAmount=e.vatAmount),e.payments!==void 0&&(s.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?be.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?be.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?be.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?be.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?be.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),s.expectedPaymentDates=i}await ws(t,s);const r=await Bn(t);return ya(r)},deleteConstructionPayment:async n=>{const e=Lt(je,ro,n);await Xr(e)},subscribeToConstructionPayments:n=>{const e=In(Mt(je,ro),Rn("createdAt","desc"));return lr(e,t=>{const s=t.docs.map(ya);n(s)})}},ba={getAllConstructionPayments:async()=>(await we.get("/construction-payments")).data,getConstructionPaymentById:async n=>(await we.get(`/construction-payments/${n}`)).data,createConstructionPayment:async n=>(await we.post("/construction-payments",n)).data,updateConstructionPayment:async(n,e)=>(await we.put(`/construction-payments/${n}`,e)).data,deleteConstructionPayment:async n=>{await we.delete(`/construction-payments/${n}`)}},$l={getAllConstructionPayments:async()=>ct()?(console.log("[constructionPaymentService] Using Firestore"),io.getAllConstructionPayments()):(console.log("[constructionPaymentService] Using Railway API"),ba.getAllConstructionPayments()),getConstructionPaymentById:async n=>{if(ct()){const e=await io.getConstructionPaymentById(n);if(!e)throw new Error("Construction payment not found");return e}return ba.getConstructionPaymentById(n)},createConstructionPayment:async n=>ct()?io.createConstructionPayment(n):ba.createConstructionPayment(n),updateConstructionPayment:async(n,e)=>ct()?io.updateConstructionPayment(n,e):ba.updateConstructionPayment(n,e),deleteConstructionPayment:async n=>ct()?io.deleteConstructionPayment(n):ba.deleteConstructionPayment(n),subscribeToConstructionPayments:io.subscribeToConstructionPayments};let yc=new Map,Na=null;async function vC(){if(!(yc.size>0))return Na||(Na=(async()=>{try{const n=Mt(je,Ht.PROJECTS);(await Gn(n)).docs.forEach(t=>{const s=t.data(),r=parseInt(t.id);!isNaN(r)&&s.name&&yc.set(s.name,r)}),console.log("[executionRecordFirestoreService]    :",yc.size,"")}catch(n){throw console.error("[executionRecordFirestoreService]    :",n),Na=null,n}})(),Na)}function oo(n){return{id:n.id,project_id:n.projectId,project_name:n.projectName||"",author:n.author||"",date:n.date||"",process:n.process||"",item_name:n.itemName||"",material_cost:n.materialCost||0,labor_cost:n.laborCost||0,vat_amount:n.vatAmount||0,total_amount:n.totalAmount||0,notes:n.notes||"",images:n.images||[],payment_id:n.paymentId,includes_tax_deduction:n.includesTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,created_at:n.createdAt||"",updated_at:n.updatedAt||""}}function Jh(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.project_name!==void 0&&(e.projectName=n.project_name),n.projectName!==void 0&&(e.projectName=n.projectName),n.author!==void 0&&(e.author=n.author),n.date!==void 0&&(e.date=n.date),n.process!==void 0&&(e.process=n.process),n.item_name!==void 0&&(e.itemName=n.item_name),n.itemName!==void 0&&(e.itemName=n.itemName),n.material_cost!==void 0&&(e.materialCost=n.material_cost),n.materialCost!==void 0&&(e.materialCost=n.materialCost),n.labor_cost!==void 0&&(e.laborCost=n.labor_cost),n.laborCost!==void 0&&(e.laborCost=n.laborCost),n.vat_amount!==void 0&&(e.vatAmount=n.vat_amount),n.vatAmount!==void 0&&(e.vatAmount=n.vatAmount),n.total_amount!==void 0&&(e.totalAmount=n.total_amount),n.totalAmount!==void 0&&(e.totalAmount=n.totalAmount),n.notes!==void 0&&(e.notes=n.notes),n.images!==void 0&&(e.images=n.images),n.payment_id!==void 0&&(e.paymentId=n.payment_id),n.paymentId!==void 0&&(e.paymentId=n.paymentId),n.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=n.includes_tax_deduction===!0||n.includes_tax_deduction===1),n.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=n.includesTaxDeduction),n.includes_vat!==void 0&&(e.includesVAT=n.includes_vat===!0||n.includes_vat===1),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),e}const tr={getAllRecords:async()=>{const n=Mt(je,Ht.EXECUTION_RECORDS),e=In(n,Rn("id","desc"));return(await Gn(e)).docs.map(s=>{const r=s.data();return oo({...r,id:parseInt(s.id)||r.id})})},getRecordById:async n=>{const e=Lt(je,Ht.EXECUTION_RECORDS,n),t=await Bn(e);if(t.exists()){const s=t.data();return oo({...s,id:parseInt(t.id)||s.id})}return null},createRecord:async n=>{var f;await vC();const e=Mt(je,Ht.EXECUTION_RECORDS),t=await Gn(e);let s=0;t.docs.forEach(h=>{const y=parseInt(h.id);!isNaN(y)&&y>s&&(s=y)});const r=s+1,i=Jh(n),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const h=yc.get(u);h?(l=h,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:i.images||[],imageCount:((f=i.images)==null?void 0:f.length)||0},d=Lt(je,Ht.EXECUTION_RECORDS,String(r));return await xf(d,m),oo(m)},updateRecord:async(n,e)=>{const t=Lt(je,Ht.EXECUTION_RECORDS,n),s=Jh(e);await ws(t,{...s,updatedAt:new Date().toISOString()});const r=await tr.getRecordById(n);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async n=>{const e=Lt(je,Ht.EXECUTION_RECORDS,n);await Xr(e)},subscribeToRecords:n=>{const e=Mt(je,Ht.EXECUTION_RECORDS),t=In(e,Rn("id","desc"));return lr(t,s=>{const r=s.docs.map(i=>{const o=i.data();return oo({...o,id:parseInt(i.id)||o.id})});n(r)})},getRecordsByProject:async n=>{const e=Mt(je,Ht.EXECUTION_RECORDS),t=In(e,nd("projectId","==",n),Rn("id","desc"));return(await Gn(t)).docs.map(r=>{const i=r.data();return oo({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async n=>{const e=Mt(je,Ht.EXECUTION_RECORDS),t=In(e,nd("paymentId","==",n)),s=await Gn(t);if(s.empty)return null;const r=s.docs[0],i=r.data();return oo({...i,id:parseInt(r.id)||i.id})}},xa={getAllRecords:async()=>(await we.get("/execution-records")).data,getRecordById:async n=>(await we.get(`/execution-records/${n}`)).data,createRecord:async n=>(console.log("[executionRecordService.createRecord] Creating:",n),(await we.post("/execution-records",n)).data),updateRecord:async(n,e)=>(await we.put(`/execution-records/${n}`,e)).data,deleteRecord:async n=>{await we.delete(`/execution-records/${n}`)}},zl={getAllRecords:async()=>ct()?(console.log("[executionRecordService] Using Firestore"),tr.getAllRecords()):(console.log("[executionRecordService] Using Railway API"),xa.getAllRecords()),getRecordById:async n=>{if(ct()){const e=await tr.getRecordById(n);if(!e)throw new Error("Execution record not found");return e}return xa.getRecordById(n)},createRecord:async n=>ct()?tr.createRecord(n):xa.createRecord(n),updateRecord:async(n,e)=>ct()?tr.updateRecord(n,e):xa.updateRecord(n,e),deleteRecord:async n=>ct()?tr.deleteRecord(n):xa.deleteRecord(n),subscribeToRecords:tr.subscribeToRecords,getRecordsByProject:tr.getRecordsByProject,getRecordByPaymentId:tr.getRecordByPaymentId},$r=ud()(by((n,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>n({projects:t}),addProject:t=>n(s=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...s.projects],constructionPayments:[r,...s.constructionPayments]}}),updateProject:(t,s)=>n(r=>({projects:r.projects.map(i=>i.id===t?{...i,...s}:i)})),deleteProject:t=>n(s=>({projects:s.projects.filter(r=>r.id!==t),constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>n({schedules:t}),addSchedule:t=>n(s=>({schedules:[t,...s.schedules]})),updateSchedule:(t,s)=>n(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...s}:i)})),deleteSchedule:t=>n(s=>({schedules:s.schedules.filter(r=>r.id!==t)})),setPayments:t=>n({payments:t}),addPayment:t=>n(s=>({payments:[t,...s.payments]})),updatePayment:(t,s)=>n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)})),deletePayment:t=>n(s=>({payments:s.payments.filter(r=>r.id!==t)})),setContractors:t=>n({contractors:t}),addContractor:t=>n(s=>({contractors:[t,...s.contractors]})),updateContractor:(t,s)=>n(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...s}:i)})),deleteContractor:t=>n(s=>({contractors:s.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>n({constructionPayments:t}),addConstructionPayment:t=>n(s=>({constructionPayments:[t,...s.constructionPayments]})),updateConstructionPayment:(t,s)=>n(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...s}:i)})),deleteConstructionPayment:t=>n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>n({asRequests:t}),addASRequest:t=>n(s=>({asRequests:[t,...s.asRequests]})),updateASRequest:(t,s)=>n(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...s}:i)})),deleteASRequest:t=>n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>n({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),n(s=>{const r=[t,...s.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,s)=>n(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...s}:i)})),deleteExecutionRecord:t=>n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await Es.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const s=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));s.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(s.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",s.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(w=>w.id)),f=s.filter(w=>!d.has(w.id)),y=[...m.map(w=>({...w,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),n({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),n({payments:s})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const s=`temp_${Date.now()}`,r={...t,id:s,_addedAt:Date.now(),_tempId:s};n(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",s);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await Es.createPayment(u),d=String(m.id);return n(f=>({payments:f.payments.map(h=>h._tempId===s?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),n(o=>({payments:o.payments.filter(l=>l._tempId!==s)})),i}},updatePaymentInAPI:async(t,s)=>{try{if(s.status&&Object.keys(s).length===1)await Es.updatePaymentStatus(t,s.status);else{let r=s.project;if(s.project){const o=e().projects.find(l=>l.name===s.project);r=o?o.id:s.project}await Es.updatePayment(t,{projectId:r,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,materialAmount:s.materialAmount,laborAmount:s.laborAmount,originalMaterialAmount:s.originalMaterialAmount,originalLaborAmount:s.originalLaborAmount,category:s.category,urgency:s.urgency,bankInfo:s.bankInfo,notes:s.notes,requestDate:s.requestDate,includesVAT:s.includesVAT,applyTaxDeduction:s.applyTaxDeduction})}n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await Es.deletePayment(t),n(s=>({payments:s.payments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete payment from API:",s),s}},loadSchedulesFromAPI:async()=>{try{const t=await ql.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const s=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});s.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),n({schedules:s})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const s=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:s};n(l=>({schedules:[...l.schedules,r]}));try{const l=await ql.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};n(f=>({schedules:f.schedules.map(h=>h.id===s?d:h)}))}catch(l){throw console.error("Failed to add schedule to API:",l),n(u=>({schedules:u.schedules.filter(m=>m.id!==s)})),l}},updateScheduleInAPI:async(t,s)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:s});const l={};s.project!==void 0&&(l.project=s.project),s.title!==void 0&&(l.title=s.title),s.type!==void 0&&(l.type=s.type),s.start!==void 0&&(l.startDate=s.start),s.end!==void 0&&(l.endDate=s.end),s.location!==void 0&&(l.location=s.location),s.description!==void 0&&(l.description=s.description),s.attendees!==void 0&&(l.assignedTo=s.attendees),s.time!==void 0&&(l.time=s.time),console.log(" Sending update data:",l);const u=await ql.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};n(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:s}=e(),r=s.find(o=>o.id===t);if(r){n(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await ql.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&n(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const s=(await bo.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});n({projects:s})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var s,r;try{const i=await bo.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:i.manager||"",team:[],description:i.description||"",meetingNotes:((s=i.meetingNotes)==null?void 0:s.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};n(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,s)=>{var r,i;try{const o=await bo.updateProject(t,s),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};n(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await bo.deleteProject(t),n(s=>({projects:s.projects.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete project from API:",s),s}},loadContractorsFromAPI:async()=>{try{const s=(await sr.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));n({contractors:s})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const s=await sr.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:s._id,rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)};n(i=>({contractors:[r,...i.contractors]}))}catch(s){throw console.error("Failed to add contractor to API:",s),s}},updateContractorInAPI:async(t,s)=>{try{const r=await sr.updateContractor(t,{rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};n(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await sr.deleteContractor(t),n(s=>({contractors:s.contractors.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete contractor from API:",s),s}},loadConstructionPaymentsFromAPI:async()=>{try{const s=(await $l.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});n({constructionPayments:s})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var s;try{const r=await $l.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((s=r.payments)==null?void 0:s.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};n(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,s)=>{var r;try{const i=await $l.updateConstructionPayment(t,s);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};n(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await $l.deleteConstructionPayment(t),n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete construction payment from API:",s),s}},loadASRequestsFromAPI:async()=>{try{const s=(await Ta.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));n({asRequests:s})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const s=await Ta.createASRequest(t),r={id:s._id,project:s.project,client:s.client,requestDate:new Date(s.requestDate),siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,scheduledVisitDate:s.scheduledVisitDate?new Date(s.scheduledVisitDate):void 0,scheduledVisitTime:s.scheduledVisitTime,assignedTo:Array.isArray(s.assignedTo)?s.assignedTo:[],completionDate:s.completionDate?new Date(s.completionDate):void 0,notes:s.notes};return n(i=>({asRequests:[r,...i.asRequests]})),r}catch(s){throw console.error("Failed to add AS request to API:",s),s}},updateASRequestInAPI:async(t,s)=>{try{const r=await Ta.updateASRequest(t,s),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};n(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await Ta.deleteASRequest(t),n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete AS request from API:",s),s}},loadExecutionRecordsFromAPI:async()=>{try{const t=await zl.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const s=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));n({executionRecords:s})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const s=await zl.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(s.id),project:s.project_name,author:s.author||void 0,date:new Date(s.date),process:s.process||void 0,itemName:s.item_name,materialCost:s.material_cost||0,laborCost:s.labor_cost||0,vatAmount:s.vat_amount||0,totalAmount:s.total_amount||0,notes:s.notes||void 0,paymentId:s.payment_id?String(s.payment_id):void 0,includesTaxDeduction:s.includes_tax_deduction===1,includesVat:s.includes_vat===1,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",s.includes_vat),n(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(s){throw console.error("Failed to add execution record to API:",s),s}},updateExecutionRecordInAPI:async(t,s)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",s);try{let r;if(s.date){const i=s.date instanceof Date?s.date:new Date(s.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:s.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat),await zl.updateRecord(t,{project_name:s.project,author:s.author,date:r,process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,images:s.images,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),n(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...s,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await zl.deleteRecord(t),n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete execution record from API:",s),s}}}),{name:"interior-management-storage",partialize:n=>({...n,payments:n.payments.map(e=>{const{images:t,...s}=e;return s}),executionRecords:n.executionRecords.map(e=>{const{images:t,...s}=e;return s})}),storage:{getItem:n=>{var u,m,d,f,h,y,w;const e=localStorage.getItem(n);if(!e)return null;const{state:t}=JSON.parse(e),s=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var C;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((C=v.payments)==null?void 0:C.map(B=>({...B,date:new Date(B.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=s.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:s,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((h=t.contractors)==null?void 0:h.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((y=t.asRequests)==null?void 0:y.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((w=t.executionRecords)==null?void 0:w.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(n,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(n,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:n=>localStorage.removeItem(n)}}));var Dl=n=>n.type==="checkbox",yi=n=>n instanceof Date,Jn=n=>n==null;const a0=n=>typeof n=="object";var kn=n=>!Jn(n)&&!Array.isArray(n)&&a0(n)&&!yi(n),_C=n=>kn(n)&&n.target?Dl(n.target)?n.target.checked:n.target.value:n,DC=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,kC=(n,e)=>n.has(DC(e)),EC=n=>{const e=n.constructor&&n.constructor.prototype;return kn(e)&&e.hasOwnProperty("isPrototypeOf")},vf=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ln(n){let e;const t=Array.isArray(n),s=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(vf&&(n instanceof Blob||s))&&(t||kn(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!EC(n))e=n;else for(const r in n)n.hasOwnProperty(r)&&(e[r]=Ln(n[r]));else return n;return e}var Vu=n=>/^\w*$/.test(n),Nn=n=>n===void 0,_f=n=>Array.isArray(n)?n.filter(Boolean):[],Df=n=>_f(n.replace(/["|']|\]/g,"").split(/\.|\[/)),Be=(n,e,t)=>{if(!e||!kn(n))return t;const s=(Vu(e)?[e]:Df(e)).reduce((r,i)=>Jn(r)?r:r[i],n);return Nn(s)||s===n?Nn(n[e])?t:n[e]:s},Hs=n=>typeof n=="boolean",nn=(n,e,t)=>{let s=-1;const r=Vu(e)?[e]:Df(e),i=r.length,o=i-1;for(;++s<i;){const l=r[s];let u=t;if(s!==o){const m=n[l];u=kn(m)||Array.isArray(m)?m:isNaN(+r[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=u,n=n[l]}};const Zh={BLUR:"blur",FOCUS_OUT:"focusout"},As={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Zs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},AC=mt.createContext(null);AC.displayName="HookFormContext";var VC=(n,e,t,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in n)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==As.all&&(e._proxyFormState[o]=!s||As.all),n[o]}});return r};const CC=typeof window<"u"?mt.useLayoutEffect:mt.useEffect;var cs=n=>typeof n=="string",wC=(n,e,t,s,r)=>cs(n)?(s&&e.watch.add(n),Be(t,n,r)):Array.isArray(n)?n.map(i=>(s&&e.watch.add(i),Be(t,i))):(s&&(e.watchAll=!0),t),sd=n=>Jn(n)||!a0(n);function Sr(n,e,t=new WeakSet){if(sd(n)||sd(e))return n===e;if(yi(n)&&yi(e))return n.getTime()===e.getTime();const s=Object.keys(n),r=Object.keys(e);if(s.length!==r.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const i of s){const o=n[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(yi(o)&&yi(l)||kn(o)&&kn(l)||Array.isArray(o)&&Array.isArray(l)?!Sr(o,l,t):o!==l)return!1}}return!0}var IC=(n,e,t,s,r)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[s]:r||!0}}:{},qa=n=>Array.isArray(n)?n:[n],eg=()=>{let n=[];return{get observers(){return n},next:r=>{for(const i of n)i.next&&i.next(r)},subscribe:r=>(n.push(r),{unsubscribe:()=>{n=n.filter(i=>i!==r)}}),unsubscribe:()=>{n=[]}}};function l0(n,e){const t={};for(const s in n)if(n.hasOwnProperty(s)){const r=n[s],i=e[s];if(r&&kn(r)&&i){const o=l0(r,i);kn(o)&&(t[s]=o)}else n[s]&&(t[s]=i)}return t}var rs=n=>kn(n)&&!Object.keys(n).length,kf=n=>n.type==="file",Vs=n=>typeof n=="function",zc=n=>{if(!vf)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},c0=n=>n.type==="select-multiple",Ef=n=>n.type==="radio",SC=n=>Ef(n)||Dl(n),cm=n=>zc(n)&&n.isConnected;function TC(n,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)n=Nn(n)?s++:n[e[s++]];return n}function PC(n){for(const e in n)if(n.hasOwnProperty(e)&&!Nn(n[e]))return!1;return!0}function yn(n,e){const t=Array.isArray(e)?e:Vu(e)?[e]:Df(e),s=t.length===1?n:TC(n,t),r=t.length-1,i=t[r];return s&&delete s[i],r!==0&&(kn(s)&&rs(s)||Array.isArray(s)&&PC(s))&&yn(n,t.slice(0,-1)),n}var LC=n=>{for(const e in n)if(Vs(n[e]))return!0;return!1};function u0(n){return Array.isArray(n)||kn(n)&&!LC(n)}function rd(n,e={}){for(const t in n)u0(n[t])?(e[t]=Array.isArray(n[t])?[]:{},rd(n[t],e[t])):Jn(n[t])||(e[t]=!0);return e}function yo(n,e,t){t||(t=rd(e));for(const s in n)u0(n[s])?Nn(e)||sd(t[s])?t[s]=rd(n[s],Array.isArray(n[s])?[]:{}):yo(n[s],Jn(e)?{}:e[s],t[s]):t[s]=!Sr(n[s],e[s]);return t}const tg={value:!1,isValid:!1},ng={value:!0,isValid:!0};var m0=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!Nn(n[0].attributes.value)?Nn(n[0].value)||n[0].value===""?ng:{value:n[0].value,isValid:!0}:ng:tg}return tg},d0=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>Nn(n)?n:e?n===""?NaN:n&&+n:t&&cs(n)?new Date(n):s?s(n):n;const sg={isValid:!1,value:null};var f0=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,sg):sg;function rg(n){const e=n.ref;return kf(e)?e.files:Ef(e)?f0(n.refs).value:c0(e)?[...e.selectedOptions].map(({value:t})=>t):Dl(e)?m0(n.refs).value:d0(Nn(e.value)?n.ref.value:e.value,n)}var jC=(n,e,t,s)=>{const r={};for(const i of n){const o=Be(e,i);o&&nn(r,i,o._f)}return{criteriaMode:t,names:[...n],fields:r,shouldUseNativeValidation:s}},Wc=n=>n instanceof RegExp,va=n=>Nn(n)?n:Wc(n)?n.source:kn(n)?Wc(n.value)?n.value.source:n.value:n,ig=n=>({isOnSubmit:!n||n===As.onSubmit,isOnBlur:n===As.onBlur,isOnChange:n===As.onChange,isOnAll:n===As.all,isOnTouch:n===As.onTouched});const og="AsyncFunction";var RC=n=>!!n&&!!n.validate&&!!(Vs(n.validate)&&n.validate.constructor.name===og||kn(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===og)),BC=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),ag=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(s=>n.startsWith(s)&&/^\.\w+/.test(n.slice(s.length))));const $a=(n,e,t,s)=>{for(const r of t||Object.keys(n)){const i=Be(n,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if($a(l,e))break}else if(kn(l)&&$a(l,e))break}}};function lg(n,e,t){const s=Be(n,t);if(s||Vu(t))return{error:s,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Be(e,i),l=Be(n,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var UC=(n,e,t,s)=>{t(n);const{name:r,...i}=n;return rs(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||As.all))},HC=(n,e,t)=>!n||!e||n===e||qa(n).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),MC=(n,e,t,s,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||n):(t?s.isOnBlur:r.isOnBlur)?!n:(t?s.isOnChange:r.isOnChange)?n:!0,FC=(n,e)=>!_f(Be(n,e)).length&&yn(n,e),OC=(n,e,t)=>{const s=qa(Be(n,t));return nn(s,"root",e[t]),nn(n,t,s),n};function cg(n,e,t="validate"){if(cs(n)||Array.isArray(n)&&n.every(cs)||Hs(n)&&!n)return{type:t,message:cs(n)?n:"",ref:e}}var ao=n=>kn(n)&&!Wc(n)?n:{value:n,message:""},ug=async(n,e,t,s,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:h,pattern:y,validate:w,name:v,valueAsNumber:C,mount:B}=n._f,T=Be(t,v);if(!B||e.has(v))return{};const F=l?l[0]:o,re=I=>{r&&F.reportValidity&&(F.setCustomValidity(Hs(I)?"":I||""),F.reportValidity())},ee={},M=Ef(o),A=Dl(o),N=M||A,V=(C||kf(o))&&Nn(o.value)&&Nn(T)||zc(o)&&o.value===""||T===""||Array.isArray(T)&&!T.length,j=IC.bind(null,v,s,ee),S=(I,k,De,qe=Zs.maxLength,he=Zs.minLength)=>{const Ue=I?k:De;ee[v]={type:I?qe:he,message:Ue,ref:o,...j(I?qe:he,Ue)}};if(i?!Array.isArray(T)||!T.length:u&&(!N&&(V||Jn(T))||Hs(T)&&!T||A&&!m0(l).isValid||M&&!f0(l).isValid)){const{value:I,message:k}=cs(u)?{value:!!u,message:u}:ao(u);if(I&&(ee[v]={type:Zs.required,message:k,ref:F,...j(Zs.required,k)},!s))return re(k),ee}if(!V&&(!Jn(f)||!Jn(h))){let I,k;const De=ao(h),qe=ao(f);if(!Jn(T)&&!isNaN(T)){const he=o.valueAsNumber||T&&+T;Jn(De.value)||(I=he>De.value),Jn(qe.value)||(k=he<qe.value)}else{const he=o.valueAsDate||new Date(T),Ue=Ft=>new Date(new Date().toDateString()+" "+Ft),ht=o.type=="time",zt=o.type=="week";cs(De.value)&&T&&(I=ht?Ue(T)>Ue(De.value):zt?T>De.value:he>new Date(De.value)),cs(qe.value)&&T&&(k=ht?Ue(T)<Ue(qe.value):zt?T<qe.value:he<new Date(qe.value))}if((I||k)&&(S(!!I,De.message,qe.message,Zs.max,Zs.min),!s))return re(ee[v].message),ee}if((m||d)&&!V&&(cs(T)||i&&Array.isArray(T))){const I=ao(m),k=ao(d),De=!Jn(I.value)&&T.length>+I.value,qe=!Jn(k.value)&&T.length<+k.value;if((De||qe)&&(S(De,I.message,k.message),!s))return re(ee[v].message),ee}if(y&&!V&&cs(T)){const{value:I,message:k}=ao(y);if(Wc(I)&&!T.match(I)&&(ee[v]={type:Zs.pattern,message:k,ref:o,...j(Zs.pattern,k)},!s))return re(k),ee}if(w){if(Vs(w)){const I=await w(T,t),k=cg(I,F);if(k&&(ee[v]={...k,...j(Zs.validate,k.message)},!s))return re(k.message),ee}else if(kn(w)){let I={};for(const k in w){if(!rs(I)&&!s)break;const De=cg(await w[k](T,t),F,k);De&&(I={...De,...j(k,De.message)},re(De.message),s&&(ee[v]=I))}if(!rs(I)&&(ee[v]={ref:F,...I},!s))return ee}}return re(!0),ee};const qC={mode:As.onSubmit,reValidateMode:As.onChange,shouldFocusError:!0};function $C(n={}){let e={...qC,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Vs(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=kn(e.defaultValues)||kn(e.values)?Ln(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Ln(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:eg(),state:eg()},y=e.criteriaMode===As.all,w=P=>q=>{clearTimeout(m),m=setTimeout(P,q)},v=async P=>{if(!e.disabled&&(d.isValid||f.isValid||P)){const q=e.resolver?rs((await A()).errors):await V(s,!0);q!==t.isValid&&h.state.next({isValid:q})}},C=(P,q)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((P||Array.from(l.mount)).forEach(te=>{te&&(q?nn(t.validatingFields,te,q):yn(t.validatingFields,te))}),h.state.next({validatingFields:t.validatingFields,isValidating:!rs(t.validatingFields)}))},B=(P,q=[],te,Ne,ce=!0,de=!0)=>{if(Ne&&te&&!e.disabled){if(o.action=!0,de&&Array.isArray(Be(s,P))){const Ie=te(Be(s,P),Ne.argA,Ne.argB);ce&&nn(s,P,Ie)}if(de&&Array.isArray(Be(t.errors,P))){const Ie=te(Be(t.errors,P),Ne.argA,Ne.argB);ce&&nn(t.errors,P,Ie),FC(t.errors,P)}if((d.touchedFields||f.touchedFields)&&de&&Array.isArray(Be(t.touchedFields,P))){const Ie=te(Be(t.touchedFields,P),Ne.argA,Ne.argB);ce&&nn(t.touchedFields,P,Ie)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=yo(r,i)),h.state.next({name:P,isDirty:S(P,q),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else nn(i,P,q)},T=(P,q)=>{nn(t.errors,P,q),h.state.next({errors:t.errors})},F=P=>{t.errors=P,h.state.next({errors:t.errors,isValid:!1})},re=(P,q,te,Ne)=>{const ce=Be(s,P);if(ce){const de=Be(i,P,Nn(te)?Be(r,P):te);Nn(de)||Ne&&Ne.defaultChecked||q?nn(i,P,q?de:rg(ce._f)):De(P,de),o.mount&&v()}},ee=(P,q,te,Ne,ce)=>{let de=!1,Ie=!1;const ze={name:P};if(!e.disabled){if(!te||Ne){(d.isDirty||f.isDirty)&&(Ie=t.isDirty,t.isDirty=ze.isDirty=S(),de=Ie!==ze.isDirty);const et=Sr(Be(r,P),q);Ie=!!Be(t.dirtyFields,P),et?yn(t.dirtyFields,P):nn(t.dirtyFields,P,!0),ze.dirtyFields=t.dirtyFields,de=de||(d.dirtyFields||f.dirtyFields)&&Ie!==!et}if(te){const et=Be(t.touchedFields,P);et||(nn(t.touchedFields,P,te),ze.touchedFields=t.touchedFields,de=de||(d.touchedFields||f.touchedFields)&&et!==te)}de&&ce&&h.state.next(ze)}return de?ze:{}},M=(P,q,te,Ne)=>{const ce=Be(t.errors,P),de=(d.isValid||f.isValid)&&Hs(q)&&t.isValid!==q;if(e.delayError&&te?(u=w(()=>T(P,te)),u(e.delayError)):(clearTimeout(m),u=null,te?nn(t.errors,P,te):yn(t.errors,P)),(te?!Sr(ce,te):ce)||!rs(Ne)||de){const Ie={...Ne,...de&&Hs(q)?{isValid:q}:{},errors:t.errors,name:P};t={...t,...Ie},h.state.next(Ie)}},A=async P=>{C(P,!0);const q=await e.resolver(i,e.context,jC(P||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return C(P),q},N=async P=>{const{errors:q}=await A(P);if(P)for(const te of P){const Ne=Be(q,te);Ne?nn(t.errors,te,Ne):yn(t.errors,te)}else t.errors=q;return q},V=async(P,q,te={valid:!0})=>{for(const Ne in P){const ce=P[Ne];if(ce){const{_f:de,...Ie}=ce;if(de){const ze=l.array.has(de.name),et=ce._f&&RC(ce._f);et&&d.validatingFields&&C([de.name],!0);const Ee=await ug(ce,l.disabled,i,y,e.shouldUseNativeValidation&&!q,ze);if(et&&d.validatingFields&&C([de.name]),Ee[de.name]&&(te.valid=!1,q))break;!q&&(Be(Ee,de.name)?ze?OC(t.errors,Ee,de.name):nn(t.errors,de.name,Ee[de.name]):yn(t.errors,de.name))}!rs(Ie)&&await V(Ie,q,te)}}return te.valid},j=()=>{for(const P of l.unMount){const q=Be(s,P);q&&(q._f.refs?q._f.refs.every(te=>!cm(te)):!cm(q._f.ref))&&at(P)}l.unMount=new Set},S=(P,q)=>!e.disabled&&(P&&q&&nn(i,P,q),!Sr(Ft(),r)),I=(P,q,te)=>wC(P,l,{...o.mount?i:Nn(q)?r:cs(P)?{[P]:q}:q},te,q),k=P=>_f(Be(o.mount?i:r,P,e.shouldUnregister?Be(r,P,[]):[])),De=(P,q,te={})=>{const Ne=Be(s,P);let ce=q;if(Ne){const de=Ne._f;de&&(!de.disabled&&nn(i,P,d0(q,de)),ce=zc(de.ref)&&Jn(q)?"":q,c0(de.ref)?[...de.ref.options].forEach(Ie=>Ie.selected=ce.includes(Ie.value)):de.refs?Dl(de.ref)?de.refs.forEach(Ie=>{(!Ie.defaultChecked||!Ie.disabled)&&(Array.isArray(ce)?Ie.checked=!!ce.find(ze=>ze===Ie.value):Ie.checked=ce===Ie.value||!!ce)}):de.refs.forEach(Ie=>Ie.checked=Ie.value===ce):kf(de.ref)?de.ref.value="":(de.ref.value=ce,de.ref.type||h.state.next({name:P,values:Ln(i)})))}(te.shouldDirty||te.shouldTouch)&&ee(P,ce,te.shouldTouch,te.shouldDirty,!0),te.shouldValidate&&zt(P)},qe=(P,q,te)=>{for(const Ne in q){if(!q.hasOwnProperty(Ne))return;const ce=q[Ne],de=P+"."+Ne,Ie=Be(s,de);(l.array.has(P)||kn(ce)||Ie&&!Ie._f)&&!yi(ce)?qe(de,ce,te):De(de,ce,te)}},he=(P,q,te={})=>{const Ne=Be(s,P),ce=l.array.has(P),de=Ln(q);nn(i,P,de),ce?(h.array.next({name:P,values:Ln(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&te.shouldDirty&&h.state.next({name:P,dirtyFields:yo(r,i),isDirty:S(P,de)})):Ne&&!Ne._f&&!Jn(de)?qe(P,de,te):De(P,de,te),ag(P,l)&&h.state.next({...t,name:P}),h.state.next({name:o.mount?P:void 0,values:Ln(i)})},Ue=async P=>{o.mount=!0;const q=P.target;let te=q.name,Ne=!0;const ce=Be(s,te),de=et=>{Ne=Number.isNaN(et)||yi(et)&&isNaN(et.getTime())||Sr(et,Be(i,te,et))},Ie=ig(e.mode),ze=ig(e.reValidateMode);if(ce){let et,Ee;const Un=q.type?rg(ce._f):_C(P),Bt=P.type===Zh.BLUR||P.type===Zh.FOCUS_OUT,ne=!BC(ce._f)&&!e.resolver&&!Be(t.errors,te)&&!ce._f.deps||MC(Bt,Be(t.touchedFields,te),t.isSubmitted,ze,Ie),Xe=ag(te,l,Bt);nn(i,te,Un),Bt?(!q||!q.readOnly)&&(ce._f.onBlur&&ce._f.onBlur(P),u&&u(0)):ce._f.onChange&&ce._f.onChange(P);const O=ee(te,Un,Bt),xe=!rs(O)||Xe;if(!Bt&&h.state.next({name:te,type:P.type,values:Ln(i)}),ne)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?Bt&&v():Bt||v()),xe&&h.state.next({name:te,...Xe?{}:O});if(!Bt&&Xe&&h.state.next({...t}),e.resolver){const{errors:ke}=await A([te]);if(de(Un),Ne){const Le=lg(t.errors,s,te),ue=lg(ke,s,Le.name||te);et=ue.error,te=ue.name,Ee=rs(ke)}}else C([te],!0),et=(await ug(ce,l.disabled,i,y,e.shouldUseNativeValidation))[te],C([te]),de(Un),Ne&&(et?Ee=!1:(d.isValid||f.isValid)&&(Ee=await V(s,!0)));Ne&&(ce._f.deps&&(!Array.isArray(ce._f.deps)||ce._f.deps.length>0)&&zt(ce._f.deps),M(te,Ee,et,O))}},ht=(P,q)=>{if(Be(t.errors,q)&&P.focus)return P.focus(),1},zt=async(P,q={})=>{let te,Ne;const ce=qa(P);if(e.resolver){const de=await N(Nn(P)?P:ce);te=rs(de),Ne=P?!ce.some(Ie=>Be(de,Ie)):te}else P?(Ne=(await Promise.all(ce.map(async de=>{const Ie=Be(s,de);return await V(Ie&&Ie._f?{[de]:Ie}:Ie)}))).every(Boolean),!(!Ne&&!t.isValid)&&v()):Ne=te=await V(s);return h.state.next({...!cs(P)||(d.isValid||f.isValid)&&te!==t.isValid?{}:{name:P},...e.resolver||!P?{isValid:te}:{},errors:t.errors}),q.shouldFocus&&!Ne&&$a(s,ht,P?ce:l.mount),Ne},Ft=(P,q)=>{let te={...o.mount?i:r};return q&&(te=l0(q.dirtyFields?t.dirtyFields:t.touchedFields,te)),Nn(P)?te:cs(P)?Be(te,P):P.map(Ne=>Be(te,Ne))},ae=(P,q)=>({invalid:!!Be((q||t).errors,P),isDirty:!!Be((q||t).dirtyFields,P),error:Be((q||t).errors,P),isValidating:!!Be(t.validatingFields,P),isTouched:!!Be((q||t).touchedFields,P)}),$e=P=>{P&&qa(P).forEach(q=>yn(t.errors,q)),h.state.next({errors:P?t.errors:{}})},me=(P,q,te)=>{const Ne=(Be(s,P,{_f:{}})._f||{}).ref,ce=Be(t.errors,P)||{},{ref:de,message:Ie,type:ze,...et}=ce;nn(t.errors,P,{...et,...q,ref:Ne}),h.state.next({name:P,errors:t.errors,isValid:!1}),te&&te.shouldFocus&&Ne&&Ne.focus&&Ne.focus()},Re=(P,q)=>Vs(P)?h.state.subscribe({next:te=>"values"in te&&P(I(void 0,q),te)}):I(P,q,!0),Qe=P=>h.state.subscribe({next:q=>{HC(P.name,q.name,P.exact)&&UC(q,P.formState||d,It,P.reRenderRoot)&&P.callback({values:{...i},...t,...q,defaultValues:r})}}).unsubscribe,vt=P=>(o.mount=!0,f={...f,...P.formState},Qe({...P,formState:f})),at=(P,q={})=>{for(const te of P?qa(P):l.mount)l.mount.delete(te),l.array.delete(te),q.keepValue||(yn(s,te),yn(i,te)),!q.keepError&&yn(t.errors,te),!q.keepDirty&&yn(t.dirtyFields,te),!q.keepTouched&&yn(t.touchedFields,te),!q.keepIsValidating&&yn(t.validatingFields,te),!e.shouldUnregister&&!q.keepDefaultValue&&yn(r,te);h.state.next({values:Ln(i)}),h.state.next({...t,...q.keepDirty?{isDirty:S()}:{}}),!q.keepIsValid&&v()},wt=({disabled:P,name:q})=>{(Hs(P)&&o.mount||P||l.disabled.has(q))&&(P?l.disabled.add(q):l.disabled.delete(q))},ot=(P,q={})=>{let te=Be(s,P);const Ne=Hs(q.disabled)||Hs(e.disabled);return nn(s,P,{...te||{},_f:{...te&&te._f?te._f:{ref:{name:P}},name:P,mount:!0,...q}}),l.mount.add(P),te?wt({disabled:Hs(q.disabled)?q.disabled:e.disabled,name:P}):re(P,!0,q.value),{...Ne?{disabled:q.disabled||e.disabled}:{},...e.progressive?{required:!!q.required,min:va(q.min),max:va(q.max),minLength:va(q.minLength),maxLength:va(q.maxLength),pattern:va(q.pattern)}:{},name:P,onChange:Ue,onBlur:Ue,ref:ce=>{if(ce){ot(P,q),te=Be(s,P);const de=Nn(ce.value)&&ce.querySelectorAll&&ce.querySelectorAll("input,select,textarea")[0]||ce,Ie=SC(de),ze=te._f.refs||[];if(Ie?ze.find(et=>et===de):de===te._f.ref)return;nn(s,P,{_f:{...te._f,...Ie?{refs:[...ze.filter(cm),de,...Array.isArray(Be(r,P))?[{}]:[]],ref:{type:de.type,name:P}}:{ref:de}}}),re(P,!1,void 0,de)}else te=Be(s,P,{}),te._f&&(te._f.mount=!1),(e.shouldUnregister||q.shouldUnregister)&&!(kC(l.array,P)&&o.action)&&l.unMount.add(P)}}},ft=()=>e.shouldFocusError&&$a(s,ht,l.mount),fn=P=>{Hs(P)&&(h.state.next({disabled:P}),$a(s,(q,te)=>{const Ne=Be(s,te);Ne&&(q.disabled=Ne._f.disabled||P,Array.isArray(Ne._f.refs)&&Ne._f.refs.forEach(ce=>{ce.disabled=Ne._f.disabled||P}))},0,!1))},K=(P,q)=>async te=>{let Ne;te&&(te.preventDefault&&te.preventDefault(),te.persist&&te.persist());let ce=Ln(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:de,values:Ie}=await A();t.errors=de,ce=Ln(Ie)}else await V(s);if(l.disabled.size)for(const de of l.disabled)yn(ce,de);if(yn(t.errors,"root"),rs(t.errors)){h.state.next({errors:{}});try{await P(ce,te)}catch(de){Ne=de}}else q&&await q({...t.errors},te),ft(),setTimeout(ft);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:rs(t.errors)&&!Ne,submitCount:t.submitCount+1,errors:t.errors}),Ne)throw Ne},Pe=(P,q={})=>{Be(s,P)&&(Nn(q.defaultValue)?he(P,Ln(Be(r,P))):(he(P,q.defaultValue),nn(r,P,Ln(q.defaultValue))),q.keepTouched||yn(t.touchedFields,P),q.keepDirty||(yn(t.dirtyFields,P),t.isDirty=q.defaultValue?S(P,Ln(Be(r,P))):S()),q.keepError||(yn(t.errors,P),d.isValid&&v()),h.state.next({...t}))},He=(P,q={})=>{const te=P?Ln(P):r,Ne=Ln(te),ce=rs(P),de=ce?r:Ne;if(q.keepDefaultValues||(r=te),!q.keepValues){if(q.keepDirtyValues){const Ie=new Set([...l.mount,...Object.keys(yo(r,i))]);for(const ze of Array.from(Ie))Be(t.dirtyFields,ze)?nn(de,ze,Be(i,ze)):he(ze,Be(de,ze))}else{if(vf&&Nn(P))for(const Ie of l.mount){const ze=Be(s,Ie);if(ze&&ze._f){const et=Array.isArray(ze._f.refs)?ze._f.refs[0]:ze._f.ref;if(zc(et)){const Ee=et.closest("form");if(Ee){Ee.reset();break}}}}if(q.keepFieldsRef)for(const Ie of l.mount)he(Ie,Be(de,Ie));else s={}}i=e.shouldUnregister?q.keepDefaultValues?Ln(r):{}:Ln(de),h.array.next({values:{...de}}),h.state.next({values:{...de}})}l={mount:q.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!q.keepIsValid||!!q.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:q.keepSubmitCount?t.submitCount:0,isDirty:ce?!1:q.keepDirty?t.isDirty:!!(q.keepDefaultValues&&!Sr(P,r)),isSubmitted:q.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ce?{}:q.keepDirtyValues?q.keepDefaultValues&&i?yo(r,i):t.dirtyFields:q.keepDefaultValues&&P?yo(r,P):q.keepDirty?t.dirtyFields:{},touchedFields:q.keepTouched?t.touchedFields:{},errors:q.keepErrors?t.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Se=(P,q)=>He(Vs(P)?P(i):P,q),Ye=(P,q={})=>{const te=Be(s,P),Ne=te&&te._f;if(Ne){const ce=Ne.refs?Ne.refs[0]:Ne.ref;ce.focus&&(ce.focus(),q.shouldSelect&&Vs(ce.select)&&ce.select())}},It=P=>{t={...t,...P}},dt={control:{register:ot,unregister:at,getFieldState:ae,handleSubmit:K,setError:me,_subscribe:Qe,_runSchema:A,_focusError:ft,_getWatch:I,_getDirty:S,_setValid:v,_setFieldArray:B,_setDisabledField:wt,_setErrors:F,_getFieldArray:k,_reset:He,_resetDefaultValues:()=>Vs(e.defaultValues)&&e.defaultValues().then(P=>{Se(P,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:fn,_subjects:h,_proxyFormState:d,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(P){o=P},get _defaultValues(){return r},get _names(){return l},set _names(P){l=P},get _formState(){return t},get _options(){return e},set _options(P){e={...e,...P}}},subscribe:vt,trigger:zt,register:ot,handleSubmit:K,watch:Re,setValue:he,getValues:Ft,reset:Se,resetField:Pe,clearErrors:$e,unregister:at,setError:me,setFocus:Ye,getFieldState:ae};return{...dt,formControl:dt}}function Af(n={}){const e=mt.useRef(void 0),t=mt.useRef(void 0),[s,r]=mt.useState({isDirty:!1,isValidating:!1,isLoading:Vs(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:Vs(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:s},n.defaultValues&&!Vs(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=$C(n);e.current={...l,formState:s}}const i=e.current.control;return i._options=n,CC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),mt.useEffect(()=>i._disableForm(n.disabled),[i,n.disabled]),mt.useEffect(()=>{n.mode&&(i._options.mode=n.mode),n.reValidateMode&&(i._options.reValidateMode=n.reValidateMode)},[i,n.mode,n.reValidateMode]),mt.useEffect(()=>{n.errors&&(i._setErrors(n.errors),i._focusError())},[i,n.errors]),mt.useEffect(()=>{n.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,n.shouldUnregister]),mt.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),mt.useEffect(()=>{n.values&&!Sr(n.values,t.current)?(i._reset(n.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=n.values,r(o=>({...o}))):i._resetDefaultValues()},[i,n.values]),mt.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=VC(s,i),e.current}const mg=["","","","","","",""],p0=({event:n,slotInfo:e,defaultProjectName:t,onClose:s,onSave:r,onDelete:i})=>{const[o,l]=E.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:h},reset:y}=Af({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:w}=$r(),[v,C]=E.useState([]),[B,T]=E.useState(""),[F,re]=E.useState(!1),[ee,M]=E.useState(""),[A,N]=E.useState(9),[V,j]=E.useState(0),[S,I]=E.useState(""),k=f("projectId");E.useEffect(()=>{if(k){const ae=w.find($e=>$e.id===k||$e.id===parseInt(k)||$e.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",v)}},[k,w,v]),E.useEffect(()=>{console.log(" Modal mount - initializing states"),C([]),I(""),T("")},[]),E.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!n,eventId:n==null?void 0:n.id,hasSlotInfo:!!e,hasMergedEvents:!!(n!=null&&n.mergedEventIds)}),n&&n.id){console.log(" ScheduleModal processing event:",{title:n.title,projectId:n.projectId,projectName:n.projectName,start:n.start,assignedTo:n.assignedTo,time:n.time});const ae=n.originalTitle||n.title,$e=/ - (|) \d{1,2}$/,me=ae.replace($e,"");if(d("title",me,{shouldValidate:!1,shouldDirty:!1}),d("date",Ot(n.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",n.description||"",{shouldValidate:!1,shouldDirty:!1}),n.projectId&&n.projectId!==""&&n.projectId!=="undefined")console.log(" Setting projectId from event:",n.projectId),d("projectId",n.projectId,{shouldValidate:!1,shouldDirty:!1}),I("");else if(n.projectName){const Qe=w.find(vt=>vt.name===n.projectName);console.log(" Finding project by name:",n.projectName,"found:",Qe),Qe?(console.log(" Setting projectId from found project:",Qe.id),d("projectId",Qe.id,{shouldValidate:!1,shouldDirty:!1}),I("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I("");const Re=n.assignedTo||n.attendees||[];if(console.log(" Setting selectedMembers to:",Re),C(Array.isArray(Re)?Re:[]),n.time&&n.time!=="-"){console.log(" Setting time from event:",{eventTime:n.time,parsedHours:n.time.split(":")[0],parsedMinutes:n.time.split(":")[1]}),re(!0);const[Qe,vt]=n.time.split(":"),at=parseInt(Qe,10),wt=parseInt(vt,10);at>=12?(M(""),N(at===12?12:at-12)):(M(""),N(at===0?12:at)),j(wt),console.log(" Time state set:",{hasTime:!0,period:at>=12?"":"",hour:at>=12?at===12?12:at-12:at===0?12:at,minute:wt})}else console.log(" No time in event, setting hasTime to false"),re(!1),M(""),N(9),j(0)}else if(e&&!n&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:Ot(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),C([]),I(""),t)){const ae=w.find($e=>$e.name===t);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[n==null?void 0:n.id]);const De=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",v),C($e=>{console.log(" Previous members in setState:",$e);const me=$e.includes(ae)?$e.filter(Re=>Re!==ae):[...$e,ae];return console.log(" Updated members after toggle:",me),me})},qe=()=>{const ae="HV LAB";v.includes(ae)?C($e=>$e.filter(me=>me!==ae)):C($e=>[...$e.filter(me=>me!==""),ae])},he=()=>{const ae="";v.includes(ae)?C($e=>$e.filter(me=>me!==ae)):C($e=>[...$e,ae])},Ue=()=>{const ae="";v.includes(ae)?C($e=>$e.filter(me=>me!==ae)):C($e=>[...$e,ae])},ht=()=>{B.trim()&&!v.includes(B.trim())&&(C(ae=>[...ae,B.trim()]),T(""))},zt=ae=>{C($e=>$e.filter(me=>me!==ae))},Ft=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",v),console.log(" hasTime state:",F),console.log(" timePeriod:",ee,"timeHour:",A,"timeMinute:",V),console.log(" Available projects:",w.map(ot=>({id:ot.id,name:ot.name,idType:typeof ot.id}))),console.log(" Merged event IDs:",n==null?void 0:n.mergedEventIds);const $e=/ - (|) \d{1,2}$/,me=ae.title.replace($e,"").trim();let Re="",Qe="";if(ae.projectId){const ot=w.find(ft=>ft.id===ae.projectId||ft.id===parseInt(ae.projectId)||ft.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",ot),Re=(ot==null?void 0:ot.name)||"",Qe=ae.projectId}else Re="",Qe="";console.log(" Final projectId:",Qe,"projectName:",Re,"cleanedTitle:",me);const vt=new Date(ae.date);let at="-";if(F){let ot=A;ee===""&&A!==12?ot=A+12:ee===""&&A===12&&(ot=0),at=`${ot.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`,console.log(" Time calculated:",at)}else console.log(" No time set (hasTime is false)");const wt={...n,title:me,start:vt,end:vt,projectId:Qe,projectName:Re,assignedTo:v,description:ae.description||"",time:at,mergedEventIds:n==null?void 0:n.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",wt);try{await r(wt),console.log(" onSave completed successfully")}catch(ot){throw console.error(" onSave failed:",ot),ot}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Ft),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),w.filter(ae=>n!=null&&n.isASVisit?!0:ae.status!=="completed").map(ae=>a.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>re(!F),className:`px-3 py-1.5 text-xs rounded border transition-colors ${F?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),F&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:A,onChange:ae=>N(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:V,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:qe,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:he,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:Ue,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),mg.map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>De(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(ae=>!mg.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>zt(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:ae=>T(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),ht())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ht,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:n&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(n.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(ki,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:s,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},id=n=>{if(!n||n==="-")return"";const[e,t]=n.split(":"),s=parseInt(e,10),r=parseInt(t,10),i=s>=12?"":"",o=s%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},Kc=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],za=n=>{if(!n)return n;const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of Kc)if(s===r)return t.slice(0,-1).join(" ").trim()}for(const s of Kc)if(e.endsWith(s))return e.substring(0,e.length-s.length).trim()||e;return e},Wl=n=>{const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of Kc)if(s===r)return r}for(const s of Kc)if(e.endsWith(s))return s;return""},zC=["","","","","","",""],WC=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],um=["","","/","","","","","","","","","","","","",""],KC={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},GC={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},dg=zC,QC=()=>{const{schedules:n,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:s}=$r(),{user:r}=Kr(),[i,o]=E.useState(!1),l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...dg.filter(d=>d!==l)]:dg,m=d=>{const f=n.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),h=v=>{const C=new Set;return v.filter(B=>{const F=`${Ot(new Date(B.start),"yyyy-MM-dd")}|${B.project}|${B.title}`;return C.has(F)?!1:(C.add(F),!0)})},y=h(f.filter(v=>tp(new Date(v.start)))),w=h(f.filter(v=>Yx(new Date(v.start))&&!tp(new Date(v.start))).sort((v,C)=>new Date(v.start).getTime()-new Date(C.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:w,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=m(d),y=f.length+h.length,w=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${w?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:113,columnNumber:21},void 0),w&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:112,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[w&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV(No,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${w&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:131,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Pg,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:141,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:142,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:140,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((C,B)=>{const T=B.project||"-";return C[T]||(C[T]=[]),C[T].push(B),C},{});return Object.entries(v).map(([C,B])=>{const T=d===l;return a.jsxDEV("div",{className:`border-l-3 ${T?"border-gray-400":"border-gray-900"} ${T?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${T?"bg-amber-100":"bg-gray-100"} border-b ${T?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:164,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:163,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:B.map(F=>{const re=F.time&&F.time!=="-"?` - ${id(F.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",F.title,re]},F.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:31},void 0)]},C,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:159,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:19},void 0),h.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Ux,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:188,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:189,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:187,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((C,B)=>{const T=Ot(new Date(B.start),"MM.dd",{locale:xn}),F=B.project||"-",re=`${T}|${F}`;return C[re]||(C[re]={date:T,project:F,schedules:[]}),C[re].schedules.push(B),C},{});return Object.values(v).map(({date:C,project:B,schedules:T})=>{const re=T.length>0&&Qx(new Date(T[0].start))?`${C} ()`:C;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:B},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:211,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:re},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:212,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:210,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:T.map(ee=>{const M=ee.time&&ee.time!=="-"?` - ${id(ee.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",ee.title,M]},ee.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:214,columnNumber:31},void 0)]},`${C}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:209,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:191,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:186,columnNumber:19},void 0),y===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:234,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:109,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:101,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:100,columnNumber:7},void 0),i&&a.jsxDEV(p0,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await s(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:246,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:98,columnNumber:5},void 0)},Cu=()=>{const{user:n}=Kr(),{projects:e}=$r();return E.useMemo(()=>n?n.name===""?e.filter(s=>{const i=(s.manager?s.manager.split(",").map(l=>l.trim()):[]).includes(""),o=s.team&&Array.isArray(s.team)&&s.team.includes("");return i||o}):e:[],[n,e])},YC=({value:n,detailValue:e="",onChange:t,onDetailChange:s,placeholder:r=" ",error:i})=>{const[o,l]=E.useState(!1),[u,m]=E.useState(n),[d,f]=E.useState(e),h=E.useRef(null);E.useEffect(()=>{const B=T=>{h.current&&!h.current.contains(T.target)&&l(!1)};return o&&document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[o]),E.useEffect(()=>{m(n)},[n]),E.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((B,T)=>{if(window.daum&&window.daum.Postcode){B(!0);return}const F=document.createElement("script");F.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",F.async=!0,F.onload=()=>B(!0),F.onerror=()=>T(new Error("Kakao Postcode   ")),document.head.appendChild(F)}),w=B=>{const T=B.roadAddr||B.jibunAddr;m(T),t(T,d),l(!1)},v=B=>{const T=B.target.value;f(T),s&&s(T),u&&t(u,T)},C=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(B){const T={roadAddr:B.roadAddress,jibunAddr:B.jibunAddress||B.autoJibunAddress||"",zipNo:B.zonecode,bdNm:B.buildingName,siNm:B.sido,sggNm:B.sigungu,emdNm:B.bname,rn:B.roadname};w(T)}}).open()}catch(B){console.error("  :",B),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>C(),onChange:B=>{m(B.target.value),t(B.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(Lg,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:C,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},fg=["","","","","","",""],XC=({project:n,onClose:e,onSave:t})=>{const{register:s,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=Af({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=E.useState([]),[d,f]=E.useState(""),[h,y]=E.useState(""),[w,v]=E.useState(""),[C,B]=E.useState(!1);E.useEffect(()=>{var M;if(n){const A=n.location?n.location.split(","):["",""],N=((M=A[0])==null?void 0:M.trim())||n.location||"",V=A.length>1?A.slice(1).join(",").trim():"";o({name:n.name,client:n.client||"",location:N,detailLocation:V,startDate:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:"",endDate:n.endDate?new Date(n.endDate).toISOString().split("T")[0]:""}),y(N),v(V);const j=n.manager?n.manager.split(",").map(S=>S.trim()).filter(S=>S&&S!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),v(""),m([])},[n,o]);const T=M=>{m(A=>A.includes(M)?A.filter(N=>N!==M):[...A,M])},F=()=>{d.trim()&&!u.includes(d.trim())&&(m(M=>[...M,d.trim()]),f(""))},re=M=>{m(A=>A.filter(N=>N!==M))},ee=async M=>{if(C)return;B(!0),console.log(" ProjectModal onSubmit - Raw form data:",M);const A=h&&w?`${h}, ${w}`:h||M.location,N={name:M.name,client:M.client,location:A,manager:u.join(", "),contractAmount:(n==null?void 0:n.contractAmount)??0,spent:(n==null?void 0:n.spent)??0,status:(n==null?void 0:n.status)??"planning",progress:(n==null?void 0:n.progress)??0,description:(n==null?void 0:n.description)??"",meetingNotes:(n==null?void 0:n.meetingNotes)??[],customerRequests:(n==null?void 0:n.customerRequests)??[],entrancePassword:(n==null?void 0:n.entrancePassword)??"",sitePassword:(n==null?void 0:n.sitePassword)??""};if(M.startDate&&M.startDate!=="")N.startDate=M.startDate,console.log(" Setting startDate from form:",M.startDate);else if(n!=null&&n.startDate){const V=typeof n.startDate=="string"&&n.startDate.includes("T")?n.startDate.split("T")[0]:n.startDate;N.startDate=V,console.log(" Keeping existing startDate:",N.startDate)}if(M.endDate&&M.endDate!=="")N.endDate=M.endDate,console.log(" Setting endDate from form:",M.endDate);else if(n!=null&&n.endDate){const V=typeof n.endDate=="string"&&n.endDate.includes("T")?n.endDate.split("T")[0]:n.endDate;N.endDate=V,console.log(" Keeping existing endDate:",N.endDate)}console.log(" ProjectModal onSubmit - Final formData:",N);try{await t(N)}catch(V){throw B(!1),V}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(ee),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...s("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...s("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(YC,{value:h,detailValue:w,onChange:(M,A)=>{y(M),v(A||""),i("location",M),i("detailLocation",A||"")},onDetailChange:M=>{v(M),i("detailLocation",M)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...s("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...s("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[fg.map(M=>a.jsxDEV("button",{type:"button",onClick:()=>T(M),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(M)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:M},M,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(M=>!fg.includes(M)).map(M=>a.jsxDEV("button",{type:"button",onClick:()=>re(M),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[M," "]},M,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyPress:M=>{M.key==="Enter"&&(M.preventDefault(),F())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:F,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:C,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:C?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},JC=({projectName:n,meetingNotes:e,onClose:t,onSave:s,onDelete:r})=>{const[i,o]=E.useState(""),[l,u]=E.useState(new Date().toISOString().split("T")[0]),[m,d]=E.useState(!1),[f,h]=E.useState(!1),y=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},w=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}h(!0);try{await s(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},C=B=>{window.confirm("   ?")&&r(B)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:B=>B.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:B=>u(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:B=>o(B.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:w,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(B=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Ot(new Date(B.date),"yyyy.MM.dd (eee)",{locale:xn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>C(B.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},ZC=({projectName:n,customerRequests:e,onClose:t,onSave:s,onToggleComplete:r,onDelete:i})=>{const[o,l]=E.useState(""),[u,m]=E.useState(new Date().toISOString().split("T")[0]),[d,f]=E.useState(!1),[h,y]=E.useState(!1),w=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!h){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}y(!0);try{await s(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},C=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},B=ee=>{window.confirm("  ?")&&i(ee)},T=ee=>{r(ee)},F=e.filter(ee=>!ee.completed),re=e.filter(ee=>ee.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:ee=>ee.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:w,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:ee=>m(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:ee=>l(ee.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:C,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[F.map(ee=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>T(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(Hx,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Ot(new Date(ee.createdAt),"yyyy.MM.dd",{locale:xn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),re.map(ee=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>T(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(Mx,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ot(new Date(ee.createdAt),"yyyy.MM.dd",{locale:xn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},ew=({projectName:n,entrancePassword:e,sitePassword:t,onClose:s,onSave:r})=>{const[i,o]=E.useState(e||""),[l,u]=E.useState(t||""),[m,d]=E.useState(!1),[f,h]=E.useState(!1),y=()=>{d(!0)},w=async()=>{if(!f){h(!0);try{await r(i,l),d(!1)}finally{h(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:C=>C.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:C=>o(C.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:C=>u(C.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:w,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:s,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},tw=({projectName:n,onClose:e})=>{var o;const[t,s]=E.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>s({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>s({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>s({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>s({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>s({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>s({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&s({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>s({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(jg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[Ot(new Date(t.startDate),"yyyy",{locale:xn}),"",Ot(new Date(t.startDate),"MM",{locale:xn}),"",Ot(new Date(t.startDate),"dd",{locale:xn})," ~ ",Ot(new Date(t.endDate),"yyyy",{locale:xn}),"",Ot(new Date(t.endDate),"MM",{locale:xn}),"",Ot(new Date(t.endDate),"dd",{locale:xn})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},nw=()=>{const{loadProjectsFromAPI:n,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:s}=$r(),{user:r}=Kr(),i=Cu(),[o,l]=E.useState("in-progress"),[u,m]=E.useState("grid"),[d,f]=E.useState(!1),[h,y]=E.useState(null),[w,v]=E.useState(!1),[C,B]=E.useState(!1),[T,F]=E.useState(!1),[re,ee]=E.useState(!1),[M,A]=E.useState(null),N=(K,Pe)=>`lastViewed_${r==null?void 0:r.id}_${K}_${Pe}`,V=(K,Pe)=>{const He=N(K,Pe),Se=localStorage.getItem(He);return Se?parseInt(Se,10):0},j=(K,Pe)=>{const He=N(K,Pe);localStorage.setItem(He,Date.now().toString())},S=(K,Pe)=>{const He=V(K.id,Pe);return Pe==="meeting"?(K.meetingNotes||[]).some(Ye=>(Ye.createdAt?new Date(Ye.createdAt).getTime():new Date(Ye.date).getTime())>He):(K.customerRequests||[]).some(Ye=>!Ye.completed)};E.useEffect(()=>{n().catch(K=>{console.error("Failed to load projects:",K),oe.error("   ")})},[n]),E.useEffect(()=>{const K=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",K),()=>window.removeEventListener("headerAddButtonClick",K)},[]);const I=(K,Pe)=>{if(!K||!Pe)return 0;const He=new Date,Se=new Date(K),Ye=new Date(Pe);if(He<Se)return 0;if(He>Ye)return 100;const It=Math.ceil((Ye.getTime()-Se.getTime())/(1e3*60*60*24)),Wt=Math.ceil((He.getTime()-Se.getTime())/(1e3*60*60*24)),dt=Math.round(Wt/It*100);return Math.min(100,Math.max(0,dt))},k=K=>{y(K),f(!0)},De=async(K,Pe)=>{if(window.confirm(`"${Pe}"  ?

    .`))try{await s(K),oe.success(" ")}catch(He){console.error("Failed to delete project:",He),oe.error("  ")}},qe=async K=>{try{if(h)await t(h.id,K),oe.success(" ");else{const Pe={id:"",...K,team:K.team||[]};await e(Pe),oe.success(" "),l(K.status||"planning")}f(!1),y(null)}catch(Pe){console.error("Failed to save project:",Pe),oe.error("  ")}},he=async(K,Pe)=>{try{await t(K,{status:Pe}),oe.success(" ")}catch(He){console.error("Failed to update project status:",He),oe.error("  ")}},Ue=K=>{A(K),v(!0),j(K.id,"meeting")},ht=K=>{A(K),B(!0),j(K.id,"request")},zt=K=>{A(K),F(!0)},Ft=K=>{A(K),ee(!0)},ae=async(K,Pe)=>{if(!M)return;const He=M.entrancePassword,Se=M.sitePassword;A({...M,entrancePassword:K,sitePassword:Pe});try{await t(M.id,{entrancePassword:K,sitePassword:Pe}),oe.success(" ")}catch(Ye){console.error("Failed to save passwords:",Ye),oe.error("  "),A({...M,entrancePassword:He,sitePassword:Se})}},$e=async(K,Pe)=>{if(!M)return;const He={id:Date.now().toString(),content:K,date:Pe,createdAt:new Date},Se=[...M.meetingNotes||[],He];A({...M,meetingNotes:Se});try{await t(M.id,{meetingNotes:Se}),oe.success("  ")}catch(Ye){console.error("Failed to save meeting note:",Ye),oe.error("   "),A({...M,meetingNotes:M.meetingNotes||[]})}},me=async(K,Pe)=>{if(!M)return;const He={id:Date.now().toString(),content:K,completed:!1,createdAt:Pe},Se=[...M.customerRequests||[],He];A({...M,customerRequests:Se});try{await t(M.id,{customerRequests:Se}),oe.success("  ")}catch(Ye){console.error("Failed to save customer request:",Ye),oe.error("   "),A({...M,customerRequests:M.customerRequests||[]})}},Re=async K=>{if(!M)return;const Pe=M.customerRequests||[],He=Pe.map(Se=>Se.id===K?{...Se,completed:!Se.completed}:Se);A({...M,customerRequests:He});try{await t(M.id,{customerRequests:He}),oe.success("  ")}catch(Se){console.error("Failed to toggle request:",Se),oe.error("  "),A({...M,customerRequests:Pe})}},Qe=async K=>{if(!M)return;const Pe=M.meetingNotes||[],He=Pe.filter(Se=>Se.id!==K);A({...M,meetingNotes:He});try{await t(M.id,{meetingNotes:He}),oe.success("  ")}catch(Se){console.error("Failed to delete meeting note:",Se),oe.error(" "),A({...M,meetingNotes:Pe})}},vt=async K=>{if(!M)return;const Pe=M.customerRequests||[],He=Pe.filter(Se=>Se.id!==K);A({...M,customerRequests:He});try{await t(M.id,{customerRequests:He}),oe.success("  ")}catch(Se){console.error("Failed to delete customer request:",Se),oe.error(" "),A({...M,customerRequests:Pe})}},at=({project:K})=>{const He={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[K.status];return a.jsxDEV("select",{value:K.status,onChange:Se=>he(K.id,Se.target.value),className:Ds("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",He.color),onClick:Se=>Se.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},ot=(()=>{let K=i;return o!=="all"&&(K=K.filter(Pe=>Pe.status===o)),r!=null&&r.name&&(K=[...K].sort((Pe,He)=>{var It,Wt;const Se=Pe.manager===r.name||((It=Pe.team)==null?void 0:It.includes(r.name)),Ye=He.manager===r.name||((Wt=He.team)==null?void 0:Wt.includes(r.name));return Se&&!Ye?-1:!Se&&Ye?1:0})),K})(),ft={planning:i.filter(K=>K.status==="planning").length,inProgress:i.filter(K=>K.status==="in-progress").length,completed:i.filter(K=>K.status==="completed").length,onHold:i.filter(K=>K.status==="on-hold").length},fn=({project:K})=>{var He,Se,Ye;const Pe=I(K.startDate,K.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ft(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(at,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.startDate&&K.endDate?`${Ot(K.startDate,"MM.dd (eee)",{locale:xn})} - ${Ot(K.endDate,"MM.dd (eee)",{locale:xn})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>zt(K),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>Ue(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((He=K.meetingNotes)==null?void 0:He.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Se=K.meetingNotes)==null?void 0:Se.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),S(K,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),K.meetingNotes&&K.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Ye=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Ye.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var dt;const It=((dt=K.customerRequests)==null?void 0:dt.filter(P=>!P.completed))||[],Wt=It[It.length-1];return a.jsxDEV("div",{onClick:()=>ht(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",It.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",It.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),S(K,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Wt?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Wt.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>De(K.id,K.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ft.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ft.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ft.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(K=>a.jsxDEV("button",{onClick:()=>l(K.id),className:Ds("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===K.id?`border-gray-700 ${K.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[K.label,a.jsxDEV("span",{className:Ds("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===K.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:K.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Ds("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Ds("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV(No,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:ot.map(K=>a.jsxDEV(fn,{project:K},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:ot.map(K=>{var He,Se,Ye,It;const Pe=I(K.startDate,K.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:K.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:K.startDate&&K.endDate?a.jsxDEV(a.Fragment,{children:[Ot(K.startDate,"yyyy.MM.dd (eee)",{locale:xn})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Ot(K.endDate,"yyyy.MM.dd (eee)",{locale:xn})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ft(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(at,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>zt(K),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>Ue(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((He=K.meetingNotes)==null?void 0:He.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Se=K.meetingNotes)==null?void 0:Se.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),S(K,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Ye=K.meetingNotes)!=null&&Ye.length?((It=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:It.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var P;const Wt=((P=K.customerRequests)==null?void 0:P.filter(q=>!q.completed))||[],dt=Wt[Wt.length-1];return a.jsxDEV("div",{onClick:()=>ht(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Wt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Wt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),S(K,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:dt?dt.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>De(K.id,K.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(XC,{project:h,onClose:()=>{f(!1),y(null)},onSave:qe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),w&&M&&a.jsxDEV(JC,{projectName:M.name,meetingNotes:M.meetingNotes||[],onClose:()=>{v(!1),A(null)},onSave:$e,onDelete:Qe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),C&&M&&a.jsxDEV(ZC,{projectName:M.name,customerRequests:M.customerRequests||[],onClose:()=>{B(!1),A(null)},onSave:me,onToggleComplete:Re,onDelete:vt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),T&&M&&a.jsxDEV(ew,{projectName:M.name,entrancePassword:M.entrancePassword||"",sitePassword:M.sitePassword||"",onClose:()=>{F(!1),A(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),re&&M&&a.jsxDEV(tw,{projectName:M.name,onClose:()=>{ee(!1),A(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var Vf={},h0={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(h0);var Yn=h0.exports,Cf={},g0={exports:{}},y0={exports:{}},b0={exports:{}},N0={exports:{}};(function(n){function e(t){"@babel/helpers - typeof";return n.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(N0);var qo=N0.exports,x0={exports:{}};(function(n){var e=qo.default;function t(s,r){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var o=i.call(s,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(x0);var sw=x0.exports;(function(n){var e=qo.default,t=sw;function s(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(b0);var v0=b0.exports;(function(n){var e=v0;function t(s,r,i){return(r=e(r))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(y0);var _0=y0.exports;(function(n){var e=_0;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function s(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(g0);var Jr=g0.exports,D0={exports:{}},k0={exports:{}};(function(n){function e(t,s){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(s.indexOf(i)!==-1)continue;r[i]=t[i]}return r}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(k0);var rw=k0.exports;(function(n){var e=rw;function t(s,r){if(s==null)return{};var i,o,l=e(s,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(s);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(l[i]=s[i])}return l}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(D0);var wf=D0.exports,E0={exports:{}};(function(n){function e(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(E0);var Ri=E0.exports,A0={exports:{}};(function(n){var e=v0;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function s(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(A0);var Bi=A0.exports,V0={exports:{}},C0={exports:{}};(function(n){function e(t){return n.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(C0);var iw=C0.exports,w0={exports:{}};(function(n){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n.exports=e=function(){return!!t},n.exports.__esModule=!0,n.exports.default=n.exports)()}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(w0);var ow=w0.exports,I0={exports:{}},S0={exports:{}};(function(n){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(S0);var aw=S0.exports;(function(n){var e=qo.default,t=aw;function s(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(I0);var lw=I0.exports;(function(n){var e=iw,t=ow,s=lw;function r(i,o,l){return o=e(o),s(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports})(V0);var $o=V0.exports,T0={exports:{}},P0={exports:{}};(function(n){function e(t,s){return n.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},n.exports.__esModule=!0,n.exports.default=n.exports,e(t,s)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(P0);var cw=P0.exports;(function(n){var e=cw;function t(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),r&&e(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(T0);var zo=T0.exports;const kl=ml(Xx);var Cs={},Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.views=Ro.navigate=void 0;Ro.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};Ro.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var uw=Yn.default;Object.defineProperty(Cs,"__esModule",{value:!0});Cs.views=Cs.dateRangeFormat=Cs.dateFormat=Cs.accessor=Cs.DayLayoutAlgorithmPropType=void 0;var is=uw(Rg),pg=Ro,hg=Object.keys(pg.views).map(function(n){return pg.views[n]});Cs.accessor=is.default.oneOfType([is.default.string,is.default.func]);Cs.dateFormat=is.default.any;Cs.dateRangeFormat=is.default.func;Cs.views=is.default.oneOfType([is.default.arrayOf(is.default.oneOf(hg)),is.default.objectOf(function(n,e){var t=hg.indexOf(e)!==-1&&typeof n[e]=="boolean";if(t)return null;for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return is.default.elementType.apply(is.default,[n,e].concat(r))})]);Cs.DayLayoutAlgorithmPropType=is.default.oneOfType([is.default.oneOf(["overlap","no-overlap"]),is.default.func]);var wu={},Wo={},mw=Yn.default;Object.defineProperty(Wo,"__esModule",{value:!0});Wo.accessor=L0;Wo.wrapAccessor=void 0;var dw=mw(qo);function L0(n,e){var t=null;return typeof e=="function"?t=e(n):typeof e=="string"&&(0,dw.default)(n)==="object"&&n!=null&&e in n&&(t=n[e]),t}Wo.wrapAccessor=function(e){return function(t){return L0(t,e)}};var Ui={},fw=Yn.default;Object.defineProperty(Ui,"__esModule",{value:!0});Ui.DnDContext=void 0;var pw=fw(E);Ui.DnDContext=pw.default.createContext();var Hi=Yn.default;Object.defineProperty(wu,"__esModule",{value:!0});wu.default=void 0;var hw=Hi(Jr),gw=Hi(Ri),yw=Hi(Bi),bw=Hi($o),Nw=Hi(zo),lo=Hi(E),gg=Hi(kl),yg=Wo,xw=Ui,j0=function(n){function e(){var t;(0,gw.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,bw.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,hw.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,Nw.default)(e,n),(0,yw.default)(e,[{key:"renderAnchor",value:function(s){var r=s==="Up"||s==="Down"?"ns":"ew";return lo.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(s)]},lo.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var s=this.props,r=s.event,i=s.type,o=s.continuesPrior,l=s.continuesAfter,u=s.resizable,m=this.props.children;if(r.__isPreview)return lo.default.cloneElement(m,{className:(0,gg.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,y=f?!!(0,yg.accessor)(r,f):!0;if(!y)return m;var w=u&&(h?!!(0,yg.accessor)(r,h):!0);if(w||y){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(w){var C=null,B=null;i==="date"?(C=!o&&this.renderAnchor("Left"),B=!l&&this.renderAnchor("Right")):(C=!o&&this.renderAnchor("Up"),B=!l&&this.renderAnchor("Down")),v.children=lo.default.createElement("div",{className:"rbc-addons-dnd-resizable"},C,m.props.children,B)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,gg.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=lo.default.cloneElement(m,v)}return m}}])}(lo.default.Component);j0.contextType=xw.DnDContext;wu.default=j0;var Iu={},R0={exports:{}};(function(n){var e=qo.default;function t(s,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(n.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,h={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return h;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,h)}for(var y in u)y!=="default"&&{}.hasOwnProperty.call(u,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,y))&&(f.get||f.set)?d(h,y,f):h[y]=u[y]);return h},n.exports.__esModule=!0,n.exports.default=n.exports)(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(R0);var B0=R0.exports;function If(n,e,t,s){if(t===void 0&&(t=!1),s===void 0&&(s=!0),n){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,s),n.dispatchEvent(r)}}function vw(n){var e=ks(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function _w(n,e,t){t===void 0&&(t=5);var s=!1,r=setTimeout(function(){s||If(n,"transitionend",!0)},e+t),i=Gc(n,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),i()}}function Sf(n,e,t,s){t==null&&(t=vw(n)||0);var r=_w(n,t,s),i=Gc(n,"transitionend",e);return function(){r(),i()}}var bg={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Ng(n){var e=n.node,t=n.properties,s=n.duration,r=s===void 0?200:s,i=n.easing,o=n.callback,l=[],u={},m="";Object.keys(t).forEach(function(h){var y=t[h];Jx(h)?m+=h+"("+y+") ":(u[h]=y,l.push(Zx(h)))}),m&&(u.transform=m,l.push("transform"));function d(h){h.target===h.currentTarget&&(ks(e,bg),o&&o.call(this,h))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=Sf(e,d,r);return e.clientLeft,ks(e,u),{cancel:function(){f(),ks(e,bg)}}}function U0(n,e,t,s,r){if(!("nodeType"in n))return Ng(n);if(!e)throw new Error("must include properties to animate");return typeof s=="function"&&(r=s,s=""),Ng({node:n,properties:e,duration:t,easing:s,callback:r})}function H0(n,e,t){if(n){if(typeof t>"u")return n.getAttribute(e);!t&&t!==""?n.removeAttribute(e):n.setAttribute(e,String(t))}}function M0(n){return n?Array.from(n.children):[]}function F0(n){if(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}return null}var Dw=Function.prototype.bind.call(Function.prototype.call,[].slice);function O0(n){return n?Dw(n.childNodes):[]}function q0(n,e){return function(s){var r=s.currentTarget,i=s.target,o=md(r,n);o.some(function(l){return dd(l,i)})&&e.call(this,s)}}function $0(n,e){return n&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(n,e.nextSibling):e.parentNode.appendChild(n),n):null}var kw=/^(?:input|select|textarea|button)$/i;function z0(n){return n?kw.test(n.nodeName):!1}function W0(n){return n?!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length):!1}function K0(n,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var s=[];n;n=n.nextElementSibling)if(n!==e){if(t&&fd(n,t))break;s.push(n)}return s}function G0(n,e){return K0(n,n,e)}function Ew(n,e){var t=null,s=[];for(t=n?n[e]:null;t&&t.nodeType!==9;)s.push(t),t=t[e]||null;return s}function Q0(n){return Ew(n,"parentElement")}function Y0(n,e){return n&&e?(e.firstElementChild?e.insertBefore(n,e.firstElementChild):e.appendChild(n),n):null}function X0(n){return n&&n.parentNode?(n.parentNode.removeChild(n),n):null}function Tf(n,e){var t=ks(n,"position"),s=t==="absolute",r=n.ownerDocument;if(t==="fixed")return r||document;for(;(n=n.parentNode)&&!ev(n);){var i=s&&ks(n,"position")==="static",o=(ks(n,"overflow")||"")+(ks(n,"overflow-y")||"")+ks(n,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||Qc(n)<n.scrollHeight))return n}return r||document}function J0(n,e){var t=Nc(n),s={top:0,left:0};if(n){var r=e||Tf(n),i=tv(r),o=xc(r),l=Qc(r,!0);i||(s=Nc(r)),t={top:t.top-s.top,left:t.left-s.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=pd(function(){return xc(r,o)});return function(){return hd(f)}}}function Z0(n){return K0(n&&n.parentElement?n.parentElement.firstElementChild:null,n)}var Aw=/&nbsp;/gi,Vw=/\xA0/g,Cw=/\s+([^\s])/gm;function ex(n,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var s="";return n&&(s=(n.textContent||"").replace(Aw," ").replace(Vw," "),e&&(s=s.trim()),t&&(s=s.replace(Cw," $1"))),s}function tx(n,e){n.classList?n.classList.toggle(e):gd(n,e)?yd(n,e):bd(n,e)}const ww={addEventListener:Gg,removeEventListener:Kg,triggerEvent:If,animate:U0,filter:q0,listen:Gc,style:ks,getComputedStyle:Wg,attribute:H0,activeElement:zg,ownerDocument:$g,ownerWindow:qg,requestAnimationFrame:pd,cancelAnimationFrame:hd,matches:fd,height:Qc,width:Og,offset:Nc,offsetParent:Fg,position:Mg,contains:dd,scrollbarSize:Hg,scrollLeft:Ug,scrollParent:Tf,scrollTo:J0,scrollTop:xc,querySelectorAll:md,closest:Bg,addClass:bd,removeClass:yd,hasClass:gd,toggleClass:tx,transitionEnd:Sf,childNodes:O0,childElements:M0,nextUntil:G0,parents:Q0,siblings:Z0,clear:F0,insertAfter:$0,isInput:z0,isVisible:W0,prepend:Y0,remove:X0,text:ex},Iw=Object.freeze(Object.defineProperty({__proto__:null,activeElement:zg,addClass:bd,addEventListener:Gg,animate:U0,attribute:H0,cancelAnimationFrame:hd,childElements:M0,childNodes:O0,clear:F0,closest:Bg,contains:dd,default:ww,filter:q0,getComputedStyle:Wg,hasClass:gd,height:Qc,insertAfter:$0,isInput:z0,isVisible:W0,listen:Gc,matches:fd,nextUntil:G0,offset:Nc,offsetParent:Fg,ownerDocument:$g,ownerWindow:qg,parents:Q0,position:Mg,prepend:Y0,querySelectorAll:md,remove:X0,removeClass:yd,removeEventListener:Kg,requestAnimationFrame:pd,scrollLeft:Ug,scrollParent:Tf,scrollTo:J0,scrollTop:xc,scrollbarSize:Hg,siblings:Z0,style:ks,text:ex,toggleClass:tx,transitionEnd:Sf,triggerEvent:If,width:Og},Symbol.toStringTag,{value:"Module"})),Sw=ml(Iw);var od={exports:{}};(function(n,e){e.__esModule=!0,e.default=s;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(r,i){return t(r.querySelectorAll(i))}n.exports=e.default})(od,od.exports);var Tw=od.exports,Ts={};const Pw=ml(nv),Lw=ml(sv),jw=ml(rv);var Ko=Yn.default;Object.defineProperty(Ts,"__esModule",{value:!0});Ts.default=void 0;Ts.getBoundsForNode=ul;Ts.getEventNodeFromPoint=sx;Ts.getShowMoreNodeFromPoint=rx;Ts.isEvent=Fw;Ts.isShowMore=Ow;Ts.objectsCollide=ld;var Rw=Ko(qo),Bw=Ko(Ri),Uw=Ko(Bi),ad=Ko(Pw),nx=Ko(Lw),Hw=Ko(jw);function $n(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,Hw.default)(t,n,e,{passive:!1})}function Mw(n,e,t){return!n||(0,ad.default)(n,document.elementFromPoint(e,t))}function sx(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,nx.default)(r,".rbc-event",n)}function rx(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,nx.default)(r,".rbc-show-more",n)}function Fw(n,e){return!!sx(n,e)}function Ow(n,e){return!!rx(n,e)}function _a(n){var e=n;return n.touches&&n.touches.length&&(e=n.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var xg=5,qw=250,$w=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t.global,r=s===void 0?!1:s,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,Bw.default)(this,n),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=$n("touchmove",function(){},window),this._removeKeyDownListener=$n("keydown",this._keyListener),this._removeKeyUpListener=$n("keyup",this._keyListener),this._removeDropFromOutsideListener=$n("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=$n("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,Uw.default)(n,[{key:"on",value:function(t,s){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(s),{remove:function(){var o=r.indexOf(s);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var s=this._selectRect;return!s||!this.selecting?!1:ld(s,ul(t))}},{key:"filter",value:function(t){var s=this._selectRect;return!s||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,s){var r=this,i=null,o=null,l=null,u=function(h){i=setTimeout(function(){d(),t(h)},r.longPressThreshold),o=$n("touchmove",function(){return d()}),l=$n("touchend",function(){return d()})},m=$n("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return s&&u(s),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,s=$n("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=$n("mousedown",t._handleInitialEvent)}),r=$n("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){s(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var s=_a(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var s=_a(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var s=_a(t),r=s.clientX,i=s.clientY,o=s.pageX,l=s.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!Mw(u,r,i))){if(!this.globalMouse&&u&&!(0,ad.default)(u,t.target)){var f=zw(0),h=f.top,y=f.left,w=f.bottom,v=f.right;if(d=ul(u),m=ld({top:d.top-h,left:d.left-y,bottom:d.bottom+w,right:d.right+v},{top:l,left:o}),!m)return}var C=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(C!==!1)switch(t.type){case"mousedown":this._removeEndListener=$n("mouseup",this._handleTerminatingEvent),this._onEscListener=$n("keydown",this._handleTerminatingEvent),this._removeMoveListener=$n("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=$n("touchend",this._handleTerminatingEvent),this._removeMoveListener=$n("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var s=t.target,r=this.validContainers;return!r||!r.length||!s?!0:r.some(function(i){return!!s.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var s=this.selecting,r=this._selectRect;if(!s&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,ad.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!s&&i?this._handleClickEvent(t):s?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var s=_a(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<qw?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var s=this._initialEventData,r=s.x,i=s.y,o=_a(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),h=Math.min(u,i),y=this.selecting,w=this.isClick(l,u);w&&!y&&!(m||d)||(!y&&!w&&this.emit("selectStart",this._initialEventData),w||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:u,right:f+m,bottom:h+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,s){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=xg&&Math.abs(s-o)<=xg}}])}();function zw(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,Rw.default)(n)!=="object"&&(n={top:n,left:n,right:n,bottom:n}),n}function ld(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=ul(n),r=s.top,i=s.left,o=s.right,l=o===void 0?i:o,u=s.bottom,m=u===void 0?r:u,d=ul(e),f=d.top,h=d.left,y=d.right,w=y===void 0?h:y,v=d.bottom,C=v===void 0?f:v;return!(m-t<f||r+t>C||l-t<h||i+t>w)}function ul(n){if(!n.getBoundingClientRect)return n;var e=n.getBoundingClientRect(),t=e.left+vg("left"),s=e.top+vg("top");return{top:s,left:t,right:(n.offsetWidth||0)+t,bottom:(n.offsetHeight||0)+s}}function vg(n){if(n==="left")return window.pageXOffset||document.body.scrollLeft||0;if(n==="top")return window.pageYOffset||document.body.scrollTop||0}Ts.default=$w;var Su={},Tu=Yn.default;Object.defineProperty(Su,"__esModule",{value:!0});Su.default=void 0;var Ww=Tu(_0),_g=Tu(Jr),Kw=Tu(kl),Da=Tu(E);function Kl(n){return typeof n=="string"?n:n+"%"}function Gw(n){var e=n.style,t=n.className,s=n.event,r=n.accessors,i=n.rtl,o=n.selected,l=n.label,u=n.continuesPrior,m=n.continuesAfter,d=n.getters,f=n.onClick,h=n.onDoubleClick,y=n.isBackgroundEvent,w=n.onKeyPress,v=n.components,C=v.event,B=v.eventWrapper,T=r.title(s),F=r.tooltip(s),re=r.end(s),ee=r.start(s),M=d.eventProp(s,ee,re,o),A=[Da.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Da.default.createElement("div",{key:"2",className:"rbc-event-content"},C?Da.default.createElement(C,{event:s,title:T}):T)],N=e.height,V=e.top,j=e.width,S=e.xOffset,I=(0,_g.default)((0,_g.default)({},M.style),{},(0,Ww.default)({top:Kl(V),height:Kl(N),width:Kl(j)},i?"right":"left",Kl(S)));return Da.default.createElement(B,Object.assign({type:"time"},n),Da.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:I,onKeyDown:w,title:F?(typeof l=="string"?l+": ":"")+F:void 0,className:(0,Kw.default)(y?"rbc-background-event":"rbc-event",t,M.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},A))}Su.default=Gw;var mr={},ix=Yn.default;Object.defineProperty(mr,"__esModule",{value:!0});mr.dragAccessors=void 0;mr.eventTimes=n2;mr.mergeComponents=e2;mr.pointInColumn=t2;var Qw=ix(Jr),Yw=ix(wf),Dg=Wo,Xw=E,Jw=["children"];mr.dragAccessors={start:(0,Dg.wrapAccessor)(function(n){return n.start}),end:(0,Dg.wrapAccessor)(function(n){return n.end})};function Zw(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var s=function(i){var o=i.children,l=(0,Yw.default)(i,Jw);return e.filter(Boolean).reduceRight(function(u,m){return(0,Xw.createElement)(m,l,u)},o)};return s}function e2(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),s=(0,Qw.default)({},n);return t.forEach(function(r){s[r]=n[r]?Zw(n[r],e[r]):e[r]}),s}function t2(n,e){var t=n.left,s=n.right,r=n.top,i=e.x,o=e.y;return i<s+10&&i>t&&o>r}function n2(n,e,t){var s=e.start(n),r=e.end(n),i=t.eq(s,r,"minutes")&&t.diff(s,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(s,r,"milliseconds");return{start:s,end:r,duration:o}}var s2=B0.default,Zr=Yn.default;Object.defineProperty(Iu,"__esModule",{value:!0});Iu.default=void 0;var kr=Zr(Jr),r2=Zr(Ri),i2=Zr(Bi),o2=Zr($o),a2=Zr(zo),mm=Sw,l2=Zr(Tw),li=Zr(E),c2=Ui,Er=s2(Ts),u2=Zr(Su),er=mr,ox=function(n){function e(){var t;(0,r2.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,o2.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,er.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,h=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),y=(0,er.eventTimes)(u,d,t.props.localizer),w=y.duration,v=t.props.localizer.add(h,w,"milliseconds");t.update(u,f.getRange(h,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),h=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),h=(0,er.eventTimes)(f,u,d),y=h.duration,w=m.nextSlot(o),v=!isNaN(y);if(v){var C=d.add(o,y,"milliseconds");w=new Date(Math.max(C,w))}return w},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,l2.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,mm.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,mm.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new Er.default(function(){return o.closest(".rbc-time-view")}),d=(0,mm.scrollParent)(o);m.on("beforeSelect",function(f){var h=t.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,er.pointInColumn)((0,Er.getBoundsForNode)(l),f);var y=(0,Er.getEventNodeFromPoint)(l,f);if(!y)return!1;t.eventOffsetTop=f.y-(0,Er.getBoundsForNode)(y).top}),m.on("selecting",function(f){var h=(0,Er.getBoundsForNode)(l),y=t.context.draggable.dragAndDropAction;y.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,h)),y.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,h))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var h=(0,Er.getBoundsForNode)(l);(0,er.pointInColumn)(h,f)&&t.handleDropFromOutside(f,h)}}),m.on("dragOverFromOutside",function(f){var h=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(h){var y=(0,Er.getBoundsForNode)(l);if(!(0,er.pointInColumn)(y,f))return t.reset();t.handleDragOverFromOutside(f,y)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var h=(0,Er.getBoundsForNode)(l);u=!1;var y=t.context.draggable.dragAndDropAction;if(y.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,er.pointInColumn)(h,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=li.default.createRef(),t}return(0,a2.default)(e,n),(0,i2.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(s,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,kr.default)((0,kr.default)({},s),{},{start:i,end:o})})}},{key:"handleResize",value:function(s,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,h=l.closestSlotFromPoint(s,r),y=(0,er.eventTimes)(d,o,u),w=y.start,v=y.end,C;if(f==="UP"){var B=u.min(h,l.closestSlotFromDate(v,-1));C=l.getRange(B,v),C=(0,kr.default)((0,kr.default)({},C),{},{endDate:v})}else if(f==="DOWN"){var T=u.max(h,l.closestSlotFromDate(w));C=l.getRange(w,T),C=(0,kr.default)((0,kr.default)({},C),{},{startDate:w})}this.update(d,C)}},{key:"renderContent",value:function(){var s=this.props,r=s.children,i=s.accessors,o=s.components,l=s.getters,u=s.slotMetrics,m=s.localizer,d=this.state,f=d.event,h=d.top,y=d.height;if(!f)return r;var w=r.props.children,v=f.start,C=f.end,B,T="eventTimeRangeFormat",F=u.startsBeforeDay(v),re=u.startsAfterDay(C);return F?T="eventTimeRangeEndFormat":re&&(T="eventTimeRangeStartFormat"),F&&re?B=m.messages.allDay:B=m.format({start:v,end:C},T),li.default.cloneElement(r,{children:li.default.createElement(li.default.Fragment,null,w,f&&li.default.createElement(u2.default,{event:f,label:B,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:y,width:100},getters:l,components:o,accessors:(0,kr.default)((0,kr.default)({},i),er.dragAccessors),continuesPrior:F,continuesAfter:re}))})}},{key:"render",value:function(){return li.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(li.default.Component);ox.contextType=c2.DnDContext;Iu.default=ox;var Pu={},ax={exports:{}},lx={exports:{}},cx={exports:{}};(function(n){function e(t,s){(s==null||s>t.length)&&(s=t.length);for(var r=0,i=Array(s);r<s;r++)i[r]=t[r];return i}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(cx);var ux=cx.exports;(function(n){var e=ux;function t(s){if(Array.isArray(s))return e(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(lx);var m2=lx.exports,mx={exports:{}};(function(n){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(mx);var d2=mx.exports,dx={exports:{}};(function(n){var e=ux;function t(s,r){if(s){if(typeof s=="string")return e(s,r);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,r):void 0}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(dx);var f2=dx.exports,fx={exports:{}};(function(n){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(fx);var p2=fx.exports;(function(n){var e=m2,t=d2,s=f2,r=p2;function i(o){return e(o)||t(o)||s(o)||r()}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports})(ax);var px=ax.exports,Lu={},ju={},Ru={},ei=Yn.default;Object.defineProperty(Ru,"__esModule",{value:!0});Ru.default=void 0;var kg=ei(Jr),h2=ei(wf),g2=ei(Ri),y2=ei(Bi),b2=ei($o),N2=ei(zo),ka=ei(E),x2=ei(kl),v2=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],_2=function(n){function e(){return(0,g2.default)(this,e),(0,b2.default)(this,e,arguments)}return(0,N2.default)(e,n),(0,y2.default)(e,[{key:"render",value:function(){var s=this.props,r=s.style,i=s.className,o=s.event,l=s.selected,u=s.isAllDay,m=s.onSelect,d=s.onDoubleClick,f=s.onKeyPress,h=s.localizer,y=s.continuesPrior,w=s.continuesAfter,v=s.accessors,C=s.getters,B=s.children,T=s.components,F=T.event,re=T.eventWrapper,ee=s.slotStart,M=s.slotEnd,A=(0,h2.default)(s,v2);delete A.resizable;var N=v.title(o),V=v.tooltip(o),j=v.end(o),S=v.start(o),I=v.allDay(o),k=u||I||h.diff(S,h.ceil(j,"day"),"day")>1,De=C.eventProp(o,S,j,l),qe=ka.default.createElement("div",{className:"rbc-event-content",title:V||void 0},F?ka.default.createElement(F,{event:o,continuesPrior:y,continuesAfter:w,title:N,isAllDay:I,localizer:h,slotStart:ee,slotEnd:M}):N);return ka.default.createElement(re,Object.assign({},this.props,{type:"date"}),ka.default.createElement("div",Object.assign({},A,{style:(0,kg.default)((0,kg.default)({},De.style),r),className:(0,x2.default)("rbc-event",i,De.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":y,"rbc-event-continues-after":w}),onClick:function(Ue){return m&&m(o,Ue)},onDoubleClick:function(Ue){return d&&d(o,Ue)},onKeyDown:function(Ue){return f&&f(o,Ue)}}),typeof B=="function"?B(qe):qe))}}])}(ka.default.Component);Ru.default=_2;var ti={},D2=Yn.default;Object.defineProperty(ti,"__esModule",{value:!0});ti.dateCellSelection=V2;ti.getSlotAtX=hx;ti.isSelected=E2;ti.pointInBox=A2;ti.slotWidth=Pf;var k2=D2(iv);function E2(n,e){return!n||e==null?!1:(0,k2.default)(n,e)}function Pf(n,e){var t=n.right-n.left,s=t/e;return s}function hx(n,e,t,s){var r=Pf(n,s);return t?s-1-Math.floor((e-n.left)/r):Math.floor((e-n.left)/r)}function A2(n,e){var t=e.x,s=e.y;return s>=n.top&&s<=n.bottom&&t>=n.left&&t<=n.right}function V2(n,e,t,s,r){var i=-1,o=-1,l=s-1,u=Pf(e,s),m=hx(e,t.x,r,s),d=e.top<t.y&&e.bottom>t.y,f=e.top<n.y&&e.bottom>n.y,h=n.y>e.bottom,y=e.top>n.y,w=t.top<e.top&&t.bottom>e.bottom;return w&&(i=0,o=l),d&&(y?(i=0,o=m):h&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((n.x-e.left)/u):Math.floor((n.x-e.left)/u),d?m<i?i=m:o=m:n.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var Lf=Yn.default;Object.defineProperty(ju,"__esModule",{value:!0});ju.default=void 0;var Bs=Lf(Rg),Eg=Lf(E),C2=Lf(Ru),w2=ti;ju.default={propTypes:{slotMetrics:Bs.default.object.isRequired,selected:Bs.default.object,isAllDay:Bs.default.bool,accessors:Bs.default.object.isRequired,localizer:Bs.default.object.isRequired,components:Bs.default.object.isRequired,getters:Bs.default.object.isRequired,onSelect:Bs.default.func,onDoubleClick:Bs.default.func,onKeyPress:Bs.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var s=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,y=d.continuesPrior(t),w=d.continuesAfter(t);return Eg.default.createElement(C2.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:y,continuesAfter:w,slotStart:d.first,slotEnd:d.last,selected:(0,w2.isSelected)(t,s),resizable:h})},renderSpan:function(e,t,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return Eg.default.createElement("div",{key:s,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var ni=Yn.default;Object.defineProperty(Lu,"__esModule",{value:!0});Lu.default=void 0;var I2=ni(Jr),S2=ni(Ri),T2=ni(Bi),P2=ni($o),L2=ni(zo),j2=ni(kl),Ag=ni(E),bc=ni(ju),gx=function(n){function e(){return(0,S2.default)(this,e),(0,P2.default)(this,e,arguments)}return(0,L2.default)(e,n),(0,T2.default)(e,[{key:"render",value:function(){var s=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return Ag.default.createElement("div",{className:(0,j2.default)(l,"rbc-row")},i.reduce(function(m,d,f){var h=d.event,y=d.left,w=d.right,v=d.span,C="_lvl_"+f,B=y-u,T=bc.default.renderEvent(s.props,h);return B&&m.push(bc.default.renderSpan(o,B,"".concat(C,"_gap"))),m.push(bc.default.renderSpan(o,v,C,T)),u=w+1,m},[]))}}])}(Ag.default.Component);gx.defaultProps=(0,I2.default)({},bc.default.defaultProps);Lu.default=gx;var dr={},yx=Yn.default;Object.defineProperty(dr,"__esModule",{value:!0});dr.endOfRange=bx;dr.eventLevels=U2;dr.eventSegments=B2;dr.inRange=H2;dr.segsOverlap=Nx;dr.sortEvents=cd;dr.sortWeekEvents=M2;var dm=yx(px),R2=yx(ov);function bx(n){var e=n.dateRange,t=n.unit,s=t===void 0?"day":t,r=n.localizer;return{first:e[0],last:r.add(e[e.length-1],1,s)}}function B2(n,e,t,s){var r=bx({dateRange:e,localizer:s}),i=r.first,o=r.last,l=s.diff(i,o,"day"),u=s.max(s.startOf(t.start(n),"day"),i),m=s.min(s.ceil(t.end(n),"day"),o),d=(0,R2.default)(e,function(h){return s.isSameDate(h,u)}),f=s.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-s.segmentOffset,1),{event:n,span:f,left:d+1,right:Math.max(d+f,1)}}function U2(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,s,r,i=[],o=[];for(t=0;t<n.length;t++){for(r=n[t],s=0;s<i.length&&Nx(r,i[s]);s++);s>=e?o.push(r):(i[s]||(i[s]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function H2(n,e,t,s,r){var i={start:s.start(n),end:s.end(n)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function Nx(n,e){return e.some(function(t){return t.left<=n.right&&t.right>=n.left})}function M2(n,e,t){var s=(0,dm.default)(n),r=[],i=[];s.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return cd(u,m,e,t)}),l=i.sort(function(u,m){return cd(u,m,e,t)});return[].concat((0,dm.default)(o),(0,dm.default)(l))}function cd(n,e,t,s){var r={start:t.start(n),end:t.end(n),allDay:t.allDay(n)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return s.sortEvents({evtA:r,evtB:i})}var F2=B0.default,si=Yn.default;Object.defineProperty(Pu,"__esModule",{value:!0});Pu.default=void 0;var Gl=si(Jr),O2=si(px),q2=si(Ri),$2=si(Bi),z2=si($o),W2=si(zo),Ql=si(E),K2=si(Lu),co=F2(Ts),G2=dr,Ar=ti,Yl=mr,Q2=Ui,xx=function(n){function e(){var t;(0,q2.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,z2.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,Ar.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,h=d.slotMetrics,y=d.rtl,w=d.localizer,v=(0,Ar.getSlotAtX)(l,o.x,y,h.slots),C=h.getDateForSlot(v),B=(0,Yl.eventTimes)(m,f,w),T=B.start,F=B.duration;T=w.merge(C,T);var re=w.add(T,F,"milliseconds");t.update(m,T,re)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,h=(0,Ar.getSlotAtX)(l,o.x,d,m.slots),y=m.getDateForSlot(h);t.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new co.default(function(){return l},{validContainers:(0,O2.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,h=t.context.draggable.dragAndDropAction.action,y=(0,co.getBoundsForNode)(o),w=(0,Ar.pointInBox)(y,d);return h==="move"||h==="resize"&&(!f||w)}),m.on("selecting",function(d){var f=(0,co.getBoundsForNode)(o),h=t.context.draggable.dragAndDropAction;h.action==="move"&&t.handleMove(d,f),h.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,co.getBoundsForNode)(o);t.state.segment&&((0,Ar.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,co.getBoundsForNode)(o);(0,Ar.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,co.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Ql.default.createRef(),t}return(0,W2.default)(e,n),(0,$2.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(s,r,i){var o=(0,G2.eventSegments)((0,Gl.default)((0,Gl.default)({},s),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Yl.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(s,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,h=u.localizer,y=(0,Yl.eventTimes)(o,m,h),w=y.start,v=y.end,C=(0,Ar.getSlotAtX)(r,s.x,f,d.slots),B=d.getDateForSlot(C),T=(0,Ar.pointInBox)(r,s);if(l==="RIGHT"){if(T){if(d.last<w)return this.reset();h.eq(h.startOf(v,"day"),v)?v=h.add(B,1,"day"):v=B}else if(h.inRange(w,d.first,d.last)||r.bottom<s.y&&+d.first>+w)v=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var F=m.end(o);v=h.merge(v,F),h.lt(v,w)&&(v=F)}else if(l==="LEFT"){if(T){if(d.first>v)return this.reset();w=B}else if(h.inRange(v,d.first,d.last)||r.top>s.y&&h.lt(d.last,v))w=h.add(d.first,-1,"milliseconds");else{this.reset();return}var re=m.start(o);w=h.merge(w,re),h.gt(w,v)&&(w=re)}this.update(o,w,v)}},{key:"render",value:function(){var s=this.props,r=s.children,i=s.accessors,o=this.state.segment;return Ql.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&Ql.default.createElement(K2.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,Gl.default)((0,Gl.default)({},i),Yl.dragAccessors)})))}}])}(Ql.default.Component);xx.contextType=Q2.DnDContext;Pu.default=xx;var Ps=Yn.default;Object.defineProperty(Cf,"__esModule",{value:!0});Cf.default=lI;var Xl=Ps(Jr),Y2=Ps(wf),X2=Ps(Ri),J2=Ps(Bi),Z2=Ps($o),eI=Ps(zo),fm=Ps(E),tI=Ps(kl),nI=Ps(wu),sI=Ps(Iu),rI=Ps(Pu),iI=mr,oI=Ui,aI=["selectable","elementProps","components"];function lI(n){var e=function(t){function s(){var r;(0,X2.default)(this,s);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,Z2.default)(this,s,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var h=r.props,y=h.onEventDrop,w=h.onEventResize;d==="move"&&y&&y(u),d==="resize"&&w&&w(u)}},r.state={interacting:!1},r}return(0,eI.default)(s,t),(0,J2.default)(s,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,Y2.default)(i,aI),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,iI.mergeComponents)(u,{eventWrapper:nI.default,eventContainerWrapper:sI.default,weekWrapper:rI.default});var f=this.props.onDropFromOutside?(0,Xl.default)((0,Xl.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,tI.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return fm.default.createElement(oI.DnDContext.Provider,{value:h},fm.default.createElement(n,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(fm.default.Component);return e.defaultProps=(0,Xl.default)((0,Xl.default)({},n.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var cI=Yn.default;Object.defineProperty(Vf,"__esModule",{value:!0});var vx=Vf.default=void 0,uI=cI(Cf);vx=Vf.default=uI.default;const mI=vx(av),dI=WC;lt.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:n=>n<12?"":"",week:{dow:0,doy:1}});lt.locale("ko");const fI=lv(lt),Vg=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],pI=mt.memo(({onSave:n,onCancel:e,processList:t})=>{const[s,r]=E.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=E.useState(i);E.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:s,onChange:m=>r(m.target.value),onBlur:()=>{s.trim()?n(s.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?s.trim()?n(s.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),Cg=n=>n,Wa={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},hI=mt.memo(({date:n,label:e,filteredEvents:t,selectedDate:s,user:r,isMobileView:i})=>{const o=lt(n).format("YYYY-MM-DD"),l=Wa[o],u=!!Wa[o],m=s&&lt(n).isSame(s,"day"),d=t.filter(M=>lt(M.start).isSame(n,"day")),f=d.length,h=d.filter(M=>M.assignedTo&&M.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-h,w=e.replace(/^0/,""),v=n.getDay()===0,C=n.getDay()===6;let B="#000000";u||v?B="#dc2626":C&&(B="#3b82f6");const T=lt(n).isSame(lt(),"day");let F="#d1d5db";u||v?F="#fecaca":C&&(F="#bfdbfe");const re=w.length===2,ee=i?{backgroundColor:"transparent",color:B,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:T?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:B,fontWeight:T?"700":"400",paddingLeft:re?"0px":"4px",...T&&{backgroundColor:F,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:ee,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((M,A)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((M,A)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:ee,children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),gI=mt.memo(({event:n,user:e,filterProject:t,isEditing:s,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const h=t&&t!=="all",y=n.assignedTo||[],[w,v]=E.useState(!1),C=mt.useRef(null),B=()=>{const he=window.innerWidth,Ue=window.innerHeight;return he>=768&&he<1024||he>=1024&&Ue>he},[T,F]=E.useState(B),[re,ee]=E.useState(!1);mt.useRef(null),mt.useRef(!1);const[M,A]=E.useState(r||""),N=mt.useRef(s);E.useEffect(()=>{s&&!N.current&&r!==void 0&&A(r),N.current=s},[s,r]);const V=e!=null&&e.name?e.name.slice(-2):null,j=V&&["",""].includes(V),S=V&&["","",""].includes(V),I=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&S||y.includes("")&&j);E.useEffect(()=>{const he=()=>{F(B())};return window.addEventListener("resize",he),()=>window.removeEventListener("resize",he)},[]);const k=he=>{A(he)},De=()=>{M!=null&&M.trim()&&o&&(i&&i(M),o()),u&&u()},qe=he=>{he.stopPropagation(),(he.key==="Enter"||he.key==="Escape")&&he.currentTarget.blur()};return T?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{ee(!0),v(!0)},onMouseLeave:()=>{ee(!1),v(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[w&&h&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:C,onMouseDown:he=>{he.stopPropagation(),he.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!n.isASVisit&&n.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",Cg(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&y.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((he,Ue)=>{const ht=he==="HV LAB"||he===""&&j||he===""&&S||he===(e==null?void 0:e.name);return a.jsxDEV(mt.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:ht?"bold":"normal"},children:he},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),Ue<y.length-1&&""]},he,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:he=>k(he.target.value),onBlur:De,onKeyDown:qe,onClick:he=>he.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:n.title,children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),re&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),n.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",n.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!n.isASVisit&&n.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",Cg(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:he=>k(he.target.value),onBlur:De,onKeyDown:qe,onClick:he=>he.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&y.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((he,Ue)=>{const ht=he==="HV LAB"||he===""&&j||he===""&&S||he===(e==null?void 0:e.name);return a.jsxDEV(mt.Fragment,{children:[a.jsxDEV("span",{className:ht?"font-bold":"",children:he},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),Ue<y.length-1&&""]},he,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),w&&h&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:C,onMouseDown:he=>{he.stopPropagation(),he.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&s&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(he=>a.jsxDEV("option",{value:he},he,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),yI=()=>{const{schedules:n,setSchedules:e,addSchedule:t,deleteSchedule:s,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=$r(),{user:y}=Kr(),w=Cu(),[v,C]=E.useState(!1);E.useEffect(()=>{const b=()=>{const H=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;C(H)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const B=b=>!b||b==="-"?"":v?b:id(b),T=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",T);const F=mt.useRef(!1);E.useEffect(()=>{F.current||(F.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),oe.error("  ")}))},[r]);const[re,ee]=E.useState([]);E.useEffect(()=>{const b=async H=>{if((H.ctrlKey||H.metaKey)&&H.key==="z"){const Y=H.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(re.length>0){H.preventDefault();const W=re[re.length-1];try{const le=W.type==="as_visit"||W.type==="expected_payment"?"other":W.type;await i({id:"",title:W.originalTitle||W.title,start:W.start,end:W.end,type:le,project:W.originalProjectName||W.projectName,attendees:W.assignedTo||[],time:W.time,description:W.description}),ee(ye=>ye.slice(0,-1)),oe.success(" ")}catch(le){console.error("  :",le),oe.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[re,i]);const[M,A]=E.useState([]),[N,V]=E.useState(!1),[j,S]=E.useState(""),[I,k]=E.useState(null),[De,qe]=E.useState(""),[he,Ue]=E.useState(!1),[ht,zt]=E.useState(null),[Ft,ae]=E.useState(null),$e=E.useCallback(async()=>{Ue(!0);try{const b=await we.get("/processes");A(b.data)}catch(b){console.error("   :",b),A([])}finally{Ue(!1)}},[]);E.useEffect(()=>{$e()},[$e]);const me=E.useMemo(()=>M.length>0?M.map(b=>b.name):dI,[M]),Re=async()=>{if(j.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(b.ok)S(""),$e(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},Qe=async()=>{if(!(!I||!De.trim()))try{const b=await fetch(`/api/processes/${I.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:De.trim()})});if(b.ok)k(null),qe(""),$e(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},vt=async b=>{if(confirm("   ?"))try{const H=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(H.ok)$e(),oe.success(" ");else{const Y=await H.json();oe.error(Y.error||"  ")}}catch(H){console.error("  :",H),oe.error("  ")}},at=b=>{zt(b)},wt=(b,H)=>{b.preventDefault(),ht!==null&&ht!==H&&ae(H)},ot=async()=>{if(ht!==null&&Ft!==null&&ht!==Ft){const b=[...M],[H]=b.splice(ht,1);b.splice(Ft,0,H),A(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(W=>({id:W.id}))})})).ok||($e(),oe.error("  "))}catch(Y){console.error("  :",Y),$e(),oe.error("  ")}}zt(null),ae(null)},ft=b=>{const H=w.findIndex(Y=>Y.name===b);return H>=0?Vg[H%Vg.length]:"#e8e2ea"},fn=w.map(b=>b.name),K=n.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||fn.includes(b.project):!0).map(b=>{const H=w.find(ge=>ge.name===b.project);let Y=b.project===""?"[]":b.project;if(H&&b.project!==""){const ge=H.name.length>2?H.name.substring(0,2):H.name,gt=(H.location||"").match(/([A-Za-z]?\d+)/),gn=gt?gt[1]:"";Y=gn?`${ge}_${gn}`:ge}const W=b.time,le=W&&W!=="-"?` - ${B(W)}`:"",ye=b.attendees||[];return{id:b.id,title:b.title+le,originalTitle:b.title,start:b.start,end:b.end,projectId:(H==null?void 0:H.id)||"",projectName:Y||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:ye,priority:"medium",allDay:!W||W==="-",color:ft(b.project||""),isASVisit:!1,time:W,description:b.description}}),Pe=u.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?fn.includes(b.project):!0).map(b=>{const H=b.scheduledVisitTime,Y=H&&H!=="-"?` - ${B(H)}`:"",W=w.find(ge=>ge.name===b.project);let le=b.project;if(W){const ge=W.name.length>2?W.name.substring(0,2):W.name,gt=(W.location||"").match(/([A-Za-z]?\d+)/),gn=gt?gt[1]:"";le=gn?`${ge}_${gn}`:ge}const ye=`[AS] ${le}`;return{id:`as-${b.id}`,title:ye+Y,originalTitle:ye,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(W==null?void 0:W.id)||"",projectName:le,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(ge=>ge.trim()):[],priority:"high",allDay:!H||H==="-",color:"#FEF3C7",isASVisit:!0,time:H,description:b.description}}),He=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var ye,ge,ut,gt,gn,Tt,Pt,ln;const H=w.find(An=>An.name===b.project);if(!H){const An=[],At=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),tn=new Set(b.payments.flatMap(hn=>{var Qt;return((Qt=hn.type)==null?void 0:Qt.split(", ").map(Yt=>Yt.trim()))||[]}));return!tn.has("")&&((ye=b.expectedPaymentDates)!=null&&ye.contract)&&An.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(At*.1).toLocaleString()}`}),!tn.has("")&&((ge=b.expectedPaymentDates)!=null&&ge.start)&&An.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(At*.4).toLocaleString()}`}),!tn.has("")&&((ut=b.expectedPaymentDates)!=null&&ut.middle)&&An.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(At*.4).toLocaleString()}`}),!tn.has("")&&((gt=b.expectedPaymentDates)!=null&&gt.final)&&An.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(At*.1).toLocaleString()}`}),An}if(!H.startDate||!H.endDate)return[];const Y=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),W=new Set(b.payments.flatMap(An=>{var At;return((At=An.type)==null?void 0:At.split(", ").map(tn=>tn.trim()))||[]})),le=[];return!W.has("")&&((gn=b.expectedPaymentDates)!=null&&gn.contract)&&le.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!W.has("")&&((Tt=b.expectedPaymentDates)!=null&&Tt.start)&&le.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((Pt=b.expectedPaymentDates)!=null&&Pt.middle)&&le.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((ln=b.expectedPaymentDates)!=null&&ln.final)&&le.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),le}):[],Se=[...K,...Pe,...He],Ye=E.useCallback(b=>{if(!(y!=null&&y.name))return!1;const H=b.assignedTo||[],Y=y.name.slice(-2),W=["",""].includes(Y),le=["","",""].includes(Y);return H.includes(y.name)||H.includes("HV LAB")||H.includes("")&&le||H.includes("")&&W},[y==null?void 0:y.name]),It=(b,H)=>{if(!H)return[...b].sort((le,ye)=>{const ge=Ye(le),ut=Ye(ye);return ge&&!ut?-1:!ge&&ut?1:le.start.getTime()-ye.start.getTime()});const Y=new Map;b.forEach(le=>{const ye=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||ye){const ge=`single_${le.id}`;Y.set(ge,[le])}else{const ge=le.start.toISOString().split("T")[0],ut=[...le.assignedTo].sort().join(","),gt=`${ge}_${le.projectName}_${ut}`;Y.has(gt)||Y.set(gt,[]),Y.get(gt).push(le)}});const W=[];return Y.forEach(le=>{if(le.length===1)W.push(le[0]);else{const ye=le[0],ge=le.map(Pt=>Pt.originalTitle||Pt.title),ut=[...new Set(ge)],gt=le.map(Pt=>{const ln=Pt.originalTitle||Pt.title;return ln.startsWith(ye.projectName+" - ")?ln.substring(ye.projectName.length+3):ln}),gn=[...new Set(gt)],Tt={...ye,id:le[0].id,title:gn.join(", "),originalTitle:ut.join(", "),description:le.map(Pt=>Pt.description||Pt.originalTitle||Pt.title).join(`
`),assignedTo:[...new Set(le.flatMap(Pt=>Pt.assignedTo))],mergedEventIds:le.map(Pt=>Pt.id)};W.push(Tt)}}),W.sort((le,ye)=>{const ge=Ye(le),ut=Ye(ye);return ge&&!ut?-1:!ge&&ut?1:le.start.getTime()-ye.start.getTime()})},[Wt,dt]=E.useState("month"),[P,q]=E.useState(new Date),[te,Ne]=E.useState(!1),[ce,de]=E.useState(null),[Ie,ze]=E.useState(null),et=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[Ee,Un]=E.useState(()=>{const b=localStorage.getItem(et);return b||((y==null?void 0:y.name)===""&&w.length>0?w[0].name:"all")});E.useEffect(()=>{localStorage.setItem(et,Ee)},[Ee,et]),E.useCallback(()=>{document.body.classList.add("printing-schedule");const b=Ee==="all"?" ":Ee,H=lt(P).format("YYYY MM"),Y=document.title;document.title=`${b} - ${H} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[Ee,P]);const Bt=It(Se,Ee==="all"),[ne,Xe]=E.useState(window.innerWidth<768?new Date:null),[O,xe]=E.useState(null),ke=mt.useRef(null),Le=mt.useRef(!1),[ue,Dt]=E.useState(null),xt=mt.useRef(!1),Jt=mt.useRef(!1);E.useEffect(()=>{const b=W=>{W.key==="Control"&&(Jt.current=!0)},H=W=>{W.key==="Control"&&(Jt.current=!1)},Y=()=>{Jt.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",H),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",H),window.removeEventListener("blur",Y)}},[]),E.useEffect(()=>{if(!O)return;let b=null;const H=ye=>{ye.preventDefault(),ye.dataTransfer&&(ye.dataTransfer.dropEffect="copy")},Y=ye=>{ye.preventDefault(),ye.dataTransfer&&(ye.dataTransfer.dropEffect="copy");const ut=ye.target.closest(".rbc-day-bg");b&&b!==ut&&(b.style.backgroundColor=""),ut&&(ut.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=ut)},W=()=>{b&&(b.style.backgroundColor="",b=null)},le=ye=>{ye.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",H),document.addEventListener("dragover",Y),document.addEventListener("dragend",W),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",H),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",W),document.removeEventListener("drop",le),b&&(b.style.backgroundColor="")}},[O]);const[Et,pn]=E.useState(null),[on,Tn]=E.useState(null),[ds,Xn]=E.useState(""),[fs,ri]=E.useState(!1),[Ls,ns]=E.useState(null),[D,Q]=E.useState(!1),[R,x]=E.useState(""),[L,U]=E.useState(null),[X,G]=E.useState({x:0,y:0}),[Z,ie]=E.useState({x:0,y:0}),[Ce,Je]=E.useState(!1),Fe=8;E.useEffect(()=>{if(!L)return;const b=Y=>{G({x:Y.clientX,y:Y.clientY});const W=Math.abs(Y.clientX-Z.x),le=Math.abs(Y.clientY-Z.y);(W>Fe||le>Fe)&&Je(!0)},H=()=>{U(null),Je(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",H),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",H)}},[L,Z]);const fe=mt.useRef(!1),We=E.useCallback(async({event:b,start:H,end:Y})=>{if(b.isASVisit||b.isExpectedPayment){oe.error("    ");return}const W=H instanceof Date?H:new Date(H),le=Y instanceof Date?Y:new Date(Y);if(Jt.current)try{const ge=b.mergedEventIds||[b.id],ut=n.filter(gt=>ge.includes(gt.id));for(const gt of ut)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:gt.title,start:W,end:le,project:gt.project,attendees:gt.attendees||[],time:gt.time,priority:gt.priority||"medium"});oe.success(" ")}catch(ge){console.error("  :",ge),oe.error("  ")}else{const ge=b.mergedEventIds||[b.id];try{for(const ut of ge)await o(ut,{start:W,end:le})}catch(ut){console.error("  :",ut),oe.error("  "),r()}}},[n,o,i,r]),un=E.useCallback(({event:b,action:H})=>{var W;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const le of Y)if((W=le.textContent)!=null&&W.includes(b.originalTitle||b.title)){const ye=le.getBoundingClientRect();ie({x:ye.left,y:ye.top}),G({x:ye.left,y:ye.top});break}Je(!1),U(b)},[]),Kt=E.useCallback(async(b,H,Y=!1)=>{if(Ee==="all"){oe.error("  ");return}const W={id:"",title:b,start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(W)}catch(le){console.error("  :",le),oe.error("  ")}},[Ee,i,y]),Ut=E.useCallback(({start:b})=>{const H=O||ke.current;H&&Ee!=="all"&&(Le.current=!0,xt.current=!0,requestAnimationFrame(()=>{xt.current=!1}),pn(null),Tn(null),Xn(""),Kt(H,b),requestAnimationFrame(()=>{xe(null),ke.current=null,Le.current=!1}))},[O,Ee,Kt]),jt=E.useCallback(()=>{const b=O||ke.current;return b?{title:b}:null},[O]),Hn=E.useCallback(async b=>{if(!b.trim()||!Et||Ee==="all"){pn(null);return}const H=Et;pn(null);const Y={id:"",title:b.trim(),start:H,end:H,type:"construction",project:Ee,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}},[Et,Ee,i,y]),On=E.useCallback(()=>{pn(null)},[]),Gt=E.useCallback(async()=>{var b;if(!on||!ds.trim()){Tn(null),Xn("");return}try{const H=((b=on.mergedEventIds)==null?void 0:b[0])||on.id;await o(H,{title:ds.trim()})}catch(H){console.error("  :",H),oe.error("  ")}Tn(null),Xn("")},[on,ds,o]),Ke=E.useCallback(async b=>{ee(Y=>[...Y,b]);const H=b.mergedEventIds||[b.id];oe.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(H.map(Y=>l(Y)))}catch(Y){console.error("  :",Y),oe.error("  "),ee(W=>W.slice(0,-1))}Tn(null),Xn("")},[l]),Ve=Ee==="all"?Bt:Bt.filter(b=>(b.originalProjectName||b.projectName)===Ee),Ze=mt.useMemo(()=>{const b=Ee!=="all",H=new Map;Ve.forEach(W=>{const le=lt(W.start).format("YYYY-MM-DD");H.has(le)||H.set(le,[]),H.get(le).push(W)});const Y=[];return H.forEach(W=>{if(b)W.forEach((le,ye)=>{const ge=lt(le.start).startOf("day").add(ye,"milliseconds").toDate();Y.push({...le,start:ge,allDay:!1})});else{const le=[],ye=[];W.forEach(ge=>{Ye(ge)?le.push(ge):ye.push(ge)}),le.forEach((ge,ut)=>{const gt=lt(ge.start).startOf("day").add(ut,"milliseconds").toDate();Y.push({...ge,start:gt,allDay:!1})}),ye.forEach((ge,ut)=>{const gt=lt(ge.start).startOf("day").add(1e3+ut,"milliseconds").toDate();Y.push({...ge,start:gt,allDay:!1})})}}),Y.sort((W,le)=>W.start.getTime()-le.start.getTime())},[Ve,Ye,Ee]),tt=mt.useMemo(()=>{if(Et&&Ee!=="all"){const b=lt(Et).format("YYYY-MM-DD"),H=Ze.filter(ye=>lt(ye.start).format("YYYY-MM-DD")===b),Y=H.length>0?Math.max(...H.map(ye=>ye.start.getTime())):lt(Et).startOf("day").valueOf(),W=new Date(Y+1),le={id:"__inline_add__",title:"",start:W,end:W,projectId:"",projectName:Ee,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Ze,le]}return Ze},[Ze,Et,Ee]);E.useEffect(()=>{(y==null?void 0:y.name)===""&&w.length>0&&(Ee==="all"||!w.find(b=>b.name===Ee))&&Un(w[0].name)},[w,y]),E.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(ge=>{ge.style.display="none",ge.style.visibility="hidden",ge.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(ge=>{ge.style.display="none",ge.style.visibility="hidden",ge.style.opacity="0",ge.style.pointerEvents="none",ge.style.position="absolute",ge.style.left="-9999px",ge.style.top="-9999px",ge.style.zIndex="-1"})};b();const H=new MutationObserver(b),Y=document.querySelector(".rbc-calendar");Y&&H.observe(Y,{childList:!0,subtree:!0});const W=new MutationObserver(b);return W.observe(document.body,{childList:!0,subtree:!0}),()=>{H.disconnect(),W.disconnect()}},[Wt,P]);const[nt,Oe]=E.useState({date:null,projectId:"",title:""}),st=mt.useRef(!1),St=mt.useRef(null),an=b=>{if(fe.current){fe.current=!1;return}if(b.id==="__inline_add__")return;st.current=!0,St.current&&clearTimeout(St.current);const H=Ee!=="all",Y=window.innerWidth<768;if(H&&!Y&&!b.isASVisit&&!b.isExpectedPayment)pn(null),Tn(b),Xn(b.originalTitle||b.title);else{const W={...b,title:b.originalTitle||b.title};ze(null),de(W),Ne(!0)}St.current=setTimeout(()=>{st.current=!1,St.current=null},300)},Zt=b=>{const H=window.innerWidth,Y=H<768,W=H>=768&&H<1024,le=Ee==="all";if(xt.current)return;if(Y){if(b.start){Xe(b.start);const ge=document.querySelector(".md\\:hidden.mt-3.bg-white");ge&&ge.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const ye=b.action==="click"||b.action==="select";if(!(W&&!ye)){if(le){st.current=!1,Tn(null),Xn(""),pn(null),ze(b),de(null),Ne(!0);return}if(!st.current){if(ue){Kt(ue,b.start,!0);return}Tn(null),Xn(""),pn(b.start)}}},bs=async()=>{if(!nt.projectId||!nt.title.trim()){alert("  ");return}const b=w.find(H=>H.id===nt.projectId);if(!(!b||!nt.date))try{await i({id:Date.now().toString(),title:nt.title,start:nt.date,end:nt.date,type:"other",project:b.name,location:"",attendees:[],description:""}),Oe({date:null,projectId:"",title:""}),Xe(null)}catch(H){console.error("Failed to add schedule:",H),oe.error("  ")}},fr=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let H=b.color||"#E0E7FF",Y="#1f2937";if(b.isASVisit)H="#E8F5E9",Y="#1f2937";else{const W=b.assignedTo&&b.assignedTo.includes("HV LAB"),le=b.assignedTo&&b.assignedTo.includes("")&&T&&["",""].includes(T),ye=b.assignedTo&&b.assignedTo.includes("")&&T&&["","",""].includes(T);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||W||le||ye?(H="#FEF3C7",Y="#1f2937"):b.color||(H="#e8e2ea")}return{style:{backgroundColor:H,"--event-bg-color":H,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},Go=mt.useCallback(b=>{const H=lt(b).format("YYYY-MM-DD"),Y=!!Wa[H],W=ne&&lt(b).isSame(ne,"day"),le=window.innerWidth<768;let ye="";W&&(ye+="selected-date "),Y&&(ye+="holiday-date ");const ge=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:ye.trim(),style:ge}},[ne]),[Nt,Mi]=E.useState(window.innerWidth<768);E.useEffect(()=>{const b=()=>{Mi(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),E.useEffect(()=>{const b=()=>{const H=ne||new Date;ze({start:H,end:H}),de(null),Ne(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[ne]);const pr=mt.useCallback(({date:b,label:H})=>a.jsxDEV(hI,{date:b,label:H,filteredEvents:tt,selectedDate:ne,user:y,isMobileView:Nt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[tt,ne,y,Nt]),hr=mt.useRef(ds);hr.current=ds;const El=mt.useCallback(b=>{Xn(b)},[]),Qo=mt.useCallback(()=>{Tn(null),Xn("")},[]),Al=mt.useCallback(({event:b})=>{if(b.id==="__inline_add__")return a.jsxDEV(pI,{onSave:Hn,onCancel:On,processList:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const H=(on==null?void 0:on.id)===b.id||(on==null?void 0:on.mergedEventIds)&&on.mergedEventIds.includes(b.id);return a.jsxDEV(gI,{event:b,user:y,filterProject:Ee,isEditing:H,editTitle:H?hr.current:void 0,onEditTitleChange:H?El:void 0,onEditSave:H?Gt:void 0,onEditDelete:H?()=>Ke(b):void 0,onEditCancel:H?Qo:void 0,onHoverDelete:()=>Ke(b),onDeleteAction:()=>{fe.current=!0},processList:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,Ee,on,Gt,Ke,Hn,On,El,Qo,me]),Bu=({onNavigate:b})=>{const[H,Y]=mt.useState(!1),[W,le]=mt.useState(lt(P).year()),[ye,ge]=mt.useState(lt(P).month()),ut=window.innerWidth<768,gt=()=>{le(lt(P).year()),ge(lt(P).month()),Y(!0)},gn=()=>{q(lt().year(W).month(ye).toDate()),Y(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${ut?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:gt,children:[a.jsxDEV("span",{children:lt(P).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ee==="all"?" ":Ee]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ee,onChange:Tt=>{Un(Tt.target.value),Dt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),w.filter(Tt=>Tt.status!=="completed").map(Tt=>a.jsxDEV("option",{value:Tt.name,children:Tt.name},Tt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),H&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(W-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[W,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(W+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(Tt=>{const Pt=ye===Tt-1,ln=lt().year()===W&&lt().month()===Tt-1;return a.jsxDEV("button",{onClick:()=>ge(Tt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${Pt?"bg-gray-900 text-white":ln?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[Tt,""]},Tt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{q(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:gn,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},Uu=()=>null,Hu=E.useMemo(()=>({toolbar:Bu,event:Al,month:{dateHeader:pr,showMore:Uu}}),[pr,Al]),gr=mt.useMemo(()=>{if(!ne)return[];let b;if(Nt)b=tt.filter(Y=>lt(Y.start).isSame(ne,"day"));else{const Y=lt(ne).startOf("week"),W=lt(ne).endOf("week");b=tt.filter(le=>{const ye=lt(le.start);return ye.isSameOrAfter(Y,"day")&&ye.isSameOrBefore(W,"day")})}const H=[...b].sort((Y,W)=>{const le=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),ye=Y.assignedTo&&Y.assignedTo.includes("")&&T&&["",""].includes(T),ge=Y.assignedTo&&Y.assignedTo.includes("")&&T&&["","",""].includes(T),ut=Y.assignedTo&&T&&Y.assignedTo.includes(T)||Y.assignedTo&&(y==null?void 0:y.name)&&Y.assignedTo.includes(y.name)||le||ye||ge,gt=W.assignedTo&&W.assignedTo.includes("HV LAB"),gn=W.assignedTo&&W.assignedTo.includes("")&&T&&["",""].includes(T),Tt=W.assignedTo&&W.assignedTo.includes("")&&T&&["","",""].includes(T),Pt=W.assignedTo&&T&&W.assignedTo.includes(T)||W.assignedTo&&(y==null?void 0:y.name)&&W.assignedTo.includes(y.name)||gt||gn||Tt;return ut&&!Pt?-1:!ut&&Pt?1:new Date(Y.start).getTime()-new Date(W.start).getTime()});return console.log("Sorted events:",H.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:y==null?void 0:y.name,userShort:T}))),H},[ne,tt,y,T,Nt]);return E.useEffect(()=>{const H=setTimeout(()=>{const Y=Nt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),W=document.querySelectorAll(".rbc-month-row"),le=[];W.forEach((At,tn)=>{const hn=At.querySelectorAll(".rbc-date-cell");let Qt=0;hn.forEach(Yt=>{const yt=Yt.querySelector("button");let en=yt==null?void 0:yt.textContent;if(!en){const Ns=Yt.querySelector("span");en=Ns==null?void 0:Ns.textContent}if(en&&!isNaN(parseInt(en))){const Ns=lt(P).date(parseInt(en)),js=tt.filter(Fi=>lt(Fi.start).isSame(Ns,"day"));Qt=Math.max(Qt,js.length)}}),le.push(Qt)});const ye=Ee&&Ee!=="all",ge=100,ut=ye?60:18,gt=25,gn=Math.floor((ge-gt)/ut),Tt=le.length,Pt=ge*Tt,ln=le.map(At=>At<=gn?ge:gt+At*ut+10),An=ln.reduce((At,tn)=>At+tn,0);if(An>Pt){const At=ln.map((Qt,Yt)=>({index:Yt,height:Qt,overflow:Qt>ge})),tn=At.filter(Qt=>Qt.overflow).reduce((Qt,Yt)=>Qt+(Yt.height-ge),0),hn=At.filter(Qt=>!Qt.overflow);if(hn.length>0){const Qt=Pt-tn-hn.length*ge,Yt=Math.max(50,ge+Qt/hn.length);W.forEach((yt,en)=>{const js=ln[en]>ge?ln[en]:Yt;yt.style.height=`${js}px`,yt.style.minHeight=`${js}px`})}else{const Qt=Pt/An;W.forEach((Yt,yt)=>{const en=Math.max(80,ln[yt]*Qt);Yt.style.height=`${en}px`,Yt.style.minHeight=`${en}px`})}}else{const At=ln.reduce((Yt,yt)=>Yt+(yt>ge?yt:0),0),tn=ln.filter(Yt=>Yt<=ge).length,hn=Pt-At,Qt=tn>0?hn/tn:ge;W.forEach((Yt,yt)=>{const en=ln[yt]>ge?ln[yt]:Qt;Yt.style.height=`${en}px`,Yt.style.minHeight=`${en}px`})}Y.forEach(At=>{const tn=At.querySelector("button");let hn=tn==null?void 0:tn.textContent;if(!hn){const en=At.querySelector("span");hn=en==null?void 0:en.textContent}if(!hn||isNaN(parseInt(hn)))return;const Qt=lt(P).date(parseInt(hn)),Yt=tt.filter(en=>lt(en.start).isSame(Qt,"day"));Yt.length>0?At.setAttribute("data-event-count",Yt.length.toString()):At.removeAttribute("data-event-count");const yt=Qt.clone().toDate();if(ne&&lt(yt).isSame(ne,"day")?At.classList.add("selected-date"):At.classList.remove("selected-date"),Nt){const en=At,Ns=en._mobileClickHandler;Ns&&At.removeEventListener("click",Ns);const js=Fi=>{if(Fi.target.closest(".rbc-event"))return;const Oi=Qt.clone().toDate();Xe(Oi);const xs=document.querySelector(".md\\:hidden.mt-3.bg-white");xs&&xs.scrollIntoView({behavior:"smooth",block:"nearest"})};en._mobileClickHandler=js,At.addEventListener("click",js,!0),At.style.cursor="pointer",At.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(H),Nt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(W=>{const le=W,ye=le._mobileClickHandler;ye&&(W.removeEventListener("click",ye),delete le._mobileClickHandler)})}},[tt,P,Nt,ne,Ee]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[nt.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:lt(nt.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:nt.projectId,onChange:b=>Oe({...nt,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:w.filter(b=>b.status!=="completed").map(b=>a.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:nt.title,onChange:b=>Oe({...nt,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&bs()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:bs,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Oe({date:null,projectId:"",title:""}),Xe(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[Ee!=="all"&&!Nt&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>V(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),ue&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:me.map(b=>a.jsxDEV("div",{draggable:!0,onClick:()=>{Dt(ue===b?null:b)},onDragStart:H=>{Le.current=!1,Dt(null),xe(b),ke.current=b,H.dataTransfer.setData("text/plain",b),H.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Le.current||(xe(null),ke.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${ue===b?"bg-blue-500 text-white ring-2 ring-blue-300":O===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ee!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(mI,{localizer:fI,events:tt,startAccessor:"start",endAccessor:"end",view:Wt,onView:dt,date:P,onNavigate:q,onSelectEvent:an,onSelectSlot:Zt,onEventDrop:Ee!=="all"?We:void 0,onDragStart:Ee!=="all"?un:void 0,onDropFromOutside:Ee!=="all"?Ut:void 0,dragFromOutsideItem:Ee!=="all"?jt:void 0,draggableAccessor:b=>Ee!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:fr,dayPropGetter:Go,components:Hu,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${Ee}-${(ne==null?void 0:ne.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ne&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:Nt?lt(ne).format("MM DD (ddd)"):`${lt(ne).startOf("week").format("MM DD")} - ${lt(ne).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Wa[lt(ne).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Wa[lt(ne).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[Ee!=="all"&&a.jsxDEV("button",{onClick:()=>Q(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Xe(null),ns(null),Q(!1),x("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:gr.length===0?a.jsxDEV("div",{className:"p-4",children:Ee!=="all"&&D?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&R.trim()){const H=ne||new Date,Y={id:"",title:R.trim(),start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(R.trim()){const b=ne||new Date,H={id:"",title:R.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const b=gr.reduce((Y,W)=>{const le=lt(W.start).format("YYYY-MM-DD");return Y[le]||(Y[le]=[]),Y[le].push(W),Y},{});return Object.keys(b).sort().map(Y=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!Nt&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:lt(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[Y].map(W=>{const le=W.assignedTo&&W.assignedTo.includes("HV LAB"),ye=W.assignedTo&&W.assignedTo.includes("")&&T&&["",""].includes(T),ge=W.assignedTo&&W.assignedTo.includes("")&&T&&["","",""].includes(T),gt=W.assignedTo&&(W.assignedTo.includes((y==null?void 0:y.name)||"")||T&&W.assignedTo.includes(T))||le||ye||ge,gn=!W.color&&!gt,Tt=!W.isASVisit&&!W.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const Pt={...W,title:W.originalTitle||W.title};an(Pt)},className:`p-3 cursor-pointer ${gt?"bg-yellow-50":""}`,style:gn?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:gt?"#FEF3C7":W.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:W.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),W.assignedTo&&W.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(An=>W.assignedTo.includes(An))?"":W.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),W.projectName&&Ee==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:W.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),Tt?a.jsxDEV("button",{onClick:Pt=>{Pt.stopPropagation(),ns(W)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},W.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ee!=="all"&&D&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&R.trim()){const H=ne||new Date,Y={id:"",title:R.trim(),start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(R.trim()){const b=ne||new Date,H={id:"",title:R.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),Nt&&Ee!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:me.map(b=>a.jsxDEV("button",{onClick:async()=>{const H=ne||new Date;if(Ee!=="all"){const Y={id:"",title:b,start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),te&&a.jsxDEV(p0,{event:ce,slotInfo:Ie,defaultProjectName:Ee!=="all"?Ee:void 0,onClose:()=>{Ne(!1),de(null),ze(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(ce)if(ce.id.startsWith("as-")){const H=ce.id.replace("as-","");let Y="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?Y=b.assignedTo.join(", "):ce.assignedTo&&Array.isArray(ce.assignedTo)?Y=ce.assignedTo.join(", "):typeof ce.assignedTo=="string"&&(Y=ce.assignedTo),await m(H,{project:b.title||ce.title,assignedTo:Y,scheduledVisitDate:b.start,scheduledVisitTime:b.time||ce.time}),await d(),Ne(!1)}else if(ce.id.startsWith("payment-")){const H=ce.id.split("-"),Y=H[1],W=H[2],le=f.find(ye=>ye.id===Y);if(le){const ye={...le.expectedPaymentDates};ye[W]=b.start,await h(Y,{expectedPaymentDates:ye})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let H=b.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(H=H.replace(Y,""),ce.mergedEventIds&&ce.mergedEventIds.length>0){console.log(" Updating merged schedules:",ce.mergedEventIds);const W=(ce.originalTitle||ce.title).split(", "),le=H.split(", ");for(let ye=0;ye<ce.mergedEventIds.length;ye++){const ge=ce.mergedEventIds[ye],ut=le[ye]||W[ye]||H;await o(ge,{title:ut.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await o(ce.id,{title:H,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const H={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(H)}Ne(!1)}catch(H){console.error("Failed to save schedule:",H),oe.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const H=b.split("-"),Y=H[1],W=H[2],le=f.find(ye=>ye.id===Y);if(le){const ye={...le.expectedPaymentDates};delete ye[W],await h(Y,{expectedPaymentDates:ye})}}else if(b.startsWith("as-")){const H=b.replace("as-","");await m(H,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const H=Bt.find(Y=>Y.id===b);if(H!=null&&H.mergedEventIds&&H.mergedEventIds.length>0){console.log("Deleting merged schedules:",H.mergedEventIds);for(const Y of H.mergedEventIds)await l(Y)}else await l(b)}Ne(!1)}catch(H){console.error("Failed to delete schedule:",H),oe.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),L&&Ce&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:X.x-50,top:X.y-15,backgroundColor:L.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:L.originalTitle||L.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Ls&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>ns(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Ls.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>ns(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const b=Ls.mergedEventIds||[Ls.id];await Promise.all(b.map(H=>l(H)))}catch(b){console.error("  :",b),oe.error(" ")}ns(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),N&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{V(!1),k(null),S("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{V(!1),k(null),S("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:b=>S(b.target.value),onKeyDown:b=>b.key==="Enter"&&Re(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Re,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:he?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):M.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:M.map((b,H)=>a.jsxDEV("div",{draggable:(I==null?void 0:I.id)!==b.id,onDragStart:()=>at(H),onDragOver:Y=>wt(Y,H),onDragEnd:ot,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${ht===H?"opacity-50 bg-gray-100":""} ${Ft===H?"border-t-2 border-gray-400":""} ${(I==null?void 0:I.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(I==null?void 0:I.id)===b.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:De,onChange:Y=>qe(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&Qe(),Y.key==="Escape"&&(k(null),qe(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:Qe,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),qe("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:H+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(b),qe(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>vt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),M.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},bI=({projectName:n,onClose:e,type:t="cash"})=>{const s=t==="cash",r=s?"":"",i=s?"      .":"      .",[o,l]=E.useState({receiptDate:Ot(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],y=["","","",""],w=["","","","","","","","","",""];let v="",C=0;for(;f>0;){const B=f%1e4;if(B>0){let T="",F=B,re=0;for(;F>0;){const ee=F%10;ee>0&&(T=w[ee]+y[re]+T),F=Math.floor(F/10),re++}v=T+h[C]+v}f=Math.floor(f/1e4),C++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&l({...o,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(jg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:s?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:Ot(new Date(o.receiptDate),"yyyy MM dd",{locale:xn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:Ot(new Date(o.receiptDate),"yyyy MM dd",{locale:xn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},NI="HVLabImageDB",xI=1,zr="paymentRecordImages";let Jl=null;const jf=()=>new Promise((n,e)=>{if(Jl){n(Jl);return}const t=indexedDB.open(NI,xI);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{Jl=t.result,n(Jl)},t.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains(zr)||r.createObjectStore(zr,{keyPath:"id"})}}),vI=async()=>{try{const n=await jf();return new Promise((e,t)=>{const i=n.transaction(zr,"readonly").objectStore(zr).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(n){console.error("IndexedDB , localStorage :",n);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},_I=async(n,e)=>{try{const t=await jf();return new Promise((s,r)=>{const l=t.transaction(zr,"readwrite").objectStore(zr).put({id:n,images:e});l.onsuccess=()=>s(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},DI=async n=>{try{const e=await jf();return new Promise((t,s)=>{const r=e.transaction(zr,"readwrite"),i=r.objectStore(zr);i.clear(),Object.entries(n).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),s(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},kI=async()=>{try{const n=localStorage.getItem("paymentRecordImages");if(n){const e=JSON.parse(n);Object.keys(e).length>0&&(await DI(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(n){console.error(" :",n)}},Zl=n=>{if(!n)return 0;try{const t=new Date(n).getTime();return isNaN(t)?0:t}catch{return 0}},wg=(n,e,t)=>{if(!n)return null;try{const s=new Date(n);return isNaN(s.getTime())?null:Ot(s,e,t)}catch{return null}},EI=()=>{const{payments:n,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:s,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=$r(),{user:l}=Kr(),u=Cu(),[m,d]=E.useState(""),[f,h]=E.useState(null),[y,w]=E.useState(null),[v,C]=E.useState(!1),[B,T]=E.useState(!1),[F,re]=E.useState(!1),[ee,M]=E.useState(!1),[A,N]=E.useState(""),[V,j]=E.useState("form"),[S,I]=E.useState(!1),[k,De]=E.useState(!1),qe=E.useRef(null),[he,Ue]=E.useState("pending"),[ht,zt]=E.useState("all"),[Ft,ae]=E.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[$e,me]=E.useState(!1),[Re,Qe]=E.useState(null),[vt,at]=E.useState(!1),[wt,ot]=E.useState(""),[ft,fn]=E.useState(!1),K=E.useRef(!1),Pe=E.useRef(!1),He=E.useRef(null),[Se,Ye]=E.useState([]),[It,Wt]=E.useState([]),[dt,P]=E.useState(null),[q,te]=E.useState([]),[Ne,ce]=E.useState([]),[de,Ie]=E.useState(!1),[ze,et]=E.useState({}),[Ee,Un]=E.useState(!1),Bt=()=>{const D=localStorage.getItem("lastSelectedProject"),Q=u.filter(R=>R.status!=="completed");return D&&Q.some(R=>R.name===D)?D:Q.length>0?Q[0].name:""},[ne,Xe]=E.useState({project:"",date:Ot(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});E.useEffect(()=>{(async()=>{try{const Q=await sr.getAllContractors();Ye(Q.map(R=>({id:R._id||R.id,rank:R.rank,companyName:R.companyName,name:R.name,process:R.process,contact:R.contact,accountNumber:R.accountNumber,bankName:R.bankName,notes:R.notes,createdAt:new Date(R.createdAt),updatedAt:new Date(R.updatedAt)})))}catch(Q){console.error("Failed to load contractors:",Q)}})()},[]),E.useEffect(()=>{zt("all"),t().catch(Q=>{console.error("Failed to load projects:",Q)}),e().catch(Q=>{console.error("Failed to load payments:",Q)});const D=()=>{I(window.innerWidth<1024)};if(D(),window.addEventListener("resize",D),u.length>0&&!ne.project&&!Pe.current){const Q=Bt();Q&&(Xe(R=>({...R,project:Q})),localStorage.setItem("lastSelectedProject",Q))}return()=>window.removeEventListener("resize",D)},[]),E.useEffect(()=>{const D=setInterval(()=>{if(He.current){console.log("[ ]     - ");return}console.log("[ ]    ..."),e().catch(R=>{console.error("[ ] :",R)})},3e4),Q=()=>{if(document.visibilityState==="visible"){if(He.current){console.log("[ ]     - ");return}console.log("[ ]   -    ..."),e().catch(R=>{console.error("[ ] :",R)})}};return document.addEventListener("visibilitychange",Q),()=>{clearInterval(D),document.removeEventListener("visibilitychange",Q)}},[e]),E.useEffect(()=>{let D=Cr.getSocket(),Q=0,R=null;const x=U=>{if(console.log(" [ ]    :",U),He.current&&String(U.paymentId)===He.current){console.log(" [ ]    -  ");return}console.log(" [ ] loadPaymentsFromAPI  (  )"),e().catch(X=>{console.error("[ ]  :",X)})},L=()=>(D=Cr.getSocket(),D?(console.log(" [Payments] Socket  , payment:refresh  "),D.on("payment:refresh",x),R&&(clearInterval(R),R=null),!0):!1);return L()||(console.log(" [Payments] Socket  ..."),R=setInterval(()=>{Q++,(L()||Q>=10)&&(R&&(clearInterval(R),R=null),Q>=10&&!Cr.getSocket()&&console.warn(" [Payments] Socket   -   "))},500)),()=>{R&&clearInterval(R);const U=Cr.getSocket();U&&U.off("payment:refresh",x)}},[e]),E.useEffect(()=>{(async()=>{var x,L,U,X;if(K.current)return;const Q=new URLSearchParams(window.location.search),R=Q.get("complete")||Q.get("c");if(R){if(!l){console.log("[ ]   -  ");return}K.current=!0,console.log("[ ]  :",R),window.history.replaceState({},"","/payments"),Pe.current=!0,j("list"),Ue("completed"),zt("all"),Xe(G=>({...G,project:""})),o(String(R),{status:"completed",completionDate:new Date}),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(R),{status:"completed"}),await e();const G=Cr.getSocket();G&&G.emit("payment:refresh",{paymentId:R,status:"completed",updatedAt:new Date().toISOString()})}catch(G){console.error("[ ]  :",G),o(String(R),{status:"pending",completionDate:void 0}),Ue("pending");let Z="  ";((x=G.response)==null?void 0:x.status)===401?Z=" .  ":((L=G.response)==null?void 0:L.status)===404?Z="     (ID: "+R+")":(X=(U=G.response)==null?void 0:U.data)!=null&&X.error?Z=G.response.data.error:G.message&&(Z+=": "+G.message),oe.error(Z)}}})()},[e,i,o,l]),E.useEffect(()=>{if(ne.process){const D=new Set(n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).map(L=>L.bankInfo.accountHolder.trim().toLowerCase())),Q=(L,U)=>{const X=L.toLowerCase(),G=U.toLowerCase();if(X.includes(G)||G.includes(X))return!0;const Z=X.split("/").map(Ce=>Ce.trim()),ie=G.replace(/$/,"").trim();for(const Ce of Z)if(Ce===ie||ie.includes(Ce)||Ce.includes(ie))return!0;return!1},x=Se.filter(L=>{if(!Q(ne.process,L.process))return!1;const X=L.accountNumber&&L.accountNumber.trim()!=="",G=L.name.trim().toLowerCase(),Z=D.has(G);return X||Z}).sort((L,U)=>{const X=L.accountNumber&&L.accountNumber.trim()!=="",G=U.accountNumber&&U.accountNumber.trim()!=="";return X&&!G?-1:!X&&G?1:0});Wt(x)}else Wt([])},[ne.process,Se,n]),E.useEffect(()=>{if(ne.process){const D=(x,L)=>{if(!L)return!1;const U=x.toLowerCase(),X=L.toLowerCase();if(U.includes(X)||X.includes(U))return!0;const G=U.split("/").map(ie=>ie.trim()),Z=X.replace(/$/,"").trim();for(const ie of G)if(ie===Z||Z.includes(ie)||ie.includes(Z))return!0;return!1},Q=n.filter(x=>{var L,U,X;return x.status==="completed"&&x.process&&D(ne.process,x.process)&&((L=x.bankInfo)==null?void 0:L.accountHolder)&&((U=x.bankInfo)==null?void 0:U.bankName)&&((X=x.bankInfo)==null?void 0:X.accountNumber)}),R=new Map;Q.forEach(x=>{const L=`${x.bankInfo.accountHolder}_${x.bankInfo.bankName}_${x.bankInfo.accountNumber}`;R.has(L)||R.set(L,{accountHolder:x.bankInfo.accountHolder,bankName:x.bankInfo.bankName,accountNumber:x.bankInfo.accountNumber,itemName:x.itemName||"",amount:x.amount||0})}),te(Array.from(R.values()))}else te([])},[ne.process,n]),E.useEffect(()=>{var Q;const D=((Q=ne.accountHolder)==null?void 0:Q.trim())||"";if(D.length>=1&&de){const R=[],x=new Set;Se.filter(L=>L.accountNumber&&L.accountNumber.trim()!=="").forEach(L=>{const U=L.name.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),R.push({name:U,bankName:L.bankName||"",accountNumber:L.accountNumber||"",source:"contractor"}))}),n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).forEach(L=>{const U=L.bankInfo.accountHolder.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),R.push({name:U,bankName:L.bankInfo.bankName||"",accountNumber:L.bankInfo.accountNumber||"",source:"payment"}))}),ce(R)}else ce([])},[ne.accountHolder,de,Se,n]);const O=D=>{const Q=D.split(`
`).map(G=>G.trim()).filter(G=>G),R={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},x=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],L=G=>{const Z=["","","","","","","",""];for(const ie of Z)if(G.endsWith(ie)&&G.length>ie.length+1)return G.slice(0,-ie.length);return G},U=G=>{if(!G||G.length<2||G.length>5||!/^[-]{2,5}$/.test(G)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G))return!1;if(G.length>=2){const Ce=G.charAt(0),Je=G.substring(0,2);if(["","","","","","",""].includes(Je)||x.includes(Ce))return!0}return G.length>=2&&G.length<=4},X=Q.some(G=>G.includes(" ")||G.includes(""));if(Q.forEach((G,Z)=>{if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.itemName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.accountHolder=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.bankName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.accountNumber=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*([\d,]+)?/);ie&&(R.amounts.total=parseInt(ie[1].replace(/,/g,"")))}}),!X){let G=-1;if(Q.forEach(Z=>{const ie=Z.match(/\[([^\]]+)\]/);ie&&!R.itemName&&(R.itemName=ie[1].trim())}),Q.forEach((Z,ie)=>{if(Z.includes("")||Z.includes(" ")||Z.includes("()")){R.includeVat=!0;const Ke=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/),Ve=Z.match(/(\d+)\s*\s*?/),Ze=Z.match(/([\d,]+)\s*/);if(Ke){const tt=parseInt(Ke[1])*1e4+parseInt(Ke[2])*1e3;R.amounts.total=tt}else if(Ve){const tt=parseInt(Ve[1])*1e4;R.amounts.total=tt}else if(Ze){const tt=parseInt(Ze[1].replace(/,/g,""));tt>=1e3&&(R.amounts.total=tt)}return}const Je=Z.match(/=\s*([\d,]+)\s*?/);let Fe=null;if(Je){const Ke=parseInt(Je[1].replace(/,/g,""));Ke>=1e3&&(R.amounts.total=Ke)}else{const Ke=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(Ke){const Ve=parseInt(Ke[1])*1e4,Ze=parseInt(Ke[2])*1e3,tt=Ve+Ze;Z.includes("")||Z.includes("")?R.amounts.material=tt:Z.includes("")||Z.includes("")?R.amounts.labor=tt:R.amounts.total||(R.amounts.total=tt),Z=Z.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Fe=Ke}else if(Fe=Z.match(/(\d+)\s*\s*?/),Fe){const Ve=parseInt(Fe[1])*1e4;Z.includes("")||Z.includes("")?R.amounts.material=Ve:Z.includes("")||Z.includes("")?R.amounts.labor=Ve:R.amounts.total||(R.amounts.total=Ve),Z=Z.replace(/(\d+)\s*\s*?/g,"")}}Z.includes("/")&&Z.split("/").forEach(Ve=>{const Ze=Ve.trim();Ze.startsWith("[")||Ze.endsWith("]")||(/^[\d\-]+$/.test(Ze)&&Ze.replace(/\-/g,"").length>=10?R.bankInfo.accountNumber||(R.bankInfo.accountNumber=Ze):U(Ze)&&!R.bankInfo.accountHolder&&(R.bankInfo.accountHolder=Ze))});const fe=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let We="",un=-1;for(const Ke of fe){const Ve=Z.match(Ke);if(Ve&&!R.bankInfo.accountNumber){We=Ve[0],un=Ve.index||-1,R.bankInfo.accountNumber=Ve[0].trim().replace(/\s+/g,"-");const tt=Z.substring(un+We.length).trim().split(/\s+/);for(const nt of tt){if(nt.startsWith("[")||nt.endsWith("]"))continue;const Oe=L(nt);if(U(Oe)){R.bankInfo.accountHolder=Oe;break}}if(!R.bankInfo.accountHolder&&ie>0){const Oe=Q[ie-1].split(/\s+/);for(const st of Oe){if(st.startsWith("[")||st.endsWith("]"))continue;const St=L(st);if(U(St)){R.bankInfo.accountHolder=St;break}}}if(!R.bankInfo.accountHolder&&ie+1<Q.length){const nt=Q[ie+1],Oe=nt.split(/\s+/);for(const st of Oe){if(st.startsWith("[")||st.endsWith("]"))continue;const St=L(st);if(U(St)){R.bankInfo.accountHolder=St;break}}if(!R.bankInfo.accountHolder){const st=nt.match(/^([-]{2,6})/);if(st){const St=L(st[1].trim());U(St)&&(R.bankInfo.accountHolder=St)}}}break}}const Kt=Z.match(/[\d,]+/g);if(Kt){const Ke=We?We.split(/[\s\-]+/).filter(Ve=>Ve):[];Kt.forEach(Ve=>{const Ze=parseInt(Ve.replace(/,/g,"")),tt=Ve.replace(/,/g,""),nt=Ke.some(Oe=>Oe===tt);!R.bankInfo.accountNumber&&tt.length>=10&&tt.length<=20?(R.bankInfo.accountNumber=tt,We=tt):Ze>=1e3&&!Fe&&!nt&&(Z.includes("")||Z.includes("")?R.amounts.material=Ze:Z.includes("")||Z.includes("")?R.amounts.labor=Ze:R.amounts.total||(R.amounts.total=Ze))})}const Ut={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},jt=Object.keys(Ut).sort((Ke,Ve)=>Ve.length-Ke.length);for(const Ke of jt)if(Z.includes(Ke)){const Ve=Ut[Ke];R.bankInfo.bankName=Ve,G=ie;const Ze=new RegExp(`${Ke}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),tt=Z.match(Ze);if(tt){const nt=L(tt[1]);nt&&!/^\d+$/.test(nt)&&nt!==""&&(R.bankInfo.accountHolder=nt)}break}if(!R.bankInfo.bankName){const Ke=Z.match(/([-]+)(|)/);Ke&&(R.bankInfo.bankName=Ke[0])}const Hn=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const Ke of Hn){const Ve=Z.match(Ke);if(Ve&&!R.bankInfo.accountHolder){R.bankInfo.accountHolder=Ve[0].trim();break}}const On=Z.match(/\(([-]{2,5})\)/);if(On&&!R.bankInfo.accountHolder){const Ke=On[1];U(Ke)&&!["","",""].includes(Ke)&&(R.bankInfo.accountHolder=Ke)}if(!R.bankInfo.accountHolder){const Ke=/[-]{2,6}/g,Ve=Z.match(Ke);if(Ve){const Ze=Z.match(/\d{10,}/)||Z.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),tt=Z.match(/||||/);Ve.forEach(nt=>{const Oe=L(nt),st=D.split(`
`)[ie];if(st&&st.includes(`[${nt}]`)||!U(Oe)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Oe))return;const an=Z.indexOf(nt);if(an>0){const Zt=Z[an-1];if(/[-]/.test(Zt))return}if(an+nt.length<Z.length){const Zt=Z[an+nt.length];if(/[-]/.test(Zt))return}if(!(On&&Oe===On[1])){if((Ze||tt)&&!R.bankInfo.accountHolder)R.bankInfo.accountHolder=Oe;else if(!R.bankInfo.accountHolder){const Zt=/||||/,bs=/\d{6,}/;(ie>0&&(bs.test(Q[ie-1])||Zt.test(Q[ie-1]))||ie<Q.length-1&&(bs.test(Q[ie+1])||Zt.test(Q[ie+1]))||Zt.test(Z))&&(R.bankInfo.accountHolder=Oe)}}})}}const Gt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[Ke,Ve]of Object.entries(Gt))if(Z.includes(Ke)){R.vendor=Ve;break}if(ie===0&&!R.itemName){const Ke=Z.replace(/[\[\]{}()<>]/g,"").trim();Ke&&!Ke.includes(" ")&&(U(Ke)||(R.itemName=Ke.substring(0,50)))}}),G>=0&&G+1<Q.length){const Z=Q[G+1],ie=Z.trim();if(/^[-]{2,5}$/.test(ie)&&U(ie))R.bankInfo.accountHolder=ie;else{const Ce=Z.split(/\s+/);for(const Je of Ce){const Fe=L(Je);if(U(Fe)){R.bankInfo.accountHolder=Fe;break}}}}}if(R.itemName&&R.itemName.includes("")&&(R.vendor=""),R.itemName){const G=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Z=R.itemName.toLowerCase(),ie=G.some(fe=>Z===fe.toLowerCase()||Z.startsWith(fe.toLowerCase()+" ")||Z.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Ce=/^[\d\-\s]/.test(R.itemName),Je=/^\d{2,}[\s\-]?\d+/.test(R.itemName.replace(/[-]/g,"").trim()),Fe=R.bankInfo.accountHolder&&(R.itemName===R.bankInfo.accountHolder||R.itemName.includes(R.bankInfo.accountHolder));(ie||Ce||Je||Fe)&&(R.itemName=void 0)}return R},xe=async()=>{var D,Q,R,x,L,U,X,G,Z,ie,Ce;try{const Je=ne.quickText;if(!Je.trim())return;let Fe=n;n.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(Ve=>setTimeout(Ve,100)),Fe=$r.getState().payments,console.log("payments  :",Fe.length,""));const fe=O(Je);console.log("  :",fe);const We={project:ne.project,date:ne.date,quickText:ne.quickText,quickImages:ne.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};P(null),T(!1),re(!1);let un=0;fe.amounts.material&&(un+=fe.amounts.material),fe.amounts.labor&&(un+=fe.amounts.labor),fe.amounts.total&&!fe.amounts.material&&!fe.amounts.labor&&(un=fe.amounts.total),un>0&&(We.amount=un),fe.bankInfo.bankName&&(We.bankName=fe.bankInfo.bankName),fe.bankInfo.accountHolder&&(We.accountHolder=fe.bankInfo.accountHolder),fe.bankInfo.accountNumber&&(We.accountNumber=fe.bankInfo.accountNumber);const Kt=Ve=>Ve?Ve.replace(/[^0-9]/g,""):"",Ut=(Ve,Ze)=>{if(!Ve||!Ze)return!1;const tt=Kt(Ve),nt=Kt(Ze);if(!tt||!nt)return!1;const Oe=6;return tt.length<Oe||nt.length<Oe?tt===nt:nt.includes(tt)||tt.includes(nt)},jt=Kt(fe.bankInfo.accountNumber||""),Hn=fe.bankInfo.accountHolder||"";let On=!1;console.log("===    ==="),console.log(" :",fe.bankInfo.accountNumber),console.log(" :",jt),console.log(" :",Hn),console.log(" :",Se.length),console.log("  :",Fe.filter(Ve=>Ve.status==="completed").length);let Gt=Se.find(Ve=>{const Ze=Kt(Ve.accountNumber||"");return Ze&&Ze===jt});if(!Gt&&jt&&(Gt=Se.find(Ve=>{const Ze=Kt(Ve.accountNumber||"");return Ut(jt,Ze)})),Gt&&(On=!0),!Gt&&Hn&&(Gt=Se.find(Ve=>Ve.name===Hn),Gt)){console.log("  :",Gt.name);const Ve=((D=Gt.accountNumber)==null?void 0:D.replace(/[-\s]/g,""))||"";jt&&!Ut(jt,Ve)?(console.log("    ( ) -  "),On=!1):On=!0}if(Gt&&(Gt.name&&(We.accountHolder=Gt.name,console.log("  :",Gt.name)),Gt.bankName?We.bankName=Gt.bankName:fe.bankInfo.bankName&&(We.bankName=fe.bankInfo.bankName),On&&(We.accountNumber=Gt.accountNumber||fe.bankInfo.accountNumber),P(Gt.id||Gt._id||null),Gt.process&&(We.process=Gt.process)),!Gt){let Ve=!1;console.log("===     ==="),console.log("  payments :",Fe.length,""),console.log(" :",jt),console.log(" :",Hn);const Ze=Fe.filter(st=>st.status==="completed");console.log(" :",Ze.length);const tt=[...new Set(Ze.map(st=>{var St;return(St=st.bankInfo)==null?void 0:St.accountHolder}).filter(Boolean))];console.log("   ( 20):",tt.slice(0,20)),console.log("  ():",jt);const nt=Ze.filter(st=>{var St;return(St=st.bankInfo)==null?void 0:St.accountNumber}).map(st=>{var St,an,Zt;return{holder:(St=st.bankInfo)==null?void 0:St.accountHolder,account:(an=st.bankInfo)==null?void 0:an.accountNumber,clean:Kt(((Zt=st.bankInfo)==null?void 0:Zt.accountNumber)||"")}}).filter(st=>st.clean.includes(jt.substring(0,6))||jt.includes(st.clean.substring(0,6)));console.log("  :",nt);let Oe=Fe.find(st=>{var Zt;const St=Kt(((Zt=st.bankInfo)==null?void 0:Zt.accountNumber)||"");return St&&St===jt&&st.status==="completed"});if(Oe&&console.log("   :",(Q=Oe.bankInfo)==null?void 0:Q.accountHolder,Oe.process),!Oe&&jt&&(Oe=Fe.find(st=>{var an;const St=Kt(((an=st.bankInfo)==null?void 0:an.accountNumber)||"");return Ut(jt,St)&&st.status==="completed"}),Oe&&console.log("   :",(R=Oe.bankInfo)==null?void 0:R.accountHolder,Oe.process)),Oe&&(Ve=!0),!Oe&&Hn&&(Oe=Fe.find(st=>{var St;return((St=st.bankInfo)==null?void 0:St.accountHolder)===Hn&&st.status==="completed"}),Oe)){console.log("    :",(x=Oe.bankInfo)==null?void 0:x.accountHolder,":",Oe.process);const st=Kt(((L=Oe.bankInfo)==null?void 0:L.accountNumber)||"");jt&&!Ut(jt,st)?(console.log("    ( ) -  "),Ve=!1):Ve=!0}Oe?(console.log(" :",{accountHolder:(U=Oe.bankInfo)==null?void 0:U.accountHolder,accountNumber:(X=Oe.bankInfo)==null?void 0:X.accountNumber,bankName:(G=Oe.bankInfo)==null?void 0:G.bankName,process:Oe.process,status:Oe.status,paymentMatchedByAccountNumber:Ve}),(Z=Oe.bankInfo)!=null&&Z.accountHolder&&(We.accountHolder=Oe.bankInfo.accountHolder,console.log("  :",Oe.bankInfo.accountHolder)),(ie=Oe.bankInfo)!=null&&ie.bankName?We.bankName=Oe.bankInfo.bankName:fe.bankInfo.bankName&&(We.bankName=fe.bankInfo.bankName),Ve&&(We.accountNumber=((Ce=Oe.bankInfo)==null?void 0:Ce.accountNumber)||fe.bankInfo.accountNumber),Oe.process&&!We.process?(We.process=Oe.process,console.log("    :",Oe.process)):console.log("   - process:",Oe.process,"updatedFormData.process:",We.process)):console.log("  ")}if(fe.vendor&&(We.process=fe.vendor),!We.process){const Ve=Je.toLowerCase();for(const Ze of um)if(Ve.includes(Ze.toLowerCase())){We.process=Ze;break}}fe.itemName&&(We.itemName=fe.itemName),Xe(We),fe.includeVat&&(T(!0),re(!1));const Ke=[];if(fe.amounts.material||fe.amounts.labor||fe.amounts.total){const Ve=[];fe.amounts.material&&Ve.push(`: ${fe.amounts.material.toLocaleString()}`),fe.amounts.labor&&Ve.push(`: ${fe.amounts.labor.toLocaleString()}`),fe.amounts.total&&!fe.amounts.material&&!fe.amounts.labor&&Ve.push(`: ${fe.amounts.total.toLocaleString()}`),Ke.push(Ve.join(", "))}if(fe.bankInfo.bankName||fe.bankInfo.accountHolder){const Ve=[];fe.bankInfo.bankName&&Ve.push(fe.bankInfo.bankName),fe.bankInfo.accountHolder&&Ve.push(fe.bankInfo.accountHolder),fe.bankInfo.accountNumber&&Ve.push(fe.bankInfo.accountNumber),Ve.length>0&&Ke.push(`: ${Ve.join(" ")}`)}fe.vendor&&Ke.push(`: ${fe.vendor}`),fe.includeVat&&Ke.push("  "),Ke.length>0?oe.success(`  !
${Ke.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):oe.info("  ...    .")}catch(Je){console.error(" :",Je),oe.error("   .")}};E.useEffect(()=>{(async()=>{try{await kI();const Q=await vI();et(Q),Un(!0)}catch(Q){console.error("  :",Q),Un(!0)}})()},[]);const ke=E.useRef({});E.useEffect(()=>{Ee&&(Object.entries(ze).forEach(([D,Q])=>{JSON.stringify(ke.current[D])!==JSON.stringify(Q)&&_I(D,Q).catch(R=>{console.error("  :",R),oe.error("  ")})}),ke.current={...ze})},[ze,Ee]);const Le=E.useCallback(async D=>{var x;const Q=(x=D.clipboardData)==null?void 0:x.items;if(!Q)return;let R=!1;for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){R=!0;break}if(R){if(!f){const L=document.activeElement;(L==null?void 0:L.tagName)==="INPUT"||(L==null?void 0:L.tagName)==="TEXTAREA"||(L==null?void 0:L.classList.contains("form-input"))||oe.error("  ");return}for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){D.preventDefault();const U=Q[L].getAsFile();if(U){const X=new FileReader;X.onload=async G=>{var ie;const Z=(ie=G.target)==null?void 0:ie.result;if(Z)try{const Ce=n.find(fe=>fe.id===f),Fe=[...(Ce==null?void 0:Ce.images)||ze[f]||[],Z];await Es.updatePaymentImages(f,Fe),et(fe=>({...fe,[f]:Fe})),await e(),oe.success(" ")}catch(Ce){console.error("  :",Ce),oe.error("  ")}},X.readAsDataURL(U)}}}},[f,n,ze,e]);E.useEffect(()=>(document.addEventListener("paste",Le),()=>document.removeEventListener("paste",Le)),[Le]);const Dt=[...(l==null?void 0:l.name)===""?n.filter(D=>u.some(Q=>Q.name===D.project)):n].sort((D,Q)=>new Date(Q.requestDate).getTime()-new Date(D.requestDate).getTime()),xt=Dt.filter(D=>{var U,X,G;if(!D||!D.id)return!1;const Q=m===""||((U=D.purpose)==null?void 0:U.toLowerCase().includes(m.toLowerCase()))||((X=D.itemName)==null?void 0:X.toLowerCase().includes(m.toLowerCase()))||((G=D.process)==null?void 0:G.toLowerCase().includes(m.toLowerCase())),R=he==="pending"?D.status!=="completed":D.status==="completed",x=ht==="all"||!ht||D.project===ht,L=!Ft||he!=="completed"||D.requestedBy===(l==null?void 0:l.name);return Q&&R&&x&&L}).sort((D,Q)=>!D&&!Q?0:D?Q?he==="completed"?Zl(Q.completionDate)-Zl(D.completionDate):Zl(Q.requestDate)-Zl(D.requestDate):-1:1),Jt=D=>{const Q=D.id||D._id||null;if(dt===Q){P(null);const U=document.querySelector('input[placeholder=" "]');U&&setTimeout(()=>{U.focus()},100);return}P(Q);const R=za(D.name);let x=D.bankName||"",L=D.accountNumber||"";if(L&&!x){const U=L.trim().split(/\s+/);if(U.length>=2){const X=U[0];(X.includes("")||X.includes("")||X.includes("")||X.includes("")||X.includes(""))&&(x=X,L=U.slice(1).join(""))}}Xe(U=>({...U,accountHolder:R,bankName:x,accountNumber:L}))};xt.reduce((D,Q)=>{const R=Q.materialAmount||0,x=Q.laborAmount||0,L=Q.amount||0;let U=R,X=x,G=0;return R===0&&x===0&&L>0?Q.includesVAT?(U=Math.round(L/1.1),G=L-U):(U=L,G=0):Q.includesVAT?(R>0&&(U=Math.round(R/1.1)),x>0&&(X=Math.round(x/1.1)),G=L-(U+X)):G=0,D.material+=U,D.labor+=X,D.vat+=G,D.total+=L,D},{material:0,labor:0,vat:0,total:0});const Et=async()=>{var Q;if(ft){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ne),!ne.project){oe.error(" ");return}if(!ne.itemName){oe.error(" ");return}const D=Number(ne.amount)||0;if(D===0){oe.error(" ");return}fn(!0);try{const R=F?Math.round(D*.967):D,x=new Date;if(y){const L={project:ne.project,requestDate:new Date(ne.date),purpose:ne.itemName,amount:R,category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:R,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,updatedAt:x};console.log(" Updating payment:",L),await i(y,L),oe.success(" "),w(null)}else{const L=ne.project||"",U={id:`payment_${Date.now()}`,project:L,requestDate:new Date(ne.date),requestedBy:(l==null?void 0:l.name)||"  ",purpose:ne.itemName,amount:R,status:"pending",category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:R,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,quickText:ne.quickText||"",images:ne.quickImages,attachments:[],createdAt:x,updatedAt:x};console.log(" Creating payment:",U),console.log(" Images in payment:",((Q=ne.quickImages)==null?void 0:Q.length)||0,"");const X=await s(U);if(He.current=X,setTimeout(()=>{He.current=null},1e4),oe.success(" "),ne.accountHolder&&ne.bankName&&ne.accountNumber){const G=B||F?"01074088864":"01089423283";try{await we.post("/payments/send-toss-payment-sms",{recipientPhone:G,accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber,amount:R,projectName:L,itemName:ne.itemName,process:ne.process,paymentId:X}),oe.success("   ")}catch(Z){console.error("SMS  :",Z)}}}Xe(L=>({project:L.project,date:Ot(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),T(!1),re(!1),P(null),window.innerWidth<768&&j("list")}catch(R){console.error(" Payment save error:",R),oe.error("  : "+R.message)}finally{fn(!1)}},pn=D=>{var Q,R,x,L;try{console.log("[handleEdit] Starting edit for payment:",D.id);const U=D.originalMaterialAmount!==void 0?D.originalMaterialAmount:D.materialAmount||0,X=D.originalLaborAmount!==void 0?D.originalLaborAmount:D.laborAmount||0,G={project:D.project||"",date:D.requestDate?Ot(new Date(D.requestDate),"yyyy-MM-dd"):Ot(new Date,"yyyy-MM-dd"),process:D.process||"",itemName:D.itemName||D.purpose||"",materialCost:U>0?U.toString():"",laborCost:X>0?X.toString():"",amount:((Q=D.amount)==null?void 0:Q.toString())||"",accountHolder:((R=D.bankInfo)==null?void 0:R.accountHolder)||"",bankName:((x=D.bankInfo)==null?void 0:x.bankName)||"",accountNumber:((L=D.bankInfo)==null?void 0:L.accountNumber)||"",images:D.attachments||[],quickText:D.quickText||"",quickImages:D.images||[]};console.log("[handleEdit] Setting form data:",G),Xe(G),T(D.includesVAT||!1),re(D.applyTaxDeduction||!1),h(D.id),w(D.id),S&&j("form"),console.log("[handleEdit] Edit setup complete"),oe.success("  ")}catch(U){console.error("[handleEdit] Error:",U),oe.error("     ")}},on=async D=>{var Q,R,x;try{const L=((Q=D.bankInfo)==null?void 0:Q.accountHolder)||D.accountHolder,U=((R=D.bankInfo)==null?void 0:R.bankName)||D.bank,X=((x=D.bankInfo)==null?void 0:x.accountNumber)||D.accountNumber;if(!L||!U||!X){oe.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}`))return;const Z=X.replace(/[-\s]/g,""),ie=GC[U]||U,Ce=KC[U]||"004",Je="",Fe=`supertoss://send?amount=${D.amount}&bankCode=${Ce}&bank=${encodeURIComponent(ie)}&accountNo=${Z}&receiverName=${encodeURIComponent(Je)}&toName=${encodeURIComponent(Je)}`;let fe=!1;try{window.location.href=Fe,fe=!0,oe.success("  ...",{duration:3e3}),setTimeout(()=>{const We=/iPhone|iPad|iPod/i.test(navigator.userAgent),un=/Android/i.test(navigator.userAgent);(We||un)&&oe(`      .

: 
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(We){console.error("   :",We),oe(`   .

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(L){console.error(" :",L),oe.error(`   : ${L.message}`)}},Tn=async D=>{const Q=n.find(R=>R.id===D);if(Q&&Q.quickText){const R=localStorage.getItem("executionMemos"),x=R?JSON.parse(R):{};x[D]=Q.quickText,localStorage.setItem("executionMemos",JSON.stringify(x))}o(D,{status:"completed",completionDate:new Date}),me(!1),Ue("completed"),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(D,{status:"completed"});const R=Cr.getSocket();R&&R.emit("payment:refresh",{paymentId:D,status:"completed"})}catch(R){console.error(" API :",R),o(D,{status:"pending",completionDate:void 0}),Ue("pending"),oe.error("   -  ")}},ds=async D=>{var x;if(!f){oe.error("  ");return}const R=Array.from(((x=D.target)==null?void 0:x.files)||[]).filter(L=>L.type.startsWith("image/"));if(R.length!==0){try{const L=await Promise.all(R.map(Z=>new Promise((ie,Ce)=>{const Je=new FileReader;Je.onload=Fe=>{var We;const fe=(We=Fe.target)==null?void 0:We.result;fe?ie(fe):Ce(new Error("  "))},Je.onerror=()=>Ce(new Error("FileReader ")),Je.readAsDataURL(Z)}))),U=n.find(Z=>Z.id===f),G=[...(U==null?void 0:U.images)||ze[f]||[],...L];await Es.updatePaymentImages(f,G),et(Z=>({...Z,[f]:G})),await e(),oe.success(`${L.length}  `)}catch(L){console.error("  :",L),oe.error("  ")}D.target.value=""}},Xn=async D=>{if(f)try{const Q=n.find(L=>L.id===f),x=((Q==null?void 0:Q.images)||ze[f]||[]).filter((L,U)=>U!==D);await Es.updatePaymentImages(f,x),et(L=>({...L,[f]:x})),await e()}catch(Q){console.error("  :",Q),oe.error("  ")}},fs=D=>{N(D),M(!0)},ri=D=>{D.preventDefault(),C(!0)},Ls=D=>{D.preventDefault(),C(!1)},ns=async D=>{if(D.preventDefault(),C(!1),!f){oe.error("  ");return}const R=Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/"));if(R.length!==0)try{const x=await Promise.all(R.map(G=>new Promise((Z,ie)=>{const Ce=new FileReader;Ce.onload=Je=>{var fe;const Fe=(fe=Je.target)==null?void 0:fe.result;Fe?Z(Fe):ie(new Error("  "))},Ce.onerror=()=>ie(new Error("FileReader ")),Ce.readAsDataURL(G)}))),L=n.find(G=>G.id===f),X=[...(L==null?void 0:L.images)||ze[f]||[],...x];await Es.updatePaymentImages(f,X),et(G=>({...G,[f]:X})),await e(),oe.success(`${x.length}  `)}catch(x){console.error("  :",x),oe.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ne.project,onChange:D=>{Xe({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2463,columnNumber:35},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2465,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2453,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2452,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2474,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2484,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2473,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2472,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2471,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${V!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ne.project,onChange:D=>{Xe({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2529,columnNumber:43},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2531,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2519,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>Xe({...ne,bankName:D.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2539,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2540,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2541,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2542,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2543,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2544,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2545,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2546,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2549,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2550,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2551,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2534,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2518,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2517,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ne.quickText,onChange:D=>Xe({...ne,quickText:D.target.value}),onPaste:D=>{var R;const Q=(R=D.clipboardData)==null?void 0:R.items;if(Q){for(let x=0;x<Q.length;x++)if(Q[x].type.indexOf("image")!==-1){D.preventDefault();const L=Q[x].getAsFile();if(L){const U=new FileReader;U.onload=X=>{var Z;const G=(Z=X.target)==null?void 0:Z.result;Xe(ie=>({...ie,quickImages:[...ie.quickImages,G]}))},U.readAsDataURL(L)}break}}},onDragOver:D=>{D.preventDefault(),D.stopPropagation()},onDrop:D=>{D.preventDefault(),D.stopPropagation(),Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/")).forEach(x=>{const L=new FileReader;L.onload=U=>{var G;const X=(G=U.target)==null?void 0:G.result;Xe(Z=>({...Z,quickImages:[...Z.quickImages,X]}))},L.readAsDataURL(x)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:S?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2558,columnNumber:15},void 0),ne.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ne.quickImages.map((D,Q)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:D,alt:` ${Q+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2613,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Xe(R=>({...R,quickImages:R.quickImages.filter((x,L)=>L!==Q)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2618,columnNumber:23},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2612,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2610,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:D=>{Array.from(D.target.files||[]).forEach(R=>{const x=new FileReader;x.onload=L=>{var X;const U=(X=L.target)==null?void 0:X.result;Xe(G=>({...G,quickImages:[...G.quickImages,U]}))},x.readAsDataURL(R)}),D.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2637,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2658,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2636,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:xe,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2662,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ne.date&&`(${Ot(new Date(ne.date),"E",{locale:xn})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2675,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ne.date,onChange:D=>Xe({...ne,date:D.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2678,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2674,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2694,columnNumber:17},void 0),a.jsxDEV("button",{ref:qe,type:"button",onClick:()=>De(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ne.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2701,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2695,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2693,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2708,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ne.itemName,onChange:D=>Xe({...ne,itemName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2709,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2707,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2720,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ne.amount?Number(ne.amount).toLocaleString():"",onChange:D=>{const Q=D.target.value.replace(/[^0-9]/g,"");Xe({...ne,amount:Q})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2722,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2733,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2721,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2719,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{B||re(!1),T(!B)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${B?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:B&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2751,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2750,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2753,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2739,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{F||T(!1),re(!F)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${F?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:F&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2769,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2771,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2718,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(It.length>0||q.length>0&&!dt)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${It.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2787,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:It.map(D=>{const Q=D.id||D._id,R=dt===Q;return a.jsxDEV("button",{type:"button",onClick:()=>Jt(D),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${R?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:za(D.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2803,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName||""," ",D.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2806,columnNumber:29},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2793,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2788,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2784,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${q.length===0||dt?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2819,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:q.map((D,Q)=>a.jsxDEV("button",{type:"button",onClick:()=>{Xe(R=>({...R,accountHolder:D.accountHolder,bankName:D.bankName,accountNumber:D.accountNumber})),te([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:D.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2836,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName," ",D.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2839,columnNumber:27},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2822,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2820,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2816,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2782,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountHolder,onChange:D=>Xe({...ne,accountHolder:D.target.value}),onFocus:()=>Ie(!0),onBlur:()=>setTimeout(()=>Ie(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2852,columnNumber:17},void 0),de&&Ne.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:Ne.map((D,Q)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:R=>R.preventDefault(),onClick:()=>{let R=D.bankName||"",x=D.accountNumber||"";const L=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],U={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const X of L)if(x.includes(X)){R||(R=U[X]||X),x=x.replace(X,"").trim();break}for(const X of L)if(R.includes(X)){const G=U[X]||X,Z=R.replace(X,"").trim();Z&&/\d/.test(Z)&&(x=Z),R=G;break}x=x.replace(/[^\d\-]/g,"").trim(),Xe({...ne,accountHolder:D.name,bankName:R||ne.bankName,accountNumber:x||ne.accountNumber}),Ie(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:D.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2952,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:D.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2953,columnNumber:25},void 0)]},`${D.name}-${Q}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2865,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2863,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2850,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2964,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>Xe({...ne,bankName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2970,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2971,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2972,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2973,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2974,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2975,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2976,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2977,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2978,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2979,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2980,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2981,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2982,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2983,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2984,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2985,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2986,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2987,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2988,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2989,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2990,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2991,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2992,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2965,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2963,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2997,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountNumber,onChange:D=>Xe({...ne,accountNumber:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2998,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2996,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3009,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(B||F)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",B&&" ",F&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3012,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const D=Number(ne.amount)||0;let Q=D;return F&&(Q=Math.round(D*.967)),Q.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3016,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3010,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3008,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3007,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&a.jsxDEV("button",{onClick:()=>{w(null),Xe(D=>({project:D.project,date:Ot(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),T(!1),re(!1),P(null),oe.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3035,columnNumber:19},void 0),a.jsxDEV("button",{onClick:D=>{console.log(" Payment button clicked!",D),console.log(" Button element:",D.currentTarget),console.log(" Form data:",ne),Et()},disabled:ft,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ft?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ft?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3064,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3033,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2779,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2515,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2512,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${V!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>Ue("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${he==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${he==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:Dt.filter(D=>D&&D.id&&D.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3103,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3094,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ue("completed"),Xe(D=>({...D,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${he==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${he==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:Dt.filter(D=>D&&D.id&&D.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3122,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3109,columnNumber:17},void 0),he==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Ft,onChange:D=>{ae(D.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(D.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3131,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3130,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3093,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3092,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3091,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3146,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:xt.length>0?a.jsxDEV("div",{className:"space-y-4",children:xt.map(D=>{var X,G,Z;const Q=D.amount||0,R=((X=D.bankInfo)==null?void 0:X.accountHolder)||D.accountHolder||"",x=((G=D.bankInfo)==null?void 0:G.bankName)||D.bank||"",L=((Z=D.bankInfo)==null?void 0:Z.accountNumber)||D.accountNumber||"",U=R&&x&&L?`${R} | ${x} ${L}`:" ";return a.jsxDEV("div",{onClick:()=>h(D.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===D.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[D.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",D.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3178,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:D.purpose||D.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3180,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3176,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:D.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3184,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3175,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[Q.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3187,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[D.requestedBy||"-","  ",wg(D.requestDate,"MM/dd",{locale:xn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3190,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3174,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3198,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3199,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3200,columnNumber:25},void 0),D.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3203,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3204,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3202,columnNumber:27},void 0),D.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3209,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3210,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3208,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3197,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:U},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3217,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),pn(D)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(Fx,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3229,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3221,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async ie=>{ie.stopPropagation(),window.confirm("  ?")&&(await r(D.id),oe.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ki,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3242,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3231,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3220,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3216,columnNumber:23},void 0),he==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:ie=>{if(ie.stopPropagation(),D.status==="completed"){oe.info("   ");return}on(D)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${D.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:D.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3251,columnNumber:27},void 0),a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),Tn(D.id)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${D.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:D.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3269,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:25},void 0)]},D.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3164,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3150,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3300,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3148,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3087,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${V!=="image"?"hidden lg:flex":""}`,onDragOver:ri,onDragLeave:Ls,onDrop:ns,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:ds,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3316,columnNumber:11},void 0),S&&f&&V==="image"&&(()=>{const D=Dt.find(Q=>Q.id===f);return D?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:D.purpose||D.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3333,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[D.process||"-","  ",wg(D.requestDate,"yyyy.MM.dd",{locale:xn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3334,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3332,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(D.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3338,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3331,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3330,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:D=>{var R;const Q=D.target;if(!Q.closest("img")&&!Q.closest("button")&&f){const x=Dt.find(G=>G.id===f),L=(x==null?void 0:x.images)||[],U=ze[f]||[];(L.length>0?L:U).length>0&&((R=document.getElementById("image-file-input"))==null||R.click())}},children:f?(()=>{const D=Dt.find(L=>L.id===f),Q=(D==null?void 0:D.images)||[],R=ze[f]||[],x=Q.length>0?Q:R;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3374,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(D==null?void 0:D.quickText)||(D==null?void 0:D.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3375,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3373,columnNumber:19},void 0),x.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:x.map((L,U)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:L,alt:` ${U+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:X=>{X.stopPropagation(),fs(L)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3389,columnNumber:27},void 0),a.jsxDEV("button",{onClick:X=>{X.stopPropagation(),Xn(U)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(vn,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3405,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3398,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[U+1,"/",x.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3407,columnNumber:27},void 0)]},U,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3388,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3386,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${x.length>0?"":"flex-1"}`,onClick:L=>L.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${x.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(pm,{className:`mx-auto text-gray-400 mb-1 ${x.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3426,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:x.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3427,columnNumber:23},void 0),x.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3431,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3421,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3416,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3371,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(Ea,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3440,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3441,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3439,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3438,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3348,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3308,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2509,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3456,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>De(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vn,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3461,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3457,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3455,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:um.map(D=>a.jsxDEV("button",{onClick:()=>{Xe({...ne,process:D}),De(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3466,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Xe({...ne,process:""}),De(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3485,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3465,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3454,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3453,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>De(!1),children:a.jsxDEV("div",{onClick:D=>D.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:qe.current?`${qe.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:qe.current?`${qe.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3509,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>De(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vn,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3510,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3508,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:um.map(D=>a.jsxDEV("button",{onClick:()=>{Xe({...ne,process:D}),De(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3519,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Xe({...ne,process:""}),De(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3538,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3518,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3500,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3499,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3451,columnNumber:9},void 0),ee&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>M(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:D=>{D.stopPropagation(),M(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(vn,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3567,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3560,columnNumber:13},void 0),a.jsxDEV("img",{src:A,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:D=>D.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3569,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3559,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3555,columnNumber:9},void 0),vt&&a.jsxDEV(bI,{projectName:wt,onClose:()=>at(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3581,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2450,columnNumber:5},void 0)},AI=()=>{var ne,Xe;const{user:n}=Kr(),{loadProjectsFromAPI:e,projects:t}=$r(),s=Cu(),[r,i]=E.useState([]),[o,l]=E.useState(!0),[u,m]=E.useState(null),[d,f]=E.useState([]),[h,y]=E.useState(!1),[w,v]=E.useState(""),[C,B]=E.useState(""),[T,F]=E.useState(null),[re,ee]=E.useState(null),[M,A]=E.useState(""),[N,V]=E.useState(null),[j,S]=E.useState(""),[I,k]=E.useState(null),[De,qe]=E.useState(new Set),he=E.useRef(null),[Ue,ht]=E.useState(window.innerWidth<768),[zt,Ft]=E.useState(!1),[ae,$e]=E.useState(null),[me,Re]=E.useState(new Set),[Qe,vt]=E.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[at,wt]=E.useState(!1),[ot,ft]=E.useState(!1),[fn,K]=E.useState(new Set);E.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(Qe))},[Qe]),E.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const xe=()=>{ht(window.innerWidth<768)};return window.addEventListener("resize",xe),()=>window.removeEventListener("resize",xe)},[]),E.useEffect(()=>{o||Pe()},[s,o]),E.useEffect(()=>{u!==null&&He()},[u]),E.useEffect(()=>{u!==null&&(n!=null&&n.id)&&localStorage.setItem(`finishCheck_selectedProject_${n.id}`,u.toString())},[u,n==null?void 0:n.id]),E.useEffect(()=>{if(!Ue&&I){const O=async xe=>{var Le;const ke=(Le=xe.clipboardData)==null?void 0:Le.items;if(ke){for(let ue=0;ue<ke.length;ue++)if(ke[ue].type.indexOf("image")!==-1){xe.preventDefault();const Dt=ke[ue].getAsFile();Dt&&await Ie(I,Dt)}}};return document.addEventListener("paste",O),()=>document.removeEventListener("paste",O)}},[I,Ue]);const Pe=async()=>{try{const O=s.map(ke=>({id:ke.id,title:ke.name}));i(O);const xe=n!=null&&n.id?localStorage.getItem(`finishCheck_selectedProject_${n.id}`):null;xe&&O.some(ke=>ke.id===Number(xe))?m(Number(xe)):O.length>0&&m(O[0].id)}catch(O){console.error("Failed to load projects:",O),oe.error("   ")}},He=async()=>{try{d.length===0&&y(!0);const O=u?`/finish-check/spaces?project_id=${u}`:"/finish-check/spaces",ke=(await we.get(O)).data.map(Le=>({...Le,items:Le.items.map(ue=>({...ue,images:ue.images||[]}))}));f(ke)}catch(O){console.error("Failed to load spaces:",O),oe.error("   ")}finally{y(!1)}},Se=async O=>{if(fn.has(O))return null;try{K(Le=>new Set(Le).add(O));const ke=(await we.get(`/finish-check/images/${O}`)).data.image_data;return f(Le=>Le.map(ue=>({...ue,items:ue.items.map(Dt=>({...Dt,images:Dt.images.map(xt=>xt.id===O?{...xt,image_data:ke}:xt)}))}))),ke}catch(xe){return console.error("   :",xe),null}finally{K(xe=>{const ke=new Set(xe);return ke.delete(O),ke})}},Ye=async O=>{const xe=d.find(ue=>ue.items.some(Dt=>Dt.id===O)),ke=xe==null?void 0:xe.items.find(ue=>ue.id===O);if(!ke)return;const Le=ke.images.filter(ue=>!ue.image_data);await Promise.all(Le.map(ue=>Se(ue.id)))},It=async()=>{if(!ot){if(!w.trim()){oe.error("  ");return}if(!u){oe.error(" ");return}ft(!0);try{const O=await we.post("/finish-check/spaces",{name:w.trim(),project_id:u}),xe={...O.data,items:O.data.items||[]};f([...d,xe]),v(""),wt(!1),oe.success(" ")}catch(O){console.error("Failed to add space:",O),oe.error("  ")}finally{ft(!1)}}},Wt=async(O,xe)=>{if(!xe.trim()){oe.error("  ");return}try{await we.put(`/finish-check/spaces/${O}`,{name:xe.trim()}),f(d.map(ke=>ke.id===O?{...ke,name:xe.trim()}:ke)),ee(null),A(""),oe.success("  ")}catch(ke){console.error("Failed to update space:",ke),oe.error("  ")}},dt=O=>{$e(O),Re(new Set)},P=async()=>{if(ae!==null){if(me.size===0){oe.error("  ");return}try{await Promise.all(Array.from(me).map(O=>we.delete(`/finish-check/items/${O}`))),f(d.map(O=>O.id===ae?{...O,items:O.items.filter(xe=>!me.has(xe.id))}:O)),oe.success(`${me.size}  `),$e(null),Re(new Set)}catch(O){console.error("Failed to delete items:",O),oe.error("  ")}}},q=async()=>{if(ae===null)return;const O=d.find(xe=>xe.id===ae);if(O&&confirm(`"${O.name}"  ?

        .`))try{await we.delete(`/finish-check/spaces/${ae}`),f(d.filter(xe=>xe.id!==ae)),oe.success(" "),$e(null),Re(new Set)}catch(xe){console.error("Failed to delete space:",xe),oe.error("  ")}},te=async O=>{if(!C.trim()){oe.error("  ");return}const xe=-Date.now(),ke={id:xe,space_id:O,content:C.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(ue=>ue.id===O?{...ue,items:[...ue.items,ke]}:ue));const Le=C.trim();B(""),F(null);try{const ue=await we.post("/finish-check/items",{space_id:O,content:Le});f(Dt=>Dt.map(xt=>xt.id===O?{...xt,items:xt.items.map(Jt=>Jt.id===xe?{...ue.data,images:[]}:Jt)}:xt))}catch(ue){console.error("Failed to add item:",ue),f(Dt=>Dt.map(xt=>xt.id===O?{...xt,items:xt.items.filter(Jt=>Jt.id!==xe)}:xt)),oe.error("  ")}},Ne=async O=>{try{const xe=await we.put(`/finish-check/items/${O}/toggle`);f(d.map(ke=>({...ke,items:ke.items.map(Le=>Le.id===O?{...Le,...xe.data}:Le)})))}catch(xe){console.error("Failed to toggle item:",xe),oe.error("   ")}},ce=async O=>{try{const xe=await we.put(`/finish-check/items/${O}/toggle-priority`);f(d.map(ke=>({...ke,items:ke.items.map(Le=>Le.id===O?{...Le,is_priority:xe.data.is_priority}:Le)})))}catch(xe){console.error("Failed to toggle priority:",xe),oe.error("  ")}},de=O=>new Promise((xe,ke)=>{const Le=new FileReader;Le.readAsDataURL(O),Le.onload=()=>xe(Le.result),Le.onerror=ue=>ke(ue)}),Ie=async(O,xe)=>{var ue,Dt;if(!["image/jpeg","image/png","image/webp"].includes(xe.type)){oe.error("JPEG, PNG, WebP    ");return}const Le=5*1024*1024;if(xe.size>Le){oe.error("  5MB  ");return}try{qe(Et=>new Set([...Et,O]));const xt=await de(xe),Jt=await we.post(`/finish-check/items/${O}/images`,{image_data:xt,filename:xe.name});f(d.map(Et=>({...Et,items:Et.items.map(pn=>pn.id===O?{...pn,images:[...pn.images,Jt.data]}:pn)}))),oe.success(" ")}catch(xt){console.error("Failed to upload image:",xt),oe.error(((Dt=(ue=xt.response)==null?void 0:ue.data)==null?void 0:Dt.error)||"  ")}finally{qe(xt=>{const Jt=new Set(xt);return Jt.delete(O),Jt})}},ze=async(O,xe)=>{const ke=xe.target.files;if(!(!ke||ke.length===0)){for(let Le=0;Le<ke.length;Le++)await Ie(O,ke[Le]);he.current&&(he.current.value="")}},et=async(O,xe)=>{if(confirm("  ?"))try{await we.delete(`/finish-check/images/${xe}`),f(d.map(ke=>({...ke,items:ke.items.map(Le=>Le.id===O?{...Le,images:Le.images.filter(ue=>ue.id!==xe)}:Le)}))),oe.success(" ")}catch(ke){console.error("Failed to delete image:",ke),oe.error("  ")}},Ee=async(O,xe)=>{O.preventDefault(),O.stopPropagation();const ke=O.dataTransfer.files;if(!(!ke||ke.length===0))for(let Le=0;Le<ke.length;Le++)ke[Le].type.startsWith("image/")&&await Ie(xe,ke[Le])},Un=O=>{O.preventDefault(),O.stopPropagation()};if(h)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:613,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:7},void 0);const Bt=I?d.flatMap(O=>O.items).find(O=>O.id===I):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:he,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:O=>{I&&ze(I,O)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:625,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:Ue?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:O=>{const xe=O.target.value?Number(O.target.value):null;m(xe)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:655,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:646,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>vt(!Qe),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${Qe?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Qe?" ":" ",children:Qe?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:665,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>wt(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV(No,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:683,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:678,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:644,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:691,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:O=>{const xe=O.target.value?Number(O.target.value):null;m(xe)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:700,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:702,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:692,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:690,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:711,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:w,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&It()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:713,columnNumber:19},void 0),a.jsxDEV("button",{onClick:It,disabled:ot,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV(No,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:731,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:725,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:710,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>vt(!Qe),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${Qe?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Qe?" ":" ",children:Qe?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:738,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:737,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:641,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:757,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((O,xe)=>{const ke=O.items.filter(ue=>!ue.is_completed).sort((ue,Dt)=>(Dt.is_priority||0)-(ue.is_priority||0)),Le=O.items.filter(ue=>ue.is_completed);return Qe&&ke.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[re===O.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:M,onChange:ue=>A(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"?Wt(O.id,M):ue.key==="Escape"&&(ee(null),A(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:776,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Wt(O.id,M),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(Tg,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:795,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:791,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{ee(null),A("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(vn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:797,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:775,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:xe+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0),O.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:810,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[Le.length,"/",O.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:816,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:809,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{T===O.id?(F(null),B("")):F(O.id)},className:`p-1 transition-colors ${T===O.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV(No,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:837,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{ee(O.id),A(O.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(hm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:839,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>dt(O.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(ki,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:849,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:808,columnNumber:23},void 0),T===O.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:C,onChange:ue=>B(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"&&C.trim()&&te(O.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:864,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>te(O.id),disabled:!C.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:877,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:863,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:862,columnNumber:23},void 0),ke.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:ke.map(ue=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>Ne(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:897,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!Ue&&I===ue.id?"font-semibold":""}`,onClick:async()=>{Ue||(k(ue.id),ue.images&&ue.images.length>0&&await Ye(ue.id))},style:{cursor:Ue?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:918,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:904,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(ue.id),Ue&&Ft(!0),ue.images&&ue.images.length>0&&await Ye(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Ea,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:942,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Jf,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:953,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:944,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:923,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:893,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:891,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:890,columnNumber:23},void 0),!Qe&&Le.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:Le.map(ue=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>Ne(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:971,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!Ue&&I===ue.id?"font-semibold":""}`,onClick:async()=>{Ue||(k(ue.id),ue.images&&ue.images.length>0&&await Ye(ue.id))},style:{cursor:Ue?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:992,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:978,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(ue.id),Ue&&Ft(!0),ue.images&&ue.images.length>0&&await Ye(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Ea,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1016,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:998,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Jf,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1027,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1018,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:997,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:967,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:965,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:964,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:772,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:755,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:639,columnNumber:7},void 0),!Ue&&I&&Bt&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1048,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(vn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1054,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1047,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Bt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1057,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=he.current)==null?void 0:O.click()},disabled:De.has(I),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(pm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1063,columnNumber:15},void 0),De.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1066,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1046,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:O=>Ee(O,I),onDragOver:Un,children:Bt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(Ea,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Bt.images.map(O=>a.jsxDEV("div",{className:"relative group",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1086,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1093,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1092,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>et(I,O.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(Zf,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:21},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1084,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1082,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1071,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1045,columnNumber:9},void 0),Ue&&zt&&I&&Bt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ft(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1130,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1121,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:Bt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1133,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=he.current)==null?void 0:O.click()},disabled:De.has(I),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(pm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1139,columnNumber:17},void 0),De.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1120,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:Bt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(Ea,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Bt.images.map(O=>a.jsxDEV("div",{className:"relative",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1155,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1162,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1161,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>et(I,O.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(Zf,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1169,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1165,columnNumber:23},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1172,columnNumber:25},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1153,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:9},void 0),ae!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ne=d.find(O=>O.id===ae))==null?void 0:ne.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1191,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{$e(null),Re(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1201,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1194,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1189,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1207,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Xe=d.find(O=>O.id===ae))==null?void 0:Xe.items.map(O=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const xe=new Set(me);xe.has(O.id)?xe.delete(O.id):xe.add(O.id),Re(xe)},children:[a.jsxDEV("input",{type:"checkbox",checked:me.has(O.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1227,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${O.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:O.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1214,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1210,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:P,disabled:me.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",me.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1242,columnNumber:15},void 0),a.jsxDEV("button",{onClick:q,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1249,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{$e(null),Re(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1255,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1241,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1188,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1187,columnNumber:9},void 0),at&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1275,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{wt(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1283,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1276,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1274,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1290,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:w,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&w.trim()&&It()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1291,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1289,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{wt(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1307,columnNumber:17},void 0),a.jsxDEV("button",{onClick:It,disabled:!w.trim()||ot,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:ot?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1316,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1306,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1288,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1272,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1271,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:623,columnNumber:5},void 0)};function VI(){const[n,e]=E.useState([]),[t,s]=E.useState(!1),[r,i]=E.useState(null),[o,l]=E.useState(!1),[u,m]=E.useState(null),[d,f]=E.useState(""),[h,y]=E.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[w,v]=E.useState(!1);E.useEffect(()=>{C()},[]),E.useEffect(()=>{const N=()=>{B()};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[]);const C=async()=>{var N,V;try{n.length===0&&s(!0),i(null);const j=await sr.getAllContractors();e(j.map(S=>({id:S._id,rank:S.rank,companyName:S.companyName,name:S.name,position:S.position,process:S.process,contact:S.contact,accountNumber:S.accountNumber,notes:S.notes,createdAt:new Date(S.createdAt),updatedAt:new Date(S.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const S=j instanceof Error&&((V=(N=j.response)==null?void 0:N.data)==null?void 0:V.message);i(S||"   .")}finally{s(!1)}},B=N=>{if(N){m(N);let V="",j=N.accountNumber||"";if(N.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const De of k)if(N.accountNumber.startsWith(De)){V=De,j=N.accountNumber.substring(De.length).trim();break}}let S=N.name,I=N.position||"";I||(I=Wl(N.name),S=za(N.name)),y({rank:N.rank||"",companyName:N.companyName||"",name:S,position:I,process:N.process,contact:N.contact||"",bankName:V,accountNumber:j,notes:N.notes||""})}else m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},T=()=>{l(!1),m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},F=async N=>{var j,S;if(N.preventDefault(),w)return;v(!0);const V=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const I={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:V,notes:h.notes};u?await sr.updateContractor(u.id,I):await sr.createContractor(I),await C(),T()}catch(I){console.error("Failed to save contractor:",I);const k=I instanceof Error&&((S=(j=I.response)==null?void 0:j.data)==null?void 0:S.message);alert(k||"  .")}finally{v(!1)}},re=async N=>{var V,j;if(window.confirm("   ?"))try{await sr.deleteContractor(N),await C()}catch(S){console.error("Failed to delete contractor:",S);const I=S instanceof Error&&((j=(V=S.response)==null?void 0:V.data)==null?void 0:j.message);alert(I||"  .")}},ee=()=>"border-gray-200 text-gray-600 bg-gray-50",M=N=>N?N==="1"?1:N==="1()"?2:N==="2"?3:N==="2()"?4:N==="3"?5:N==="3()"?6:N===""?100:N===""?200:999:999,A=n.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())||N.process.toLowerCase().includes(d.toLowerCase())||N.accountNumber.toLowerCase().includes(d.toLowerCase())||N.contact&&N.contact.toLowerCase().includes(d.toLowerCase())||N.rank&&N.rank.toLowerCase().includes(d.toLowerCase())||N.companyName&&N.companyName.toLowerCase().includes(d.toLowerCase())).sort((N,V)=>{const j=M(N.rank)-M(V.rank);if(j!==0)return j;const S=N.process.localeCompare(V.process,"ko");return S!==0?S:N.name.localeCompare(V.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>B(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(Lg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:C,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):A.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):A.map(N=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${ee(N.rank)}`,children:N.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:za(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.position||Wl(N.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:N.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>B(N),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(hm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(ki,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:C,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):A.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):A.map(N=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[N.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${ee(N.rank)}`,children:N.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),N.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:N.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:za(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>B(N),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(hm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(ki,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(N.position||Wl(N.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.position||Wl(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),N.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),N.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:N.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:T,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(vn,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:F,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:h.rank,onChange:N=>y({...h,rank:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.companyName,onChange:N=>y({...h,companyName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:N=>y({...h,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.position,onChange:N=>y({...h,position:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:N=>y({...h,process:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.contact,onChange:N=>y({...h,contact:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:h.bankName,onChange:N=>y({...h,bankName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:N=>y({...h,accountNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:h.notes,onChange:N=>y({...h,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:T,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:w?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const CI=()=>{const[n,e]=E.useState([]),[t,s]=E.useState(null),[r,i]=E.useState(!1);E.useEffect(()=>{o()},[]);const o=async()=>{try{n.length===0&&i(!0);const f=await we.get("/quote-inquiries");e(f.data)}catch(f){console.error("Failed to load inquiries:",f),oe.error("  ")}finally{i(!1)}},l=async f=>{try{await we.put(`/quote-inquiries/${f}/read`),e(h=>h.map(y=>y.id===f?{...y,isRead:!0}:y)),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},u=f=>{s(f),f.isRead||l(f.id)},m=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await we.delete(`/quote-inquiries/${f}`),e(y=>y.filter(w=>w.id!==f)),(t==null?void 0:t.id)===f&&s(null),oe.success(" ")}catch(y){console.error("Failed to delete inquiry:",y),oe.error("  ")}},d=n.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:93,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:92,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:106,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:103,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:115,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:n.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:135,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:Ot(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:139,columnNumber:25},void 0),a.jsxDEV("button",{onClick:h=>m(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ki,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:147,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:142,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(ep,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:157,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:127,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:121,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:101,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>s(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:Ot(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(Ox,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:194,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:193,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(ep,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(qx,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:204,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:202,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV($x,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:208,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:209,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:207,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:197,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:192,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(zx,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:219,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:218,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:225,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:224,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:231,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:217,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:241,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:240,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:249,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:169,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:99,columnNumber:5},void 0)},wI=()=>{const{login:n}=Kr(),[e,t]=E.useState(!1),{register:s,handleSubmit:r,setValue:i,formState:{errors:o}}=Af(),l=async m=>{t(!0);try{await n(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...s("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...s("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(Wx,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},II=E.lazy(()=>Ys(()=>import("./Drawings-Cxr7bNd0.js"),__vite__mapDeps([0,1,2,3,4,5]))),SI=E.lazy(()=>Ys(()=>import("./SiteLog-CYwhspq-.js"),__vite__mapDeps([6,1,4,2,3,5]))),TI=E.lazy(()=>Ys(()=>import("./AfterService-BWigL-nm.js"),__vite__mapDeps([7,1,2,4,3,5]))),PI=E.lazy(()=>Ys(()=>import("./AdditionalWork-CpusnoG_.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),LI=E.lazy(()=>Ys(()=>import("./ConstructionPayment-DEMOrv-0.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),jI=E.lazy(()=>Ys(()=>import("./WorkRequest-CRtev8Yy.js"),__vite__mapDeps([11,1,2,4,3,5]))),RI=E.lazy(()=>Ys(()=>import("./Specbook-CpvbPM1E.js"),__vite__mapDeps([12,1,2,3,4,5]))),BI=E.lazy(()=>Ys(()=>import("./EstimatePreview-CtITYSNU.js"),__vite__mapDeps([13,1,2,3,4,5]))),UI=E.lazy(()=>Ys(()=>import("./ExecutionHistory-DNjQXdD1.js"),__vite__mapDeps([14,1,4,2,3,5]))),HI=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),MI=new Tx({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function FI(){const[n,e]=E.useState(!1);return E.useEffect(()=>{const t=W_({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),oe.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{oe.dismiss(),oe.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});xC();const s=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(s,5e3);const r=setInterval(s,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=Pa(u,{transports:["websocket","polling"]}),Cr.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;NC(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(Px,{client:MI,children:a.jsxDEV(wx,{children:a.jsxDEV(X_,{children:[a.jsxDEV(E.Suspense,{fallback:a.jsxDEV(HI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(Ix,{children:[a.jsxDEV(Cn,{path:"/login",element:a.jsxDEV(wI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(Cn,{path:"/",element:a.jsxDEV(gC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(Cn,{index:!0,element:a.jsxDEV(Sg,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(Cn,{path:"dashboard",element:a.jsxDEV(QC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(Cn,{path:"projects",element:a.jsxDEV(nw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(Cn,{path:"schedule",element:a.jsxDEV(yI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(Cn,{path:"drawings",element:a.jsxDEV(II,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(Cn,{path:"site-log",element:a.jsxDEV(SI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(Cn,{path:"after-service",element:a.jsxDEV(TI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(Cn,{path:"additional-work",element:a.jsxDEV(PI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(Cn,{path:"construction-payment",element:a.jsxDEV(LI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(Cn,{path:"contractors",element:a.jsxDEV(VI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(Cn,{path:"work-request",element:a.jsxDEV(jI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(Cn,{path:"finish-check",element:a.jsxDEV(AI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(Cn,{path:"specbook",element:a.jsxDEV(RI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(Cn,{path:"estimate-preview",element:a.jsxDEV(BI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(Cn,{path:"execution-history",element:a.jsxDEV(UI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(Cn,{path:"payments",element:a.jsxDEV(EI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(Cn,{path:"quote-inquiry",element:a.jsxDEV(CI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(Jv,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(n){for(const e of n)e.update()});Yg(document.getElementById("root")).render(a.jsxDEV(E.StrictMode,{children:a.jsxDEV(FI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{Es as A,kI as B,Ht as C,vI as D,um as P,be as T,we as a,Cu as b,Mt as c,je as d,lr as e,Lt as f,Gn as g,Xr as h,ws as i,a as j,Bn as k,Oo as l,ct as m,$r as n,Rn as o,Af as p,In as q,xn as r,id as s,dC as t,Kr as u,Y_ as v,nd as w,YI as x,_I as y,oe as z};
