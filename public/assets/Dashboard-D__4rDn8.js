import{u as E,j as e,l as B}from"./index-BjcabfEh.js";import{u as _}from"./dataStore-YeNw4XQ7.js";import{r as L}from"./vendor-react-B9Yt5e0k.js";import{S as U}from"./ScheduleModal-CU9ONXvD.js";import{f as N}from"./formatters-15aXprTM.js";import{T as H}from"./index-CSlX1tQB.js";import{P as S,b as w,e as M}from"./vendor-ui-CcgAtStV.js";import{p as x,q as T,r as D,s as $}from"./vendor-date-9Cl9d1sr.js";import"./vendor-data-BwGxWJIh.js";import"./index.esm-CwHht2tV.js";const h=H,J=()=>{const{schedules:y,loadSchedulesFromAPI:b,addScheduleToAPI:k,deleteScheduleFromAPI:V}=_(),{user:m}=E(),[v,f]=L.useState(!1),p=m!=null&&m.name?m.name.slice(-2):null,j=(m==null?void 0:m.name)==="안팀"?["안팀"]:p?[p,...h.filter(s=>s!==p)]:h,A=s=>{const a=y.filter(t=>t.attendees?!!(t.attendees.includes(s)||t.attendees.includes("HV LAB")&&s!=="안팀"||t.attendees.includes("현장팀")&&["재천","민기"].includes(s)||t.attendees.includes("디자인팀")&&["신애","재성","재현"].includes(s)):!1),d=t=>{const r=new Set;return t.filter(i=>{const o=`${x(new Date(i.start),"yyyy-MM-dd")}|${i.project}|${i.title}`;return r.has(o)?!1:(r.add(o),!0)})},g=d(a.filter(t=>D(new Date(t.start)))),u=d(a.filter(t=>$(new Date(t.start))&&!D(new Date(t.start))).sort((t,r)=>new Date(t.start).getTime()-new Date(r.start).getTime())).slice(0,3);return{todaySchedules:g,upcomingSchedules:u,member:s}};return e.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[e.jsxDEV("div",{children:e.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:j.map(s=>{const{todaySchedules:a,upcomingSchedules:d}=A(s),g=a.length+d.length,u=s===p;return e.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${u?"ring-1 ring-gray-300":""}`,children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:113,columnNumber:21},void 0),u&&e.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:"나"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:112,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex items-center gap-2",children:[u&&e.jsxDEV("button",{onClick:()=>f(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:"일정 추가",children:e.jsxDEV(S,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:23},void 0),e.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${u&&a.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[a.length," 오늘"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},void 0),e.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[d.length," 예정"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:131,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:17},void 0),a.length>0&&e.jsxDEV("div",{className:"mb-4",children:[e.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsxDEV(w,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:141,columnNumber:23},void 0),e.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:"오늘"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:142,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:140,columnNumber:21},void 0),e.jsxDEV("div",{className:"space-y-2",children:(()=>{const t=a.reduce((r,i)=>{const n=i.project||"-";return r[n]||(r[n]=[]),r[n].push(i),r},{});return Object.entries(t).map(([r,i])=>{const n=s===p;return e.jsxDEV("div",{className:`border-l-3 ${n?"border-gray-400":"border-gray-900"} ${n?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[e.jsxDEV("div",{className:`px-3 py-1 ${n?"bg-amber-100":"bg-gray-100"} border-b ${n?"border-amber-200":"border-gray-200"}`,children:e.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:164,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:163,columnNumber:31},void 0),e.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:i.map(o=>{const l=o.time&&o.time!=="-"?` - ${N(o.time)}`:"";return e.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:["• ",o.title,l]},o.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:31},void 0)]},r,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:159,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:19},void 0),d.length>0&&e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsxDEV(M,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:188,columnNumber:23},void 0),e.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:"예정"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:189,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:187,columnNumber:21},void 0),e.jsxDEV("div",{className:"space-y-2",children:(()=>{const t=d.reduce((r,i)=>{const n=x(new Date(i.start),"MM.dd",{locale:B}),o=i.project||"-",l=`${n}|${o}`;return r[l]||(r[l]={date:n,project:o,schedules:[]}),r[l].schedules.push(i),r},{});return Object.values(t).map(({date:r,project:i,schedules:n})=>{const l=n.length>0&&T(new Date(n[0].start))?`${r} (내일)`:r;return e.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[e.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[e.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:211,columnNumber:33},void 0),e.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:212,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:210,columnNumber:31},void 0),e.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:n.map(c=>{const C=c.time&&c.time!=="-"?` - ${N(c.time)}`:"";return e.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:["• ",c.title,C]},c.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:214,columnNumber:31},void 0)]},`${r}-${i}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:209,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:191,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:186,columnNumber:19},void 0),g===0&&e.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"예정된 일정이 없습니다"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:234,columnNumber:19},void 0)]},s,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:109,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:101,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:100,columnNumber:7},void 0),v&&e.jsxDEV(U,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>f(!1),onSave:async s=>{try{console.log("Dashboard: Adding schedule...",s),await k({id:Date.now().toString(),title:s.title||"",start:s.start||new Date,end:s.end||new Date,type:"other",project:s.projectId||s.projectName||"",location:"",attendees:s.assignedTo||[],description:s.description||"",time:s.time}),console.log("Dashboard: Schedule added successfully"),await b(),console.log("Dashboard: Schedules fetched, closing modal"),f(!1)}catch(a){console.error("Failed to add schedule:",a),alert("일정 추가에 실패했습니다: "+(a instanceof Error?a.message:"알 수 없는 오류"))}},onDelete:async s=>{try{await V(s),await b(),f(!1)}catch(a){console.error("Failed to delete schedule:",a),alert("일정 삭제에 실패했습니다: "+(a instanceof Error?a.message:"알 수 없는 오류"))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:246,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:98,columnNumber:5},void 0)};export{J as default};
