const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-nH3_VtDb.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-DdmuQSbR.js","assets/AfterService-DZ7YrAsO.js","assets/AdditionalWork-Bqr94ZOC.js","assets/additionalWorkService-C_kbSaxY.js","assets/ConstructionPayment-ByFfoaPG.js","assets/WorkRequest-n8PxFLsR.js","assets/Specbook-Dc86oDF7.js","assets/EstimatePreview-Dwv1Dbfk.js","assets/ExecutionHistory-BgFn1jRY.js"])))=>i.map(i=>d[i]);
var ex=Object.defineProperty;var tx=(n,e,t)=>e in n?ex(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Af=(n,e,t)=>tx(n,typeof e!="symbol"?e+"":e,t);import{r as V,b as nx,u as og,d as sx,N as ag,e as Nu,O as rx,R as ot,f as Ua,B as ix,h as ox,i as kn}from"./vendor-react-DN7YJcfR.js";import{a as ax,c as Um,Q as lx,b as cx}from"./vendor-data-DrLf5NIQ.js";import{B as xu,X as yn,C as lg,T as xi,a as ux,b as cg,W as mx,c as dx,d as Ns,P as ro,R as fx,e as px,S as ug,f as hx,g as gx,h as mg,i as yx,U as Ou,I as Jo,j as qu,k as Cf,l as wf,m as If,n as bx,M as Nx,o as xx,p as vx,L as _x}from"./vendor-ui-D8A9iq7X.js";import{k as vu,l as Ro,m as Bo,n as Dx,o as kx,p as Ut,q as Ex,r as Tf,s as Vx,t as rt}from"./vendor-date-DbWJ9m7c.js";import{c as Ax,p as dg,l as _c,s as xs,i as Cx,h as wx,q as Hm,a as Mm,m as Fm,b as Ix,d as Dc,o as zl,e as Tx,f as Wl,r as Om,g as qm,j as $m,k as zm,n as Wm,t as fg,u as pg,v as hg,w as gg,x as yg,y as bg,z as Ng,A as xg,B as vg,C as _g,D as Dg,E as kg,F as Sx,G as Px,H as Lx,I as jx,J as Rx,K as Bx,L as Ux}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var Eg={exports:{}},$u={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var n=V,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),I=Symbol.iterator,v="@@iterator";function w(x){if(x===null||typeof x!="object")return null;var k=I&&x[I]||x[v];return typeof k=="function"?k:null}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function P(x){{for(var k=arguments.length,U=new Array(k>1?k-1:0),B=1;B<k;B++)U[B-1]=arguments[B];F("error",x,U)}}function F(x,k,U){{var B=R.ReactDebugCurrentFrame,Y=B.getStackAddendum();Y!==""&&(k+="%s",U=U.concat([Y]));var ne=U.map(function(W){return String(W)});ne.unshift("Warning: "+k),Function.prototype.apply.call(console[x],console,ne)}}var re=!1,Z=!1,M=!1,A=!1,N=!1,C;C=Symbol.for("react.module.reference");function j(x){return!!(typeof x=="string"||typeof x=="function"||x===s||x===i||N||x===r||x===m||x===d||A||x===y||re||Z||M||typeof x=="object"&&x!==null&&(x.$$typeof===h||x.$$typeof===f||x.$$typeof===o||x.$$typeof===l||x.$$typeof===u||x.$$typeof===C||x.getModuleId!==void 0))}function S(x,k,U){var B=x.displayName;if(B)return B;var Y=k.displayName||k.name||"";return Y!==""?U+"("+Y+")":U}function T(x){return x.displayName||"Context"}function E(x){if(x==null)return null;if(typeof x.tag=="number"&&P("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case s:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case l:var k=x;return T(k)+".Consumer";case o:var U=x;return T(U._context)+".Provider";case u:return S(x,x.render,"ForwardRef");case f:var B=x.displayName||null;return B!==null?B:E(x.type)||"Memo";case h:{var Y=x,ne=Y._payload,W=Y._init;try{return E(W(ne))}catch{return null}}}return null}var De=Object.assign,He=0,fe,je,ut,Ft,Rt,oe,Me;function ue(){}ue.__reactDisabledLog=!0;function Pe(){{if(He===0){fe=console.log,je=console.info,ut=console.warn,Ft=console.error,Rt=console.group,oe=console.groupCollapsed,Me=console.groupEnd;var x={configurable:!0,enumerable:!0,value:ue,writable:!0};Object.defineProperties(console,{info:x,log:x,warn:x,error:x,group:x,groupCollapsed:x,groupEnd:x})}He++}}function We(){{if(He--,He===0){var x={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:De({},x,{value:fe}),info:De({},x,{value:je}),warn:De({},x,{value:ut}),error:De({},x,{value:Ft}),group:De({},x,{value:Rt}),groupCollapsed:De({},x,{value:oe}),groupEnd:De({},x,{value:Me})})}He<0&&P("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bt=R.ReactCurrentDispatcher,st;function At(x,k,U){{if(st===void 0)try{throw Error()}catch(Y){var B=Y.stack.trim().match(/\n( *(at )?)/);st=B&&B[1]||""}return`
`+st+x}}var nt=!1,lt;{var an=typeof WeakMap=="function"?WeakMap:Map;lt=new an}function G(x,k){if(!x||nt)return"";{var U=lt.get(x);if(U!==void 0)return U}var B;nt=!0;var Y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var ne;ne=bt.current,bt.current=null,Pe();try{if(k){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(wt){B=wt}Reflect.construct(x,[],W)}else{try{W.call()}catch(wt){B=wt}x.call(W.prototype)}}else{try{throw Error()}catch(wt){B=wt}x()}}catch(wt){if(wt&&B&&typeof wt.stack=="string"){for(var X=wt.stack.split(`
`),de=B.stack.split(`
`),Be=X.length-1,Ke=de.length-1;Be>=1&&Ke>=0&&X[Be]!==de[Ke];)Ke--;for(;Be>=1&&Ke>=0;Be--,Ke--)if(X[Be]!==de[Ke]){if(Be!==1||Ke!==1)do if(Be--,Ke--,Ke<0||X[Be]!==de[Ke]){var Xe=`
`+X[Be].replace(" at new "," at ");return x.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",x.displayName)),typeof x=="function"&&lt.set(x,Xe),Xe}while(Be>=1&&Ke>=0);break}}}finally{nt=!1,bt.current=ne,We(),Error.prepareStackTrace=Y}var _e=x?x.displayName||x.name:"",Ge=_e?At(_e):"";return typeof x=="function"&&lt.set(x,Ge),Ge}function Te(x,k,U){return G(x,!1)}function Re(x){var k=x.prototype;return!!(k&&k.isReactComponent)}function we(x,k,U){if(x==null)return"";if(typeof x=="function")return G(x,Re(x));if(typeof x=="string")return At(x);switch(x){case m:return At("Suspense");case d:return At("SuspenseList")}if(typeof x=="object")switch(x.$$typeof){case u:return Te(x.render);case f:return we(x.type,k,U);case h:{var B=x,Y=B._payload,ne=B._init;try{return we(ne(Y),k,U)}catch{}}}return""}var Qe=Object.prototype.hasOwnProperty,Ct={},Ot=R.ReactDebugCurrentFrame;function at(x){if(x){var k=x._owner,U=we(x.type,x._source,k?k.type:null);Ot.setExtraStackFrame(U)}else Ot.setExtraStackFrame(null)}function L(x,k,U,B,Y){{var ne=Function.call.bind(Qe);for(var W in x)if(ne(x,W)){var X=void 0;try{if(typeof x[W]!="function"){var de=Error((B||"React class")+": "+U+" type `"+W+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof x[W]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw de.name="Invariant Violation",de}X=x[W](k,W,B,U,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Be){X=Be}X&&!(X instanceof Error)&&(at(Y),P("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",B||"React class",U,W,typeof X),at(null)),X instanceof Error&&!(X.message in Ct)&&(Ct[X.message]=!0,at(Y),P("Failed %s type: %s",U,X.message),at(null))}}}var q=Array.isArray;function ee(x){return q(x)}function ye(x){{var k=typeof Symbol=="function"&&Symbol.toStringTag,U=k&&x[Symbol.toStringTag]||x.constructor.name||"Object";return U}}function ce(x){try{return me(x),!1}catch{return!0}}function me(x){return""+x}function Ce(x){if(ce(x))return P("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ye(x)),me(x)}var Fe=R.ReactCurrentOwner,Ze={key:!0,ref:!0,__self:!0,__source:!0},Ee,Sn,jt;jt={};function te(x){if(Qe.call(x,"ref")){var k=Object.getOwnPropertyDescriptor(x,"ref").get;if(k&&k.isReactWarning)return!1}return x.ref!==void 0}function Ye(x){if(Qe.call(x,"key")){var k=Object.getOwnPropertyDescriptor(x,"key").get;if(k&&k.isReactWarning)return!1}return x.key!==void 0}function O(x,k){if(typeof x.ref=="string"&&Fe.current&&k&&Fe.current.stateNode!==k){var U=E(Fe.current.type);jt[U]||(P('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',E(Fe.current.type),x.ref),jt[U]=!0)}}function be(x,k){{var U=function(){Ee||(Ee=!0,P("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",k))};U.isReactWarning=!0,Object.defineProperty(x,"key",{get:U,configurable:!0})}}function ke(x,k){{var U=function(){Sn||(Sn=!0,P("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",k))};U.isReactWarning=!0,Object.defineProperty(x,"ref",{get:U,configurable:!0})}}var Se=function(x,k,U,B,Y,ne,W){var X={$$typeof:e,type:x,key:k,ref:U,props:W,_owner:ne};return X._store={},Object.defineProperty(X._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(X,"_self",{configurable:!1,enumerable:!1,writable:!1,value:B}),Object.defineProperty(X,"_source",{configurable:!1,enumerable:!1,writable:!1,value:Y}),Object.freeze&&(Object.freeze(X.props),Object.freeze(X)),X};function ae(x,k,U,B,Y){{var ne,W={},X=null,de=null;U!==void 0&&(Ce(U),X=""+U),Ye(k)&&(Ce(k.key),X=""+k.key),te(k)&&(de=k.ref,O(k,Y));for(ne in k)Qe.call(k,ne)&&!Ze.hasOwnProperty(ne)&&(W[ne]=k[ne]);if(x&&x.defaultProps){var Be=x.defaultProps;for(ne in Be)W[ne]===void 0&&(W[ne]=Be[ne])}if(X||de){var Ke=typeof x=="function"?x.displayName||x.name||"Unknown":x;X&&be(W,Ke),de&&ke(W,Ke)}return Se(x,X,de,Y,B,Fe.current,W)}}var yt=R.ReactCurrentOwner,_t=R.ReactDebugCurrentFrame;function Kt(x){if(x){var k=x._owner,U=we(x.type,x._source,k?k.type:null);_t.setExtraStackFrame(U)}else _t.setExtraStackFrame(null)}var Nt;Nt=!1;function ln(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function tn(){{if(yt.current){var x=E(yt.current.type);if(x)return`

Check the render method of \``+x+"`."}return""}}function An(x){{if(x!==void 0){var k=x.fileName.replace(/^.*[\\\/]/,""),U=x.lineNumber;return`

Check your code at `+k+":"+U+"."}return""}}var cs={};function Wn(x){{var k=tn();if(!k){var U=typeof x=="string"?x:x.displayName||x.name;U&&(k=`

Check the top-level render call using <`+U+">.")}return k}}function us(x,k){{if(!x._store||x._store.validated||x.key!=null)return;x._store.validated=!0;var U=Wn(k);if(cs[U])return;cs[U]=!0;var B="";x&&x._owner&&x._owner!==yt.current&&(B=" It was passed a child from "+E(x._owner.type)+"."),Kt(x),P('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',U,B),Kt(null)}}function ti(x,k){{if(typeof x!="object")return;if(ee(x))for(var U=0;U<x.length;U++){var B=x[U];ln(B)&&us(B,k)}else if(ln(x))x._store&&(x._store.validated=!0);else if(x){var Y=w(x);if(typeof Y=="function"&&Y!==x.entries)for(var ne=Y.call(x),W;!(W=ne.next()).done;)ln(W.value)&&us(W.value,k)}}}function ws(x){{var k=x.type;if(k==null||typeof k=="string")return;var U;if(typeof k=="function")U=k.propTypes;else if(typeof k=="object"&&(k.$$typeof===u||k.$$typeof===f))U=k.propTypes;else return;if(U){var B=E(k);L(U,x.props,"prop",B,x)}else if(k.PropTypes!==void 0&&!Nt){Nt=!0;var Y=E(k);P("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",Y||"Unknown")}typeof k.getDefaultProps=="function"&&!k.getDefaultProps.isReactClassApproved&&P("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Xn(x){{for(var k=Object.keys(x.props),U=0;U<k.length;U++){var B=k[U];if(B!=="children"&&B!=="key"){Kt(x),P("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",B),Kt(null);break}}x.ref!==null&&(Kt(x),P("Invalid attribute `ref` supplied to `React.Fragment`."),Kt(null))}}var Is={};function Pn(x,k,U,B,Y,ne){{var W=j(x);if(!W){var X="";(x===void 0||typeof x=="object"&&x!==null&&Object.keys(x).length===0)&&(X+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var de=An(Y);de?X+=de:X+=tn();var Be;x===null?Be="null":ee(x)?Be="array":x!==void 0&&x.$$typeof===e?(Be="<"+(E(x.type)||"Unknown")+" />",X=" Did you accidentally export a JSX literal instead of a component?"):Be=typeof x,P("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Be,X)}var Ke=ae(x,k,U,Y,ne);if(Ke==null)return Ke;if(W){var Xe=k.children;if(Xe!==void 0)if(B)if(ee(Xe)){for(var _e=0;_e<Xe.length;_e++)ti(Xe[_e],x);Object.freeze&&Object.freeze(Xe)}else P("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ti(Xe,x)}if(Qe.call(k,"key")){var Ge=E(x),wt=Object.keys(k).filter(function(Yt){return Yt!=="key"}),Gt=wt.length>0?"{key: someKey, "+wt.join(": ..., ")+": ...}":"{key: someKey}";if(!Is[Ge+Gt]){var Bn=wt.length>0?"{"+wt.join(": ..., ")+": ...}":"{}";P(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Gt,Ge,Bn,Ge),Is[Ge+Gt]=!0}}return x===s?Xn(Ke):ws(Ke),Ke}}var _=Pn;$u.Fragment=s,$u.jsxDEV=_})();Eg.exports=$u;var a=Eg.exports,Vg,Sf=nx;{var Pf=Sf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Vg=function(n,e){Pf.usingClientEntryPoint=!0;try{return Sf.createRoot(n,e)}finally{Pf.usingClientEntryPoint=!1}}}const Hx="modulepreload",Mx=function(n){return"/"+n},Lf={},Ks=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=Mx(u),u in Lf)return;Lf[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":Hx,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((h,y)=>{f.addEventListener("load",h),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let Fx={data:""},Ox=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||Fx},qx=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,$x=/\/\*[^]*?\*\/|  +/g,jf=/\n+/g,Vr=(n,e)=>{let t="",s="",r="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":s+=i[1]=="f"?Vr(o,i):i+"{"+Vr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=Vr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Vr.p?Vr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+s},Qs={},Ag=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+Ag(n[t]);return e}return n},zx=(n,e,t,s,r)=>{let i=Ag(n),o=Qs[i]||(Qs[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!Qs[o]){let u=i!==n?n:(m=>{let d,f,h=[{}];for(;d=qx.exec(m.replace($x,""));)d[4]?h.shift():d[3]?(f=d[3].replace(jf," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(jf," ").trim();return h[0]})(n);Qs[o]=Vr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&Qs.g?Qs.g:null;return t&&(Qs.g=Qs[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(Qs[o],e,s,l),o},Wx=(n,e,t)=>n.reduce((s,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":Vr(l,""):l===!1?"":l}return s+r+(o??"")},"");function kc(n){let e=this||{},t=n.call?n(e.p):n;return zx(t.unshift?t.raw?Wx(t,[].slice.call(arguments,1),e.p):t.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):t,Ox(e.target),e.g,e.o,e.k)}let Cg,zu,Wu;kc.bind({g:1});let nr=kc.bind({k:1});function Kx(n,e,t,s){Vr.p=e,Cg=n,zu=t,Wu=s}function $r(n,e){let t=this||{};return function(){let s=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:zu&&zu()},l),t.o=/ *go\d+/.test(u),l.className=kc.apply(t,s)+(u?" "+u:"");let m=n;return n[0]&&(m=l.as||n,delete l.as),Wu&&m[0]&&Wu(l),Cg(m,l)}return r}}var Gx=n=>typeof n=="function",Kl=(n,e)=>Gx(n)?n(e):n,Qx=(()=>{let n=0;return()=>(++n).toString()})(),wg=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),Yx=20,Km="default",Ig=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:s}=e;return Ig(n,{type:n.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...n,toasts:n.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Al=[],Tg={toasts:[],pausedAt:void 0,settings:{toastLimit:Yx}},Rs={},Sg=(n,e=Km)=>{Rs[e]=Ig(Rs[e]||Tg,n),Al.forEach(([t,s])=>{t===e&&s(Rs[e])})},Pg=n=>Object.keys(Rs).forEach(e=>Sg(n,e)),Xx=n=>Object.keys(Rs).find(e=>Rs[e].toasts.some(t=>t.id===n)),Ec=(n=Km)=>e=>{Sg(e,n)},Jx={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Zx=(n={},e=Km)=>{let[t,s]=V.useState(Rs[e]||Tg),r=V.useRef(Rs[e]);V.useEffect(()=>(r.current!==Rs[e]&&s(Rs[e]),Al.push([e,s]),()=>{let o=Al.findIndex(([l])=>l===e);o>-1&&Al.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((l=n[o.type])==null?void 0:l.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((u=n[o.type])==null?void 0:u.duration)||(n==null?void 0:n.duration)||Jx[o.type],style:{...n.style,...(m=n[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},ev=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Qx()}),Ha=n=>(e,t)=>{let s=ev(e,n,t);return Ec(s.toasterId||Xx(s.id))({type:2,toast:s}),s.id},En=(n,e)=>Ha("blank")(n,e);En.error=Ha("error");En.success=Ha("success");En.loading=Ha("loading");En.custom=Ha("custom");En.dismiss=(n,e)=>{let t={type:3,toastId:n};e?Ec(e)(t):Pg(t)};En.dismissAll=n=>En.dismiss(void 0,n);En.remove=(n,e)=>{let t={type:4,toastId:n};e?Ec(e)(t):Pg(t)};En.removeAll=n=>En.remove(void 0,n);En.promise=(n,e,t)=>{let s=En.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(r=>{let i=e.success?Kl(e.success,r):void 0;return i?En.success(i,{id:s,...t,...t==null?void 0:t.success}):En.dismiss(s),r}).catch(r=>{let i=e.error?Kl(e.error,r):void 0;i?En.error(i,{id:s,...t,...t==null?void 0:t.error}):En.dismiss(s)}),n};var tv=1e3,nv=(n,e="default")=>{let{toasts:t,pausedAt:s}=Zx(n,e),r=V.useRef(new Map).current,i=V.useCallback((f,h=tv)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},h);r.set(f,y)},[]);V.useEffect(()=>{if(s)return;let f=Date.now(),h=t.map(y=>{if(y.duration===1/0)return;let I=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(I<0){y.visible&&En.dismiss(y.id);return}return setTimeout(()=>En.dismiss(y.id,e),I)});return()=>{h.forEach(y=>y&&clearTimeout(y))}},[t,s,e]);let o=V.useCallback(Ec(e),[e]),l=V.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=V.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),m=V.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),d=V.useCallback((f,h)=>{let{reverseOrder:y=!1,gutter:I=8,defaultPosition:v}=h||{},w=t.filter(F=>(F.position||v)===(f.position||v)&&F.height),R=w.findIndex(F=>F.id===f.id),P=w.filter((F,re)=>re<R&&F.visible).length;return w.filter(F=>F.visible).slice(...y?[P+1]:[0,P]).reduce((F,re)=>F+(re.height||0)+I,0)},[t]);return V.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},sv=nr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,rv=nr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iv=nr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ov=$r("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${sv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${rv} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${iv} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,av=nr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,lv=$r("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${av} 1s linear infinite;
`,cv=nr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,uv=nr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,mv=$r("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${uv} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,dv=$r("div")`
  position: absolute;
`,fv=$r("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,pv=nr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,hv=$r("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${pv} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gv=({toast:n})=>{let{icon:e,type:t,iconTheme:s}=n;return e!==void 0?typeof e=="string"?V.createElement(hv,null,e):e:t==="blank"?null:V.createElement(fv,null,V.createElement(lv,{...s}),t!=="loading"&&V.createElement(dv,null,t==="error"?V.createElement(ov,{...s}):V.createElement(mv,{...s})))},yv=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,bv=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,Nv="0%{opacity:0;} 100%{opacity:1;}",xv="0%{opacity:1;} 100%{opacity:0;}",vv=$r("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,_v=$r("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Dv=(n,e)=>{let t=n.includes("top")?1:-1,[s,r]=wg()?[Nv,xv]:[yv(t),bv(t)];return{animation:e?`${nr(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${nr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},kv=V.memo(({toast:n,position:e,style:t,children:s})=>{let r=n.height?Dv(n.position||e||"top-center",n.visible):{opacity:0},i=V.createElement(gv,{toast:n}),o=V.createElement(_v,{...n.ariaProps},Kl(n.message,n));return V.createElement(vv,{className:n.className,style:{...r,...t,...n.style}},typeof s=="function"?s({icon:i,message:o}):V.createElement(V.Fragment,null,i,o))});Kx(V.createElement);var Ev=({id:n,className:e,style:t,onHeightUpdate:s,children:r})=>{let i=V.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;s(n,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,s]);return V.createElement("div",{ref:i,className:e,style:t},r)},Vv=(n,e)=>{let t=n.includes("top"),s=t?{top:0}:{bottom:0},r=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:wg()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...s,...r}},Av=kc`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,il=16,Cv=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:s,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=nv(t,i);return V.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:il,left:il,right:il,bottom:il,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,h=m.calculateOffset(d,{reverseOrder:n,gutter:s,defaultPosition:e}),y=Vv(f,h);return V.createElement(Ev,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?Av:"",style:y},d.type==="custom"?Kl(d.message,d):r?r(d):V.createElement(kv,{toast:d,position:f}))}))},ie=En;const qs=Object.create(null);qs.open="0";qs.close="1";qs.ping="2";qs.pong="3";qs.message="4";qs.upgrade="5";qs.noop="6";const Cl=Object.create(null);Object.keys(qs).forEach(n=>{Cl[qs[n]]=n});const Ku={type:"error",data:"parser error"},Lg=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",jg=typeof ArrayBuffer=="function",Rg=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Gm=({type:n,data:e},t,s)=>Lg&&e instanceof Blob?t?s(e):Rf(e,s):jg&&(e instanceof ArrayBuffer||Rg(e))?t?s(e):Rf(new Blob([e]),s):s(qs[n]+(e||"")),Rf=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function Bf(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let _u;function wv(n,e){if(Lg&&n.data instanceof Blob)return n.data.arrayBuffer().then(Bf).then(e);if(jg&&(n.data instanceof ArrayBuffer||Rg(n.data)))return e(Bf(n.data));Gm(n,!1,t=>{_u||(_u=new TextEncoder),e(_u.encode(t))})}const Uf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zo=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Uf.length;n++)Zo[Uf.charCodeAt(n)]=n;const Iv=n=>{let e=n.length*.75,t=n.length,s,r=0,i,o,l,u;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(s=0;s<t;s+=4)i=Zo[n.charCodeAt(s)],o=Zo[n.charCodeAt(s+1)],l=Zo[n.charCodeAt(s+2)],u=Zo[n.charCodeAt(s+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},Tv=typeof ArrayBuffer=="function",Qm=(n,e)=>{if(typeof n!="string")return{type:"message",data:Bg(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:Sv(n.substring(1),e)}:Cl[t]?n.length>1?{type:Cl[t],data:n.substring(1)}:{type:Cl[t]}:Ku},Sv=(n,e)=>{if(Tv){const t=Iv(n);return Bg(t,e)}else return{base64:!0,data:n}},Bg=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},Ug="",Pv=(n,e)=>{const t=n.length,s=new Array(t);let r=0;n.forEach((i,o)=>{Gm(i,!1,l=>{s[o]=l,++r===t&&e(s.join(Ug))})})},Lv=(n,e)=>{const t=n.split(Ug),s=[];for(let r=0;r<t.length;r++){const i=Qm(t[r],e);if(s.push(i),i.type==="error")break}return s};function jv(){return new TransformStream({transform(n,e){wv(n,t=>{const s=t.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let Du;function ol(n){return n.reduce((e,t)=>e+t.length,0)}function al(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)t[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function Rv(n,e){Du||(Du=new TextDecoder);const t=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(s===0){if(ol(t)<1)break;const u=al(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(ol(t)<2)break;const u=al(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),s=3}else if(s===2){if(ol(t)<8)break;const u=al(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(Ku);break}r=d*Math.pow(2,32)+m.getUint32(4),s=3}else{if(ol(t)<r)break;const u=al(t,r);l.enqueue(Qm(i?u:Du.decode(u),e)),s=0}if(r===0||r>n){l.enqueue(Ku);break}}}})}const Hg=4;function bn(n){if(n)return Bv(n)}function Bv(n){for(var e in bn.prototype)n[e]=bn.prototype[e];return n}bn.prototype.on=bn.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};bn.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};bn.prototype.off=bn.prototype.removeListener=bn.prototype.removeAllListeners=bn.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<t.length;r++)if(s=t[r],s===e||s.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};bn.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,r=t.length;s<r;++s)t[s].apply(this,e)}return this};bn.prototype.emitReserved=bn.prototype.emit;bn.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};bn.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Vc=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ms=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Uv="arraybuffer";function Mg(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const Hv=ms.setTimeout,Mv=ms.clearTimeout;function Ac(n,e){e.useNativeTimers?(n.setTimeoutFn=Hv.bind(ms),n.clearTimeoutFn=Mv.bind(ms)):(n.setTimeoutFn=ms.setTimeout.bind(ms),n.clearTimeoutFn=ms.clearTimeout.bind(ms))}const Fv=1.33;function Ov(n){return typeof n=="string"?qv(n):Math.ceil((n.byteLength||n.size)*Fv)}function qv(n){let e=0,t=0;for(let s=0,r=n.length;s<r;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function Fg(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function $v(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function zv(n){let e={},t=n.split("&");for(let s=0,r=t.length;s<r;s++){let i=t[s].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class Wv extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class Ym extends bn{constructor(e){super(),this.writable=!1,Ac(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new Wv(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Qm(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=$v(e);return t.length?"?"+t:""}}class Kv extends Ym{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Lv(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Pv(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Fg()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Og=!1;try{Og=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Gv=Og;function Qv(){}class Yv extends Kv{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}let io=class wl extends bn{constructor(e,t,s){super(),this.createRequest=e,Ac(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=Mg(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=wl.requestsCount++,wl.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Qv,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete wl.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};io.requestsCount=0;io.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Hf);else if(typeof addEventListener=="function"){const n="onpagehide"in ms?"pagehide":"unload";addEventListener(n,Hf,!1)}}function Hf(){for(let n in io.requests)io.requests.hasOwnProperty(n)&&io.requests[n].abort()}const Xv=function(){const n=qg({xdomain:!1});return n&&n.responseType!==null}();class Jv extends Yv{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Xv&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new io(qg,this.uri(),e)}}function qg(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Gv))return new XMLHttpRequest}catch{}if(!e)try{return new ms[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const $g=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Zv extends Ym{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=$g?{}:Mg(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;Gm(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&Vc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Fg()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const ku=ms.WebSocket||ms.MozWebSocket;class e_ extends Zv{createSocket(e,t,s){return $g?new ku(e,t,s):t?new ku(e,t):new ku(e)}doWrite(e,t){this.ws.send(t)}}class t_ extends Ym{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Rv(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),r=jv();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;this._writer.write(s).then(()=>{r&&Vc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const n_={websocket:e_,webtransport:t_,polling:Jv},s_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Gu(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let r=s_.exec(n||""),i={},o=14;for(;o--;)i[r_[o]]=r[o]||"";return t!=-1&&s!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=i_(i,i.path),i.queryKey=o_(i,i.query),i}function i_(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function o_(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(t[r]=i)}),t}const Qu=typeof addEventListener=="function"&&typeof removeEventListener=="function",Il=[];Qu&&addEventListener("offline",()=>{Il.forEach(n=>n())},!1);class Ir extends bn{constructor(e,t){if(super(),this.binaryType=Uv,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=Gu(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=Gu(t.host).host);Ac(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=zv(this.opts.query)),Qu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Il.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Hg,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Ir.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Ir.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(t+=Ov(r)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Vc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,r){if(typeof t=="function"&&(r=t,t=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:e,data:t,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(Ir.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Qu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Il.indexOf(this._offlineEventListener);s!==-1&&Il.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Ir.protocol=Hg;class a_ extends Ir{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;Ir.priorWebsocketSuccess=!1;const r=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!s)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ir.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){s||(s=!0,d(),t.close(),t=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let l_=class extends a_{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>n_[r]).filter(r=>!!r)),super(e,s)}};function c_(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=Gu(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+e,s.href=s.protocol+"://"+i+(t&&t.port===s.port?"":":"+s.port),s}const u_=typeof ArrayBuffer=="function",m_=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,zg=Object.prototype.toString,d_=typeof Blob=="function"||typeof Blob<"u"&&zg.call(Blob)==="[object BlobConstructor]",f_=typeof File=="function"||typeof File<"u"&&zg.call(File)==="[object FileConstructor]";function Xm(n){return u_&&(n instanceof ArrayBuffer||m_(n))||d_&&n instanceof Blob||f_&&n instanceof File}function Tl(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(Tl(n[t]))return!0;return!1}if(Xm(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return Tl(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&Tl(n[t]))return!0;return!1}function p_(n){const e=[],t=n.data,s=n;return s.data=Yu(t,e),s.attachments=e.length,{packet:s,buffers:e}}function Yu(n,e){if(!n)return n;if(Xm(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=Yu(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=Yu(n[s],e));return t}return n}function h_(n,e){return n.data=Xu(n.data,e),delete n.attachments,n}function Xu(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=Xu(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=Xu(n[t],e));return n}const g_=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],y_=5;var Dt;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(Dt||(Dt={}));class b_{constructor(e){this.replacer=e}encode(e){return(e.type===Dt.EVENT||e.type===Dt.ACK)&&Tl(e)?this.encodeAsBinary({type:e.type===Dt.EVENT?Dt.BINARY_EVENT:Dt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Dt.BINARY_EVENT||e.type===Dt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=p_(e),s=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(s),r}}function Mf(n){return Object.prototype.toString.call(n)==="[object Object]"}class Jm extends bn{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===Dt.BINARY_EVENT;s||t.type===Dt.BINARY_ACK?(t.type=s?Dt.EVENT:Dt.ACK,this.reconstructor=new N_(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Xm(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(Dt[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Dt.BINARY_EVENT||s.type===Dt.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(i,t)}else s.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(Jm.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Dt.CONNECT:return Mf(t);case Dt.DISCONNECT:return t===void 0;case Dt.CONNECT_ERROR:return typeof t=="string"||Mf(t);case Dt.EVENT:case Dt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&g_.indexOf(t[0])===-1);case Dt.ACK:case Dt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class N_{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=h_(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const x_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Jm,Encoder:b_,get PacketType(){return Dt},protocol:y_},Symbol.toStringTag,{value:"Module"}));function ys(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const v_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Wg extends bn{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ys(e,"open",this.onopen.bind(this)),ys(e,"packet",this.onpacket.bind(this)),ys(e,"error",this.onerror.bind(this)),ys(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,r,i;if(v_.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:Dt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((s,r)=>{const i=(o,l)=>o?r(o):s(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Dt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Dt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Dt.EVENT:case Dt.BINARY_EVENT:this.onevent(e);break;case Dt.ACK:case Dt.BINARY_ACK:this.onack(e);break;case Dt.DISCONNECT:this.ondisconnect();break;case Dt.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...r){s||(s=!0,t.packet({type:Dt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Dt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function Do(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Do.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};Do.prototype.reset=function(){this.attempts=0};Do.prototype.setMin=function(n){this.ms=n};Do.prototype.setMax=function(n){this.max=n};Do.prototype.setJitter=function(n){this.jitter=n};class Ju extends bn{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Ac(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Do({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||x_;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new l_(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=ys(t,"open",function(){s.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=ys(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ys(e,"ping",this.onping.bind(this)),ys(e,"data",this.ondata.bind(this)),ys(e,"error",this.onerror.bind(this)),ys(e,"close",this.onclose.bind(this)),ys(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Vc(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new Wg(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Uo={};function oa(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=c_(n,e.path||"/socket.io"),s=t.source,r=t.id,i=t.path,o=Uo[r]&&i in Uo[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new Ju(s,e):(Uo[r]||(Uo[r]=new Ju(s,e)),u=Uo[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(oa,{Manager:Ju,Socket:Wg,io:oa,connect:oa});function __(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=n;let l,u,m;const d=async(h=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await Ks(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const y=()=>{h=!0,l==null||l.addEventListener("controlling",I=>{I.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",I=>{typeof I.isUpdate>"u"?typeof I.isExternal<"u"?I.isExternal?y():!h&&(s==null||s()):I.isExternal?window.location.reload():!h&&(s==null||s()):I.isUpdate||s==null||s()}),l.addEventListener("waiting",y),l.addEventListener("externalwaiting",y)}l.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}const D_=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},k_=D_(),Ae=ax.create({baseURL:k_,headers:{"Content-Type":"application/json"}});Ae.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers.Authorization=`Bearer ${e}`),n},n=>Promise.reject(n));Ae.interceptors.response.use(n=>n,n=>{var e,t,s;return((e=n.response)==null?void 0:e.status)===401&&!((s=(t=n.config)==null?void 0:t.url)!=null&&s.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(n)});const E_=10*60*1e3,V_=Um((n,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<E_){console.log("[SpecbookStore]   , ");return}n({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const s=await Ae.get("/specbook/library/meta");n({libraryItems:s.data,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",s.data.length," ")}catch(s){console.error("[SpecbookStore]   :",s),n({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const s=await Ae.get("/specbook/categories");n({categories:s.data,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",s.data.length,"")}catch(s){console.error("[SpecbookStore]   :",s)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:s}=e();await Promise.all([t(),s()])},getLibraryItems:(t,s)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),s&&s.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return s.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:s}=e();return s.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const o=(await Ae.get(`/specbook/project/${t}/meta`)).data;return n(l=>{const u=new Map(l.projectItemsCache);return u.set(t,o),{projectItemsCache:u}}),o}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{n(s=>{const r=new Map(s.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?n(s=>({libraryItems:[t,...s.libraryItems]})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?n(s=>({libraryItems:s.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,s,r)=>{s?n(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&n(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),Kg=V.createContext(void 0);function A_({children:n}){const[e,t]=V.useState(null),[s,r]=V.useState(!0),i=og(),o=V_(f=>f.preloadAll);V.useEffect(()=>{l()},[]);const l=async()=>{var f;try{const h=localStorage.getItem("token");if(!h){r(!1);return}Ae.defaults.headers.common.Authorization=`Bearer ${h}`;const y=await Ae.get("/auth/me");y.data.success&&(t(y.data.user),o())}catch(h){if(((f=h.response)==null?void 0:f.status)===401)localStorage.removeItem("token"),delete Ae.defaults.headers.common.Authorization;else{const I=localStorage.getItem("user");if(I)try{t(JSON.parse(I))}catch{}}}finally{r(!1)}},u=async(f,h)=>{var y,I;try{const v=await Ae.post("/auth/login",{username:f,password:h}),{token:w,user:R}=v.data;localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify(R)),Ae.defaults.headers.common.Authorization=`Bearer ${w}`,t(R),o(),ie.success(`${R.name}, !`);const P=sessionStorage.getItem("redirectAfterLogin");P?(sessionStorage.removeItem("redirectAfterLogin"),i(P)):i("/")}catch(v){const w=v;throw ie.error(((I=(y=w.response)==null?void 0:y.data)==null?void 0:I.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Ae.defaults.headers.common.Authorization,t(null),i("/login"),ie.success("")},d=f=>{t(f)};return a.jsxDEV(Kg.Provider,{value:{user:e,loading:s,login:u,logout:m,updateUser:d},children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:122,columnNumber:5},this)}function zr(){const n=V.useContext(Kg);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const C_={};function w_(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const xa=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(s){return xa(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return xa(s)(t)}}}},I_=(n,e)=>(t,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,R)=>({...R,...w}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...w)},s,r);const d=xa(i.serialize),f=()=>{const w=i.partialize({...s()});let R;const P=d({state:w,version:i.version}).then(F=>m.setItem(i.name,F)).catch(F=>{R=F});if(R)throw R;return P},h=r.setState;r.setState=(w,R)=>{h(w,R),f()};const y=n((...w)=>{t(...w),f()},s,r);let I;const v=()=>{var w;if(!m)return;o=!1,l.forEach(P=>P(s()));const R=((w=i.onRehydrateStorage)==null?void 0:w.call(i,s()))||void 0;return xa(m.getItem.bind(m))(i.name).then(P=>{if(P)return i.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==i.version){if(i.migrate)return i.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var F;return I=i.merge(P,(F=s())!=null?F:y),t(I,!0),f()}).then(()=>{R==null||R(I,void 0),o=!0,u.forEach(P=>P(I))}).catch(P=>{R==null||R(void 0,P)})};return r.persist={setOptions:w=>{i={...i,...w},w.getStorage&&(m=w.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},v(),I||y},T_=(n,e)=>(t,s,r)=>{let i={storage:w_(()=>localStorage),partialize:v=>v,version:0,merge:(v,w)=>({...w,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},s,r);const d=()=>{const v=i.partialize({...s()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,w)=>{f(v,w),d()};const h=n((...v)=>{t(...v),d()},s,r);r.getInitialState=()=>h;let y;const I=()=>{var v,w;if(!m)return;o=!1,l.forEach(P=>{var F;return P((F=s())!=null?F:h)});const R=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(v=s())!=null?v:h))||void 0;return xa(m.getItem.bind(m))(i.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==i.version){if(i.migrate)return[!0,i.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var F;const[re,Z]=P;if(y=i.merge(Z,(F=s())!=null?F:h),t(y,!0),re)return d()}).then(()=>{R==null||R(y,void 0),y=s(),o=!0,u.forEach(P=>P(y))}).catch(P=>{R==null||R(void 0,P)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||I(),y||h},S_=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((C_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),I_(n,e)):T_(n,e),Gg=S_,Qg=Um()(Gg((n,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const s={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};n(r=>({notifications:[s,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{n(s=>({notifications:s.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{n(t=>({notifications:t.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},deleteNotification:t=>{n(s=>{const r=s.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:s.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAll:()=>{n({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:n=>({notifications:n.notifications,unreadCount:n.unreadCount})}));var P_={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},L_=function(e,t,s){var r,i=P_[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?r+" ":r+" ":r},j_={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},R_={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},B_={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},U_={date:vu({formats:j_,defaultWidth:"full"}),time:vu({formats:R_,defaultWidth:"full"}),dateTime:vu({formats:B_,defaultWidth:"full"})},H_={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},M_=function(e,t,s,r){return H_[e]},F_={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},O_={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},q_={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},$_={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},z_={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},W_={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},K_=function(e,t){var s=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(s);case"date":return s+"";default:return s+""}},G_={ordinalNumber:K_,era:Ro({values:F_,defaultWidth:"wide"}),quarter:Ro({values:O_,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Ro({values:q_,defaultWidth:"wide"}),day:Ro({values:$_,defaultWidth:"wide"}),dayPeriod:Ro({values:z_,defaultWidth:"wide",formattingValues:W_,defaultFormattingWidth:"wide"})},Q_=/^(\d+)(|)?/i,Y_=/\d+/i,X_={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},J_={any:[/^(bc|)/i,/^(ad|)/i]},Z_={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},eD={any:[/1/i,/2/i,/3/i,/4/i]},tD={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},nD={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},sD={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},rD={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},iD={any:/^(am|pm|||||||)/i},oD={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},aD={ordinalNumber:Dx({matchPattern:Q_,parsePattern:Y_,valueCallback:function(e){return parseInt(e,10)}}),era:Bo({matchPatterns:X_,defaultMatchWidth:"wide",parsePatterns:J_,defaultParseWidth:"any"}),quarter:Bo({matchPatterns:Z_,defaultMatchWidth:"wide",parsePatterns:eD,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Bo({matchPatterns:tD,defaultMatchWidth:"wide",parsePatterns:nD,defaultParseWidth:"any"}),day:Bo({matchPatterns:sD,defaultMatchWidth:"wide",parsePatterns:rD,defaultParseWidth:"any"}),dayPeriod:Bo({matchPatterns:iD,defaultMatchWidth:"any",parsePatterns:oD,defaultParseWidth:"any"})},gn={code:"ko",formatDistance:L_,formatLong:U_,formatRelative:M_,localize:G_,match:aD,options:{weekStartsOn:0,firstWeekContainsDate:1}};const lD=({isOpen:n,onClose:e})=>{const t=og(),{notifications:s,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=Qg();if(!n)return null;const m=h=>{switch(h){case"payment":return a.jsxDEV(dx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(mx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(cg,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(ux,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(xu,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(t(h.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(xu,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(yn,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),s.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(lg,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(xi,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(xu,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:s.map(h=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:m(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:kx(new Date(h.createdAt),{addSuffix:!0,locale:gn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:y=>{y.stopPropagation(),l(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(yn,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},cD={getAllWorkRequests:async()=>(await Ae.get("/workrequests")).data,getWorkRequestById:async n=>(await Ae.get(`/workrequests/${n}`)).data,createWorkRequest:async n=>{console.log("[workRequestService.createWorkRequest] Input data:",n);const e={project:n.project,requestType:n.requestType,description:n.description,requestDate:n.requestDate instanceof Date?n.requestDate.toISOString():n.requestDate,dueDate:n.dueDate instanceof Date?n.dueDate.toISOString():n.dueDate,requestedBy:n.requestedBy,assignedTo:n.assignedTo,priority:n.priority||"medium",status:n.status||"pending",notes:n.notes||""};return console.log("[workRequestService.createWorkRequest] Sending to backend:",e),(await Ae.post("/workrequests",e)).data},updateWorkRequest:async(n,e)=>{console.log("[workRequestService.updateWorkRequest] Input data:",e);const t={};return e.project!==void 0&&(t.project=e.project),e.requestType!==void 0&&(t.requestType=e.requestType),e.description!==void 0&&(t.description=e.description),e.requestDate!==void 0&&(t.requestDate=e.requestDate instanceof Date?e.requestDate.toISOString():e.requestDate),e.dueDate!==void 0&&(t.dueDate=e.dueDate instanceof Date?e.dueDate.toISOString():e.dueDate),e.requestedBy!==void 0&&(t.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(t.assignedTo=e.assignedTo),e.priority!==void 0&&(t.priority=e.priority),e.status!==void 0&&(t.status=e.status),e.notes!==void 0&&(t.notes=e.notes),e.completedDate!==void 0&&(t.completedDate=e.completedDate instanceof Date?e.completedDate.toISOString():e.completedDate),console.log("[workRequestService.updateWorkRequest] Sending to backend:",t),(await Ae.put(`/workrequests/${n}`,t)).data},deleteWorkRequest:async n=>{await Ae.delete(`/workrequests/${n}`)}},uD=()=>{};var Ff={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},mD=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Xg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,m=u?n[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let h=(l&15)<<2|m>>6,y=m&63;u||(y=64,o||(h=64)),s.push(t[d],t[f],t[h],t[y])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Yg(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const m=r<n.length?t[n.charAt(r)]:64;++r;const f=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new dD;const h=i<<2|l>>4;if(s.push(h),m!==64){const y=l<<4&240|m>>2;if(s.push(y),f!==64){const I=m<<6&192|f;s.push(I)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class dD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fD=function(n){const e=Yg(n);return Xg.encodeByteArray(e,!0)},Gl=function(n){return fD(n).replace(/\./g,"")},pD=function(n){try{return Xg.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hD=()=>Jg().__FIREBASE_DEFAULTS__,gD=()=>{if(typeof process>"u"||typeof Ff>"u")return;const n=Ff.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},yD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&pD(n[1]);return e&&JSON.parse(e)},Zm=()=>{try{return uD()||hD()||gD()||yD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bD=n=>{var e,t;return(t=(e=Zm())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Zg=n=>{const e=bD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},ey=()=>{var n;return(n=Zm())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ty(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Gl(JSON.stringify(t)),Gl(JSON.stringify(o)),""].join(".")}const aa={};function xD(){const n={prod:[],emulator:[]};for(const e of Object.keys(aa))aa[e]?n.emulator.push(e):n.prod.push(e);return n}function vD(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Of=!1;function sy(n,e){if(typeof window>"u"||typeof document>"u"||!Cc(window.location.host)||aa[n]===e||aa[n]||Of)return;aa[n]=e;function t(h){return`__firebase__banner__${h}`}const s="__firebase__banner",i=xD().prod.length>0;function o(){const h=document.getElementById(s);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function u(h,y){h.setAttribute("width","24"),h.setAttribute("id",y),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function m(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{Of=!0,o()},h}function d(h,y){h.setAttribute("id",y),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=vD(s),y=t("text"),I=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),w=document.getElementById(v)||document.createElement("a"),R=t("preprendIcon"),P=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const F=h.element;l(F),d(w,v);const re=m();u(P,R),F.append(P,I,w,re),document.body.appendChild(F)}i?(I.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ry(){var e;const n=(e=Zm())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iy(){return!ry()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function oy(){return!ry()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ay(){try{return typeof indexedDB=="object"}catch{return!1}}function _D(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD="FirebaseError";class wi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=DD,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ly.prototype.create)}}class ly{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?kD(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new wi(r,l,s)}}function kD(n,e){return n.replace(ED,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const ED=/\{\$([^}]+)}/g;function Yl(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(qf(i)&&qf(o)){if(!Yl(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function qf(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(n){return n&&n._delegate?n._delegate:n}class ao{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new ND;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CD(e))try{this.getOrInitializeService({instanceIdentifier:oi})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=oi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=oi){return this.instances.has(e)}getOptions(e=oi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:AD(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=oi){return this.component?this.component.multipleInstances?e:oi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function AD(n){return n===oi?void 0:n}function CD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Vt||(Vt={}));const ID={debug:Vt.DEBUG,verbose:Vt.VERBOSE,info:Vt.INFO,warn:Vt.WARN,error:Vt.ERROR,silent:Vt.SILENT},TD=Vt.INFO,SD={[Vt.DEBUG]:"log",[Vt.VERBOSE]:"log",[Vt.INFO]:"info",[Vt.WARN]:"warn",[Vt.ERROR]:"error"},PD=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=SD[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cy{constructor(e){this.name=e,this._logLevel=TD,this._logHandler=PD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ID[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vt.DEBUG,...e),this._logHandler(this,Vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vt.VERBOSE,...e),this._logHandler(this,Vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vt.INFO,...e),this._logHandler(this,Vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vt.WARN,...e),this._logHandler(this,Vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vt.ERROR,...e),this._logHandler(this,Vt.ERROR,...e)}}const LD=(n,e)=>e.some(t=>n instanceof t);let $f,zf;function jD(){return $f||($f=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RD(){return zf||(zf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const uy=new WeakMap,Zu=new WeakMap,my=new WeakMap,Eu=new WeakMap,ed=new WeakMap;function BD(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Tr(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&uy.set(t,n)}).catch(()=>{}),ed.set(e,n),e}function UD(n){if(Zu.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Zu.set(n,e)}let em={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Zu.get(n);if(e==="objectStoreNames")return n.objectStoreNames||my.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Tr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function HD(n){em=n(em)}function MD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Vu(this),e,...t);return my.set(s,e.sort?e.sort():[e]),Tr(s)}:RD().includes(n)?function(...e){return n.apply(Vu(this),e),Tr(uy.get(this))}:function(...e){return Tr(n.apply(Vu(this),e))}}function FD(n){return typeof n=="function"?MD(n):(n instanceof IDBTransaction&&UD(n),LD(n,jD())?new Proxy(n,em):n)}function Tr(n){if(n instanceof IDBRequest)return BD(n);if(Eu.has(n))return Eu.get(n);const e=FD(n);return e!==n&&(Eu.set(n,e),ed.set(e,n)),e}const Vu=n=>ed.get(n);function OD(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),l=Tr(o);return s&&o.addEventListener("upgradeneeded",u=>{s(Tr(o.result),u.oldVersion,u.newVersion,Tr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const qD=["get","getKey","getAll","getAllKeys","count"],$D=["put","add","delete","clear"],Au=new Map;function Wf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Au.get(e))return Au.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=$D.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||qD.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return s&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return Au.set(e,i),i}HD(n=>({...n,get:(e,t,s)=>Wf(e,t)||n.get(e,t,s),has:(e,t)=>!!Wf(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(WD(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function WD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tm="@firebase/app",Kf="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr=new cy("@firebase/app"),KD="@firebase/app-compat",GD="@firebase/analytics-compat",QD="@firebase/analytics",YD="@firebase/app-check-compat",XD="@firebase/app-check",JD="@firebase/auth",ZD="@firebase/auth-compat",ek="@firebase/database",tk="@firebase/data-connect",nk="@firebase/database-compat",sk="@firebase/functions",rk="@firebase/functions-compat",ik="@firebase/installations",ok="@firebase/installations-compat",ak="@firebase/messaging",lk="@firebase/messaging-compat",ck="@firebase/performance",uk="@firebase/performance-compat",mk="@firebase/remote-config",dk="@firebase/remote-config-compat",fk="@firebase/storage",pk="@firebase/storage-compat",hk="@firebase/firestore",gk="@firebase/ai",yk="@firebase/firestore-compat",bk="firebase",Nk="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm="[DEFAULT]",xk={[tm]:"fire-core",[KD]:"fire-core-compat",[QD]:"fire-analytics",[GD]:"fire-analytics-compat",[XD]:"fire-app-check",[YD]:"fire-app-check-compat",[JD]:"fire-auth",[ZD]:"fire-auth-compat",[ek]:"fire-rtdb",[tk]:"fire-data-connect",[nk]:"fire-rtdb-compat",[sk]:"fire-fn",[rk]:"fire-fn-compat",[ik]:"fire-iid",[ok]:"fire-iid-compat",[ak]:"fire-fcm",[lk]:"fire-fcm-compat",[ck]:"fire-perf",[uk]:"fire-perf-compat",[mk]:"fire-rc",[dk]:"fire-rc-compat",[fk]:"fire-gcs",[pk]:"fire-gcs-compat",[hk]:"fire-fst",[yk]:"fire-fst-compat",[gk]:"fire-vertex","fire-js":"fire-js",[bk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=new Map,vk=new Map,sm=new Map;function Gf(n,e){try{n.container.addComponent(e)}catch(t){sr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function va(n){const e=n.name;if(sm.has(e))return sr.debug(`There were multiple attempts to register component ${e}.`),!1;sm.set(e,n);for(const t of Xl.values())Gf(t,n);for(const t of vk.values())Gf(t,n);return!0}function dy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function fy(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Sr=new ly("app","Firebase",_k);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ao("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Sr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py=Nk;function hy(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:nm,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Sr.create("bad-app-name",{appName:String(r)});if(t||(t=ey()),!t)throw Sr.create("no-options");const i=Xl.get(r);if(i){if(Yl(t,i.options)&&Yl(s,i.config))return i;throw Sr.create("duplicate-app",{appName:r})}const o=new wD(r);for(const u of sm.values())o.addComponent(u);const l=new Dk(t,s,o);return Xl.set(r,l),l}function gy(n=nm){const e=Xl.get(n);if(!e&&n===nm&&ey())return hy();if(!e)throw Sr.create("no-app",{appName:n});return e}function Pr(n,e,t){let s=xk[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sr.warn(o.join(" "));return}va(new ao(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk="firebase-heartbeat-database",Ek=1,_a="firebase-heartbeat-store";let Cu=null;function yy(){return Cu||(Cu=OD(kk,Ek,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_a)}catch(t){console.warn(t)}}}}).catch(n=>{throw Sr.create("idb-open",{originalErrorMessage:n.message})})),Cu}async function Vk(n){try{const t=(await yy()).transaction(_a),s=await t.objectStore(_a).get(by(n));return await t.done,s}catch(e){if(e instanceof wi)sr.warn(e.message);else{const t=Sr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});sr.warn(t.message)}}}async function Qf(n,e){try{const s=(await yy()).transaction(_a,"readwrite");await s.objectStore(_a).put(e,by(n)),await s.done}catch(t){if(t instanceof wi)sr.warn(t.message);else{const s=Sr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});sr.warn(s.message)}}}function by(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=1024,Ck=30;class wk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Tk(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Yf();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>Ck){const o=Sk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){sr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Yf(),{heartbeatsToSend:s,unsentEntries:r}=Ik(this._heartbeatsCache.heartbeats),i=Gl(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return sr.warn(t),""}}}function Yf(){return new Date().toISOString().substring(0,10)}function Ik(n,e=Ak){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Xf(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Xf(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class Tk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ay()?_D().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Vk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Qf(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Qf(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Xf(n){return Gl(JSON.stringify({version:2,heartbeats:n})).length}function Sk(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(n){va(new ao("platform-logger",e=>new zD(e),"PRIVATE")),va(new ao("heartbeat",e=>new wk(e),"PRIVATE")),Pr(tm,Kf,n),Pr(tm,Kf,"esm2020"),Pr("fire-js","")}Pk("");var Lk="firebase",jk="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr(Lk,jk,"app");var Jf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lr,Ny;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,N){function C(){}C.prototype=N.prototype,A.F=N.prototype,A.prototype=new C,A.prototype.constructor=A,A.D=function(j,S,T){for(var E=Array(arguments.length-2),De=2;De<arguments.length;De++)E[De-2]=arguments[De];return N.prototype[S].apply(j,E)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(A,N,C){C||(C=0);const j=Array(16);if(typeof N=="string")for(var S=0;S<16;++S)j[S]=N.charCodeAt(C++)|N.charCodeAt(C++)<<8|N.charCodeAt(C++)<<16|N.charCodeAt(C++)<<24;else for(S=0;S<16;++S)j[S]=N[C++]|N[C++]<<8|N[C++]<<16|N[C++]<<24;N=A.g[0],C=A.g[1],S=A.g[2];let T=A.g[3],E;E=N+(T^C&(S^T))+j[0]+3614090360&4294967295,N=C+(E<<7&4294967295|E>>>25),E=T+(S^N&(C^S))+j[1]+3905402710&4294967295,T=N+(E<<12&4294967295|E>>>20),E=S+(C^T&(N^C))+j[2]+606105819&4294967295,S=T+(E<<17&4294967295|E>>>15),E=C+(N^S&(T^N))+j[3]+3250441966&4294967295,C=S+(E<<22&4294967295|E>>>10),E=N+(T^C&(S^T))+j[4]+4118548399&4294967295,N=C+(E<<7&4294967295|E>>>25),E=T+(S^N&(C^S))+j[5]+1200080426&4294967295,T=N+(E<<12&4294967295|E>>>20),E=S+(C^T&(N^C))+j[6]+2821735955&4294967295,S=T+(E<<17&4294967295|E>>>15),E=C+(N^S&(T^N))+j[7]+4249261313&4294967295,C=S+(E<<22&4294967295|E>>>10),E=N+(T^C&(S^T))+j[8]+1770035416&4294967295,N=C+(E<<7&4294967295|E>>>25),E=T+(S^N&(C^S))+j[9]+2336552879&4294967295,T=N+(E<<12&4294967295|E>>>20),E=S+(C^T&(N^C))+j[10]+4294925233&4294967295,S=T+(E<<17&4294967295|E>>>15),E=C+(N^S&(T^N))+j[11]+2304563134&4294967295,C=S+(E<<22&4294967295|E>>>10),E=N+(T^C&(S^T))+j[12]+1804603682&4294967295,N=C+(E<<7&4294967295|E>>>25),E=T+(S^N&(C^S))+j[13]+4254626195&4294967295,T=N+(E<<12&4294967295|E>>>20),E=S+(C^T&(N^C))+j[14]+2792965006&4294967295,S=T+(E<<17&4294967295|E>>>15),E=C+(N^S&(T^N))+j[15]+1236535329&4294967295,C=S+(E<<22&4294967295|E>>>10),E=N+(S^T&(C^S))+j[1]+4129170786&4294967295,N=C+(E<<5&4294967295|E>>>27),E=T+(C^S&(N^C))+j[6]+3225465664&4294967295,T=N+(E<<9&4294967295|E>>>23),E=S+(N^C&(T^N))+j[11]+643717713&4294967295,S=T+(E<<14&4294967295|E>>>18),E=C+(T^N&(S^T))+j[0]+3921069994&4294967295,C=S+(E<<20&4294967295|E>>>12),E=N+(S^T&(C^S))+j[5]+3593408605&4294967295,N=C+(E<<5&4294967295|E>>>27),E=T+(C^S&(N^C))+j[10]+38016083&4294967295,T=N+(E<<9&4294967295|E>>>23),E=S+(N^C&(T^N))+j[15]+3634488961&4294967295,S=T+(E<<14&4294967295|E>>>18),E=C+(T^N&(S^T))+j[4]+3889429448&4294967295,C=S+(E<<20&4294967295|E>>>12),E=N+(S^T&(C^S))+j[9]+568446438&4294967295,N=C+(E<<5&4294967295|E>>>27),E=T+(C^S&(N^C))+j[14]+3275163606&4294967295,T=N+(E<<9&4294967295|E>>>23),E=S+(N^C&(T^N))+j[3]+4107603335&4294967295,S=T+(E<<14&4294967295|E>>>18),E=C+(T^N&(S^T))+j[8]+1163531501&4294967295,C=S+(E<<20&4294967295|E>>>12),E=N+(S^T&(C^S))+j[13]+2850285829&4294967295,N=C+(E<<5&4294967295|E>>>27),E=T+(C^S&(N^C))+j[2]+4243563512&4294967295,T=N+(E<<9&4294967295|E>>>23),E=S+(N^C&(T^N))+j[7]+1735328473&4294967295,S=T+(E<<14&4294967295|E>>>18),E=C+(T^N&(S^T))+j[12]+2368359562&4294967295,C=S+(E<<20&4294967295|E>>>12),E=N+(C^S^T)+j[5]+4294588738&4294967295,N=C+(E<<4&4294967295|E>>>28),E=T+(N^C^S)+j[8]+2272392833&4294967295,T=N+(E<<11&4294967295|E>>>21),E=S+(T^N^C)+j[11]+1839030562&4294967295,S=T+(E<<16&4294967295|E>>>16),E=C+(S^T^N)+j[14]+4259657740&4294967295,C=S+(E<<23&4294967295|E>>>9),E=N+(C^S^T)+j[1]+2763975236&4294967295,N=C+(E<<4&4294967295|E>>>28),E=T+(N^C^S)+j[4]+1272893353&4294967295,T=N+(E<<11&4294967295|E>>>21),E=S+(T^N^C)+j[7]+4139469664&4294967295,S=T+(E<<16&4294967295|E>>>16),E=C+(S^T^N)+j[10]+3200236656&4294967295,C=S+(E<<23&4294967295|E>>>9),E=N+(C^S^T)+j[13]+681279174&4294967295,N=C+(E<<4&4294967295|E>>>28),E=T+(N^C^S)+j[0]+3936430074&4294967295,T=N+(E<<11&4294967295|E>>>21),E=S+(T^N^C)+j[3]+3572445317&4294967295,S=T+(E<<16&4294967295|E>>>16),E=C+(S^T^N)+j[6]+76029189&4294967295,C=S+(E<<23&4294967295|E>>>9),E=N+(C^S^T)+j[9]+3654602809&4294967295,N=C+(E<<4&4294967295|E>>>28),E=T+(N^C^S)+j[12]+3873151461&4294967295,T=N+(E<<11&4294967295|E>>>21),E=S+(T^N^C)+j[15]+530742520&4294967295,S=T+(E<<16&4294967295|E>>>16),E=C+(S^T^N)+j[2]+3299628645&4294967295,C=S+(E<<23&4294967295|E>>>9),E=N+(S^(C|~T))+j[0]+4096336452&4294967295,N=C+(E<<6&4294967295|E>>>26),E=T+(C^(N|~S))+j[7]+1126891415&4294967295,T=N+(E<<10&4294967295|E>>>22),E=S+(N^(T|~C))+j[14]+2878612391&4294967295,S=T+(E<<15&4294967295|E>>>17),E=C+(T^(S|~N))+j[5]+4237533241&4294967295,C=S+(E<<21&4294967295|E>>>11),E=N+(S^(C|~T))+j[12]+1700485571&4294967295,N=C+(E<<6&4294967295|E>>>26),E=T+(C^(N|~S))+j[3]+2399980690&4294967295,T=N+(E<<10&4294967295|E>>>22),E=S+(N^(T|~C))+j[10]+4293915773&4294967295,S=T+(E<<15&4294967295|E>>>17),E=C+(T^(S|~N))+j[1]+2240044497&4294967295,C=S+(E<<21&4294967295|E>>>11),E=N+(S^(C|~T))+j[8]+1873313359&4294967295,N=C+(E<<6&4294967295|E>>>26),E=T+(C^(N|~S))+j[15]+4264355552&4294967295,T=N+(E<<10&4294967295|E>>>22),E=S+(N^(T|~C))+j[6]+2734768916&4294967295,S=T+(E<<15&4294967295|E>>>17),E=C+(T^(S|~N))+j[13]+1309151649&4294967295,C=S+(E<<21&4294967295|E>>>11),E=N+(S^(C|~T))+j[4]+4149444226&4294967295,N=C+(E<<6&4294967295|E>>>26),E=T+(C^(N|~S))+j[11]+3174756917&4294967295,T=N+(E<<10&4294967295|E>>>22),E=S+(N^(T|~C))+j[2]+718787259&4294967295,S=T+(E<<15&4294967295|E>>>17),E=C+(T^(S|~N))+j[9]+3951481745&4294967295,A.g[0]=A.g[0]+N&4294967295,A.g[1]=A.g[1]+(S+(E<<21&4294967295|E>>>11))&4294967295,A.g[2]=A.g[2]+S&4294967295,A.g[3]=A.g[3]+T&4294967295}s.prototype.v=function(A,N){N===void 0&&(N=A.length);const C=N-this.blockSize,j=this.C;let S=this.h,T=0;for(;T<N;){if(S==0)for(;T<=C;)r(this,A,T),T+=this.blockSize;if(typeof A=="string"){for(;T<N;)if(j[S++]=A.charCodeAt(T++),S==this.blockSize){r(this,j),S=0;break}}else for(;T<N;)if(j[S++]=A[T++],S==this.blockSize){r(this,j),S=0;break}}this.h=S,this.o+=N},s.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var N=1;N<A.length-8;++N)A[N]=0;N=this.o*8;for(var C=A.length-8;C<A.length;++C)A[C]=N&255,N/=256;for(this.v(A),A=Array(16),N=0,C=0;C<4;++C)for(let j=0;j<32;j+=8)A[N++]=this.g[C]>>>j&255;return A};function i(A,N){var C=l;return Object.prototype.hasOwnProperty.call(C,A)?C[A]:C[A]=N(A)}function o(A,N){this.h=N;const C=[];let j=!0;for(let S=A.length-1;S>=0;S--){const T=A[S]|0;j&&T==N||(C[S]=T,j=!1)}this.g=C}var l={};function u(A){return-128<=A&&A<128?i(A,function(N){return new o([N|0],N<0?-1:0)}):new o([A|0],A<0?-1:0)}function m(A){if(isNaN(A)||!isFinite(A))return f;if(A<0)return w(m(-A));const N=[];let C=1;for(let j=0;A>=C;j++)N[j]=A/C|0,C*=4294967296;return new o(N,0)}function d(A,N){if(A.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(A.charAt(0)=="-")return w(d(A.substring(1),N));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=m(Math.pow(N,8));let j=f;for(let T=0;T<A.length;T+=8){var S=Math.min(8,A.length-T);const E=parseInt(A.substring(T,T+S),N);S<8?(S=m(Math.pow(N,S)),j=j.j(S).add(m(E))):(j=j.j(C),j=j.add(m(E)))}return j}var f=u(0),h=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();let A=0,N=1;for(let C=0;C<this.g.length;C++){const j=this.i(C);A+=(j>=0?j:4294967296+j)*N,N*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(I(this))return"0";if(v(this))return"-"+w(this).toString(A);const N=m(Math.pow(A,6));var C=this;let j="";for(;;){const S=re(C,N).g;C=R(C,S.j(N));let T=((C.g.length>0?C.g[0]:C.h)>>>0).toString(A);if(C=S,I(C))return T+j;for(;T.length<6;)T="0"+T;j=T+j}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function I(A){if(A.h!=0)return!1;for(let N=0;N<A.g.length;N++)if(A.g[N]!=0)return!1;return!0}function v(A){return A.h==-1}n.l=function(A){return A=R(this,A),v(A)?-1:I(A)?0:1};function w(A){const N=A.g.length,C=[];for(let j=0;j<N;j++)C[j]=~A.g[j];return new o(C,~A.h).add(h)}n.abs=function(){return v(this)?w(this):this},n.add=function(A){const N=Math.max(this.g.length,A.g.length),C=[];let j=0;for(let S=0;S<=N;S++){let T=j+(this.i(S)&65535)+(A.i(S)&65535),E=(T>>>16)+(this.i(S)>>>16)+(A.i(S)>>>16);j=E>>>16,T&=65535,E&=65535,C[S]=E<<16|T}return new o(C,C[C.length-1]&-2147483648?-1:0)};function R(A,N){return A.add(w(N))}n.j=function(A){if(I(this)||I(A))return f;if(v(this))return v(A)?w(this).j(w(A)):w(w(this).j(A));if(v(A))return w(this.j(w(A)));if(this.l(y)<0&&A.l(y)<0)return m(this.m()*A.m());const N=this.g.length+A.g.length,C=[];for(var j=0;j<2*N;j++)C[j]=0;for(j=0;j<this.g.length;j++)for(let S=0;S<A.g.length;S++){const T=this.i(j)>>>16,E=this.i(j)&65535,De=A.i(S)>>>16,He=A.i(S)&65535;C[2*j+2*S]+=E*He,P(C,2*j+2*S),C[2*j+2*S+1]+=T*He,P(C,2*j+2*S+1),C[2*j+2*S+1]+=E*De,P(C,2*j+2*S+1),C[2*j+2*S+2]+=T*De,P(C,2*j+2*S+2)}for(A=0;A<N;A++)C[A]=C[2*A+1]<<16|C[2*A];for(A=N;A<2*N;A++)C[A]=0;return new o(C,0)};function P(A,N){for(;(A[N]&65535)!=A[N];)A[N+1]+=A[N]>>>16,A[N]&=65535,N++}function F(A,N){this.g=A,this.h=N}function re(A,N){if(I(N))throw Error("division by zero");if(I(A))return new F(f,f);if(v(A))return N=re(w(A),N),new F(w(N.g),w(N.h));if(v(N))return N=re(A,w(N)),new F(w(N.g),N.h);if(A.g.length>30){if(v(A)||v(N))throw Error("slowDivide_ only works with positive integers.");for(var C=h,j=N;j.l(A)<=0;)C=Z(C),j=Z(j);var S=M(C,1),T=M(j,1);for(j=M(j,2),C=M(C,2);!I(j);){var E=T.add(j);E.l(A)<=0&&(S=S.add(C),T=E),j=M(j,1),C=M(C,1)}return N=R(A,S.j(N)),new F(S,N)}for(S=f;A.l(N)>=0;){for(C=Math.max(1,Math.floor(A.m()/N.m())),j=Math.ceil(Math.log(C)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),T=m(C),E=T.j(N);v(E)||E.l(A)>0;)C-=j,T=m(C),E=T.j(N);I(T)&&(T=h),S=S.add(T),A=R(A,E)}return new F(S,A)}n.B=function(A){return re(this,A).h},n.and=function(A){const N=Math.max(this.g.length,A.g.length),C=[];for(let j=0;j<N;j++)C[j]=this.i(j)&A.i(j);return new o(C,this.h&A.h)},n.or=function(A){const N=Math.max(this.g.length,A.g.length),C=[];for(let j=0;j<N;j++)C[j]=this.i(j)|A.i(j);return new o(C,this.h|A.h)},n.xor=function(A){const N=Math.max(this.g.length,A.g.length),C=[];for(let j=0;j<N;j++)C[j]=this.i(j)^A.i(j);return new o(C,this.h^A.h)};function Z(A){const N=A.g.length+1,C=[];for(let j=0;j<N;j++)C[j]=A.i(j)<<1|A.i(j-1)>>>31;return new o(C,A.h)}function M(A,N){const C=N>>5;N%=32;const j=A.g.length-C,S=[];for(let T=0;T<j;T++)S[T]=N>0?A.i(T+C)>>>N|A.i(T+C+1)<<32-N:A.i(T+C);return new o(S,A.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,Ny=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,Lr=o}).apply(typeof Jf<"u"?Jf:typeof self<"u"?self:typeof window<"u"?window:{});var ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xy,ea,vy,Sl,rm,_y,Dy,ky;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof ll=="object"&&ll];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=t(this);function r(c,p){if(p)e:{var g=s;c=c.split(".");for(var D=0;D<c.length-1;D++){var z=c[D];if(!(z in g))break e;g=g[z]}c=c[c.length-1],D=g[c],p=p(D),p!=D&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(p){var g=[],D;for(D in p)Object.prototype.hasOwnProperty.call(p,D)&&g.push([D,p[D]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function u(c,p,g){return c.call.apply(c.bind,arguments)}function m(c,p,g){return m=u,m.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var D=g.slice();return D.push.apply(D,arguments),c.apply(this,D)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(D,z,J){for(var ve=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)ve[ct-2]=arguments[ct];return p.prototype[z].apply(D,ve)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const p=c.length;if(p>0){const g=Array(p);for(let D=0;D<p;D++)g[D]=c[D];return g}return[]}function I(c,p){for(let D=1;D<arguments.length;D++){const z=arguments[D];var g=typeof z;if(g=g!="object"?g:z?Array.isArray(z)?"array":g:"null",g=="array"||g=="object"&&typeof z.length=="number"){g=c.length||0;const J=z.length||0;c.length=g+J;for(let ve=0;ve<J;ve++)c[g+ve]=z[ve]}else c.push(z)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function w(c){o.setTimeout(()=>{throw c},0)}function R(){var c=A;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class P{constructor(){this.h=this.g=null}add(p,g){const D=F.get();D.set(p,g),this.h?this.h.next=D:this.g=D,this.h=D}}var F=new v(()=>new re,c=>c.reset());class re{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,M=!1,A=new P,N=()=>{const c=Promise.resolve(void 0);Z=()=>{c.then(C)}};function C(){for(var c;c=R();){try{c.h.call(c.g)}catch(g){w(g)}var p=F;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var T=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function E(c){return/^[\s\xa0]*$/.test(c)}function De(c,p){S.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(De,S),De.prototype.init=function(c,p){const g=this.type=c.type,D=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var He="closure_listenable_"+(Math.random()*1e6|0),fe=0;function je(c,p,g,D,z){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!D,this.ha=z,this.key=++fe,this.da=this.fa=!1}function ut(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Ft(c,p,g){for(const D in c)p.call(g,c[D],D,c)}function Rt(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function oe(c){const p={};for(const g in c)p[g]=c[g];return p}const Me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(c,p){let g,D;for(let z=1;z<arguments.length;z++){D=arguments[z];for(g in D)c[g]=D[g];for(let J=0;J<Me.length;J++)g=Me[J],Object.prototype.hasOwnProperty.call(D,g)&&(c[g]=D[g])}}function Pe(c){this.src=c,this.g={},this.h=0}Pe.prototype.add=function(c,p,g,D,z){const J=c.toString();c=this.g[J],c||(c=this.g[J]=[],this.h++);const ve=bt(c,p,D,z);return ve>-1?(p=c[ve],g||(p.fa=!1)):(p=new je(p,this.src,J,!!D,z),p.fa=g,c.push(p)),p};function We(c,p){const g=p.type;if(g in c.g){var D=c.g[g],z=Array.prototype.indexOf.call(D,p,void 0),J;(J=z>=0)&&Array.prototype.splice.call(D,z,1),J&&(ut(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function bt(c,p,g,D){for(let z=0;z<c.length;++z){const J=c[z];if(!J.da&&J.listener==p&&J.capture==!!g&&J.ha==D)return z}return-1}var st="closure_lm_"+(Math.random()*1e6|0),At={};function nt(c,p,g,D,z){if(Array.isArray(p)){for(let J=0;J<p.length;J++)nt(c,p[J],g,D,z);return null}return g=Ot(g),c&&c[He]?c.J(p,g,l(D)?!!D.capture:!1,z):lt(c,p,g,!1,D,z)}function lt(c,p,g,D,z,J){if(!p)throw Error("Invalid event type");const ve=l(z)?!!z.capture:!!z;let ct=Qe(c);if(ct||(c[st]=ct=new Pe(c)),g=ct.add(p,g,D,ve,J),g.proxy)return g;if(D=an(),g.proxy=D,D.src=c,D.listener=g,c.addEventListener)T||(z=ve),z===void 0&&(z=!1),c.addEventListener(p.toString(),D,z);else if(c.attachEvent)c.attachEvent(Re(p.toString()),D);else if(c.addListener&&c.removeListener)c.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return g}function an(){function c(g){return p.call(c.src,c.listener,g)}const p=we;return c}function G(c,p,g,D,z){if(Array.isArray(p))for(var J=0;J<p.length;J++)G(c,p[J],g,D,z);else D=l(D)?!!D.capture:!!D,g=Ot(g),c&&c[He]?(c=c.i,J=String(p).toString(),J in c.g&&(p=c.g[J],g=bt(p,g,D,z),g>-1&&(ut(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[J],c.h--)))):c&&(c=Qe(c))&&(p=c.g[p.toString()],c=-1,p&&(c=bt(p,g,D,z)),(g=c>-1?p[c]:null)&&Te(g))}function Te(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[He])We(p.i,c);else{var g=c.type,D=c.proxy;p.removeEventListener?p.removeEventListener(g,D,c.capture):p.detachEvent?p.detachEvent(Re(g),D):p.addListener&&p.removeListener&&p.removeListener(D),(g=Qe(p))?(We(g,c),g.h==0&&(g.src=null,p[st]=null)):ut(c)}}}function Re(c){return c in At?At[c]:At[c]="on"+c}function we(c,p){if(c.da)c=!0;else{p=new De(p,this);const g=c.listener,D=c.ha||c.src;c.fa&&Te(c),c=g.call(D,p)}return c}function Qe(c){return c=c[st],c instanceof Pe?c:null}var Ct="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ot(c){return typeof c=="function"?c:(c[Ct]||(c[Ct]=function(p){return c.handleEvent(p)}),c[Ct])}function at(){j.call(this),this.i=new Pe(this),this.M=this,this.G=null}f(at,j),at.prototype[He]=!0,at.prototype.removeEventListener=function(c,p,g,D){G(this,c,p,g,D)};function L(c,p){var g,D=c.G;if(D)for(g=[];D;D=D.G)g.push(D);if(c=c.M,D=p.type||p,typeof p=="string")p=new S(p,c);else if(p instanceof S)p.target=p.target||c;else{var z=p;p=new S(D,c),ue(p,z)}z=!0;let J,ve;if(g)for(ve=g.length-1;ve>=0;ve--)J=p.g=g[ve],z=q(J,D,!0,p)&&z;if(J=p.g=c,z=q(J,D,!0,p)&&z,z=q(J,D,!1,p)&&z,g)for(ve=0;ve<g.length;ve++)J=p.g=g[ve],z=q(J,D,!1,p)&&z}at.prototype.N=function(){if(at.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let D=0;D<g.length;D++)ut(g[D]);delete c.g[p],c.h--}}this.G=null},at.prototype.J=function(c,p,g,D){return this.i.add(String(c),p,!1,g,D)},at.prototype.K=function(c,p,g,D){return this.i.add(String(c),p,!0,g,D)};function q(c,p,g,D){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let z=!0;for(let J=0;J<p.length;++J){const ve=p[J];if(ve&&!ve.da&&ve.capture==g){const ct=ve.listener,Dn=ve.ha||ve.src;ve.fa&&We(c.i,ve),z=ct.call(Dn,D)!==!1&&z}}return z&&!D.defaultPrevented}function ee(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function ye(c){c.g=ee(()=>{c.g=null,c.i&&(c.i=!1,ye(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ce extends j{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function me(c){j.call(this),this.h=c,this.g={}}f(me,j);var Ce=[];function Fe(c){Ft(c.g,function(p,g){this.g.hasOwnProperty(g)&&Te(p)},c),c.g={}}me.prototype.N=function(){me.Z.N.call(this),Fe(this)},me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ze=o.JSON.stringify,Ee=o.JSON.parse,Sn=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function jt(){}function te(){}var Ye={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function O(){S.call(this,"d")}f(O,S);function be(){S.call(this,"c")}f(be,S);var ke={},Se=null;function ae(){return Se=Se||new at}ke.Ia="serverreachability";function yt(c){S.call(this,ke.Ia,c)}f(yt,S);function _t(c){const p=ae();L(p,new yt(p))}ke.STAT_EVENT="statevent";function Kt(c,p){S.call(this,ke.STAT_EVENT,c),this.stat=p}f(Kt,S);function Nt(c){const p=ae();L(p,new Kt(p,c))}ke.Ja="timingevent";function ln(c,p){S.call(this,ke.Ja,c),this.size=p}f(ln,S);function tn(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function An(){this.g=!0}An.prototype.ua=function(){this.g=!1};function cs(c,p,g,D,z,J){c.info(function(){if(c.g)if(J){var ve="",ct=J.split("&");for(let Wt=0;Wt<ct.length;Wt++){var Dn=ct[Wt].split("=");if(Dn.length>1){const Cn=Dn[0];Dn=Dn[1];const Ss=Cn.split("_");ve=Ss.length>=2&&Ss[1]=="type"?ve+(Cn+"="+Dn+"&"):ve+(Cn+"=redacted&")}}}else ve=null;else ve=J;return"XMLHTTP REQ ("+D+") [attempt "+z+"]: "+p+`
`+g+`
`+ve})}function Wn(c,p,g,D,z,J,ve){c.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+z+"]: "+p+`
`+g+`
`+J+" "+ve})}function us(c,p,g,D){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+ws(c,g)+(D?" "+D:"")})}function ti(c,p){c.info(function(){return"TIMEOUT: "+p})}An.prototype.info=function(){};function ws(c,p){if(!c.g)return p;if(!p)return null;try{const J=JSON.parse(p);if(J){for(c=0;c<J.length;c++)if(Array.isArray(J[c])){var g=J[c];if(!(g.length<2)){var D=g[1];if(Array.isArray(D)&&!(D.length<1)){var z=D[0];if(z!="noop"&&z!="stop"&&z!="close")for(let ve=1;ve<D.length;ve++)D[ve]=""}}}}return Ze(J)}catch{return p}}var Xn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Is={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Pn;function _(){}f(_,jt),_.prototype.g=function(){return new XMLHttpRequest},Pn=new _;function x(c){return encodeURIComponent(String(c))}function k(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function U(c,p,g,D){this.j=c,this.i=p,this.l=g,this.S=D||1,this.V=new me(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new B}function B(){this.i=null,this.g="",this.h=!1}var Y={},ne={};function W(c,p,g){c.M=1,c.A=Ri(dt(p)),c.u=g,c.R=!0,X(c,null)}function X(c,p){c.F=Date.now(),Xe(c),c.B=dt(c.A);var g=c.B,D=c.S;Array.isArray(D)||(D=[String(D)]),le(g.i,"t",D),c.C=0,g=c.j.L,c.h=new B,c.g=Df(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ce(m(c.Y,c,c.g),c.P)),p=c.V,g=c.g,D=c.ba;var z="readystatechange";Array.isArray(z)||(z&&(Ce[0]=z.toString()),z=Ce);for(let J=0;J<z.length;J++){const ve=nt(g,z[J],D||p.handleEvent,!1,p.h||p);if(!ve)break;p.g[ve.key]=ve}p=c.J?oe(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),_t(),cs(c.i,c.v,c.B,c.l,c.S,c.u)}U.prototype.ba=function(c){c=c.target;const p=this.O;p&&gs(c)==3?p.j():this.Y(c)},U.prototype.Y=function(c){try{if(c==this.g)e:{const ct=gs(this.g),Dn=this.g.ya(),Wt=this.g.ca();if(!(ct<3)&&(ct!=3||this.g&&(this.h.h||this.g.la()||df(this.g)))){this.K||ct!=4||Dn==7||(Dn==8||Wt<=0?_t(3):_t(2)),Ge(this);var p=this.g.ca();this.X=p;var g=de(this);if(this.o=p==200,Wn(this.i,this.v,this.B,this.l,this.S,ct,p),this.o){if(this.U&&!this.L){t:{if(this.g){var D,z=this.g;if((D=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(D)){var J=D;break t}}J=null}if(c=J)us(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Bn(this,c);else{this.o=!1,this.m=3,Nt(12),Gt(this),wt(this);break e}}if(this.R){c=!0;let Cn;for(;!this.K&&this.C<g.length;)if(Cn=Ke(this,g),Cn==ne){ct==4&&(this.m=4,Nt(14),c=!1),us(this.i,this.l,null,"[Incomplete Response]");break}else if(Cn==Y){this.m=4,Nt(15),us(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else us(this.i,this.l,Cn,null),Bn(this,Cn);if(Be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||g.length!=0||this.h.h||(this.m=1,Nt(16),c=!1),this.o=this.o&&c,!c)us(this.i,this.l,g,"[Invalid Chunked Response]"),Gt(this),wt(this);else if(g.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),yu(ve),ve.P=!0,Nt(11))}}else us(this.i,this.l,g,null),Bn(this,g);ct==4&&Gt(this),this.o&&!this.K&&(ct==4?Nf(this.j,this):(this.o=!1,Xe(this)))}else J0(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Nt(12)):(this.m=0,Nt(13)),Gt(this),wt(this)}}}catch{}finally{}};function de(c){if(!Be(c))return c.g.la();const p=df(c.g);if(p==="")return"";let g="";const D=p.length,z=gs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Gt(c),wt(c),"";c.h.i=new o.TextDecoder}for(let J=0;J<D;J++)c.h.h=!0,g+=c.h.i.decode(p[J],{stream:!(z&&J==D-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function Be(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Ke(c,p){var g=c.C,D=p.indexOf(`
`,g);return D==-1?ne:(g=Number(p.substring(g,D)),isNaN(g)?Y:(D+=1,D+g>p.length?ne:(p=p.slice(D,D+g),c.C=D+g,p)))}U.prototype.cancel=function(){this.K=!0,Gt(this)};function Xe(c){c.T=Date.now()+c.H,_e(c,c.H)}function _e(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=tn(m(c.aa,c),p)}function Ge(c){c.D&&(o.clearTimeout(c.D),c.D=null)}U.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(ti(this.i,this.B),this.M!=2&&(_t(),Nt(17)),Gt(this),this.m=2,wt(this)):_e(this,this.T-c)};function wt(c){c.j.I==0||c.K||Nf(c.j,c)}function Gt(c){Ge(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Fe(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Bn(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Oe(g.h,c))){if(!c.L&&Oe(g.h,c)&&g.I==3){try{var D=g.Ba.g.parse(p)}catch{D=null}if(Array.isArray(D)&&D.length==3){var z=D;if(z[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)nl(g),el(g);else break e;gu(g),Nt(18)}}else g.xa=z[1],0<g.xa-g.K&&z[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=tn(m(g.Va,g),6e3));qt(g.h)<=1&&g.ta&&(g.ta=void 0)}else ni(g,11)}else if((c.L||g.g==c)&&nl(g),!E(p))for(z=g.Ba.g.parse(p),p=0;p<z.length;p++){let Wt=z[p];const Cn=Wt[0];if(!(Cn<=g.K))if(g.K=Cn,Wt=Wt[1],g.I==2)if(Wt[0]=="c"){g.M=Wt[1],g.ba=Wt[2];const Ss=Wt[3];Ss!=null&&(g.ka=Ss,g.j.info("VER="+g.ka));const si=Wt[4];si!=null&&(g.za=si,g.j.info("SVER="+g.za));const pr=Wt[5];pr!=null&&typeof pr=="number"&&pr>0&&(D=1.5*pr,g.O=D,g.j.info("backChannelRequestTimeoutMs_="+D)),D=g;const hr=c.g;if(hr){const rl=hr.g?hr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rl){var J=D.h;J.g||rl.indexOf("spdy")==-1&&rl.indexOf("quic")==-1&&rl.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(xe(J,J.h),J.h=null))}if(D.G){const bu=hr.g?hr.g.getResponseHeader("X-HTTP-Session-Id"):null;bu&&(D.wa=bu,ft(D.J,D.G,bu))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),D=g;var ve=c;if(D.na=_f(D,D.L?D.ba:null,D.W),ve.L){$e(D.h,ve);var ct=ve,Dn=D.O;Dn&&(ct.H=Dn),ct.D&&(Ge(ct),Xe(ct)),D.g=ve}else yf(D);g.i.length>0&&tl(g)}else Wt[0]!="stop"&&Wt[0]!="close"||ni(g,7);else g.I==3&&(Wt[0]=="stop"||Wt[0]=="close"?Wt[0]=="stop"?ni(g,7):hu(g):Wt[0]!="noop"&&g.l&&g.l.qa(Wt),g.A=0)}}_t(4)}catch{}}var Yt=class{constructor(c,p){this.g=c,this.map=p}};function Jn(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Un(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function qt(c){return c.h?1:c.g?c.g.size:0}function Oe(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function xe(c,p){c.g?c.g.add(p):c.h=p}function $e(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}Jn.prototype.cancel=function(){if(this.i=mt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function mt(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return y(c.i)}var xt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qe(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const D=c[g].indexOf("=");let z,J=null;D>=0?(z=c[g].substring(0,D),J=c[g].substring(D+1)):z=c[g],p(z,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function Je(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof Je?(this.l=c.l,mn(this,c.j),this.o=c.o,this.g=c.g,cn(this,c.u),this.h=c.h,ur(this,ge(c.i)),this.m=c.m):c&&(p=String(c).match(xt))?(this.l=!1,mn(this,p[1]||"",!0),this.o=mr(p[2]||""),this.g=mr(p[3]||"",!0),cn(this,p[4]),this.h=mr(p[5]||"",!0),ur(this,p[6]||"",!0),this.m=mr(p[7]||"")):(this.l=!1,this.i=new fr(null,this.l))}Je.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(dr(p,Po,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(dr(p,Po,!0),"@"),c.push(x(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(dr(g,g.charAt(0)=="/"?mu:Za,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",dr(g,fu)),c.join("")},Je.prototype.resolve=function(c){const p=dt(this);let g=!!c.j;g?mn(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var D=c.h;if(g)cn(p,c.u);else if(g=!!c.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var z=p.h.lastIndexOf("/");z!=-1&&(D=p.h.slice(0,z+1)+D)}if(z=D,z==".."||z==".")D="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){D=z.lastIndexOf("/",0)==0,z=z.split("/");const J=[];for(let ve=0;ve<z.length;){const ct=z[ve++];ct=="."?D&&ve==z.length&&J.push(""):ct==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),D&&ve==z.length&&J.push("")):(J.push(ct),D=!0)}D=J.join("/")}else D=z}return g?p.h=D:g=c.i.toString()!=="",g?ur(p,ge(c.i)):g=!!c.m,g&&(p.m=c.m),p};function dt(c){return new Je(c)}function mn(c,p,g){c.j=g?mr(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function cn(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function ur(c,p,g){p instanceof fr?(c.i=p,it(c.i,c.l)):(g||(p=dr(p,du)),c.i=new fr(p,c.l))}function ft(c,p,g){c.i.set(p,g)}function Ri(c){return ft(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function mr(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function dr(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,Ja),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ja(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Po=/[#\/\?@]/g,Za=/[#\?:]/g,mu=/[#\?]/g,du=/[#\?@]/g,fu=/#/g;function fr(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function b(c){c.g||(c.g=new Map,c.h=0,c.i&&qe(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}n=fr.prototype,n.add=function(c,p){b(this),this.i=null,c=he(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function H(c,p){b(c),p=he(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Q(c,p){return b(c),p=he(c,p),c.g.has(p)}n.forEach=function(c,p){b(this),this.g.forEach(function(g,D){g.forEach(function(z){c.call(p,z,D,this)},this)},this)};function K(c,p){b(c);let g=[];if(typeof p=="string")Q(c,p)&&(g=g.concat(c.g.get(he(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}n.set=function(c,p){return b(this),this.i=null,c=he(this,c),Q(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},n.get=function(c,p){return c?(c=K(this,c),c.length>0?String(c[0]):p):p};function le(c,p,g){H(c,p),g.length>0&&(c.i=null,c.g.set(he(c,p),y(g)),c.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let D=0;D<p.length;D++){var g=p[D];const z=x(g);g=K(this,g);for(let J=0;J<g.length;J++){let ve=z;g[J]!==""&&(ve+="="+x(g[J])),c.push(ve)}}return this.i=c.join("&")};function ge(c){const p=new fr;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function he(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function it(c,p){p&&!c.j&&(b(c),c.i=null,c.g.forEach(function(g,D){const z=D.toLowerCase();D!=z&&(H(this,D),le(this,z,g))},c)),c.j=p}function pt(c,p){const g=new An;if(o.Image){const D=new Image;D.onload=d(It,g,"TestLoadImage: loaded",!0,p,D),D.onerror=d(It,g,"TestLoadImage: error",!1,p,D),D.onabort=d(It,g,"TestLoadImage: abort",!1,p,D),D.ontimeout=d(It,g,"TestLoadImage: timeout",!1,p,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=c}else p(!1)}function dn(c,p){const g=new An,D=new AbortController,z=setTimeout(()=>{D.abort(),It(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:D.signal}).then(J=>{clearTimeout(z),J.ok?It(g,"TestPingServer: ok",!0,p):It(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(z),It(g,"TestPingServer: error",!1,p)})}function It(c,p,g,D,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),D(g)}catch{}}function Tt(){this.g=new Sn}function nn(c){this.i=c.Sb||null,this.h=c.ab||!1}f(nn,jt),nn.prototype.g=function(){return new _n(this.i,this.h)};function _n(c,p){at.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(_n,at),n=_n.prototype,n.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,un(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xt(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,un(this)),this.g&&(this.readyState=3,un(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kt(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function kt(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Xt(this):un(this),this.readyState==3&&kt(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,Xt(this))},n.Na=function(c){this.g&&(this.response=c,Xt(this))},n.ga=function(){this.g&&Xt(this)};function Xt(c){c.readyState=4,c.l=null,c.j=null,c.B=null,un(c)}n.setRequestHeader=function(c,p){this.A.append(c,p)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function un(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(_n.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function $t(c){let p="";return Ft(c,function(g,D){p+=D,p+=":",p+=g,p+=`\r
`}),p}function zt(c,p,g){e:{for(D in g){var D=!1;break e}D=!0}D||(g=$t(g),typeof c=="string"?g!=null&&x(g):ft(c,p,g))}function ht(c){at.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ht,at);var Qt=/^https?$/i,hs=["POST","PUT"];n=ht.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,p,g,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Pn.g(),this.g.onreadystatechange=h(m(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(J){Ts(this,J);return}if(c=g||"",g=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var z in D)g.set(z,D[z]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const J of D.keys())g.set(J,D.get(J));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(g.keys()).find(J=>J.toLowerCase()=="content-type"),z=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(hs,p,void 0)>=0)||D||z||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ve]of g)this.g.setRequestHeader(J,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(J){Ts(this,J)}};function Ts(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,Bi(c),Ui(c)}function Bi(c){c.A||(c.A=!0,L(c,"complete"),L(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,L(this,"complete"),L(this,"abort"),Ui(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ui(this,!0)),ht.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?pu(this):this.Xa())},n.Xa=function(){pu(this)};function pu(c){if(c.h&&typeof i<"u"){if(c.v&&gs(c)==4)setTimeout(c.Ca.bind(c),0);else if(L(c,"readystatechange"),gs(c)==4){c.h=!1;try{const J=c.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var D;if(D=J===0){let ve=String(c.D).match(xt)[1]||null;!ve&&o.self&&o.self.location&&(ve=o.self.location.protocol.slice(0,-1)),D=!Qt.test(ve?ve.toLowerCase():"")}g=D}if(g)L(c,"complete"),L(c,"success");else{c.o=6;try{var z=gs(c)>2?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.ca()+"]",Bi(c)}}finally{Ui(c)}}}}function Ui(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||L(c,"ready");try{g.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function gs(c){return c.g?c.g.readyState:0}n.ca=function(){try{return gs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Ee(p)}};function df(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function J0(c){const p={};c=(c.g&&gs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<c.length;D++){if(E(c[D]))continue;var g=k(c[D]);const z=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const J=p[z]||[];p[z]=J,J.push(g)}Rt(p,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lo(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function ff(c){this.za=0,this.i=[],this.j=new An,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Lo("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Lo("baseRetryDelayMs",5e3,c),this.Za=Lo("retryDelaySeedMs",1e4,c),this.Ta=Lo("forwardChannelMaxRetries",2,c),this.va=Lo("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Jn(c&&c.concurrentRequestLimit),this.Ba=new Tt,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ff.prototype,n.ka=8,n.I=1,n.connect=function(c,p,g,D){Nt(0),this.W=c,this.H=p||{},g&&D!==void 0&&(this.H.OSID=g,this.H.OAID=D),this.F=this.X,this.J=_f(this,null,this.W),tl(this)};function hu(c){if(pf(c),c.I==3){var p=c.V++,g=dt(c.J);if(ft(g,"SID",c.M),ft(g,"RID",p),ft(g,"TYPE","terminate"),jo(c,g),p=new U(c,c.j,p),p.M=2,p.A=Ri(dt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=Df(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Xe(p)}vf(c)}function el(c){c.g&&(yu(c),c.g.cancel(),c.g=null)}function pf(c){el(c),c.v&&(o.clearTimeout(c.v),c.v=null),nl(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function tl(c){if(!Un(c.h)&&!c.m){c.m=!0;var p=c.Ea;Z||N(),M||(Z(),M=!0),A.add(p,c),c.D=0}}function Z0(c,p){return qt(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=tn(m(c.Ea,c,p),xf(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const z=new U(this,this.j,c);let J=this.o;if(this.U&&(J?(J=oe(J),ue(J,this.U)):J=this.U),this.u!==null||this.R||(z.J=J,J=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var D=this.i[g];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(p+=D,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=gf(this,z,p),g=dt(this.J),ft(g,"RID",c),ft(g,"CVER",22),this.G&&ft(g,"X-HTTP-Session-Id",this.G),jo(this,g),J&&(this.R?p="headers="+x($t(J))+"&"+p:this.u&&zt(g,this.u,J)),xe(this.h,z),this.Ra&&ft(g,"TYPE","init"),this.S?(ft(g,"$req",p),ft(g,"SID","null"),z.U=!0,W(z,g,null)):W(z,g,p),this.I=2}}else this.I==3&&(c?hf(this,c):this.i.length==0||Un(this.h)||hf(this))};function hf(c,p){var g;p?g=p.l:g=c.V++;const D=dt(c.J);ft(D,"SID",c.M),ft(D,"RID",g),ft(D,"AID",c.K),jo(c,D),c.u&&c.o&&zt(D,c.u,c.o),g=new U(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=gf(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),xe(c.h,g),W(g,D,p)}function jo(c,p){c.H&&Ft(c.H,function(g,D){ft(p,D,g)}),c.l&&Ft({},function(g,D){ft(p,D,g)})}function gf(c,p,g){g=Math.min(c.i.length,g);const D=c.l?m(c.l.Ka,c.l,c):null;e:{var z=c.i;let ct=-1;for(;;){const Dn=["count="+g];ct==-1?g>0?(ct=z[0].g,Dn.push("ofs="+ct)):ct=0:Dn.push("ofs="+ct);let Wt=!0;for(let Cn=0;Cn<g;Cn++){var J=z[Cn].g;const Ss=z[Cn].map;if(J-=ct,J<0)ct=Math.max(0,z[Cn].g-100),Wt=!1;else try{J="req"+J+"_"||"";try{var ve=Ss instanceof Map?Ss:Object.entries(Ss);for(const[si,pr]of ve){let hr=pr;l(pr)&&(hr=Ze(pr)),Dn.push(J+si+"="+encodeURIComponent(hr))}}catch(si){throw Dn.push(J+"type="+encodeURIComponent("_badmap")),si}}catch{D&&D(Ss)}}if(Wt){ve=Dn.join("&");break e}}ve=void 0}return c=c.i.splice(0,g),p.G=c,ve}function yf(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;Z||N(),M||(Z(),M=!0),A.add(p,c),c.A=0}}function gu(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=tn(m(c.Da,c),xf(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,bf(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=tn(m(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Nt(10),el(this),bf(this))};function yu(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function bf(c){c.g=new U(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=dt(c.na);ft(p,"RID","rpc"),ft(p,"SID",c.M),ft(p,"AID",c.K),ft(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ft(p,"TO",c.ia),ft(p,"TYPE","xmlhttp"),jo(c,p),c.u&&c.o&&zt(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Ri(dt(p)),g.u=null,g.R=!0,X(g,c)}n.Va=function(){this.C!=null&&(this.C=null,el(this),gu(this),Nt(19))};function nl(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function Nf(c,p){var g=null;if(c.g==p){nl(c),yu(c),c.g=null;var D=2}else if(Oe(c.h,p))g=p.G,$e(c.h,p),D=1;else return;if(c.I!=0){if(p.o)if(D==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var z=c.D;D=ae(),L(D,new ln(D,g)),tl(c)}else yf(c);else if(z=p.m,z==3||z==0&&p.X>0||!(D==1&&Z0(c,p)||D==2&&gu(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),z){case 1:ni(c,5);break;case 4:ni(c,10);break;case 3:ni(c,6);break;default:ni(c,2)}}}function xf(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ni(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.bb,c),D=c.Ua;const z=!D;D=new Je(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||mn(D,"https"),Ri(D),z?pt(D.toString(),g):dn(D.toString(),g)}else Nt(2);c.I=0,c.l&&c.l.pa(p),vf(c),pf(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function vf(c){if(c.I=0,c.ja=[],c.l){const p=mt(c.h);(p.length!=0||c.i.length!=0)&&(I(c.ja,p),I(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function _f(c,p,g){var D=g instanceof Je?dt(g):new Je(g);if(D.g!="")p&&(D.g=p+"."+D.g),cn(D,D.u);else{var z=o.location;D=z.protocol,p=p?p+"."+z.hostname:z.hostname,z=+z.port;const J=new Je(null);D&&mn(J,D),p&&(J.g=p),z&&cn(J,z),g&&(J.h=g),D=J}return g=c.G,p=c.wa,g&&p&&ft(D,g,p),ft(D,"VER",c.ka),jo(c,D),D}function Df(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new ht(new nn({ab:g})):new ht(c.ma),p.Fa(c.L),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function kf(){}n=kf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function sl(){}sl.prototype.g=function(c,p){return new rs(c,p)};function rs(c,p){at.call(this),this.g=new ff(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!E(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!E(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new Hi(this)}f(rs,at),rs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rs.prototype.close=function(){hu(this.g)},rs.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=Ze(c),c=g);p.i.push(new Yt(p.Ya++,c)),p.I==3&&tl(p)},rs.prototype.N=function(){this.g.l=null,delete this.j,hu(this.g),delete this.g,rs.Z.N.call(this)};function Ef(c){O.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Ef,O);function Vf(){be.call(this),this.status=1}f(Vf,be);function Hi(c){this.g=c}f(Hi,kf),Hi.prototype.ra=function(){L(this.g,"a")},Hi.prototype.qa=function(c){L(this.g,new Ef(c))},Hi.prototype.pa=function(c){L(this.g,new Vf)},Hi.prototype.oa=function(){L(this.g,"b")},sl.prototype.createWebChannel=sl.prototype.g,rs.prototype.send=rs.prototype.o,rs.prototype.open=rs.prototype.m,rs.prototype.close=rs.prototype.close,ky=function(){return new sl},Dy=function(){return ae()},_y=ke,rm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Xn.NO_ERROR=0,Xn.TIMEOUT=8,Xn.HTTP_ERROR=6,Sl=Xn,Is.COMPLETE="complete",vy=Is,te.EventType=Ye,Ye.OPEN="a",Ye.CLOSE="b",Ye.ERROR="c",Ye.MESSAGE="d",at.prototype.listen=at.prototype.J,ea=te,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,xy=ht}).apply(typeof ll<"u"?ll:typeof self<"u"?self:typeof window<"u"?window:{});const Zf="@firebase/firestore",ep="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ln.UNAUTHENTICATED=new Ln(null),Ln.GOOGLE_CREDENTIALS=new Ln("google-credentials-uid"),Ln.FIRST_PARTY=new Ln("first-party-uid"),Ln.MOCK_USER=new Ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ko="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi=new cy("@firebase/firestore");function Yi(){return vi.logLevel}function pe(n,...e){if(vi.logLevel<=Vt.DEBUG){const t=e.map(td);vi.debug(`Firestore (${ko}): ${n}`,...t)}}function Gn(n,...e){if(vi.logLevel<=Vt.ERROR){const t=e.map(td);vi.error(`Firestore (${ko}): ${n}`,...t)}}function _i(n,...e){if(vi.logLevel<=Vt.WARN){const t=e.map(td);vi.warn(`Firestore (${ko}): ${n}`,...t)}}function td(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ie(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,Ey(n,s,t)}function Ey(n,e,t){let s=`FIRESTORE (${ko}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Gn(s),new Error(s)}function Ue(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||Ey(e,r,s)}function tt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ne extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ln.UNAUTHENTICATED))}shutdown(){}}class Bk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Uk{constructor(e){this.t=e,this.currentUser=Ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ue(this.o===void 0,42304);let s=this.i;const r=u=>this.i!==s?(s=this.i,t(u)):Promise.resolve();let i=new Ms;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ms,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ms)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Ue(typeof s.accessToken=="string",31837,{l:s}),new Vy(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string",2055,{h:e}),new Ln(e)}}class Hk{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Ln.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Mk{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new Hk(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ln.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tp{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Fk{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,fy(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ue(this.o===void 0,3512);const s=i=>{i.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tp(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ue(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=Ok(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function et(n,e){return n<e?-1:n>e?1:0}function im(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return wu(r)===wu(i)?et(r,i):wu(r)?1:-1}return et(n.length,e.length)}const qk=55296,$k=57343;function wu(n){const e=n.charCodeAt(0);return e>=qk&&e<=$k}function lo(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}function Ay(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np="__name__";class Ls{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ie(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Ie(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ls.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ls?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=Ls.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return et(e.length,t.length)}static compareSegments(e,t){const s=Ls.isNumericId(e),r=Ls.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Ls.extractNumericId(e).compare(Ls.extractNumericId(t)):im(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Lr.fromString(e.substring(4,e.length-2))}}class Pt extends Ls{construct(e,t,s){return new Pt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ne(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new Pt(t)}static emptyPath(){return new Pt([])}}const zk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sn extends Ls{construct(e,t,s){return new sn(e,t,s)}static isValidIdentifier(e){return zk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===np}static keyField(){return new sn([np])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new Ne(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ne(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ne(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(s+=l,r++):(i(),r++)}if(i(),o)throw new Ne(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sn(t)}static emptyPath(){return new sn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.path=e}static fromPath(e){return new Ve(Pt.fromString(e))}static fromName(e){return new Ve(Pt.fromString(e).popFirst(5))}static empty(){return new Ve(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ve(new Pt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(n,e,t){if(!t)throw new Ne(se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Wk(n,e,t,s){if(e===!0&&s===!0)throw new Ne(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sp(n){if(!Ve.isDocumentKey(n))throw new Ne(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rp(n){if(Ve.isDocumentKey(n))throw new Ne(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function wy(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ie(12329,{type:typeof n})}function Qn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ne(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wc(n);throw new Ne(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ma(n,e){if(!wy(n))throw new Ne(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const o=n[s];if(r&&typeof o!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new Ne(se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip=-62135596800,op=1e6;class Lt{static now(){return Lt.fromMillis(Date.now())}static fromDate(e){return Lt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*op);return new Lt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ne(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ne(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ip)throw new Ne(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ne(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/op}_compareTo(e){return this.seconds===e.seconds?et(this.nanoseconds,e.nanoseconds):et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Lt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ma(e,Lt._jsonSchema))return new Lt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ip;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Lt._jsonSchemaVersion="firestore/timestamp/1.0",Lt._jsonSchema={type:Nn("string",Lt._jsonSchemaVersion),seconds:Nn("number"),nanoseconds:Nn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{static fromTimestamp(e){return new ze(e)}static min(){return new ze(new Lt(0,0))}static max(){return new ze(new Lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=-1;class Jl{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}}function om(n){return n.fields.find(e=>e.kind===2)}function ai(n){return n.fields.filter(e=>e.kind!==2)}Jl.UNKNOWN_ID=-1;class Pl{constructor(e,t){this.fieldPath=e,this.kind=t}}class ka{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ka(0,ls.min())}}function Kk(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=ze.fromTimestamp(s===1e9?new Lt(t+1,0):new Lt(t,s));return new ls(r,Ve.empty(),e)}function Iy(n){return new ls(n.readTime,n.key,Da)}class ls{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new ls(ze.min(),Ve.empty(),Da)}static max(){return new ls(ze.max(),Ve.empty(),Da)}}function sd(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ve.comparator(n.documentKey,e.documentKey),t!==0?t:et(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ty="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Sy{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ii(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==Ty)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):$.reject(t)}static resolve(e){return new $((t,s)=>{t(e)})}static reject(e){return new $((t,s)=>{s(e)})}static waitFor(e){return new $((t,s)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>s(u))}),o=!0,i===r&&t()})}static or(e){let t=$.resolve(!1);for(const s of e)t=t.next(r=>r?$.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new $((s,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&s(o)},d=>r(d))}})}static doWhile(e,t){return new $((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="SimpleDb";class Ic{static open(e,t,s,r){try{return new Ic(t,e.transaction(r,s))}catch(i){throw new la(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ms,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new la(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const r=rd(s.target.error);this.S.reject(new la(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe(is,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Qk(t)}}class jr{static delete(e){return pe(is,"Removing database:",e),ci(Jg().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ay())return!1;if(jr.F())return!0;const e=Ql(),t=jr.M(e),s=0<t&&t<10,r=Py(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,jr.M(Ql())===12.2&&Gn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe(is,"Opening database:",this.name),this.db=await new Promise((t,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;t(o)},r.onblocked=()=>{s(new la(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new Ne(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new Ne(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new la(e,o))},r.onupgradeneeded=i=>{pe(is,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,r.transaction,i.oldVersion,this.version).next(()=>{pe(is,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,r){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Ic.open(this.db,e,i?"readonly":"readwrite",s),u=r(l).next(m=>(l.C(),m)).catch(m=>(l.abort(m),$.reject(m))).toPromise();return u.catch(()=>{}),await l.D,u}catch(l){const u=l,m=u.name!=="FirebaseError"&&o<3;if(pe(is,"Transaction failed with error:",u.message,"Retrying:",m),this.close(),!m)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Py(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Gk{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ci(this.U.delete())}}class la extends Ne{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Wr(n){return n.name==="IndexedDbTransactionError"}class Qk{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(pe(is,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(pe(is,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),ci(s)}add(e){return pe(is,"ADD",this.store.name,e,e),ci(this.store.add(e))}get(e){return ci(this.store.get(e)).next(t=>(t===void 0&&(t=null),pe(is,"GET",this.store.name,e,t),t))}delete(e){return pe(is,"DELETE",this.store.name,e),ci(this.store.delete(e))}count(){return pe(is,"COUNT",this.store.name),ci(this.store.count())}J(e,t){const s=this.options(e,t),r=s.index?this.store.index(s.index):this.store;if(typeof r.getAll=="function"){const i=r.getAll(s.range);return new $((o,l)=>{i.onerror=u=>{l(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(s),o=[];return this.H(i,(l,u)=>{o.push(u)}).next(()=>o)}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new $((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Z(e,t){pe(is,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const r=this.cursor(s);return this.H(r,(i,o,l)=>l.delete())}ee(e,t){let s;t?s=e:(s={},t=e);const r=this.cursor(s);return this.H(r,t)}te(e){const t=this.cursor({});return new $((s,r)=>{t.onerror=i=>{const o=rd(i.target.error);r(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}H(e,t){const s=[];return new $((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new Gk(l),m=t(l.primaryKey,l.value,u);if(m instanceof $){const d=m.catch(f=>(u.done(),$.reject(f)));s.push(d)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}}).next(()=>$.waitFor(s))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ci(n){return new $((e,t)=>{n.onsuccess=s=>{const r=s.target.result;e(r)},n.onerror=s=>{const r=rd(s.target.error);t(r)}})}let ap=!1;function rd(n){const e=jr.M(Ql());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new Ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ap||(ap=!0,setTimeout(()=>{throw s},0)),s}}return n}const ca="IndexBackfiller";class Yk{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe(ca,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();pe(ca,`Documents written: ${t}`)}catch(t){Wr(t)?pe(ca,"Ignoring IndexedDB error during index backfill: ",t):await Ii(t)}await this.re(6e4)})}}class Xk{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const s=new Set;let r=t,i=!0;return $.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return pe(ca,`Processing collection: ${o}`),this.oe(e,o,r).next(l=>{r-=l,s.add(o)});i=!1})).next(()=>t-r)}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(r,i)).next(l=>(pe(ca,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}_e(e,t){let s=e;return t.changes.forEach((r,i)=>{const o=Iy(i);sd(o,s)>0&&(s=o)}),new ls(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}fs.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=-1;function Tc(n){return n==null}function Ea(n){return n===0&&1/n==-1/0}function Jk(n){return typeof n=="number"&&Number.isInteger(n)&&!Ea(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl="";function $n(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lp(e)),e=Zk(n.get(t),e);return lp(e)}function Zk(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case Zl:t+="";break;default:t+=i}}return t}function lp(n){return n+Zl+""}function Bs(n){const e=n.length;if(Ue(e>=2,64408,{path:n}),e===2)return Ue(n.charAt(0)===Zl&&n.charAt(1)==="",56145,{path:n}),Pt.emptyPath();const t=e-2,s=[];let r="";for(let i=0;i<e;){const o=n.indexOf(Zl,i);switch((o<0||o>t)&&Ie(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(i,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),s.push(u);break;case"":r+=n.substring(i,o),r+="\0";break;case"":r+=n.substring(i,o+1);break;default:Ie(61167,{path:n})}i=o+2}return new Pt(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li="remoteDocuments",Fa="owner",Mi="owner",Va="mutationQueues",eE="userId",bs="mutations",cp="batchId",fi="userMutationsIndex",up=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(n,e){return[n,$n(e)]}function Ly(n,e,t){return[n,$n(e),t]}const tE={},co="documentMutations",ec="remoteDocumentsV14",nE=["prefixPath","collectionGroup","readTime","documentId"],jl="documentKeyIndex",sE=["prefixPath","collectionGroup","documentId"],jy="collectionGroupIndex",rE=["collectionGroup","readTime","prefixPath","documentId"],Aa="remoteDocumentGlobal",am="remoteDocumentGlobalKey",uo="targets",Ry="queryTargetsIndex",iE=["canonicalId","targetId"],mo="targetDocuments",oE=["targetId","path"],id="documentTargetsIndex",aE=["path","targetId"],tc="targetGlobalKey",gi="targetGlobal",Ca="collectionParents",lE=["collectionId","parent"],fo="clientMetadata",cE="clientId",Sc="bundles",uE="bundleId",Pc="namedQueries",mE="name",od="indexConfiguration",dE="indexId",lm="collectionGroupIndex",fE="collectionGroup",ua="indexState",pE=["indexId","uid"],By="sequenceNumberIndex",hE=["uid","sequenceNumber"],ma="indexEntries",gE=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Uy="documentKeyIndex",yE=["indexId","uid","orderedDocumentKey"],Lc="documentOverlays",bE=["userId","collectionPath","documentId"],cm="collectionPathOverlayIndex",NE=["userId","collectionPath","largestBatchId"],Hy="collectionGroupOverlayIndex",xE=["userId","collectionGroup","largestBatchId"],ad="globals",vE="name",My=[Va,bs,co,li,uo,Fa,gi,mo,fo,Aa,Ca,Sc,Pc],_E=[...My,Lc],Fy=[Va,bs,co,ec,uo,Fa,gi,mo,fo,Aa,Ca,Sc,Pc,Lc],Oy=Fy,ld=[...Oy,od,ua,ma],DE=ld,qy=[...ld,ad],kE=qy;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um extends Sy{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Vn(n,e){const t=tt(n);return jr.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Kr(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $y(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,t){this.comparator=e,this.root=t||jn.EMPTY}insert(e,t){return new en(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,jn.BLACK,null,null))}remove(e){return new en(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cl(this.root,e,this.comparator,!1)}getReverseIterator(){return new cl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cl(this.root,e,this.comparator,!0)}}class cl{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jn{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??jn.RED,this.left=r??jn.EMPTY,this.right=i??jn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new jn(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return jn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return jn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ie(27949);return e+(this.isRed()?0:1)}}jn.EMPTY=null,jn.RED=!0,jn.BLACK=!1;jn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie(57766)}get value(){throw Ie(16141)}get color(){throw Ie(16727)}get left(){throw Ie(29726)}get right(){throw Ie(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new jn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.comparator=e,this.data=new en(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dp(this.data.getIterator())}getIteratorFrom(e){return new dp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Mt(this.comparator);return t.data=e,t}}class dp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.fields=e,e.sort(sn.comparator)}static empty(){return new ss([])}unionWith(e){let t=new Mt(sn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new ss(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lo(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new zy("Invalid base64 string: "+i):i}}(e);return new vn(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new vn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vn.EMPTY_BYTE_STRING=new vn("");const EE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rr(n){if(Ue(!!n,39018),typeof n=="string"){let e=0;const t=EE.exec(n);if(Ue(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Zt(n.seconds),nanos:Zt(n.nanos)}}function Zt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ir(n){return typeof n=="string"?vn.fromBase64String(n):vn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wy="server_timestamp",Ky="__type__",Gy="__previous_value__",Qy="__local_write_time__";function cd(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Ky])==null?void 0:s.stringValue)===Wy}function jc(n){const e=n.mapValue.fields[Gy];return cd(e)?jc(e):e}function wa(n){const e=rr(n.mapValue.fields[Qy].timestampValue);return new Lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e,t,s,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const nc="(default)";class Di{constructor(e,t){this.projectId=e,this.database=t||nc}static empty(){return new Di("","")}get isDefaultDatabase(){return this.database===nc}isEqual(e){return e instanceof Di&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ud="__type__",Yy="__max__",wr={mapValue:{fields:{__type__:{stringValue:Yy}}}},md="__vector__",po="value",Rl={nullValue:"NULL_VALUE"};function Ur(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?cd(n)?4:Xy(n)?9007199254740991:Rc(n)?10:11:Ie(28295,{value:n})}function $s(n,e){if(n===e)return!0;const t=Ur(n);if(t!==Ur(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wa(n).isEqual(wa(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=rr(r.timestampValue),l=rr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return ir(r.bytesValue).isEqual(ir(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return Zt(r.geoPointValue.latitude)===Zt(i.geoPointValue.latitude)&&Zt(r.geoPointValue.longitude)===Zt(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Zt(r.integerValue)===Zt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=Zt(r.doubleValue),l=Zt(i.doubleValue);return o===l?Ea(o)===Ea(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return lo(n.arrayValue.values||[],e.arrayValue.values||[],$s);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(mp(o)!==mp(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!$s(o[u],l[u])))return!1;return!0}(n,e);default:return Ie(52216,{left:n})}}function Ia(n,e){return(n.values||[]).find(t=>$s(t,e))!==void 0}function Hr(n,e){if(n===e)return 0;const t=Ur(n),s=Ur(e);if(t!==s)return et(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return et(n.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Zt(i.integerValue||i.doubleValue),u=Zt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(n,e);case 3:return fp(n.timestampValue,e.timestampValue);case 4:return fp(wa(n),wa(e));case 5:return im(n.stringValue,e.stringValue);case 6:return function(i,o){const l=ir(i),u=ir(o);return l.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=et(l[m],u[m]);if(d!==0)return d}return et(l.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const l=et(Zt(i.latitude),Zt(o.latitude));return l!==0?l:et(Zt(i.longitude),Zt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return pp(n.arrayValue,e.arrayValue);case 10:return function(i,o){var h,y,I,v;const l=i.fields||{},u=o.fields||{},m=(h=l[po])==null?void 0:h.arrayValue,d=(y=u[po])==null?void 0:y.arrayValue,f=et(((I=m==null?void 0:m.values)==null?void 0:I.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:pp(m,d)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===wr.mapValue&&o===wr.mapValue)return 0;if(i===wr.mapValue)return 1;if(o===wr.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const h=im(u[f],d[f]);if(h!==0)return h;const y=Hr(l[u[f]],m[d[f]]);if(y!==0)return y}return et(u.length,d.length)}(n.mapValue,e.mapValue);default:throw Ie(23264,{he:t})}}function fp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return et(n,e);const t=rr(n),s=rr(e),r=et(t.seconds,s.seconds);return r!==0?r:et(t.nanos,s.nanos)}function pp(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Hr(t[r],s[r]);if(i)return i}return et(t.length,s.length)}function ho(n){return mm(n)}function mm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=rr(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ir(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ve.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=mm(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${mm(t.fields[o])}`;return r+"}"}(n.mapValue):Ie(61005,{value:n})}function Bl(n){switch(Ur(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=jc(n);return e?16+Bl(e):16;case 5:return 2*n.stringValue.length;case 6:return ir(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+Bl(i),0)}(n.arrayValue);case 10:case 11:return function(s){let r=0;return Kr(s.fields,(i,o)=>{r+=i.length+Bl(o)}),r}(n.mapValue);default:throw Ie(13486,{value:n})}}function Ta(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dm(n){return!!n&&"integerValue"in n}function Sa(n){return!!n&&"arrayValue"in n}function hp(n){return!!n&&"nullValue"in n}function gp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ul(n){return!!n&&"mapValue"in n}function Rc(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[ud])==null?void 0:s.stringValue)===md}function da(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Kr(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=da(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=da(n.arrayValue.values[t]);return e}return{...n}}function Xy(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Yy}const Jy={mapValue:{fields:{[ud]:{stringValue:md},[po]:{arrayValue:{}}}}};function AE(n){return"nullValue"in n?Rl:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ta(Di.empty(),Ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Rc(n)?Jy:{mapValue:{}}:Ie(35942,{value:n})}function CE(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ta(Di.empty(),Ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Jy:"mapValue"in n?Rc(n)?{mapValue:{}}:wr:Ie(61959,{value:n})}function yp(n,e){const t=Hr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function bp(n,e){const t=Hr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.value=e}static empty(){return new On({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Ul(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=da(t)}setAll(e){let t=sn.emptyPath(),s={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,s,r),s={},r=[],t=l.popLast()}o?s[l.lastSegment()]=da(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());Ul(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $s(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];Ul(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Kr(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new On(da(this.value))}}function Zy(n){const e=[];return Kr(n.fields,(t,s)=>{const r=new sn([t]);if(Ul(s)){const i=Zy(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new ss(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,t,s,r,i,o,l){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new rn(e,0,ze.min(),ze.min(),ze.min(),On.empty(),0)}static newFoundDocument(e,t,s,r){return new rn(e,1,t,ze.min(),s,r,0)}static newNoDocument(e,t){return new rn(e,2,t,ze.min(),ze.min(),On.empty(),0)}static newUnknownDocument(e,t){return new rn(e,3,t,ze.min(),ze.min(),On.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=On.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=On.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,t){this.position=e,this.inclusive=t}}function Np(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=Ve.comparator(Ve.fromName(o.referenceValue),t.key):s=Hr(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function xp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$s(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t="asc"){this.field=e,this.dir=t}}function wE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{}class vt extends eb{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new IE(e,t,s):t==="array-contains"?new PE(e,s):t==="in"?new ob(e,s):t==="not-in"?new LE(e,s):t==="array-contains-any"?new jE(e,s):new vt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new TE(e,s):new SE(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Hr(t,this.value)):t!==null&&Ur(this.value)===Ur(t)&&this.matchesComparison(Hr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ht extends eb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ht(e,t)}matches(e){return yo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function yo(n){return n.op==="and"}function fm(n){return n.op==="or"}function dd(n){return tb(n)&&yo(n)}function tb(n){for(const e of n.filters)if(e instanceof Ht)return!1;return!0}function pm(n){if(n instanceof vt)return n.field.canonicalString()+n.op.toString()+ho(n.value);if(dd(n))return n.filters.map(e=>pm(e)).join(",");{const e=n.filters.map(t=>pm(t)).join(",");return`${n.op}(${e})`}}function nb(n,e){return n instanceof vt?function(s,r){return r instanceof vt&&s.op===r.op&&s.field.isEqual(r.field)&&$s(s.value,r.value)}(n,e):n instanceof Ht?function(s,r){return r instanceof Ht&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,l)=>i&&nb(o,r.filters[l]),!0):!1}(n,e):void Ie(19439)}function sb(n,e){const t=n.filters.concat(e);return Ht.create(t,n.op)}function rb(n){return n instanceof vt?function(t){return`${t.field.canonicalString()} ${t.op} ${ho(t.value)}`}(n):n instanceof Ht?function(t){return t.op.toString()+" {"+t.getFilters().map(rb).join(" ,")+"}"}(n):"Filter"}class IE extends vt{constructor(e,t,s){super(e,t,s),this.key=Ve.fromName(s.referenceValue)}matches(e){const t=Ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class TE extends vt{constructor(e,t){super(e,"in",t),this.keys=ib("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class SE extends vt{constructor(e,t){super(e,"not-in",t),this.keys=ib("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ib(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(s=>Ve.fromName(s.referenceValue))}class PE extends vt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Sa(t)&&Ia(t.arrayValue,this.value)}}class ob extends vt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ia(this.value.arrayValue,t)}}class LE extends vt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ia(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ia(this.value.arrayValue,t)}}class jE extends vt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Sa(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>Ia(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,t=null,s=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function hm(n,e=null,t=[],s=[],r=null,i=null,o=null){return new RE(n,e,t,s,r,i,o)}function ki(n){const e=tt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>pm(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Tc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>ho(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>ho(s)).join(",")),e.Te=t}return e.Te}function Oa(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!nb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!xp(n.startAt,e.startAt)&&xp(n.endAt,e.endAt)}function sc(n){return Ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function rc(n,e){return n.filters.filter(t=>t instanceof vt&&t.field.isEqual(e))}function vp(n,e,t){let s=Rl,r=!0;for(const i of rc(n,e)){let o=Rl,l=!0;switch(i.op){case"<":case"<=":o=AE(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Rl}yp({value:s,inclusive:r},{value:o,inclusive:l})<0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];yp({value:s,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}function _p(n,e,t){let s=wr,r=!0;for(const i of rc(n,e)){let o=wr,l=!0;switch(i.op){case">=":case">":o=CE(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=wr}bp({value:s,inclusive:r},{value:o,inclusive:l})>0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];bp({value:s,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,t=null,s=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function BE(n,e,t,s,r,i,o,l){return new Eo(n,e,t,s,r,i,o,l)}function qa(n){return new Eo(n)}function Dp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ab(n){return n.collectionGroup!==null}function fa(n){const e=tt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Mt(sn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Pa(i,s))}),t.has(sn.keyField().canonicalString())||e.Ie.push(new Pa(sn.keyField(),s))}return e.Ie}function ps(n){const e=tt(n);return e.Ee||(e.Ee=UE(e,fa(n))),e.Ee}function UE(n,e){if(n.limitType==="F")return hm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Pa(r.field,i)});const t=n.endAt?new go(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new go(n.startAt.position,n.startAt.inclusive):null;return hm(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function gm(n,e){const t=n.filters.concat([e]);return new Eo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ym(n,e,t){return new Eo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Bc(n,e){return Oa(ps(n),ps(e))&&n.limitType===e.limitType}function lb(n){return`${ki(ps(n))}|lt:${n.limitType}`}function Xi(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>rb(r)).join(", ")}]`),Tc(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>ho(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>ho(r)).join(",")),`Target(${s})`}(ps(n))}; limitType=${n.limitType})`}function $a(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Ve.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of fa(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(o,l,u){const m=Np(o,l,u);return o.inclusive?m<=0:m<0}(s.startAt,fa(s),r)||s.endAt&&!function(o,l,u){const m=Np(o,l,u);return o.inclusive?m>=0:m>0}(s.endAt,fa(s),r))}(n,e)}function HE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function cb(n){return(e,t)=>{let s=!1;for(const r of fa(n)){const i=ME(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function ME(n,e,t){const s=n.field.isKeyField()?Ve.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Hr(u,m):Ie(42886)}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Ie(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Kr(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return $y(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE=new en(Ve.comparator);function as(){return FE}const ub=new en(Ve.comparator);function ta(...n){let e=ub;for(const t of n)e=e.insert(t.key,t);return e}function mb(n){let e=ub;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Us(){return pa()}function db(){return pa()}function pa(){return new or(n=>n.toString(),(n,e)=>n.isEqual(e))}const OE=new en(Ve.comparator),qE=new Mt(Ve.comparator);function gt(...n){let e=qE;for(const t of n)e=e.add(t);return e}const $E=new Mt(et);function zE(){return $E}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ea(e)?"-0":e}}function fb(n){return{integerValue:""+n}}function WE(n,e){return Jk(e)?fb(e):fd(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(){this._=void 0}}function KE(n,e,t){return n instanceof La?function(r,i){const o={fields:{[Ky]:{stringValue:Wy},[Qy]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&cd(i)&&(i=jc(i)),i&&(o.fields[Gy]=i),{mapValue:o}}(t,e):n instanceof bo?hb(n,e):n instanceof No?gb(n,e):function(r,i){const o=pb(r,i),l=kp(o)+kp(r.Ae);return dm(o)&&dm(r.Ae)?fb(l):fd(r.serializer,l)}(n,e)}function GE(n,e,t){return n instanceof bo?hb(n,e):n instanceof No?gb(n,e):t}function pb(n,e){return n instanceof ja?function(s){return dm(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class La extends Uc{}class bo extends Uc{constructor(e){super(),this.elements=e}}function hb(n,e){const t=yb(e);for(const s of n.elements)t.some(r=>$s(r,s))||t.push(s);return{arrayValue:{values:t}}}class No extends Uc{constructor(e){super(),this.elements=e}}function gb(n,e){let t=yb(e);for(const s of n.elements)t=t.filter(r=>!$s(r,s));return{arrayValue:{values:t}}}class ja extends Uc{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kp(n){return Zt(n.integerValue||n.doubleValue)}function yb(n){return Sa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e,t){this.field=e,this.transform=t}}function YE(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof bo&&r instanceof bo||s instanceof No&&r instanceof No?lo(s.elements,r.elements,$s):s instanceof ja&&r instanceof ja?$s(s.Ae,r.Ae):s instanceof La&&r instanceof La}(n.transform,e.transform)}class XE{constructor(e,t){this.version=e,this.transformResults=t}}class qn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new qn}static exists(e){return new qn(void 0,e)}static updateTime(e){return new qn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Hc{}function bb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Mc(n.key,qn.none()):new Vo(n.key,n.data,qn.none());{const t=n.data,s=On.empty();let r=new Mt(sn.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new ar(n.key,s,new ss(r.toArray()),qn.none())}}function JE(n,e,t){n instanceof Vo?function(r,i,o){const l=r.value.clone(),u=Vp(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ar?function(r,i,o){if(!Hl(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Vp(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Nb(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ha(n,e,t,s){return n instanceof Vo?function(i,o,l,u){if(!Hl(i.precondition,o))return l;const m=i.value.clone(),d=Ap(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(n,e,t,s):n instanceof ar?function(i,o,l,u){if(!Hl(i.precondition,o))return l;const m=Ap(i.fieldTransforms,u,o),d=o.data;return d.setAll(Nb(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(i,o,l){return Hl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function ZE(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=pb(s.transform,r||null);i!=null&&(t===null&&(t=On.empty()),t.set(s.field,i))}return t||null}function Ep(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&lo(s,r,(i,o)=>YE(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Vo extends Hc{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ar extends Hc{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Nb(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function Vp(n,e,t){const s=new Map;Ue(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,l=e.data.field(i.field);s.set(i.field,GE(o,l,t[r]))}return s}function Ap(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,KE(i,o,e))}return s}class Mc extends Hc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xb extends Hc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&JE(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=ha(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=ha(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=db();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=bb(o,l);u!==null&&s.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(ze.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),gt())}isEqual(e){return this.batchId===e.batchId&&lo(this.mutations,e.mutations,(t,s)=>Ep(t,s))&&lo(this.baseMutations,e.baseMutations,(t,s)=>Ep(t,s))}}class hd{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){Ue(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return OE}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new hd(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pn,Et;function tV(n){switch(n){case se.OK:return Ie(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Ie(15467,{code:n})}}function vb(n){if(n===void 0)return Gn("GRPC error has no .code"),se.UNKNOWN;switch(n){case pn.OK:return se.OK;case pn.CANCELLED:return se.CANCELLED;case pn.UNKNOWN:return se.UNKNOWN;case pn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case pn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case pn.INTERNAL:return se.INTERNAL;case pn.UNAVAILABLE:return se.UNAVAILABLE;case pn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case pn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case pn.NOT_FOUND:return se.NOT_FOUND;case pn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case pn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case pn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case pn.ABORTED:return se.ABORTED;case pn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case pn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case pn.DATA_LOSS:return se.DATA_LOSS;default:return Ie(39323,{code:n})}}(Et=pn||(pn={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV=new Lr([4294967295,4294967295],0);function Cp(n){const e=nV().encode(n),t=new Ny;return t.update(e),new Uint8Array(t.digest())}function wp(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Lr([t,s],0),new Lr([r,i],0)]}class yd{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new na(`Invalid padding: ${t}`);if(s<0)throw new na(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new na(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new na(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Lr.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(Lr.fromNumber(s)));return r.compare(sV)===1&&(r=new Lr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Cp(e),[s,r]=wp(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new yd(i,r,t);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Cp(e),[s,r]=wp(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class na extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,za.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Fc(ze.min(),r,new en(et),as(),gt())}}class za{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new za(s,t,gt(),gt(),gt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class _b{constructor(e,t){this.targetId=e,this.Ce=t}}class Db{constructor(e,t,s=vn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Ip{constructor(){this.ve=0,this.Fe=Tp(),this.Me=vn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gt(),t=gt(),s=gt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Ie(38017,{changeType:i})}}),new za(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Tp()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ue(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class rV{constructor(e){this.Ge=e,this.ze=new Map,this.je=as(),this.Je=ul(),this.He=ul(),this.Ye=new en(et)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Ie(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((s,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(sc(i))if(s===0){const o=new Ve(i.path);this.et(t,o,rn.newNoDocument(o,ze.min()))}else Ue(s===1,20013,{expectedCount:s});else{const o=this._t(t);if(o!==s){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=ir(s).toUint8Array()}catch(u){if(u instanceof zy)return _i("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new yd(o,r,i)}catch(u){return _i(u instanceof na?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&sc(l.target)){const u=new Ve(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,rn.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let s=gt();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new Fc(e,t,this.Ye,this.je,s);return this.je=as(),this.Je=ul(),this.He=ul(),this.Ye=new en(et),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Ip,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Mt(et),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Mt(et),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ip),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ul(){return new en(Ve.comparator)}function Tp(){return new en(Ve.comparator)}const iV={asc:"ASCENDING",desc:"DESCENDING"},oV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aV={and:"AND",or:"OR"};class lV{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bm(n,e){return n.useProto3Json||Tc(e)?e:{value:e}}function xo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function cV(n,e){return xo(n,e.toTimestamp())}function Yn(n){return Ue(!!n,49232),ze.fromTimestamp(function(t){const s=rr(t);return new Lt(s.seconds,s.nanos)}(n))}function bd(n,e){return Nm(n,e).canonicalString()}function Nm(n,e){const t=function(r){return new Pt(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Eb(n){const e=Pt.fromString(n);return Ue(Lb(e),10190,{key:e.toString()}),e}function ic(n,e){return bd(n.databaseId,e.path)}function yi(n,e){const t=Eb(e);if(t.get(1)!==n.databaseId.projectId)throw new Ne(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ne(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ve(Cb(t))}function Vb(n,e){return bd(n.databaseId,e)}function Ab(n){const e=Eb(n);return e.length===4?Pt.emptyPath():Cb(e)}function xm(n){return new Pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Cb(n){return Ue(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Sp(n,e,t){return{name:ic(n,e),fields:t.value.mapValue.fields}}function uV(n,e,t){const s=yi(n,e.name),r=Yn(e.updateTime),i=e.createTime?Yn(e.createTime):ze.min(),o=new On({mapValue:{fields:e.fields}}),l=rn.newFoundDocument(s,r,i,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function mV(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ie(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Ue(d===void 0||typeof d=="string",58123),vn.fromBase64String(d||"")):(Ue(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),vn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?se.UNKNOWN:vb(m.code);return new Ne(d,m.message||"")}(o);t=new Db(s,r,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=yi(n,s.document.name),i=Yn(s.document.updateTime),o=s.document.createTime?Yn(s.document.createTime):ze.min(),l=new On({mapValue:{fields:s.document.fields}}),u=rn.newFoundDocument(r,i,o,l),m=s.targetIds||[],d=s.removedTargetIds||[];t=new Ml(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=yi(n,s.document),i=s.readTime?Yn(s.readTime):ze.min(),o=rn.newNoDocument(r,i),l=s.removedTargetIds||[];t=new Ml([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=yi(n,s.document),i=s.removedTargetIds||[];t=new Ml([],i,r,null)}else{if(!("filter"in e))return Ie(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new eV(r,i),l=s.targetId;t=new _b(l,o)}}return t}function oc(n,e){let t;if(e instanceof Vo)t={update:Sp(n,e.key,e.value)};else if(e instanceof Mc)t={delete:ic(n,e.key)};else if(e instanceof ar)t={update:Sp(n,e.key,e.data),updateMask:yV(e.fieldMask)};else{if(!(e instanceof xb))return Ie(16599,{Vt:e.type});t={verify:ic(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const l=o.transform;if(l instanceof La)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof bo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof No)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ja)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Ie(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:cV(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ie(27497)}(n,e.precondition)),t}function vm(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?qn.updateTime(Yn(i.updateTime)):i.exists!==void 0?qn.exists(i.exists):qn.none()}(e.currentDocument):qn.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(o,l){let u=null;if("setToServerValue"in l)Ue(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new La;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];u=new bo(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];u=new No(d)}else"increment"in l?u=new ja(o,l.increment):Ie(16584,{proto:l});const m=sn.fromServerFormat(l.fieldPath);return new QE(m,u)}(n,r)):[];if(e.update){e.update.name;const r=yi(n,e.update.name),i=new On({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const m=u.fieldPaths||[];return new ss(m.map(d=>sn.fromServerFormat(d)))}(e.updateMask);return new ar(r,i,o,t,s)}return new Vo(r,i,t,s)}if(e.delete){const r=yi(n,e.delete);return new Mc(r,t)}if(e.verify){const r=yi(n,e.verify);return new xb(r,t)}return Ie(1463,{proto:e})}function dV(n,e){return n&&n.length>0?(Ue(e!==void 0,14353),n.map(t=>function(r,i){let o=r.updateTime?Yn(r.updateTime):Yn(i);return o.isEqual(ze.min())&&(o=Yn(i)),new XE(o,r.transformResults||[])}(t,e))):[]}function wb(n,e){return{documents:[Vb(n,e.path)]}}function Ib(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Vb(n,r);const i=function(m){if(m.length!==0)return Pb(Ht.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(h){return{field:Ji(h.field),direction:pV(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=bm(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function Tb(n){let e=Ab(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){Ue(s===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const h=Sb(f);return h instanceof Ht&&dd(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(h=>function(I){return new Pa(Zi(I.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(h))}(t.orderBy));let l=null;t.limit&&(l=function(f){let h;return h=typeof f=="object"?f.value:f,Tc(h)?null:h}(t.limit));let u=null;t.startAt&&(u=function(f){const h=!!f.before,y=f.values||[];return new go(y,h)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const h=!f.before,y=f.values||[];return new go(y,h)}(t.endAt)),BE(e,r,o,i,l,"F",u,m)}function fV(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Sb(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Zi(t.unaryFilter.field);return vt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Zi(t.unaryFilter.field);return vt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Zi(t.unaryFilter.field);return vt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Zi(t.unaryFilter.field);return vt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ie(61313);default:return Ie(60726)}}(n):n.fieldFilter!==void 0?function(t){return vt.create(Zi(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ie(58110);default:return Ie(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ht.create(t.compositeFilter.filters.map(s=>Sb(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ie(1026)}}(t.compositeFilter.op))}(n):Ie(30097,{filter:n})}function pV(n){return iV[n]}function hV(n){return oV[n]}function gV(n){return aV[n]}function Ji(n){return{fieldPath:n.canonicalString()}}function Zi(n){return sn.fromServerFormat(n.fieldPath)}function Pb(n){return n instanceof vt?function(t){if(t.op==="=="){if(gp(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NAN"}};if(hp(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(gp(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NOT_NAN"}};if(hp(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ji(t.field),op:hV(t.op),value:t.value}}}(n):n instanceof Ht?function(t){const s=t.getFilters().map(r=>Pb(r));return s.length===1?s[0]:{compositeFilter:{op:gV(t.op),filters:s}}}(n):Ie(54877,{filter:n})}function yV(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Lb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,t,s,r,i=ze.min(),o=ze.min(),l=vn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Zs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e){this.yt=e}}function bV(n,e){let t;if(e.document)t=uV(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Ve.fromSegments(e.noDocument.path),r=Vi(e.noDocument.readTime);t=rn.newNoDocument(s,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ie(56709);{const s=Ve.fromSegments(e.unknownDocument.path),r=Vi(e.unknownDocument.version);t=rn.newUnknownDocument(s,r)}}return e.readTime&&t.setReadTime(function(r){const i=new Lt(r[0],r[1]);return ze.fromTimestamp(i)}(e.readTime)),t}function Pp(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ac(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(i,o){return{name:ic(i,o.key),fields:o.data.value.mapValue.fields,updateTime:xo(i,o.version.toTimestamp()),createTime:xo(i,o.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:Ei(e.version)};else{if(!e.isUnknownDocument())return Ie(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:Ei(e.version)}}return s}function ac(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ei(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Vi(n){const e=new Lt(n.seconds,n.nanoseconds);return ze.fromTimestamp(e)}function ui(n,e){const t=(e.baseMutations||[]).map(i=>vm(n.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>vm(n.yt,i)),r=Lt.fromMillis(e.localWriteTimeMs);return new pd(e.batchId,r,t,s)}function sa(n){const e=Vi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Vi(n.lastLimboFreeSnapshotVersion):ze.min();let s;return s=function(i){return i.documents!==void 0}(n.query)?function(i){const o=i.documents.length;return Ue(o===1,1966,{count:o}),ps(qa(Ab(i.documents[0])))}(n.query):function(i){return ps(Tb(i))}(n.query),new Zs(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,vn.fromBase64String(n.resumeToken))}function Rb(n,e){const t=Ei(e.snapshotVersion),s=Ei(e.lastLimboFreeSnapshotVersion);let r;r=sc(e.target)?wb(n.yt,e.target):Ib(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ki(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function Bb(n){const e=Tb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ym(e,e.limit,"L"):e}function Iu(n,e){return new gd(e.largestBatchId,vm(n.yt,e.overlayMutation))}function Lp(n,e){const t=e.path.lastSegment();return[n,$n(e.path.popLast()),t]}function jp(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ei(s.readTime),documentKey:$n(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{getBundleMetadata(e,t){return Rp(e).get(t).next(s=>{if(s)return function(i){return{id:i.bundleId,createTime:Vi(i.createTime),version:i.version}}(s)})}saveBundleMetadata(e,t){return Rp(e).put(function(r){return{bundleId:r.id,createTime:Ei(Yn(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return Bp(e).get(t).next(s=>{if(s)return function(i){return{name:i.name,query:Bb(i.bundledQuery),readTime:Vi(i.readTime)}}(s)})}saveNamedQuery(e,t){return Bp(e).put(function(r){return{name:r.name,readTime:Ei(Yn(r.readTime)),bundledQuery:r.bundledQuery}}(t))}}function Rp(n){return Vn(n,Sc)}function Bp(n){return Vn(n,Pc)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new Oc(e,s)}getOverlay(e,t){return Ho(e).get(Lp(this.userId,t)).next(s=>s?Iu(this.serializer,s):null)}getOverlays(e,t){const s=Us();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){const r=[];return s.forEach((i,o)=>{const l=new gd(t,o);r.push(this.St(e,l))}),$.waitFor(r)}removeOverlaysForBatchId(e,t,s){const r=new Set;t.forEach(o=>r.add($n(o.getCollectionPath())));const i=[];return r.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(Ho(e).Z(cm,l))}),$.waitFor(i)}getOverlaysForCollection(e,t,s){const r=Us(),i=$n(t),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ho(e).J(cm,o).next(l=>{for(const u of l){const m=Iu(this.serializer,u);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,s,r){const i=Us();let o;const l=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ho(e).ee({index:Hy,range:l},(u,m,d)=>{const f=Iu(this.serializer,m);i.size()<r||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}St(e,t){return Ho(e).put(function(r,i,o){const[l,u,m]=Lp(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:m,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:oc(r.yt,o.mutation)}}(this.serializer,this.userId,t))}}function Ho(n){return Vn(n,Lc)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{bt(e){return Vn(e,ad)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const s=t==null?void 0:t.value;return s?vn.fromUint8Array(s):vn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Zt(e.integerValue));else if("doubleValue"in e){const s=Zt(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),Ea(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=rr(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ir(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?Xy(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Rc(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ie(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const r of Object.keys(s))this.Ot(r,t),this.Ct(s[r],t)}kt(e,t){var o,l;const s=e.fields||{};this.Ft(t,53);const r=po,i=((l=(o=s[r].arrayValue)==null?void 0:o.values)==null?void 0:l.length)||0;this.Ft(t,15),t.Mt(Zt(i)),this.Ot(r,t),this.Ct(s[r],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const r of s)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ve.fromName(e).path.forEach(s=>{this.Ft(t,60),this.Ut(s,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}mi.Kt=new mi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi=255;function vV(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Up(n){const e=64-function(s){let r=0;for(let i=0;i<8;++i){const o=vV(255&s[i]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(e/8)}class _V{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),s=Up(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),s=Up(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Oi),this.sn(255)}_n(){this.an(Oi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let r=1;r<t.length;++r)t[r]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Oi?(this.sn(Oi),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Oi?(this.an(Oi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class DV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class kV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Mo{constructor(){this.cn=new _V,this.ln=new DV(this.cn),this.hn=new kV(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,t,s,r){this.Tn=e,this.In=t,this.En=s,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new di(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:Fl(this.En),directionalValue:Fl(this.dn),orderedDocumentKey:Fl(t),documentKey:s.path.toArray()}}Vn(e,t,s){const r=this.Rn(e,t,s);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function gr(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=Hp(n.En,e.En),t!==0?t:(t=Hp(n.dn,e.dn),t!==0?t:Ve.comparator(n.In,e.In)))}function Hp(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function Fl(n){return oy()?function(t){let s="";for(let r=0;r<t.length;r++)s+=String.fromCharCode(t[r]);return s}(n):n}function Mp(n){return typeof n!="string"?n:function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(n)}class Fp{constructor(e){this.mn=new Mt((t,s)=>sn.comparator(t.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(Ue(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=om(e);if(t!==void 0&&!this.wn(t))return!1;const s=ai(e);let r=new Set,i=0,o=0;for(;i<s.length&&this.wn(s[i]);++i)r=r.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=s[i];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new Mt(sn.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Pl(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Pl(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Pl(s.field,s.dir==="asc"?0:1)));return new Jl(Jl.UNKNOWN_ID,this.collectionId,t,ka.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(n){var t,s;if(Ue(n instanceof vt||n instanceof Ht,20012),n instanceof vt){if(n instanceof ob){const r=((s=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:s.map(i=>vt.create(n.field,"==",i)))||[];return Ht.create(r,"or")}return n}const e=n.filters.map(r=>Ub(r));return Ht.create(e,n.op)}function EV(n){if(n.getFilters().length===0)return[];const e=km(Ub(n));return Ue(Hb(e),7391),_m(e)||Dm(e)?[e]:e.getFilters()}function _m(n){return n instanceof vt}function Dm(n){return n instanceof Ht&&dd(n)}function Hb(n){return _m(n)||Dm(n)||function(t){if(t instanceof Ht&&fm(t)){for(const s of t.getFilters())if(!_m(s)&&!Dm(s))return!1;return!0}return!1}(n)}function km(n){if(Ue(n instanceof vt||n instanceof Ht,34018),n instanceof vt)return n;if(n.filters.length===1)return km(n.filters[0]);const e=n.filters.map(s=>km(s));let t=Ht.create(e,n.op);return t=lc(t),Hb(t)?t:(Ue(t instanceof Ht,64498),Ue(yo(t),40251),Ue(t.filters.length>1,57927),t.filters.reduce((s,r)=>Nd(s,r)))}function Nd(n,e){let t;return Ue(n instanceof vt||n instanceof Ht,38388),Ue(e instanceof vt||e instanceof Ht,25473),t=n instanceof vt?e instanceof vt?function(r,i){return Ht.create([r,i],"and")}(n,e):Op(n,e):e instanceof vt?Op(e,n):function(r,i){if(Ue(r.filters.length>0&&i.filters.length>0,48005),yo(r)&&yo(i))return sb(r,i.getFilters());const o=fm(r)?r:i,l=fm(r)?i:r,u=o.filters.map(m=>Nd(m,l));return Ht.create(u,"or")}(n,e),lc(t)}function Op(n,e){if(yo(e))return sb(e,n.getFilters());{const t=e.filters.map(s=>Nd(n,s));return Ht.create(t,"or")}}function lc(n){if(Ue(n instanceof vt||n instanceof Ht,11850),n instanceof vt)return n;const e=n.getFilters();if(e.length===1)return lc(e[0]);if(tb(n))return n;const t=e.map(r=>lc(r)),s=[];return t.forEach(r=>{r instanceof vt?s.push(r):r instanceof Ht&&(r.op===n.op?s.push(...r.filters):s.push(r))}),s.length===1?s[0]:Ht.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(){this.Cn=new xd}addToCollectionParentIndex(e,t){return this.Cn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(ls.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(ls.min())}updateCollectionGroup(e,t,s){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class xd{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Mt(Pt.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Mt(Pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp="IndexedDbIndexManager",ml=new Uint8Array(0);class AV{constructor(e,t){this.databaseId=t,this.vn=new xd,this.Fn=new or(s=>ki(s),(s,r)=>Oa(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:s,parent:$n(r)};return $p(e).put(i)}return $.resolve()}getCollectionParents(e,t){const s=[],r=IDBKeyRange.bound([t,""],[Ay(t),""],!1,!0);return $p(e).J(r).next(i=>{for(const o of i){if(o.collectionId!==t)break;s.push(Bs(o.parent))}return s})}addFieldIndex(e,t){const s=Fo(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete r.indexId;const i=s.add(r);if(t.indexState){const o=$i(e);return i.next(l=>{o.put(jp(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const s=Fo(e),r=$i(e),i=qi(e);return s.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Fo(e),s=qi(e),r=$i(e);return t.Z().next(()=>s.Z()).next(()=>r.Z())}createTargetIndexes(e,t){return $.forEach(this.Mn(t),s=>this.getIndexType(e,s).next(r=>{if(r===0||r===1){const i=new Fp(s).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const s=qi(e);let r=!0;const i=new Map;return $.forEach(this.Mn(t),o=>this.xn(e,o).next(l=>{r&&(r=!!l),i.set(o,l)})).next(()=>{if(r){let o=gt();const l=[];return $.forEach(i,(u,m)=>{pe(qp,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(re=>`${re.fieldPath}:${re.kind}`).join(",")}`}(u)} to execute ${ki(t)}`);const d=function(F,re){const Z=om(re);if(Z===void 0)return null;for(const M of rc(F,Z.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(m,u),f=function(F,re){const Z=new Map;for(const M of ai(re))for(const A of rc(F,M.fieldPath))switch(A.op){case"==":case"in":Z.set(M.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return Z.set(M.fieldPath.canonicalString(),A.value),Array.from(Z.values())}return null}(m,u),h=function(F,re){const Z=[];let M=!0;for(const A of ai(re)){const N=A.kind===0?vp(F,A.fieldPath,F.startAt):_p(F,A.fieldPath,F.startAt);Z.push(N.value),M&&(M=N.inclusive)}return new go(Z,M)}(m,u),y=function(F,re){const Z=[];let M=!0;for(const A of ai(re)){const N=A.kind===0?_p(F,A.fieldPath,F.endAt):vp(F,A.fieldPath,F.endAt);Z.push(N.value),M&&(M=N.inclusive)}return new go(Z,M)}(m,u),I=this.On(u,m,h),v=this.On(u,m,y),w=this.Nn(u,m,f),R=this.Bn(u.indexId,d,I,h.inclusive,v,y.inclusive,w);return $.forEach(R,P=>s.Y(P,t.limit).next(F=>{F.forEach(re=>{const Z=Ve.fromSegments(re.documentKey);o.has(Z)||(o=o.add(Z),l.push(Z))})}))}).next(()=>l)}return $.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=EV(Ht.create(e.filters,"and")).map(s=>hm(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,s,r,i,o,l){const u=(t!=null?t.length:1)*Math.max(s.length,i.length),m=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const h=t?this.Ln(t[f/m]):ml,y=this.kn(e,h,s[f%m],r),I=this.qn(e,h,i[f%m],o),v=l.map(w=>this.kn(e,h,w,!0));d.push(...this.createRange(y,I,v))}return d}kn(e,t,s,r){const i=new di(e,Ve.empty(),t,s);return r?i:i.An()}qn(e,t,s,r){const i=new di(e,Ve.empty(),t,s);return r?i.An():i}xn(e,t){const s=new Fp(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const l of i)s.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let s=2;const r=this.Mn(t);return $.forEach(r,i=>this.xn(e,i).next(o=>{o?s!==0&&o.fields.length<function(u){let m=new Mt(sn.comparator),d=!1;for(const f of u.filters)for(const h of f.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?d=!0:m=m.add(h.field));for(const f of u.orderBy)f.field.isKeyField()||(m=m.add(f.field));return m.size+(d?1:0)}(i)&&(s=1):s=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&s===2?1:s)}Qn(e,t){const s=new Mo;for(const r of ai(e)){const i=t.data.field(r.fieldPath);if(i==null)return null;const o=s.Pn(r.kind);mi.Kt.Dt(i,o)}return s.un()}Ln(e){const t=new Mo;return mi.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new Mo;return mi.Kt.Dt(Ta(this.databaseId,t),s.Pn(function(i){const o=ai(i);return o.length===0?0:o[o.length-1].kind}(e))),s.un()}Nn(e,t,s){if(s===null)return[];let r=[];r.push(new Mo);let i=0;for(const o of ai(e)){const l=s[i++];for(const u of r)if(this.Un(t,o.fieldPath)&&Sa(l))r=this.Kn(r,o,l);else{const m=u.Pn(o.kind);mi.Kt.Dt(l,m)}}return this.Wn(r)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of r){const u=new Mo;u.seed(l.un()),mi.Kt.Dt(o,u.Pn(t.kind)),i.push(u)}return i}Un(e,t){return!!e.filters.find(s=>s instanceof vt&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,t){const s=Fo(e),r=$i(e);return(t?s.J(lm,IDBKeyRange.bound(t,t)):s.J()).next(i=>{const o=[];return $.forEach(i,l=>r.get([l.indexId,this.uid]).next(u=>{o.push(function(d,f){const h=f?new ka(f.sequenceNumber,new ls(Vi(f.readTime),new Ve(Bs(f.documentKey)),f.largestBatchId)):ka.empty(),y=d.fields.map(([I,v])=>new Pl(sn.fromServerFormat(I),v));return new Jl(d.indexId,d.collectionGroup,y,h)}(l,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:et(s.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const r=Fo(e),i=$i(e);return this.Gn(e).next(o=>r.J(lm,IDBKeyRange.bound(t,t)).next(l=>$.forEach(l,u=>i.put(jp(u.indexId,this.uid,o,s)))))}updateIndexEntries(e,t){const s=new Map;return $.forEach(t,(r,i)=>{const o=s.get(r.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(s.set(r.collectionGroup,l),$.forEach(l,u=>this.zn(e,r,u).next(m=>{const d=this.jn(i,u);return m.isEqual(d)?$.resolve():this.Jn(e,i,u,m,d)}))))})}Hn(e,t,s,r){return qi(e).put(r.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,r){return qi(e).delete(r.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const r=qi(e);let i=new Mt(gr);return r.ee({index:Uy,range:IDBKeyRange.only([s.indexId,this.uid,Fl(this.$n(s,t))])},(o,l)=>{i=i.add(new di(s.indexId,t,Mp(l.arrayValue),Mp(l.directionalValue)))}).next(()=>i)}jn(e,t){let s=new Mt(gr);const r=this.Qn(t,e);if(r==null)return s;const i=om(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Sa(o))for(const l of o.arrayValue.values||[])s=s.add(new di(t.indexId,e.key,this.Ln(l),r))}else s=s.add(new di(t.indexId,e.key,ml,r));return s}Jn(e,t,s,r,i){pe(qp,"Updating index entries for document '%s'",t.key);const o=[];return function(u,m,d,f,h){const y=u.getIterator(),I=m.getIterator();let v=Fi(y),w=Fi(I);for(;v||w;){let R=!1,P=!1;if(v&&w){const F=d(v,w);F<0?P=!0:F>0&&(R=!0)}else v!=null?P=!0:R=!0;R?(f(w),w=Fi(I)):P?(h(v),v=Fi(y)):(v=Fi(y),w=Fi(I))}}(r,i,gr,l=>{o.push(this.Hn(e,t,s,l))},l=>{o.push(this.Yn(e,t,s,l))}),$.waitFor(o)}Gn(e){let t=1;return $i(e).ee({index:By,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((o,l)=>gr(o,l)).filter((o,l,u)=>!l||gr(o,u[l-1])!==0);const r=[];r.push(e);for(const o of s){const l=gr(o,e),u=gr(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,ml,Ve.empty()),u=r[o+1].Vn(this.uid,ml,Ve.empty());i.push(IDBKeyRange.bound(l,u))}return i}Zn(e,t){return gr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(zp)}getMinOffset(e,t){return $.mapArray(this.Mn(t),s=>this.xn(e,s).next(r=>r||Ie(44426))).next(zp)}}function $p(n){return Vn(n,Ca)}function qi(n){return Vn(n,ma)}function Fo(n){return Vn(n,od)}function $i(n){return Vn(n,ua)}function zp(n){Ue(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const r=n[s].indexState.offset;sd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ls(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mb=41943040;class Fn{static withCacheSize(e){return new Fn(e,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(n,e,t){const s=n.store(bs),r=n.store(co),i=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=s.ee({range:o},(d,f,h)=>(l++,h.delete()));i.push(u.next(()=>{Ue(l===1,47070,{batchId:t.batchId})}));const m=[];for(const d of t.mutations){const f=Ly(e,d.key.path,t.batchId);i.push(r.delete(f)),m.push(d.key)}return $.waitFor(i).next(()=>m)}function cc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ie(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(Mb,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);class qc{constructor(e,t,s,r){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=r,this.Xn={}}static wt(e,t,s,r){Ue(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new qc(i,t,s,r)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return yr(e).ee({index:fi,range:s},(r,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,s,r){const i=eo(e),o=yr(e);return o.add({}).next(l=>{Ue(typeof l=="number",49019);const u=new pd(l,t,s,r),m=function(y,I,v){const w=v.baseMutations.map(P=>oc(y.yt,P)),R=v.mutations.map(P=>oc(y.yt,P));return{userId:I,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:R}}(this.serializer,this.userId,u),d=[];let f=new Mt((h,y)=>et(h.canonicalString(),y.canonicalString()));for(const h of r){const y=Ly(this.userId,h.key.path,l);f=f.add(h.key.path.popLast()),d.push(o.put(m)),d.push(i.put(y,tE))}return f.forEach(h=>{d.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Xn[l]=u.keys()}),$.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return yr(e).get(t).next(s=>s?(Ue(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),ui(this.serializer,s)):null)}er(e,t){return this.Xn[t]?$.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const r=s.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return yr(e).ee({index:fi,range:r},(o,l,u)=>{l.userId===this.userId&&(Ue(l.batchId>=s,47524,{tr:s}),i=ui(this.serializer,l)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=hi;return yr(e).ee({index:fi,range:t,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,hi],[this.userId,Number.POSITIVE_INFINITY]);return yr(e).J(fi,t).next(s=>s.map(r=>ui(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=Ll(this.userId,t.path),r=IDBKeyRange.lowerBound(s),i=[];return eo(e).ee({range:r},(o,l,u)=>{const[m,d,f]=o,h=Bs(d);if(m===this.userId&&t.path.isEqual(h))return yr(e).get(f).next(y=>{if(!y)throw Ie(61480,{nr:o,batchId:f});Ue(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),i.push(ui(this.serializer,y))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Mt(et);const r=[];return t.forEach(i=>{const o=Ll(this.userId,i.path),l=IDBKeyRange.lowerBound(o),u=eo(e).ee({range:l},(m,d,f)=>{const[h,y,I]=m,v=Bs(y);h===this.userId&&i.path.isEqual(v)?s=s.add(I):f.done()});r.push(u)}),$.waitFor(r).next(()=>this.rr(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1,i=Ll(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new Mt(et);return eo(e).ee({range:o},(u,m,d)=>{const[f,h,y]=u,I=Bs(h);f===this.userId&&s.isPrefixOf(I)?I.length===r&&(l=l.add(y)):d.done()}).next(()=>this.rr(e,l))}rr(e,t){const s=[],r=[];return t.forEach(i=>{r.push(yr(e).get(i).next(o=>{if(o===null)throw Ie(35274,{batchId:i});Ue(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),s.push(ui(this.serializer,o))}))}),$.waitFor(r).next(()=>s)}removeMutationBatch(e,t){return Fb(e.le,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),$.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return $.resolve();const s=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return eo(e).ee({range:s},(i,o,l)=>{if(i[0]===this.userId){const u=Bs(i[1]);r.push(u)}else l.done()}).next(()=>{Ue(r.length===0,56720,{sr:r.map(i=>i.canonicalString())})})})}containsKey(e,t){return Ob(e,this.userId,t)}_r(e){return qb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:hi,lastStreamToken:""})}}function Ob(n,e,t){const s=Ll(e,t.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return eo(n).ee({range:i,X:!0},(l,u,m)=>{const[d,f,h]=l;d===e&&f===r&&(o=!0),m.done()}).next(()=>o)}function yr(n){return Vn(n,bs)}function eo(n){return Vn(n,co)}function qb(n){return Vn(n,Va)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ai(0)}static cr(){return new Ai(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const s=new Ai(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>ze.fromTimestamp(new Lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.lr(e).next(r=>(r.highestListenSequenceNumber=t,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>zi(e).delete(t.targetId)).next(()=>this.lr(e)).next(s=>(Ue(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s)))}removeTargets(e,t,s){let r=0;const i=[];return zi(e).ee((o,l)=>{const u=sa(l);u.sequenceNumber<=t&&s.get(u.targetId)===null&&(r++,i.push(this.removeTargetData(e,u)))}).next(()=>$.waitFor(i)).next(()=>r)}forEachTarget(e,t){return zi(e).ee((s,r)=>{const i=sa(r);t(i)})}lr(e){return Kp(e).get(tc).next(t=>(Ue(t!==null,2888),t))}hr(e,t){return Kp(e).put(tc,t)}Pr(e,t){return zi(e).put(Rb(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const s=ki(t),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return zi(e).ee({range:r,index:Ry},(o,l,u)=>{const m=sa(l);Oa(t,m.target)&&(i=m,u.done())}).next(()=>i)}addMatchingKeys(e,t,s){const r=[],i=Ar(e);return t.forEach(o=>{const l=$n(o.path);r.push(i.put({targetId:s,path:l})),r.push(this.referenceDelegate.addReference(e,s,o))}),$.waitFor(r)}removeMatchingKeys(e,t,s){const r=Ar(e);return $.forEach(t,i=>{const o=$n(i.path);return $.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,t){const s=Ar(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),r=Ar(e);let i=gt();return r.ee({range:s,X:!0},(o,l,u)=>{const m=Bs(o[1]),d=new Ve(m);i=i.add(d)}).next(()=>i)}containsKey(e,t){const s=$n(t.path),r=IDBKeyRange.bound([s],[Ay(s)],!1,!0);let i=0;return Ar(e).ee({index:id,X:!0,range:r},([o,l],u,m)=>{o!==0&&(i++,m.done())}).next(()=>i>0)}At(e,t){return zi(e).get(t).next(s=>s?sa(s):null)}}function zi(n){return Vn(n,uo)}function Kp(n){return Vn(n,gi)}function Ar(n){return Vn(n,mo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="LruGarbageCollector",wV=1048576;function Qp([n,e],[t,s]){const r=et(n,t);return r===0?et(e,s):r}class IV{constructor(e){this.Ir=e,this.buffer=new Mt(Qp),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Qp(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class $b{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(Gp,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Wr(t)?pe(Gp,"Ignoring IndexedDB error during garbage collection: ",t):await Ii(t)}await this.Vr(3e5)})}}class TV{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return $.resolve(fs.ce);const s=new IV(t);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(Wp)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wp):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(s=f,l=Date.now(),this.removeTargets(e,s,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(m=Date.now(),Yi()<=Vt.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function zb(n,e){return new TV(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e,t){this.db=e,this.garbageCollector=zb(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(s,r)=>t(r))}addReference(e,t,s){return dl(e,s)}removeReference(e,t,s){return dl(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return dl(e,t)}br(e,t){return function(r,i){let o=!1;return qb(r).te(l=>Ob(r,l,i).next(u=>(u&&(o=!0),$.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,(o,l)=>{if(l<=t){const u=this.br(e,o).next(m=>{if(!m)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,ze.min()),Ar(e).delete(function(f){return[0,$n(f.path)]}(o))))});r.push(u)}}).next(()=>$.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return dl(e,t)}Sr(e,t){const s=Ar(e);let r,i=fs.ce;return s.ee({index:id},([o,l],{path:u,sequenceNumber:m})=>{o===0?(i!==fs.ce&&t(new Ve(Bs(r)),i),i=m,r=u):i=fs.ce}).next(()=>{i!==fs.ce&&t(new Ve(Bs(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function dl(n,e){return Ar(n).put(function(s,r){return{targetId:0,path:$n(s.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(){this.changes=new or(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?$.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return ri(e).put(s)}removeEntry(e,t,s){return ri(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],ac(o),l[l.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.Dr(e,s)))}getEntry(e,t){let s=rn.newInvalidDocument(t);return ri(e).ee({index:jl,range:IDBKeyRange.only(Oo(t))},(r,i)=>{s=this.Cr(t,i)}).next(()=>s)}vr(e,t){let s={size:0,document:rn.newInvalidDocument(t)};return ri(e).ee({index:jl,range:IDBKeyRange.only(Oo(t))},(r,i)=>{s={document:this.Cr(t,i),size:cc(i)}}).next(()=>s)}getEntries(e,t){let s=as();return this.Fr(e,t,(r,i)=>{const o=this.Cr(r,i);s=s.insert(r,o)}).next(()=>s)}Mr(e,t){let s=as(),r=new en(Ve.comparator);return this.Fr(e,t,(i,o)=>{const l=this.Cr(i,o);s=s.insert(i,l),r=r.insert(i,cc(o))}).next(()=>({documents:s,Or:r}))}Fr(e,t,s){if(t.isEmpty())return $.resolve();let r=new Mt(Jp);t.forEach(u=>r=r.add(u));const i=IDBKeyRange.bound(Oo(r.first()),Oo(r.last())),o=r.getIterator();let l=o.getNext();return ri(e).ee({index:jl,range:i},(u,m,d)=>{const f=Ve.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;l&&Jp(l,f)<0;)s(l,null),l=o.getNext();l&&l.isEqual(f)&&(s(l,m),l=o.hasNext()?o.getNext():null),l?d.j(Oo(l)):d.done()}).next(()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,s,r,i){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),ac(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ri(e).J(IDBKeyRange.bound(l,u,!0)).next(m=>{i==null||i.incrementDocumentReadCount(m.length);let d=as();for(const f of m){const h=this.Cr(Ve.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);h.isFoundDocument()&&($a(t,h)||r.has(h.key))&&(d=d.insert(h.key,h))}return d})}getAllFromCollectionGroup(e,t,s,r){let i=as();const o=Xp(t,s),l=Xp(t,ls.max());return ri(e).ee({index:jy,range:IDBKeyRange.bound(o,l,!0)},(u,m,d)=>{const f=this.Cr(Ve.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);i=i.insert(f.key,f),i.size===r&&d.done()}).next(()=>i)}newChangeBuffer(e){return new LV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Yp(e).get(am).next(t=>(Ue(!!t,20021),t))}Dr(e,t){return Yp(e).put(am,t)}Cr(e,t){if(t){const s=bV(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(ze.min())))return s}return rn.newInvalidDocument(e)}}function Kb(n){return new PV(n)}class LV extends Wb{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new or(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const t=[];let s=0,r=new Mt((i,o)=>et(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const u=Pp(this.Nr.serializer,o);r=r.add(i.path.popLast());const m=cc(u);s+=m-l.size,t.push(this.Nr.addEntry(e,i,u))}else if(s-=l.size,this.trackRemovals){const u=Pp(this.Nr.serializer,o.convertToNoDocument(ze.min()));t.push(this.Nr.addEntry(e,i,u))}}),r.forEach(i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Nr.updateMetadata(e,s)),$.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:s,Or:r})=>(r.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function Yp(n){return Vn(n,Aa)}function ri(n){return Vn(n,ec)}function Oo(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Xp(n,e){const t=e.documentKey.path.toArray();return[n,ac(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Jp(n,e){const t=n.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<t.length-2&&i<s.length-2;++i)if(r=et(t[i],s[i]),r)return r;return r=et(t.length,s.length),r||(r=et(t[t.length-2],s[s.length-2]),r||et(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&ha(s.mutation,r,ss.empty(),Lt.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,gt()).next(()=>s))}getLocalViewOfDocuments(e,t,s=gt()){const r=Us();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=ta();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=Us();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,gt()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,s,r){let i=as();const o=pa(),l=function(){return pa()}();return t.forEach((u,m)=>{const d=s.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof ar)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),ha(d.mutation,m,d.mutation.getFieldMask(),Lt.now())):o.set(m.key,ss.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new jV(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const s=pa();let r=new en((o,l)=>o-l),i=gt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=s.get(u)||ss.empty();d=l.applyToLocalView(m,d),s.set(u,d);const f=(r.get(l.batchId)||gt()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=db();d.forEach(h=>{if(!i.has(h)){const y=bb(t.get(h),s.get(h));y!==null&&f.set(h,y),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(o){return Ve.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ab(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):$.resolve(Us());let l=Da,u=i;return o.next(m=>$.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{u=u.insert(d,h)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,gt())).next(d=>({batchId:l,changes:mb(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ve(t)).next(s=>{let r=ta();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=ta();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const m=function(f,h){return new Eo(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,s,r).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,rn.newInvalidDocument(d)))});let l=ta();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&ha(d.mutation,m,ss.empty(),Lt.now()),$a(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Yn(r.createTime)}}(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:Bb(r.bundledQuery),readTime:Yn(r.readTime)}}(t)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(){this.overlays=new en(Ve.comparator),this.qr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Us();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.St(e,t,i)}),$.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),$.resolve()}getOverlaysForCollection(e,t,s){const r=Us(),i=t.length+1,o=new Ve(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>s&&r.set(u.getKey(),u)}return $.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new en((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>s){let d=i.get(m.largestBatchId);d===null&&(d=Us(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=Us(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return $.resolve(l)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new gd(t,s));let i=this.qr.get(t);i===void 0&&(i=gt(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(){this.sessionToken=vn.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(){this.Qr=new Mt(In.$r),this.Ur=new Mt(In.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new In(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Gr(new In(e,t))}zr(e,t){e.forEach(s=>this.removeReference(s,t))}jr(e){const t=new Ve(new Pt([])),s=new In(t,e),r=new In(t,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ve(new Pt([])),s=new In(t,e),r=new In(t,e+1);let i=gt();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new In(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class In{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ve.comparator(e.key,t.key)||et(e.Yr,t.Yr)}static Kr(e,t){return et(e.Yr,t.Yr)||Ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Mt(In.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new pd(i,t,s,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new In(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,t){return $.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?hi:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new In(t,0),r=new In(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Mt(et);return t.forEach(r=>{const i=new In(r,0),o=new In(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{s=s.add(l.Yr)})}),$.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;Ve.isDocumentKey(i)||(i=i.child(""));const o=new In(new Ve(i),0);let l=new Mt(et);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!s.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),$.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Ue(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return $.forEach(t.mutations,r=>{const i=new In(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,t){const s=new In(t,0),r=this.Zr.firstAfterOrEqual(s);return $.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(e){this.ri=e,this.docs=function(){return new en(Ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return $.resolve(s?s.document.mutableCopy():rn.newInvalidDocument(t))}getEntries(e,t){let s=as();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():rn.newInvalidDocument(r))}),$.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=as();const o=t.path,l=new Ve(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||sd(Iy(d),s)<=0||(r.has(d.key)||$a(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,t,s,r){Ie(9500)}ii(e,t){return $.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new FV(this)}getSize(e){return $.resolve(this.size)}}class FV extends Wb{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),$.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e){this.persistence=e,this.si=new or(t=>ki(t),Oa),this.lastRemoteSnapshotVersion=ze.min(),this.highestTargetId=0,this.oi=0,this._i=new vd,this.targetCount=0,this.ai=Ai.ur()}forEachTarget(e,t){return this.si.forEach((s,r)=>t(r)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),$.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ai(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Pr(t),$.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&s.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),$.waitFor(i).next(()=>r)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return $.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),$.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return $.resolve(s)}containsKey(e,t){return $.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,t){this.ui={},this.overlays={},this.ci=new fs(0),this.li=!1,this.li=!0,this.hi=new UV,this.referenceDelegate=e(this),this.Pi=new OV(this),this.indexManager=new VV,this.remoteDocumentCache=function(r){return new MV(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new jb(t),this.Ii=new RV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new BV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new HV(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){pe("MemoryPersistence","Starting transaction:",e);const r=new qV(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return $.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,t)))}}class qV extends Sy{constructor(e){super(),this.currentSequenceNumber=e}}class $c{constructor(e){this.persistence=e,this.Ri=new vd,this.Vi=null}static mi(e){return new $c(e)}get fi(){if(this.Vi)return this.Vi;throw Ie(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),$.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,s=>{const r=Ve.fromPath(s);return this.gi(e,r).next(i=>{i||t.removeEntry(r,ze.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return $.or([()=>$.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class uc{constructor(e,t){this.persistence=e,this.pi=new or(s=>$n(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=zb(this,t)}static mi(e,t){return new uc(e,t)}Ei(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}pr(e,t){return $.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?$.resolve():t(r)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(s++,i.removeEntry(o,ze.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Bl(e.data.value)),t}br(e,t,s){return $.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return $.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e){this.serializer=e}k(e,t,s,r){const i=new Ic("createOrUpgrade",t);s<1&&r>=1&&(function(u){u.createObjectStore(Fa)}(e),function(u){u.createObjectStore(Va,{keyPath:eE}),u.createObjectStore(bs,{keyPath:cp,autoIncrement:!0}).createIndex(fi,up,{unique:!0}),u.createObjectStore(co)}(e),Zp(e),function(u){u.createObjectStore(li)}(e));let o=$.resolve();return s<3&&r>=3&&(s!==0&&(function(u){u.deleteObjectStore(mo),u.deleteObjectStore(uo),u.deleteObjectStore(gi)}(e),Zp(e)),o=o.next(()=>function(u){const m=u.store(gi),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ze.min().toTimestamp(),targetCount:0};return m.put(tc,d)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(u,m){return m.store(bs).J().next(f=>{u.deleteObjectStore(bs),u.createObjectStore(bs,{keyPath:cp,autoIncrement:!0}).createIndex(fi,up,{unique:!0});const h=m.store(bs),y=f.map(I=>h.put(I));return $.waitFor(y)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore(fo,{keyPath:cE})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.yi(i))),s<6&&r>=6&&(o=o.next(()=>(function(u){u.createObjectStore(Aa)}(e),this.wi(i)))),s<7&&r>=7&&(o=o.next(()=>this.Si(i))),s<8&&r>=8&&(o=o.next(()=>this.bi(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Di(i))),s<11&&r>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(Sc,{keyPath:uE})})(e),function(u){u.createObjectStore(Pc,{keyPath:mE})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(u){const m=u.createObjectStore(Lc,{keyPath:bE});m.createIndex(cm,NE,{unique:!1}),m.createIndex(Hy,xE,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(u){const m=u.createObjectStore(ec,{keyPath:nE});m.createIndex(jl,sE),m.createIndex(jy,rE)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(li))),s<14&&r>=14&&(o=o.next(()=>this.Fi(e,i))),s<15&&r>=15&&(o=o.next(()=>function(u){u.createObjectStore(od,{keyPath:dE,autoIncrement:!0}).createIndex(lm,fE,{unique:!1}),u.createObjectStore(ua,{keyPath:pE}).createIndex(By,hE,{unique:!1}),u.createObjectStore(ma,{keyPath:gE}).createIndex(Uy,yE,{unique:!1})}(e))),s<16&&r>=16&&(o=o.next(()=>{t.objectStore(ua).clear()}).next(()=>{t.objectStore(ma).clear()})),s<17&&r>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(ad,{keyPath:vE})})(e)})),s<18&&r>=18&&oy()&&(o=o.next(()=>{t.objectStore(ua).clear()}).next(()=>{t.objectStore(ma).clear()})),o}wi(e){let t=0;return e.store(li).ee((s,r)=>{t+=cc(r)}).next(()=>{const s={byteSize:t};return e.store(Aa).put(am,s)})}yi(e){const t=e.store(Va),s=e.store(bs);return t.J().next(r=>$.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,hi],[i.userId,i.lastAcknowledgedBatchId]);return s.J(fi,o).next(l=>$.forEach(l,u=>{Ue(u.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const m=ui(this.serializer,u);return Fb(e,i.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(mo),s=e.store(li);return e.store(gi).get(tc).next(r=>{const i=[];return s.ee((o,l)=>{const u=new Pt(o),m=function(f){return[0,$n(f)]}(u);i.push(t.get(m).next(d=>d?$.resolve():(f=>t.put({targetId:0,path:$n(f),sequenceNumber:r.highestListenSequenceNumber}))(u)))}).next(()=>$.waitFor(i))})}bi(e,t){e.createObjectStore(Ca,{keyPath:lE});const s=t.store(Ca),r=new xd,i=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return s.put({collectionId:l,parent:$n(u)})}};return t.store(li).ee({X:!0},(o,l)=>{const u=new Pt(o);return i(u.popLast())}).next(()=>t.store(co).ee({X:!0},([o,l,u],m)=>{const d=Bs(l);return i(d.popLast())}))}Di(e){const t=e.store(uo);return t.ee((s,r)=>{const i=sa(r),o=Rb(this.serializer,i);return t.put(o)})}Ci(e,t){const s=t.store(li),r=[];return s.ee((i,o)=>{const l=t.store(ec),u=function(f){return f.document?new Ve(Pt.fromString(f.document.name).popFirst(5)):f.noDocument?Ve.fromSegments(f.noDocument.path):f.unknownDocument?Ve.fromSegments(f.unknownDocument.path):Ie(36783)}(o).path.toArray(),m={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(m))}).next(()=>$.waitFor(r))}Fi(e,t){const s=t.store(bs),r=Kb(this.serializer),i=new _d($c.mi,this.serializer.yt);return s.J().next(o=>{const l=new Map;return o.forEach(u=>{let m=l.get(u.userId)??gt();ui(this.serializer,u).keys().forEach(d=>m=m.add(d)),l.set(u.userId,m)}),$.forEach(l,(u,m)=>{const d=new Ln(m),f=Oc.wt(this.serializer,d),h=i.getIndexManager(d),y=qc.wt(d,this.serializer,h,i.referenceDelegate);return new Gb(r,y,f,h).recalculateAndSaveOverlaysForDocumentKeys(new um(t,fs.ce),u).next()})})}}function Zp(n){n.createObjectStore(mo,{keyPath:oE}).createIndex(id,aE,{unique:!0}),n.createObjectStore(uo,{keyPath:"targetId"}).createIndex(Ry,iE,{unique:!0}),n.createObjectStore(gi)}const br="IndexedDbPersistence",Tu=18e5,Su=5e3,Pu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",zV="main";class Dd{constructor(e,t,s,r,i,o,l,u,m,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=i,this.window=o,this.document=l,this.xi=m,this.Oi=d,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=h=>Promise.resolve(),!Dd.v())throw new Ne(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new SV(this,r),this.$i=t+zV,this.serializer=new jb(u),this.Ui=new jr(this.$i,this.Ni,new $V(this.serializer)),this.hi=new xV,this.Pi=new CV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Kb(this.serializer),this.Ii=new NV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&Gn(br,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ne(se.FAILED_PRECONDITION,Pu);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new fs(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(Wr(e))return pe(br,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(br,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return qo(e).get(Mi).next(t=>$.resolve(this.es(t)))}ts(e){return fl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Tu)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const s=Vn(t,fo);return s.J().next(r=>{const i=this.ss(r,Tu),o=r.filter(l=>i.indexOf(l)===-1);return $.forEach(o,l=>s.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):qo(e).get(Mi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Su)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ne(se.FAILED_PRECONDITION,Pu);return!1}}return!(!this.networkEnabled||!this.inForeground)||fl(e).J().next(s=>this.ss(s,Su).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&pe(br,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Fa,fo],e=>{const t=new um(e,fs.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>fl(e).J().next(t=>this.ss(t,Tu).map(s=>s.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return qc.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new AV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Oc.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){pe(br,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",i=function(u){return u===18?kE:u===17?qy:u===16?DE:u===15?ld:u===14?Oy:u===13?Fy:u===12?_E:u===11?My:void Ie(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,r,i,l=>(o=new um(l,this.ci?this.ci.next():fs.ce),t==="readwrite-primary"?this.Hi(o).next(u=>!!u||this.Yi(o)).next(u=>{if(!u)throw Gn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new Ne(se.FAILED_PRECONDITION,Ty);return s(o)}).next(u=>this.Xi(o).next(()=>u)):this.Is(o).next(()=>s(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Is(e){return qo(e).get(Mi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Su)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ne(se.FAILED_PRECONDITION,Pu)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qo(e).put(Mi,t)}static v(){return jr.v()}Zi(e){const t=qo(e);return t.get(Mi).next(s=>this.es(s)?(pe(br,"Releasing primary lease."),t.delete(Mi)):$.resolve())}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Gn(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;iy()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const s=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return pe(br,`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return Gn(br,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Gn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function qo(n){return Vn(n,Fa)}function fl(n){return Vn(n,fo)}function WV(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=gt(),r=gt();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new kd(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return iy()?8:Py(Ql())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new KV;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,s,r){return s.documentReadCount<this.fs?(Yi()<=Vt.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",Xi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(Yi()<=Vt.DEBUG&&pe("QueryEngine","Query:",Xi(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Yi()<=Vt.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",Xi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ps(t))):$.resolve())}ys(e,t){if(Dp(t))return $.resolve(null);let s=ps(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=ym(t,null,"F"),s=ps(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=gt(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,ym(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,s,r){return Dp(t)||r.isEqual(ze.min())?$.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,s,r)?$.resolve(null):(Yi()<=Vt.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Xi(t)),this.vs(e,o,t,Kk(r,Da)).next(l=>l))})}Ds(e,t){let s=new Mt(cb(e));return t.forEach((r,i)=>{$a(e,i)&&(s=s.add(i))}),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return Yi()<=Vt.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",Xi(t)),this.ps.getDocumentsMatchingQuery(e,t,ls.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed="LocalStore",GV=3e8;class QV{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new en(et),this.xs=new or(i=>ki(i),Oa),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Gb(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Yb(n,e,t,s){return new QV(n,e,t,s)}async function Xb(n,e){const t=tt(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],l=[];let u=gt();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(s,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function YV(n,e){const t=tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,h=f.keys();let y=$.resolve();return h.forEach(I=>{y=y.next(()=>d.getEntry(u,I)).next(v=>{const w=m.docVersions.get(I);Ue(w!==null,48541),v.version.compareTo(w)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let u=gt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}function Jb(n){const e=tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function XV(n,e){const t=tt(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(vn.EMPTY_BYTE_STRING,ze.min()).withLastLimboFreeSnapshotVersion(ze.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(f,y),function(v,w,R){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=GV?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(h,y,d)&&l.push(t.Pi.updateTargetData(i,y))});let u=as(),m=gt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(JV(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!s.isEqual(ze.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));l.push(d)}return $.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function JV(n,e,t){let s=gt(),r=gt();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=as();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(ze.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):pe(Ed,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function ZV(n,e){const t=tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=hi),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function eA(n,e){const t=tt(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.Pi.getTargetData(s,e).next(i=>i?(r=i,$.resolve(r)):t.Pi.allocateTargetId(s).next(o=>(r=new Zs(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s})}async function Em(n,e,t){const s=tt(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Wr(o))throw o;pe(Ed,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function eh(n,e,t){const s=tt(n);let r=ze.min(),i=gt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=tt(u),h=f.xs.get(d);return h!==void 0?$.resolve(f.Ms.get(h)):f.Pi.getTargetData(m,d)}(s,o,ps(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,t?r:ze.min(),t?i:gt())).next(l=>(tA(s,HE(e),l),{documents:l,Qs:i})))}function tA(n,e,t){let s=n.Os.get(e)||ze.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.Os.set(e,s)}class th{constructor(){this.activeTargetIds=zE()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zb{constructor(){this.Mo=new th,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new th,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nh="ConnectivityMonitor";class sh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(nh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(nh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl=null;function Vm(){return pl===null?pl=function(){return 268435456+Math.round(2147483648*Math.random())}():pl++,"0x"+pl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu="RestConnection",sA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rA{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===nc?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const o=Vm(),l=this.zo(e,t.toUriEncodedString());pe(Lu,`Sending RPC '${e}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=Cc(m);return this.Jo(e,l,u,s,d).then(f=>(pe(Lu,`Received RPC '${e}' ${o}: `,f),f),f=>{throw _i(Lu,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",s),f})}Ho(e,t,s,r,i,o){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ko}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const s=sA[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="WebChannelConnection";class oA extends rA{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const o=Vm();return new Promise((l,u)=>{const m=new xy;m.setWithCredentials(!0),m.listenOnce(vy.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case Sl.NO_ERROR:const f=m.getResponseJson();pe(Hn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case Sl.TIMEOUT:pe(Hn,`RPC '${e}' ${o} timed out`),u(new Ne(se.DEADLINE_EXCEEDED,"Request time out"));break;case Sl.HTTP_ERROR:const h=m.getStatus();if(pe(Hn,`RPC '${e}' ${o} failed with status:`,h,"response text:",m.getResponseText()),h>0){let y=m.getResponseJson();Array.isArray(y)&&(y=y[0]);const I=y==null?void 0:y.error;if(I&&I.status&&I.message){const v=function(R){const P=R.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(P)>=0?P:se.UNKNOWN}(I.status);u(new Ne(v,I.message))}else u(new Ne(se.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new Ne(se.UNAVAILABLE,"Connection failed."));break;default:Ie(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{pe(Hn,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);pe(Hn,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,s,15)})}T_(e,t,s){const r=Vm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ky(),l=Dy(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,s),u.encodeInitMessageHeaders=!0;const d=i.join("");pe(Hn,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let h=!1,y=!1;const I=new iA({Yo:w=>{y?pe(Hn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(h||(pe(Hn,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),pe(Hn,`RPC '${e}' stream ${r} sending:`,w),f.send(w))},Zo:()=>f.close()}),v=(w,R,P)=>{w.listen(R,F=>{try{P(F)}catch(re){setTimeout(()=>{throw re},0)}})};return v(f,ea.EventType.OPEN,()=>{y||(pe(Hn,`RPC '${e}' stream ${r} transport opened.`),I.o_())}),v(f,ea.EventType.CLOSE,()=>{y||(y=!0,pe(Hn,`RPC '${e}' stream ${r} transport closed`),I.a_(),this.E_(f))}),v(f,ea.EventType.ERROR,w=>{y||(y=!0,_i(Hn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),I.a_(new Ne(se.UNAVAILABLE,"The operation could not be completed")))}),v(f,ea.EventType.MESSAGE,w=>{var R;if(!y){const P=w.data[0];Ue(!!P,16349);const F=P,re=(F==null?void 0:F.error)||((R=F[0])==null?void 0:R.error);if(re){pe(Hn,`RPC '${e}' stream ${r} received error:`,re);const Z=re.status;let M=function(C){const j=pn[C];if(j!==void 0)return vb(j)}(Z),A=re.message;M===void 0&&(M=se.INTERNAL,A="Unknown error status: "+Z+" with message "+re.message),y=!0,I.a_(new Ne(M,A)),f.close()}else pe(Hn,`RPC '${e}' stream ${r} received:`,P),I.u_(P)}}),v(l,_y.STAT_EVENT,w=>{w.stat===rm.PROXY?pe(Hn,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===rm.NOPROXY&&pe(Hn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{I.__()},0),I}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(){return typeof window<"u"?window:null}function Ol(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(n){return new lV(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh="PersistentStream";class tN{constructor(e,t,s,r,i,o,l,u){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new eN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(Gn(t.toString()),Gn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===t&&this.G_(s,r)},s=>{e(()=>{const r=new Ne(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return pe(rh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(pe(rh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lA extends tN{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=mV(this.serializer,e),s=function(i){if(!("targetChange"in i))return ze.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ze.min():o.readTime?Yn(o.readTime):ze.min()}(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=xm(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=sc(u)?{documents:wb(i,u)}:{query:Ib(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=kb(i,o.resumeToken);const m=bm(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(ze.min())>0){l.readTime=xo(i,o.snapshotVersion.toTimestamp());const m=bm(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const s=fV(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=xm(this.serializer),t.removeTarget=e,this.q_(t)}}class cA extends tN{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=dV(e.writeResults,e.commitTime),s=Yn(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=xm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>oc(this.serializer,s))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{}class mA extends uA{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ne(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Nm(t,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ne(se.UNKNOWN,i.toString())})}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,Nm(t,s),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ne(se.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class dA{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Gn(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="RemoteStore";class fA{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{Ti(this)&&(pe(Ci,"Restarting streams for network reachability change."),await async function(u){const m=tt(u);m.Ea.add(4),await Wa(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Wc(m)}(this))})}),this.Ra=new dA(s,r)}}async function Wc(n){if(Ti(n))for(const e of n.da)await e(!0)}async function Wa(n){for(const e of n.da)await e(!1)}function nN(n,e){const t=tt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),wd(t)?Cd(t):Ao(t).O_()&&Ad(t,e))}function Vd(n,e){const t=tt(n),s=Ao(t);t.Ia.delete(e),s.O_()&&sN(t,e),t.Ia.size===0&&(s.O_()?s.L_():Ti(t)&&t.Ra.set("Unknown"))}function Ad(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ze.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ao(n).Y_(e)}function sN(n,e){n.Va.Ue(e),Ao(n).Z_(e)}function Cd(n){n.Va=new rV({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ao(n).start(),n.Ra.ua()}function wd(n){return Ti(n)&&!Ao(n).x_()&&n.Ia.size>0}function Ti(n){return tt(n).Ea.size===0}function rN(n){n.Va=void 0}async function pA(n){n.Ra.set("Online")}async function hA(n){n.Ia.forEach((e,t)=>{Ad(n,e)})}async function gA(n,e){rN(n),wd(n)?(n.Ra.ha(e),Cd(n)):n.Ra.set("Unknown")}async function yA(n,e,t){if(n.Ra.set("Online"),e instanceof Db&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(n,e)}catch(s){pe(Ci,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await mc(n,s)}else if(e instanceof Ml?n.Va.Ze(e):e instanceof _b?n.Va.st(e):n.Va.tt(e),!t.isEqual(ze.min()))try{const s=await Jb(n.localStore);t.compareTo(s)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(vn.EMPTY_BYTE_STRING,d.snapshotVersion)),sN(i,u);const f=new Zs(d.target,u,m,d.sequenceNumber);Ad(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(s){pe(Ci,"Failed to raise snapshot:",s),await mc(n,s)}}async function mc(n,e,t){if(!Wr(e))throw e;n.Ea.add(1),await Wa(n),n.Ra.set("Offline"),t||(t=()=>Jb(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{pe(Ci,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Wc(n)})}function iN(n,e){return e().catch(t=>mc(n,t,e))}async function Ka(n){const e=tt(n),t=Mr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:hi;for(;bA(e);)try{const r=await ZV(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,NA(e,r)}catch(r){await mc(e,r)}oN(e)&&aN(e)}function bA(n){return Ti(n)&&n.Ta.length<10}function NA(n,e){n.Ta.push(e);const t=Mr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function oN(n){return Ti(n)&&!Mr(n).x_()&&n.Ta.length>0}function aN(n){Mr(n).start()}async function xA(n){Mr(n).ra()}async function vA(n){const e=Mr(n);for(const t of n.Ta)e.ea(t.mutations)}async function _A(n,e,t){const s=n.Ta.shift(),r=hd.from(s,e,t);await iN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Ka(n)}async function DA(n,e){e&&Mr(n).X_&&await async function(s,r){if(function(o){return tV(o)&&o!==se.ABORTED}(r.code)){const i=s.Ta.shift();Mr(s).B_(),await iN(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ka(s)}}(n,e),oN(n)&&aN(n)}async function ih(n,e){const t=tt(n);t.asyncQueue.verifyOperationInProgress(),pe(Ci,"RemoteStore received new credentials");const s=Ti(t);t.Ea.add(3),await Wa(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Wc(t)}async function kA(n,e){const t=tt(n);e?(t.Ea.delete(2),await Wc(t)):e||(t.Ea.add(2),await Wa(t),t.Ra.set("Unknown"))}function Ao(n){return n.ma||(n.ma=function(t,s,r){const i=tt(t);return i.sa(),new lA(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:pA.bind(null,n),t_:hA.bind(null,n),r_:gA.bind(null,n),H_:yA.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),wd(n)?Cd(n):n.Ra.set("Unknown")):(await n.ma.stop(),rN(n))})),n.ma}function Mr(n){return n.fa||(n.fa=function(t,s,r){const i=tt(t);return i.sa(),new cA(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:xA.bind(null,n),r_:DA.bind(null,n),ta:vA.bind(null,n),na:_A.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Ka(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(Ci,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Ms,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,l=new Id(e,t,o,r,i);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Td(n,e){if(Gn("AsyncQueue",`${e}: ${n}`),Wr(n))return new Ne(se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{static emptySet(e){return new oo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ve.comparator(t.key,s.key):(t,s)=>Ve.comparator(t.key,s.key),this.keyedMap=ta(),this.sortedSet=new en(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof oo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new oo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(){this.ga=new en(Ve.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ie(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,s)=>{e.push(s)}),e}}class vo{constructor(e,t,s,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new vo(e,t,oo.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Bc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class VA{constructor(){this.queries=ah(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=tt(t),i=r.queries;r.queries=ah(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(s)})})(this,new Ne(se.ABORTED,"Firestore shutting down"))}}function ah(){return new or(n=>lb(n),Bc)}async function Sd(n,e){const t=tt(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new EA,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=Td(o,`Initialization of query '${Xi(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Ld(t)}async function Pd(n,e){const t=tt(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function AA(n,e){const t=tt(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(s=!0);o.wa=r}}s&&Ld(t)}function CA(n,e,t){const s=tt(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function Ld(n){n.Ca.forEach(e=>{e.next()})}var Am,lh;(lh=Am||(Am={})).Ma="default",lh.Cache="cache";class jd{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new vo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=vo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Am.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e){this.key=e}}class cN{constructor(e){this.key=e}}class wA{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=gt(),this.mutatedKeys=gt(),this.eu=cb(e),this.tu=new oo(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new oh,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),y=$a(this.query,f)?f:null,I=!!h&&this.mutatedKeys.has(h.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;h&&y?h.data.isEqual(y.data)?I!==v&&(s.track({type:3,doc:y}),w=!0):this.su(h,y)||(s.track({type:2,doc:y}),w=!0,(u&&this.eu(y,u)>0||m&&this.eu(y,m)<0)&&(l=!0)):!h&&y?(s.track({type:0,doc:y}),w=!0):h&&!y&&(s.track({type:1,doc:h}),w=!0,(u||m)&&(l=!0)),w&&(y?(o=o.add(y),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:o,iu:s,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(y,I){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie(20277,{Rt:w})}};return v(y)-v(I)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(s),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new vo(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=gt(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const t=[];return e.forEach(s=>{this.Xa.has(s)||t.push(new cN(s))}),this.Xa.forEach(s=>{e.has(s)||t.push(new lN(s))}),t}cu(e){this.Ya=e.Qs,this.Xa=gt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return vo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Rd="SyncEngine";class IA{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class TA{constructor(e){this.key=e,this.hu=!1}}class SA{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new or(l=>lb(l),Bc),this.Iu=new Map,this.Eu=new Set,this.du=new en(Ve.comparator),this.Au=new Map,this.Ru=new vd,this.Vu={},this.mu=new Map,this.fu=Ai.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function PA(n,e,t=!0){const s=hN(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await uN(s,e,t,!0),r}async function LA(n,e){const t=hN(n);await uN(t,e,!0,!1)}async function uN(n,e,t,s){const r=await eA(n.localStore,ps(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let l;return s&&(l=await jA(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&nN(n.remoteStore,r),l}async function jA(n,e,t,s,r){n.pu=(f,h,y)=>async function(v,w,R,P){let F=w.view.ru(R);F.Cs&&(F=await eh(v.localStore,w.query,!1).then(({documents:A})=>w.view.ru(A,F)));const re=P&&P.targetChanges.get(w.targetId),Z=P&&P.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(F,v.isPrimaryClient,re,Z);return uh(v,w.targetId,M.au),M.snapshot}(n,f,h,y);const i=await eh(n.localStore,e,!0),o=new wA(e,i.Qs),l=o.ru(i.documents),u=za.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),m=o.applyChanges(l,n.isPrimaryClient,u);uh(n,t,m.au);const d=new IA(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function RA(n,e,t){const s=tt(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!Bc(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Em(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),t&&Vd(s.remoteStore,r.targetId),Cm(s,r.targetId)}).catch(Ii)):(Cm(s,r.targetId),await Em(s.localStore,r.targetId,!0))}async function BA(n,e){const t=tt(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Vd(t.remoteStore,s.targetId))}async function UA(n,e,t){const s=gN(n);try{const r=await function(o,l){const u=tt(o),m=Lt.now(),d=l.reduce((y,I)=>y.add(I.key),gt());let f,h;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let I=as(),v=gt();return u.Ns.getEntries(y,d).next(w=>{I=w,I.forEach((R,P)=>{P.isValidDocument()||(v=v.add(R))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,I)).next(w=>{f=w;const R=[];for(const P of l){const F=ZE(P,f.get(P.key).overlayedDocument);F!=null&&R.push(new ar(P.key,F,Zy(F.value.mapValue),qn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,m,R,l)}).next(w=>{h=w;const R=w.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(y,w.batchId,R)})}).then(()=>({batchId:h.batchId,changes:mb(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new en(et)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(s,r.batchId,t),await Ga(s,r.changes),await Ka(s.remoteStore)}catch(r){const i=Td(r,"Failed to persist write");t.reject(i)}}async function mN(n,e){const t=tt(n);try{const s=await XV(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Ue(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ue(o.hu,14607):r.removedDocuments.size>0&&(Ue(o.hu,42227),o.hu=!1))}),await Ga(t,s,e)}catch(s){await Ii(s)}}function ch(n,e,t){const s=tt(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=tt(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(l)&&(m=!0)}),m&&Ld(u)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function HA(n,e,t){const s=tt(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new en(Ve.comparator);o=o.insert(i,rn.newNoDocument(i,ze.min()));const l=gt().add(i),u=new Fc(ze.min(),new Map,new en(et),o,l);await mN(s,u),s.du=s.du.remove(i),s.Au.delete(e),Bd(s)}else await Em(s.localStore,e,!1).then(()=>Cm(s,e,t)).catch(Ii)}async function MA(n,e){const t=tt(n),s=e.batch.batchId;try{const r=await YV(t.localStore,e);fN(t,s,null),dN(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Ga(t,r)}catch(r){await Ii(r)}}async function FA(n,e,t){const s=tt(n);try{const r=await function(o,l){const u=tt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Ue(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(s.localStore,e);fN(s,e,t),dN(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Ga(s,r)}catch(r){await Ii(r)}}function dN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function fN(n,e,t){const s=tt(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Cm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(s=>{n.Ru.containsKey(s)||pN(n,s)})}function pN(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Vd(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Bd(n))}function uh(n,e,t){for(const s of t)s instanceof lN?(n.Ru.addReference(s.key,e),OA(n,s)):s instanceof cN?(pe(Rd,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||pN(n,s.key)):Ie(19791,{wu:s})}function OA(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(pe(Rd,"New document in limbo: "+t),n.Eu.add(s),Bd(n))}function Bd(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ve(Pt.fromString(e)),s=n.fu.next();n.Au.set(s,new TA(t)),n.du=n.du.insert(t,s),nN(n.remoteStore,new Zs(ps(qa(t.path)),s,"TargetPurposeLimboResolution",fs.ce))}}async function Ga(n,e,t){const s=tt(n),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((l,u)=>{o.push(s.pu(u,e,t).then(m=>{var d;if((m||t)&&s.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=kd.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(u,m){const d=tt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>$.forEach(m,h=>$.forEach(h.Es,y=>d.persistence.referenceDelegate.addReference(f,h.targetId,y)).next(()=>$.forEach(h.ds,y=>d.persistence.referenceDelegate.removeReference(f,h.targetId,y)))))}catch(f){if(!Wr(f))throw f;pe(Ed,"Failed to update sequence numbers: "+f)}for(const f of m){const h=f.targetId;if(!f.fromCache){const y=d.Ms.get(h),I=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(I);d.Ms=d.Ms.insert(h,v)}}}(s.localStore,i))}async function qA(n,e){const t=tt(n);if(!t.currentUser.isEqual(e)){pe(Rd,"User change. New user:",e.toKey());const s=await Xb(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new Ne(se.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Ga(t,s.Ls)}}function $A(n,e){const t=tt(n),s=t.Au.get(e);if(s&&s.hu)return gt().add(s.key);{let r=gt();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function hN(n){const e=tt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=mN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$A.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HA.bind(null,e),e.Pu.H_=AA.bind(null,e.eventManager),e.Pu.yu=CA.bind(null,e.eventManager),e}function gN(n){const e=tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FA.bind(null,e),e}class Ra{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=zc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Yb(this.persistence,new Qb,e.initialUser,this.serializer)}Cu(e){return new _d($c.mi,this.serializer)}Du(e){return new Zb}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ra.provider={build:()=>new Ra};class zA extends Ra{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ue(this.persistence.referenceDelegate instanceof uc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new $b(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new _d(s=>uc.mi(s,t),this.serializer)}}class WA extends Ra{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await gN(this.xu.syncEngine),await Ka(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return Yb(this.persistence,new Qb,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new $b(s,e.asyncQueue,t)}Mu(e,t){const s=new Xk(t,this.persistence);return new Yk(e.asyncQueue,s)}Cu(e){const t=WV(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new Dd(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,aA(),Ol(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Zb}}class dc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>ch(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=qA.bind(null,this.syncEngine),await kA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new VA}()}createDatastore(e){const t=zc(e.databaseInfo.databaseId),s=function(i){return new oA(i)}(e.databaseInfo);return function(i,o,l,u){return new mA(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,o,l){return new fA(s,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>ch(this.syncEngine,t,0),function(){return sh.v()?new sh:new nA}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new SA(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=tt(r);pe(Ci,"RemoteStore shutting down."),i.Ea.add(5),await Wa(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}dc.provider={build:()=>new dc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="FirestoreClient";class KA{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=Ln.UNAUTHENTICATED,this.clientId=nd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{pe(Fr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(pe(Fr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ms;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Td(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function ju(n,e){n.asyncQueue.verifyOperationInProgress(),pe(Fr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await Xb(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function mh(n,e){n.asyncQueue.verifyOperationInProgress();const t=await GA(n);pe(Fr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>ih(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,r)=>ih(e.remoteStore,r)),n._onlineComponents=e}async function GA(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(Fr,"Using user provided OfflineComponentProvider");try{await ju(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;_i("Error using user provided cache. Falling back to memory cache: "+t),await ju(n,new Ra)}}else pe(Fr,"Using default OfflineComponentProvider"),await ju(n,new zA(void 0));return n._offlineComponents}async function yN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(Fr,"Using user provided OnlineComponentProvider"),await mh(n,n._uninitializedComponentsProvider._online)):(pe(Fr,"Using default OnlineComponentProvider"),await mh(n,new dc))),n._onlineComponents}function QA(n){return yN(n).then(e=>e.syncEngine)}async function fc(n){const e=await yN(n),t=e.eventManager;return t.onListen=PA.bind(null,e.syncEngine),t.onUnlisten=RA.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=LA.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=BA.bind(null,e.syncEngine),t}function YA(n,e,t={}){const s=new Ms;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Ud({next:h=>{d.Nu(),o.enqueueAndForget(()=>Pd(i,f));const y=h.docs.has(l);!y&&h.fromCache?m.reject(new Ne(se.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&h.fromCache&&u&&u.source==="server"?m.reject(new Ne(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new jd(qa(l.path),d,{includeMetadataChanges:!0,qa:!0});return Sd(i,f)}(await fc(n),n.asyncQueue,e,t,s)),s.promise}function XA(n,e,t={}){const s=new Ms;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Ud({next:h=>{d.Nu(),o.enqueueAndForget(()=>Pd(i,f)),h.fromCache&&u.source==="server"?m.reject(new Ne(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new jd(l,d,{includeMetadataChanges:!0,qa:!0});return Sd(i,f)}(await fc(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN="firestore.googleapis.com",fh=!0;class ph{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ne(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=NN,this.ssl=fh}else this.host=e.host,this.ssl=e.ssl??fh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<wV)throw new Ne(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Wk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bN(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ne(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ne(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ne(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kc{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ph({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ne(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ne(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ph(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new Rk;switch(s.type){case"firstParty":return new Mk(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ne(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=dh.get(t);s&&(pe("ComponentProvider","Removing Datastore"),dh.delete(t),s.terminate())}(this),Promise.resolve()}}function JA(n,e,t,s={}){var m;n=Qn(n,Kc);const r=Cc(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(ty(`https://${l}`),sy("Firestore",!0)),i.host!==NN&&i.host!==l&&_i("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:s};if(!Yl(u,o)&&(n._setSettings(u),s.mockUserToken)){let d,f;if(typeof s.mockUserToken=="string")d=s.mockUserToken,f=Ln.MOCK_USER;else{d=ny(s.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const h=s.mockUserToken.sub||s.mockUserToken.user_id;if(!h)throw new Ne(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ln(h)}n._authCredentials=new Bk(new Vy(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Gr(this.firestore,e,this._query)}}class on{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}toJSON(){return{type:on._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Ma(t,on._jsonSchema))return new on(e,s||null,new Ve(Pt.fromString(t.referencePath)))}}on._jsonSchemaVersion="firestore/documentReference/1.0",on._jsonSchema={type:Nn("string",on._jsonSchemaVersion),referencePath:Nn("string")};class Rr extends Gr{constructor(e,t,s){super(e,t,qa(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new Ve(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function ns(n,e,...t){if(n=Vs(n),Cy("collection","path",e),n instanceof Kc){const s=Pt.fromString(e,...t);return rp(s),new Rr(n,null,s)}{if(!(n instanceof on||n instanceof Rr))throw new Ne(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Pt.fromString(e,...t));return rp(s),new Rr(n.firestore,null,s)}}function Rn(n,e,...t){if(n=Vs(n),arguments.length===1&&(e=nd.newId()),Cy("doc","path",e),n instanceof Kc){const s=Pt.fromString(e,...t);return sp(s),new on(n,null,new Ve(s))}{if(!(n instanceof on||n instanceof Rr))throw new Ne(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Pt.fromString(e,...t));return sp(s),new on(n.firestore,n instanceof Rr?n.converter:null,new Ve(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="AsyncQueue";class gh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new eN(this,"async_queue_retry"),this._c=()=>{const s=Ol();s&&pe(hh,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=Ol();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ol();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Ms;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Wr(e))throw e;pe(hh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Gn("INTERNAL UNHANDLED ERROR: ",yh(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Id.createAndSchedule(this,e,t,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Ie(47125,{Pc:yh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function yh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}class zs extends Kc{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new gh,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gh(e),this._firestoreClient=void 0,await e}}}function ZA(n,e){const t=typeof n=="object"?n:gy(),s=typeof n=="string"?n:nc,r=dy(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Zg("firestore");i&&JA(r,...i)}return r}function Gc(n){if(n._terminated)throw new Ne(se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||xN(n),n._firestoreClient}function xN(n){var s,r,i;const e=n._freezeSettings(),t=function(l,u,m,d){return new VE(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,bN(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new KA(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(n._componentsProvider))}function e1(n,e){_i("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return t1(n,dc.provider,{build:s=>new WA(s,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function t1(n,e,t){if((n=Qn(n,zs))._firestoreClient||n._terminated)throw new Ne(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ne(se.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},xN(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ds(vn.fromBase64String(e))}catch(t){throw new Ne(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ds(vn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ds._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ma(e,ds._jsonSchema))return ds.fromBase64String(e.bytes)}}ds._jsonSchemaVersion="firestore/bytes/1.0",ds._jsonSchema={type:Nn("string",ds._jsonSchemaVersion),bytes:Nn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ne(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ne(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ne(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return et(this._lat,e._lat)||et(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fs._jsonSchemaVersion}}static fromJSON(e){if(Ma(e,Fs._jsonSchema))return new Fs(e.latitude,e.longitude)}}Fs._jsonSchemaVersion="firestore/geoPoint/1.0",Fs._jsonSchema={type:Nn("string",Fs._jsonSchemaVersion),latitude:Nn("number"),longitude:Nn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Os._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ma(e,Os._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Os(e.vectorValues);throw new Ne(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Os._jsonSchemaVersion="firestore/vectorValue/1.0",Os._jsonSchema={type:Nn("string",Os._jsonSchemaVersion),vectorValues:Nn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1=/^__.*__$/;class s1{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ar(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vo(e,this.data,t,this.fieldTransforms)}}class vN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ar(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function _N(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie(40011,{Ac:n})}}class Md{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Md({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return pc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(_N(this.Ac)&&n1.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class r1{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||zc(e)}Cc(e,t,s,r=!1){return new Md({Ac:e,methodName:t,Dc:s,path:sn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yc(n){const e=n._freezeSettings(),t=zc(n._databaseId);return new r1(n._databaseId,!!e.ignoreUndefinedProperties,t)}function DN(n,e,t,s,r,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);Fd("Data must be an object, but it was:",o,s);const l=kN(s,o);let u,m;if(i.merge)u=new ss(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=wm(e,f,t);if(!o.contains(h))throw new Ne(se.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);VN(d,h)||d.push(h)}u=new ss(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new s1(new On(l),u,m)}class Xc extends Hd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xc}}function i1(n,e,t,s){const r=n.Cc(1,e,t);Fd("Data must be an object, but it was:",r,s);const i=[],o=On.empty();Kr(s,(u,m)=>{const d=Od(e,u,t);m=Vs(m);const f=r.yc(d);if(m instanceof Xc)i.push(d);else{const h=Qa(m,f);h!=null&&(i.push(d),o.set(d,h))}});const l=new ss(i);return new vN(o,l,r.fieldTransforms)}function o1(n,e,t,s,r,i){const o=n.Cc(1,e,t),l=[wm(e,s,t)],u=[r];if(i.length%2!=0)throw new Ne(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(wm(e,i[h])),u.push(i[h+1]);const m=[],d=On.empty();for(let h=l.length-1;h>=0;--h)if(!VN(m,l[h])){const y=l[h];let I=u[h];I=Vs(I);const v=o.yc(y);if(I instanceof Xc)m.push(y);else{const w=Qa(I,v);w!=null&&(m.push(y),d.set(y,w))}}const f=new ss(m);return new vN(d,f,o.fieldTransforms)}function a1(n,e,t,s=!1){return Qa(t,n.Cc(s?4:3,e))}function Qa(n,e){if(EN(n=Vs(n)))return Fd("Unsupported field value:",e,n),kN(n,e);if(n instanceof Hd)return function(s,r){if(!_N(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const l of s){let u=Qa(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=Vs(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return WE(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Lt.fromDate(s);return{timestampValue:xo(r.serializer,i)}}if(s instanceof Lt){const i=new Lt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:xo(r.serializer,i)}}if(s instanceof Fs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ds)return{bytesValue:kb(r.serializer,s._byteString)};if(s instanceof on){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bd(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Os)return function(o,l){return{mapValue:{fields:{[ud]:{stringValue:md},[po]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return fd(l.serializer,m)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${wc(s)}`)}(n,e)}function kN(n,e){const t={};return $y(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Kr(n,(s,r)=>{const i=Qa(r,e.mc(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function EN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Lt||n instanceof Fs||n instanceof ds||n instanceof on||n instanceof Hd||n instanceof Os)}function Fd(n,e,t){if(!EN(t)||!wy(t)){const s=wc(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function wm(n,e,t){if((e=Vs(e))instanceof Qc)return e._internalPath;if(typeof e=="string")return Od(n,e);throw pc("Field path arguments must be of type string or ",n,!1,void 0,t)}const l1=new RegExp("[~\\*/\\[\\]]");function Od(n,e,t){if(e.search(l1)>=0)throw pc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Qc(...e.split("."))._internalPath}catch{throw pc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function pc(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${s}`),o&&(u+=` in document ${r}`),u+=")"),new Ne(se.INVALID_ARGUMENT,l+n+u)}function VN(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new c1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Jc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class c1 extends AN{data(){return super.data()}}function Jc(n,e){return typeof e=="string"?Od(n,e):e instanceof Qc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ne(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qd{}class wN extends qd{}function er(n,e,...t){let s=[];e instanceof qd&&s.push(e),s=s.concat(t),function(i){const o=i.filter(u=>u instanceof $d).length,l=i.filter(u=>u instanceof Zc).length;if(o>1||o>0&&l>0)throw new Ne(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class Zc extends wN{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Zc(e,t,s)}_apply(e){const t=this._parse(e);return IN(e._query,t),new Gr(e.firestore,e.converter,gm(e._query,t))}_parse(e){const t=Yc(e.firestore);return function(i,o,l,u,m,d,f){let h;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ne(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){xh(f,d);const I=[];for(const v of f)I.push(Nh(u,i,v));h={arrayValue:{values:I}}}else h=Nh(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||xh(f,d),h=a1(l,o,f,d==="in"||d==="not-in");return vt.create(m,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Im(n,e,t){const s=e,r=Jc("where",n);return Zc._create(r,s,t)}class $d extends qd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new $d(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:Ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)IN(o,u),o=gm(o,u)}(e._query,t),new Gr(e.firestore,e.converter,gm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zd extends wN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zd(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new Ne(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ne(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Pa(i,o)}(e._query,this._field,this._direction);return new Gr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Eo(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Br(n,e="asc"){const t=e,s=Jc("orderBy",n);return zd._create(s,t)}function Nh(n,e,t){if(typeof(t=Vs(t))=="string"){if(t==="")throw new Ne(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ab(e)&&t.indexOf("/")!==-1)throw new Ne(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Pt.fromString(t));if(!Ve.isDocumentKey(s))throw new Ne(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Ta(n,new Ve(s))}if(t instanceof on)return Ta(n,t._key);throw new Ne(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wc(t)}.`)}function xh(n,e){if(!Array.isArray(n)||n.length===0)throw new Ne(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function IN(n,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ne(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ne(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class u1{convertValue(e,t="none"){switch(Ur(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Zt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ir(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Kr(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertVectorValue(e){var s,r,i;const t=(i=(r=(s=e.fields)==null?void 0:s[po].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>Zt(o.doubleValue));return new Os(t)}convertGeoPoint(e){return new Fs(Zt(e.latitude),Zt(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=jc(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(wa(e));default:return null}}convertTimestamp(e){const t=rr(e);return new Lt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Pt.fromString(e);Ue(Lb(s),9688,{name:e});const r=new Di(s.get(1),s.get(3)),i=new Ve(s.popFirst(5));return r.isEqual(t)||Gn(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n,e,t){let s;return s=n?n.toFirestore(e):e,s}class ra{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class bi extends AN{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ql(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Jc("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=bi._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}bi._jsonSchemaVersion="firestore/documentSnapshot/1.0",bi._jsonSchema={type:Nn("string",bi._jsonSchemaVersion),bundleSource:Nn("string","DocumentSnapshot"),bundleName:Nn("string"),bundle:Nn("string")};class ql extends bi{data(e={}){return super.data(e)}}class Ni{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ra(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new ql(this._firestore,this._userDataWriter,s.key,s,new ra(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ne(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new ql(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ra(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new ql(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ra(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:m1(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ni._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=nd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function m1(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wd(n){n=Qn(n,on);const e=Qn(n.firestore,zs);return YA(Gc(e),n._key).then(t=>SN(e,n,t))}Ni._jsonSchemaVersion="firestore/querySnapshot/1.0",Ni._jsonSchema={type:Nn("string",Ni._jsonSchemaVersion),bundleSource:Nn("string","QuerySnapshot"),bundleName:Nn("string"),bundle:Nn("string")};class Kd extends u1{constructor(e){super(),this.firestore=e}convertBytes(e){return new ds(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}function Hs(n){n=Qn(n,Gr);const e=Qn(n.firestore,zs),t=Gc(e),s=new Kd(e);return CN(n._query),XA(t,n._query).then(r=>new Ni(e,s,n,r))}function Gd(n,e,t){n=Qn(n,on);const s=Qn(n.firestore,zs),r=TN(n.converter,e);return eu(s,[DN(Yc(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,qn.none())])}function no(n,e,t,...s){n=Qn(n,on);const r=Qn(n.firestore,zs),i=Yc(r);let o;return o=typeof(e=Vs(e))=="string"||e instanceof Qc?o1(i,"updateDoc",n._key,e,t,s):i1(i,"updateDoc",n._key,e),eu(r,[o.toMutation(n._key,qn.exists(!0))])}function Qd(n){return eu(Qn(n.firestore,zs),[new Mc(n._key,qn.none())])}function d1(n,e){const t=Qn(n.firestore,zs),s=Rn(n),r=TN(n.converter,e);return eu(t,[DN(Yc(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,qn.exists(!1))]).then(()=>s)}function hc(n,...e){var u,m,d;n=Vs(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||bh(e[s])||(t=e[s++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(bh(e[s])){const f=e[s];e[s]=(u=f.next)==null?void 0:u.bind(f),e[s+1]=(m=f.error)==null?void 0:m.bind(f),e[s+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(n instanceof on)o=Qn(n.firestore,zs),l=qa(n._key.path),i={next:f=>{e[s]&&e[s](SN(o,n,f))},error:e[s+1],complete:e[s+2]};else{const f=Qn(n,Gr);o=Qn(f.firestore,zs),l=f._query;const h=new Kd(o);i={next:y=>{e[s]&&e[s](new Ni(o,h,f,y))},error:e[s+1],complete:e[s+2]},CN(n._query)}return function(h,y,I,v){const w=new Ud(v),R=new jd(y,w,I);return h.asyncQueue.enqueueAndForget(async()=>Sd(await fc(h),R)),()=>{w.Nu(),h.asyncQueue.enqueueAndForget(async()=>Pd(await fc(h),R))}}(Gc(o),l,r,i)}function eu(n,e){return function(s,r){const i=new Ms;return s.asyncQueue.enqueueAndForget(async()=>UA(await QA(s),r,i)),i.promise}(Gc(n),e)}function SN(n,e,t){const s=t.docs.get(e._key),r=new Kd(n);return new bi(n,r,e._key,s,new ra(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){ko=r})(py),va(new ao("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new zs(new Uk(s.getProvider("auth-internal")),new Fk(o,s.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ne(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Di(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Pr(Zf,ep,e),Pr(Zf,ep,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN="firebasestorage.googleapis.com",f1="storageBucket",p1=2*60*1e3,h1=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs extends wi{constructor(e,t,s=0){super(Ru(e),`Firebase Storage: ${t} (${Ru(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Gs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ru(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ws;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ws||(Ws={}));function Ru(n){return"storage/"+n}function g1(){const n="An unknown error occurred, please check the error payload for server response.";return new Gs(Ws.UNKNOWN,n)}function y1(){return new Gs(Ws.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function b1(){return new Gs(Ws.CANCELED,"User canceled the upload/download.")}function N1(n){return new Gs(Ws.INVALID_URL,"Invalid URL '"+n+"'.")}function x1(n){return new Gs(Ws.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function vh(n){return new Gs(Ws.INVALID_ARGUMENT,n)}function LN(){return new Gs(Ws.APP_DELETED,"The Firebase app was deleted.")}function v1(n){return new Gs(Ws.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Es.makeFromUrl(e,t)}catch{return new Es(e,"")}if(s.path==="")return s;throw x1(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(re){re.path_=decodeURIComponent(re.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),I={bucket:1,path:3},v=t===PN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",R=new RegExp(`^https?://${v}/${r}/${w}`,"i"),F=[{regex:l,indices:u,postModify:i},{regex:y,indices:I,postModify:m},{regex:R,indices:{bucket:1,path:2},postModify:m}];for(let re=0;re<F.length;re++){const Z=F[re],M=Z.regex.exec(e);if(M){const A=M[Z.indices.bucket];let N=M[Z.indices.path];N||(N=""),s=new Es(A,N),Z.postModify(s);break}}if(s==null)throw N1(e);return s}}class _1{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(n,e,t){let s=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...w){m||(m=!0,e.apply(null,w))}function f(w){r=setTimeout(()=>{r=null,n(y,u())},w)}function h(){i&&clearTimeout(i)}function y(w,...R){if(m){h();return}if(w){h(),d.call(null,w,...R);return}if(u()||o){h(),d.call(null,w,...R);return}s<64&&(s*=2);let F;l===1?(l=2,F=0):F=(s+Math.random())*1e3,f(F)}let I=!1;function v(w){I||(I=!0,h(),!m&&(r!==null?(w||(l=2),clearTimeout(r),f(0)):w||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function k1(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(n){return n!==void 0}function _h(n,e,t,s){if(s<e)throw vh(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw vh(`Invalid value for '${n}'. Expected ${t} or less.`)}function V1(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var gc;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(gc||(gc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e,t,s,r,i,o,l,u,m,d,f,h=!0,y=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,v)=>{this.resolve_=I,this.reject_=v,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new hl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===gc.NO_ERROR,u=i.getStatus();if(!l||A1(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===gc.ABORT;s(!1,new hl(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;s(!0,new hl(m,i))})},t=(s,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());E1(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=g1();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?LN():b1();o(u)}else{const u=y1();o(u)}};this.canceled_?t(!1,new hl(!1,null,!0)):this.backoffId_=D1(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&k1(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hl{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function w1(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function I1(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function T1(n,e){e&&(n["X-Firebase-GMPID"]=e)}function S1(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function P1(n,e,t,s,r,i,o=!0,l=!1){const u=V1(n.urlParams),m=n.url+u,d=Object.assign({},n.headers);return T1(d,e),w1(d,t),I1(d,i),S1(d,s),new C1(m,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function j1(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,t){this._service=e,t instanceof Es?this._location=t:this._location=Es.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new yc(e,t)}get root(){const e=new Es(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return j1(this._location.path)}get storage(){return this._service}get parent(){const e=L1(this._location.path);if(e===null)return null;const t=new Es(this._location.bucket,e);return new yc(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw v1(e)}}function Dh(n,e){const t=e==null?void 0:e[f1];return t==null?null:Es.makeFromBucketSpec(t,n)}function R1(n,e,t,s={}){n.host=`${e}:${t}`;const r=Cc(e);r&&(ty(`https://${n.host}/b`),sy("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:ny(i,n.app.options.projectId))}class B1{constructor(e,t,s,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=PN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=p1,this._maxUploadRetryTime=h1,this._requests=new Set,r!=null?this._bucket=Es.makeFromBucketSpec(r,this._host):this._bucket=Dh(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Es.makeFromBucketSpec(this._url,e):this._bucket=Dh(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){_h("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){_h("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(fy(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new yc(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new _1(LN());{const o=P1(e,this._appId,s,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const kh="@firebase/storage",Eh="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN="storage";function U1(n=gy(),e){n=Vs(n);const s=dy(n,jN).getImmediate({identifier:e}),r=Zg("storage");return r&&H1(s,...r),s}function H1(n,e,t,s={}){R1(n,e,t,s)}function M1(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new B1(t,s,r,e,py)}function F1(){va(new ao(jN,M1,"PUBLIC").setMultipleInstances(!0)),Pr(kh,Eh,""),Pr(kh,Eh,"esm2020")}F1();const O1={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},RN=hy(O1),St=ZA(RN);U1(RN);e1(St).catch(n=>{n.code==="failed-precondition"?console.warn(" :     "):n.code==="unimplemented"&&console.warn(" :   ")});const Bt={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function VI(n,e){const t=ns(St,n);return(await d1(t,{...e,createdAt:Lt.now(),updatedAt:Lt.now()})).id}let bc=new Map;async function Nr(){if(bc.size>0)return;const n=ns(St,Bt.PROJECTS);(await Hs(n)).docs.forEach(t=>{const s=t.data();bc.set(t.id,{name:s.name||"",color:s.color||"#4A90E2"})})}function $o(n){const e=bc.get(String(n.projectId))||{name:"",color:"#4A90E2"};return{id:n.id,project_id:n.projectId,project_name:e.name,project_color:e.color,user_id:n.userId||0,requester_name:"",approved_by:n.approvedBy||void 0,request_type:n.requestType||"material",vendor_name:n.vendorName||"",description:n.description||"",amount:n.amount||0,account_holder:n.accountHolder||"",bank_name:n.bankName||"",account_number:n.accountNumber||"",item_name:n.itemName||"",material_amount:n.materialAmount||0,labor_amount:n.laborAmount||0,original_material_amount:n.originalMaterialAmount||0,original_labor_amount:n.originalLaborAmount||0,apply_tax_deduction:n.applyTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,quick_text:n.quickText||"",images:n.images?JSON.stringify(n.images):"[]",notes:n.notes||"",status:n.status||"pending",created_at:n.createdAt||"",updated_at:n.updatedAt||"",paid_at:n.paidAt||void 0}}function Vh(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.request_type!==void 0&&(e.requestType=n.request_type),n.category!==void 0&&(e.requestType=n.category),n.vendor_name!==void 0&&(e.vendorName=n.vendor_name),n.process!==void 0&&(e.vendorName=n.process),n.description!==void 0&&(e.description=n.description),n.purpose!==void 0&&(e.description=n.purpose),n.amount!==void 0&&(e.amount=n.amount),n.account_holder!==void 0&&(e.accountHolder=n.account_holder),n.bank_name!==void 0&&(e.bankName=n.bank_name),n.account_number!==void 0&&(e.accountNumber=n.account_number),n.notes!==void 0&&(e.notes=n.notes),n.itemName!==void 0&&(e.itemName=n.itemName),n.item_name!==void 0&&(e.itemName=n.item_name),n.materialAmount!==void 0&&(e.materialAmount=n.materialAmount),n.laborAmount!==void 0&&(e.laborAmount=n.laborAmount),n.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=n.originalMaterialAmount),n.originalLaborAmount!==void 0&&(e.originalLaborAmount=n.originalLaborAmount),n.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=n.applyTaxDeduction),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),n.quickText!==void 0&&(e.quickText=n.quickText),n.images!==void 0&&(e.images=Array.isArray(n.images)?n.images:[]),n.status!==void 0&&(e.status=n.status),e}const Zn={getAllPayments:async()=>{await Nr();const n=ns(St,Bt.PAYMENTS),e=er(n,Br("id","desc"));return(await Hs(e)).docs.map(s=>{const r=s.data();return $o({...r,id:parseInt(s.id)||r.id})})},getPaymentById:async n=>{await Nr();const e=Rn(St,Bt.PAYMENTS,n),t=await Wd(e);if(t.exists()){const s=t.data();return $o({...s,id:parseInt(t.id)||s.id})}return null},createPayment:async n=>{var m;await Nr();const e=ns(St,Bt.PAYMENTS),t=await Hs(e);let s=0;t.docs.forEach(d=>{const f=parseInt(d.id);!isNaN(f)&&f>s&&(s=f)});const r=s+1,i=Vh(n),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:i.images||[],imageCount:((m=i.images)==null?void 0:m.length)||0},u=Rn(St,Bt.PAYMENTS,String(r));return await Gd(u,l),$o(l)},updatePayment:async(n,e)=>{await Nr();const t=Rn(St,Bt.PAYMENTS,n),s=Vh(e);await no(t,{...s,updatedAt:new Date().toISOString()});const r=await Zn.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(n,e)=>{await Nr();const t=Rn(St,Bt.PAYMENTS,n),s=new Date().toISOString(),r={status:e,updatedAt:s};e==="completed"&&(r.paidAt=s),await no(t,r);const i=await Zn.getPaymentById(n);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(n,e,t)=>{await Nr();const s=Rn(St,Bt.PAYMENTS,n);await no(s,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await Zn.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(n,e)=>{const t=Rn(St,Bt.PAYMENTS,n);return await no(t,{images:e,imageCount:e.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:e}},deletePayment:async n=>{const e=Rn(St,Bt.PAYMENTS,n);await Qd(e)},subscribeToPayments:n=>{const e=ns(St,Bt.PAYMENTS),t=er(e,Br("id","desc"));return hc(t,async s=>{await Nr();const r=s.docs.map(i=>{const o=i.data();return $o({...o,id:parseInt(i.id)||o.id})});n(r)})},getPaymentsByProject:async n=>{await Nr();const e=ns(St,Bt.PAYMENTS),t=er(e,Im("projectId","==",n),Br("id","desc"));return(await Hs(t)).docs.map(r=>{const i=r.data();return $o({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{bc.clear()}},q1=!0,Tn=()=>q1,xr={getAllPayments:async()=>(await Ae.get("/payments")).data,getPaymentById:async n=>(await Ae.get(`/payments/${n}`)).data,createPayment:async n=>{var s,r,i;const e={project_id:n.projectId,request_type:n.category,vendor_name:n.process||"",description:n.purpose||"",amount:n.amount,account_holder:((s=n.bankInfo)==null?void 0:s.accountHolder)||"",bank_name:((r=n.bankInfo)==null?void 0:r.bankName)||"",account_number:((i=n.bankInfo)==null?void 0:i.accountNumber)||"",notes:n.notes||"",itemName:n.itemName||"",materialAmount:n.materialAmount??n.amount,laborAmount:n.laborAmount??0,originalMaterialAmount:n.originalMaterialAmount||0,originalLaborAmount:n.originalLaborAmount||0,applyTaxDeduction:n.applyTaxDeduction||!1,includesVAT:n.includesVAT||!1,quickText:n.quickText||"",images:n.images||[]};return console.log("[paymentService.createPayment] Sending to backend:",e),(await Ae.post("/payments",e)).data},updatePayment:async(n,e)=>{const t={};return e.projectId!==void 0&&(t.project=e.projectId),e.purpose!==void 0&&(t.description=e.purpose),e.amount!==void 0&&(t.amount=e.amount),e.process!==void 0&&(t.vendor_name=e.process),e.category!==void 0&&(t.request_type=e.category),e.itemName!==void 0&&(t.itemName=e.itemName),e.materialAmount!==void 0&&(t.materialAmount=e.materialAmount),e.laborAmount!==void 0&&(t.laborAmount=e.laborAmount),e.originalMaterialAmount!==void 0&&(t.originalMaterialAmount=e.originalMaterialAmount),e.originalLaborAmount!==void 0&&(t.originalLaborAmount=e.originalLaborAmount),e.applyTaxDeduction!==void 0&&(t.applyTaxDeduction=e.applyTaxDeduction),e.includesVAT!==void 0&&(t.includesVAT=e.includesVAT),e.notes!==void 0&&(t.notes=e.notes),e.requestDate!==void 0&&(t.requestDate=e.requestDate),e.bankInfo!==void 0&&(e.bankInfo.accountHolder&&(t.account_holder=e.bankInfo.accountHolder),e.bankInfo.bankName&&(t.bank_name=e.bankInfo.bankName),e.bankInfo.accountNumber&&(t.account_number=e.bankInfo.accountNumber)),(await Ae.put(`/payments/${n}`,t)).data},updatePaymentStatus:async(n,e)=>(await Ae.put(`/payments/${n}/status`,{status:e})).data,updatePaymentAmounts:async(n,e,t)=>(await Ae.patch(`/payments/${n}/amounts`,{materialAmount:e,laborAmount:t})).data,updatePaymentImages:async(n,e)=>(await Ae.put(`/payments/${n}/images`,{images:e})).data,deletePayment:async n=>{await Ae.delete(`/payments/${n}`)}},vs={getAllPayments:async()=>Tn()?(console.log("[paymentService] Using Firestore"),Zn.getAllPayments()):(console.log("[paymentService] Using Railway API"),xr.getAllPayments()),getPaymentById:async n=>{if(Tn()){const e=await Zn.getPaymentById(n);if(!e)throw new Error("Payment not found");return e}return xr.getPaymentById(n)},createPayment:async n=>Tn()?Zn.createPayment(n):xr.createPayment(n),updatePayment:async(n,e)=>Tn()?Zn.updatePayment(n,e):xr.updatePayment(n,e),updatePaymentStatus:async(n,e)=>Tn()?Zn.updatePaymentStatus(n,e):xr.updatePaymentStatus(n,e),updatePaymentAmounts:async(n,e,t)=>Tn()?Zn.updatePaymentAmounts(n,e,t):xr.updatePaymentAmounts(n,e,t),updatePaymentImages:async(n,e)=>Tn()?Zn.updatePaymentImages(n,e):xr.updatePaymentImages(n,e),deletePayment:async n=>Tn()?Zn.deletePayment(n):xr.deletePayment(n),subscribeToPayments:Zn.subscribeToPayments,getPaymentsByProject:Zn.getPaymentsByProject,clearProjectsCache:Zn.clearProjectsCache},ia={getAllASRequests:async()=>(await Ae.get("/as-requests")).data,getASRequestById:async n=>(await Ae.get(`/as-requests/${n}`)).data,createASRequest:async n=>(await Ae.post("/as-requests",n)).data,updateASRequest:async(n,e)=>(await Ae.put(`/as-requests/${n}`,e)).data,deleteASRequest:async n=>{await Ae.delete(`/as-requests/${n}`)}};function zo(n){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:n.id,id:parseInt(n.id)||0,name:n.name,client:{name:n.client||"",phone:"",address:n.address||""},location:{address:n.address||""},startDate:n.startDate||"",endDate:n.endDate||"",status:e[n.status]||"planning",budget:0,actualCost:0,manager:{_id:String(n.managerId||""),name:n.managerName||n.manager||"",username:n.managerUsername||""},fieldManagers:[],workers:[],colorCode:n.color||"#4A90E2",progress:0,description:n.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:n.createdAt||"",updatedAt:n.updatedAt||"",meetingNotes:n.meetingNotes||[],customerRequests:n.customerRequests||[],entrancePassword:n.entrancePassword||"",sitePassword:n.sitePassword||""}}function Ah(n){var t,s,r,i,o,l,u,m;const e={};if(n.name!==void 0&&(e.name=n.name),n.client!==void 0&&(e.client=typeof n.client=="string"?n.client:((t=n.client)==null?void 0:t.name)||""),n.location!==void 0&&(e.address=typeof n.location=="string"?n.location:((s=n.location)==null?void 0:s.address)||""),n.address!==void 0&&(e.address=n.address),n.startDate!==void 0&&(e.startDate=typeof n.startDate=="string"?n.startDate:((o=(i=(r=n.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),n.endDate!==void 0&&(e.endDate=typeof n.endDate=="string"?n.endDate:((m=(u=(l=n.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),n.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[n.status]||"planning"}return n.description!==void 0&&(e.description=n.description),n.manager!==void 0&&(e.manager=n.manager),n.meetingNotes!==void 0&&(e.meetingNotes=n.meetingNotes),n.customerRequests!==void 0&&(e.customerRequests=n.customerRequests),n.entrancePassword!==void 0&&(e.entrancePassword=n.entrancePassword),n.sitePassword!==void 0&&(e.sitePassword=n.sitePassword),n.color!==void 0&&(e.color=n.color),n.colorCode!==void 0&&(e.color=n.colorCode),e}const kr={getAllProjects:async()=>{const n=ns(St,Bt.PROJECTS),e=er(n,Br("id","desc"));return(await Hs(e)).docs.map(s=>{const r=s.data();return zo({...r,id:s.id})})},getProjectById:async n=>{const e=Rn(St,Bt.PROJECTS,n),t=await Wd(e);if(t.exists()){const s=t.data();return zo({...s,id:t.id})}return null},createProject:async n=>{const e=ns(St,Bt.PROJECTS),t=await Hs(e);let s=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>s&&(s=d)});const r=String(s+1),i=Ah(n),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Rn(St,Bt.PROJECTS,r);return await Gd(u,l),zo(l)},updateProject:async(n,e)=>{const t=Rn(St,Bt.PROJECTS,n),s=Ah(e);await no(t,{...s,updatedAt:new Date().toISOString()});const r=await kr.getProjectById(n);if(!r)throw new Error("Project not found after update");return r},deleteProject:async n=>{const e=Rn(St,Bt.PROJECTS,n);await Qd(e)},subscribeToProjects:n=>{const e=ns(St,Bt.PROJECTS),t=er(e,Br("id","desc"));return hc(t,s=>{const r=s.docs.map(i=>{const o=i.data();return zo({...o,id:i.id})});n(r)})},subscribeToProject:(n,e)=>{const t=Rn(St,Bt.PROJECTS,n);return hc(t,s=>{if(s.exists()){const r=s.data();e(zo({...r,id:s.id}))}else e(null)})}},Wo={getAllProjects:async()=>(await Ae.get("/projects")).data,getProjectById:async n=>(await Ae.get(`/projects/${n}`)).data,createProject:async n=>{const e={name:n.name,client:typeof n.client=="string"?n.client:n.client.name,location:typeof n.location=="string"?n.location:n.location.address,status:n.status||"planning",manager:n.manager,description:n.description||""};if(n.startDate){const s=typeof n.startDate=="string"?new Date(n.startDate):n.startDate;e.startDate=s.toISOString().split("T")[0]}if(n.endDate){const s=typeof n.endDate=="string"?new Date(n.endDate):n.endDate;e.endDate=s.toISOString().split("T")[0]}return console.log("[projectService.createProject] Sending to backend:",e),(await Ae.post("/projects",e)).data},updateProject:async(n,e)=>{var s;const t={};if(e.name!==void 0&&(t.name=e.name),e.client!==void 0&&(t.client=typeof e.client=="string"?e.client:e.client.name),e.location!==void 0&&(t.location=typeof e.location=="string"?e.location:e.location.address),e.startDate!==void 0)if(typeof e.startDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.startDate))t.startDate=e.startDate;else{const r=typeof e.startDate=="string"?new Date(e.startDate):e.startDate;t.startDate=r.toISOString().split("T")[0]}if(e.endDate!==void 0)if(typeof e.endDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.endDate))t.endDate=e.endDate;else{const r=typeof e.endDate=="string"?new Date(e.endDate):e.endDate;t.endDate=r.toISOString().split("T")[0]}e.status!==void 0&&(t.status=e.status),e.manager!==void 0&&(t.manager=e.manager),e.description!==void 0&&(t.description=e.description),e.meetingNotes!==void 0&&(t.meetingNotes=e.meetingNotes),e.customerRequests!==void 0&&(t.customerRequests=e.customerRequests),e.entrancePassword!==void 0&&(t.entrancePassword=e.entrancePassword),e.sitePassword!==void 0&&(t.sitePassword=e.sitePassword),console.log("[projectService.updateProject] Sending to backend:",t);try{return(await Ae.put(`/projects/${n}`,t)).data}catch(r){const i=r;throw console.error("[projectService.updateProject] Error:",r),console.error("[projectService.updateProject] Error response:",(s=i.response)==null?void 0:s.data),r}},deleteProject:async n=>{await Ae.delete(`/projects/${n}`)}},so={getAllProjects:async()=>Tn()?(console.log("[projectService] Using Firestore"),kr.getAllProjects()):(console.log("[projectService] Using Railway API"),Wo.getAllProjects()),getProjectById:async n=>{if(Tn()){const e=await kr.getProjectById(n);if(!e)throw new Error("Project not found");return e}return Wo.getProjectById(n)},createProject:async n=>Tn()?kr.createProject(n):Wo.createProject(n),updateProject:async(n,e)=>Tn()?kr.updateProject(n,e):Wo.updateProject(n,e),deleteProject:async n=>Tn()?kr.deleteProject(n):Wo.deleteProject(n),subscribeToProjects:kr.subscribeToProjects,subscribeToProject:kr.subscribeToProject},$1=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://api.hvlab.app"}return window.location.origin},z1=$1();class W1{constructor(){Af(this,"socket",null)}connect(e){return this.socket=oa(z1,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var s;(s=this.socket)==null||s.on(e,t)}emit(e,t){var s;(s=this.socket)==null||s.emit(e,t)}off(e,t){var s;(s=this.socket)==null||s.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const Er=new W1,K1=()=>{var oe,Me;const{user:n,logout:e,loading:t}=zr(),[s,r]=V.useState(!1),[i,o]=V.useState(!1),[l,u]=V.useState(!1),m=sx(),{unreadCount:d}=Qg(),[f,h]=V.useState(0),[y,I]=V.useState(0),[v,w]=V.useState(0),[R,P]=V.useState(0),[F,re]=V.useState(!1),[Z,M]=V.useState(0),[A,N]=V.useState(!1),C=V.useRef(0),j=V.useRef(null),S=80,T=V.useCallback(ue=>{if(window.scrollY>0)return!1;let Pe=ue;for(;Pe&&Pe!==document.body;){const bt=window.getComputedStyle(Pe).overflowY;if((bt==="auto"||bt==="scroll")&&Pe.scrollTop>0)return!1;Pe=Pe.parentElement}return!0},[]),E=V.useCallback(ue=>{if(window.innerWidth>=768)return;const Pe=ue.target;T(Pe)&&(C.current=ue.touches[0].clientY,re(!0))},[T]),De=V.useCallback(ue=>{if(!F||A)return;const Pe=ue.target;if(!T(Pe)){re(!1),M(0);return}const bt=ue.touches[0].clientY-C.current;if(bt>0){const st=Math.min(bt*.5,120);M(st)}else re(!1),M(0)},[F,A,T]),He=V.useCallback(()=>{F&&(Z>=S&&!A?(N(!0),M(50),setTimeout(()=>{window.location.reload()},300)):M(0),re(!1))},[F,Z,A]);if(V.useEffect(()=>{u(!1)},[m.pathname]),V.useEffect(()=>{const ue=Pe=>{u(Pe.detail.isOpen)};return window.addEventListener("mobileFormStateChange",ue),()=>window.removeEventListener("mobileFormStateChange",ue)},[]),V.useEffect(()=>{const ue=()=>{P(Pe=>Math.max(0,Pe-1))};return window.addEventListener("quoteInquiryRead",ue),()=>window.removeEventListener("quoteInquiryRead",ue)},[]),V.useEffect(()=>{const ue=()=>{I(Pe=>Math.max(0,Pe-1))};return window.addEventListener("paymentCompleted",ue),()=>window.removeEventListener("paymentCompleted",ue)},[]),V.useEffect(()=>{const ue=Er.getSocket();if(!ue||!n)return;const Pe=async()=>{try{const[We,bt]=await Promise.all([vs.getAllPayments(),so.getAllProjects()]);let st=We;if(n.name===""){const At=bt.map(nt=>nt.name);st=We.filter(nt=>At.includes(nt.project))}I(st.filter(At=>At.status==="pending").length)}catch(We){console.error("Failed to refresh payment count:",We)}};return ue.on("payment:refresh",Pe),()=>{ue.off("payment:refresh",Pe)}},[n]),V.useEffect(()=>{if(!n)return;const ue=async()=>{try{const[We,bt,st,At]=await Promise.all([cD.getAllWorkRequests(),vs.getAllPayments(),ia.getAllASRequests(),so.getAllProjects()]);h(We.filter(lt=>lt.assignedTo===n.name&&lt.status==="pending").length);let nt=bt;if(n.name===""){const lt=At.map(an=>an.name);nt=bt.filter(an=>lt.includes(an.project))}if(I(nt.filter(lt=>lt.status==="pending").length),w(st.filter(lt=>lt.status==="in-progress").length),n.role==="admin"||n.role==="manager")try{const an=(await Ae.get("/quote-inquiries")).data.filter(G=>!G.isRead).length;P(an)}catch(lt){console.error("Failed to load quote inquiry count:",lt)}}catch(We){console.error("Failed to load badge counts:",We)}};ue();const Pe=setInterval(ue,3e4);return()=>clearInterval(Pe)},[n]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!n){const ue=window.location.pathname+window.location.search;return ue&&ue!=="/login"&&ue!=="/"&&sessionStorage.setItem("redirectAfterLogin",ue),a.jsxDEV(ag,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const fe=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...R>0&&{badge:R}},{name:"",href:"/contractors"}],je=fe.filter(ue=>!ue.roles||ue.roles.includes((n==null?void 0:n.role)||"")),ut=((oe=fe.find(ue=>ue.href===m.pathname))==null?void 0:oe.name)||"",Rt=(()=>{const ue=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(ue)?()=>{const We=new CustomEvent("headerAddButtonClick");window.dispatchEvent(We)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Ns("fixed inset-0 z-40 lg:hidden",s?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(ue=>a.jsxDEV(Nu,{to:ue.href,className:({isActive:Pe})=>Ns("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Pe?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:ue.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),ue.badge&&ue.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:ue.badge>99?"99+":ue.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},ue.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(ue=>a.jsxDEV(Nu,{to:ue.href,className:({isActive:Pe})=>Ns("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Pe?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:ue.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),ue.badge&&ue.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:ue.badge>99?"99+":ue.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},ue.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),ut&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:ut},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Rt&&a.jsxDEV("button",{onClick:Rt,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(yn,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV(ro,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:n==null?void 0:n.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:n==null?void 0:n.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(Me=n==null?void 0:n.name)==null?void 0:Me.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:je.map(ue=>a.jsxDEV(Nu,{to:ue.href,className:({isActive:Pe})=>Ns("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Pe?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:ue.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),ue.badge&&ue.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:ue.badge>99?"99+":ue.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},ue.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:E,onTouchMove:De,onTouchEnd:He,children:[Z>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:Z,transition:F?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Ns("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",A&&"animate-spin"),style:{transform:`rotate(${A?0:Z*2}deg)`,opacity:Math.min(Z/S,1)},children:a.jsxDEV(fx,{className:Ns("w-5 h-5",Z>=S?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:Z>0?`translateY(${Z}px)`:"none",transition:F?"none":"transform 0.2s ease-out"},children:a.jsxDEV(rx,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(lD,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},G1=n=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,s=n==="emergency"?5:3;let r=0;const i=()=>{if(r>=s)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=n==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<s&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},Q1=n=>{if("vibrate"in navigator){const e=n==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},Y1=(n,e)=>{G1(n),Q1(n),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},X1=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",gl={getAllSchedules:async()=>(await Ae.get("/schedules")).data,getScheduleById:async n=>(await Ae.get(`/schedules/${n}`)).data,createSchedule:async n=>(await Ae.post("/schedules",{project:n.project,title:n.title,type:n.type||"other",phase:n.phase||"",startDate:n.startDate,endDate:n.endDate,allDay:n.allDay!==void 0?n.allDay:!0,assignedTo:n.assignedTo||[],description:n.description,location:n.location,priority:n.priority||"medium",progress:n.progress||0,isCompleted:n.isCompleted||!1,asRequestId:n.asRequestId,time:n.time})).data,updateSchedule:async(n,e)=>(await Ae.put(`/schedules/${n}`,e)).data,deleteSchedule:async n=>{await Ae.delete(`/schedules/${n}`)}},tr={getAllContractors:async()=>(await Ae.get("/contractors")).data,getContractorById:async n=>(await Ae.get(`/contractors/${n}`)).data,createContractor:async n=>(await Ae.post("/contractors",n)).data,updateContractor:async(n,e)=>(await Ae.put(`/contractors/${n}`,e)).data,deleteContractor:async n=>{await Ae.delete(`/contractors/${n}`)}},yl={getAllConstructionPayments:async()=>(await Ae.get("/construction-payments")).data,getConstructionPaymentById:async n=>(await Ae.get(`/construction-payments/${n}`)).data,createConstructionPayment:async n=>(await Ae.post("/construction-payments",n)).data,updateConstructionPayment:async(n,e)=>(await Ae.put(`/construction-payments/${n}`,e)).data,deleteConstructionPayment:async n=>{await Ae.delete(`/construction-payments/${n}`)}};function Wi(n){return{id:n.id,project_id:n.projectId,project_name:n.projectName||"",author:n.author||"",date:n.date||"",process:n.process||"",item_name:n.itemName||"",material_cost:n.materialCost||0,labor_cost:n.laborCost||0,vat_amount:n.vatAmount||0,total_amount:n.totalAmount||0,notes:n.notes||"",images:n.images||[],payment_id:n.paymentId,includes_tax_deduction:n.includesTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,created_at:n.createdAt||"",updated_at:n.updatedAt||""}}function Ch(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.project_name!==void 0&&(e.projectName=n.project_name),n.projectName!==void 0&&(e.projectName=n.projectName),n.author!==void 0&&(e.author=n.author),n.date!==void 0&&(e.date=n.date),n.process!==void 0&&(e.process=n.process),n.item_name!==void 0&&(e.itemName=n.item_name),n.itemName!==void 0&&(e.itemName=n.itemName),n.material_cost!==void 0&&(e.materialCost=n.material_cost),n.materialCost!==void 0&&(e.materialCost=n.materialCost),n.labor_cost!==void 0&&(e.laborCost=n.labor_cost),n.laborCost!==void 0&&(e.laborCost=n.laborCost),n.vat_amount!==void 0&&(e.vatAmount=n.vat_amount),n.vatAmount!==void 0&&(e.vatAmount=n.vatAmount),n.total_amount!==void 0&&(e.totalAmount=n.total_amount),n.totalAmount!==void 0&&(e.totalAmount=n.totalAmount),n.notes!==void 0&&(e.notes=n.notes),n.images!==void 0&&(e.images=n.images),n.payment_id!==void 0&&(e.paymentId=n.payment_id),n.paymentId!==void 0&&(e.paymentId=n.paymentId),n.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=n.includes_tax_deduction===!0||n.includes_tax_deduction===1),n.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=n.includesTaxDeduction),n.includes_vat!==void 0&&(e.includesVAT=n.includes_vat===!0||n.includes_vat===1),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),e}const Js={getAllRecords:async()=>{const n=ns(St,Bt.EXECUTION_RECORDS),e=er(n,Br("id","desc"));return(await Hs(e)).docs.map(s=>{const r=s.data();return Wi({...r,id:parseInt(s.id)||r.id})})},getRecordById:async n=>{const e=Rn(St,Bt.EXECUTION_RECORDS,n),t=await Wd(e);if(t.exists()){const s=t.data();return Wi({...s,id:parseInt(t.id)||s.id})}return null},createRecord:async n=>{var m;const e=ns(St,Bt.EXECUTION_RECORDS),t=await Hs(e);let s=0;t.docs.forEach(d=>{const f=parseInt(d.id);!isNaN(f)&&f>s&&(s=f)});const r=s+1,i=Ch(n),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,projectName:i.projectName||"",author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:i.images||[],imageCount:((m=i.images)==null?void 0:m.length)||0},u=Rn(St,Bt.EXECUTION_RECORDS,String(r));return await Gd(u,l),Wi(l)},updateRecord:async(n,e)=>{const t=Rn(St,Bt.EXECUTION_RECORDS,n),s=Ch(e);await no(t,{...s,updatedAt:new Date().toISOString()});const r=await Js.getRecordById(n);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async n=>{const e=Rn(St,Bt.EXECUTION_RECORDS,n);await Qd(e)},subscribeToRecords:n=>{const e=ns(St,Bt.EXECUTION_RECORDS),t=er(e,Br("id","desc"));return hc(t,s=>{const r=s.docs.map(i=>{const o=i.data();return Wi({...o,id:parseInt(i.id)||o.id})});n(r)})},getRecordsByProject:async n=>{const e=ns(St,Bt.EXECUTION_RECORDS),t=er(e,Im("projectId","==",n),Br("id","desc"));return(await Hs(t)).docs.map(r=>{const i=r.data();return Wi({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async n=>{const e=ns(St,Bt.EXECUTION_RECORDS),t=er(e,Im("paymentId","==",n)),s=await Hs(t);if(s.empty)return null;const r=s.docs[0],i=r.data();return Wi({...i,id:parseInt(r.id)||i.id})}},Ko={getAllRecords:async()=>(await Ae.get("/execution-records")).data,getRecordById:async n=>(await Ae.get(`/execution-records/${n}`)).data,createRecord:async n=>(console.log("[executionRecordService.createRecord] Creating:",n),(await Ae.post("/execution-records",n)).data),updateRecord:async(n,e)=>(await Ae.put(`/execution-records/${n}`,e)).data,deleteRecord:async n=>{await Ae.delete(`/execution-records/${n}`)}},bl={getAllRecords:async()=>Tn()?(console.log("[executionRecordService] Using Firestore"),Js.getAllRecords()):(console.log("[executionRecordService] Using Railway API"),Ko.getAllRecords()),getRecordById:async n=>{if(Tn()){const e=await Js.getRecordById(n);if(!e)throw new Error("Execution record not found");return e}return Ko.getRecordById(n)},createRecord:async n=>Tn()?Js.createRecord(n):Ko.createRecord(n),updateRecord:async(n,e)=>Tn()?Js.updateRecord(n,e):Ko.updateRecord(n,e),deleteRecord:async n=>Tn()?Js.deleteRecord(n):Ko.deleteRecord(n),subscribeToRecords:Js.subscribeToRecords,getRecordsByProject:Js.getRecordsByProject,getRecordByPaymentId:Js.getRecordByPaymentId},Or=Um()(Gg((n,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>n({projects:t}),addProject:t=>n(s=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...s.projects],constructionPayments:[r,...s.constructionPayments]}}),updateProject:(t,s)=>n(r=>({projects:r.projects.map(i=>i.id===t?{...i,...s}:i)})),deleteProject:t=>n(s=>({projects:s.projects.filter(r=>r.id!==t),constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>n({schedules:t}),addSchedule:t=>n(s=>({schedules:[t,...s.schedules]})),updateSchedule:(t,s)=>n(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...s}:i)})),deleteSchedule:t=>n(s=>({schedules:s.schedules.filter(r=>r.id!==t)})),setPayments:t=>n({payments:t}),addPayment:t=>n(s=>({payments:[t,...s.payments]})),updatePayment:(t,s)=>n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)})),deletePayment:t=>n(s=>({payments:s.payments.filter(r=>r.id!==t)})),setContractors:t=>n({contractors:t}),addContractor:t=>n(s=>({contractors:[t,...s.contractors]})),updateContractor:(t,s)=>n(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...s}:i)})),deleteContractor:t=>n(s=>({contractors:s.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>n({constructionPayments:t}),addConstructionPayment:t=>n(s=>({constructionPayments:[t,...s.constructionPayments]})),updateConstructionPayment:(t,s)=>n(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...s}:i)})),deleteConstructionPayment:t=>n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>n({asRequests:t}),addASRequest:t=>n(s=>({asRequests:[t,...s.asRequests]})),updateASRequest:(t,s)=>n(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...s}:i)})),deleteASRequest:t=>n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>n({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),n(s=>{const r=[t,...s.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,s)=>n(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...s}:i)})),deleteExecutionRecord:t=>n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await vs.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const s=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));s.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(s.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",s.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return console.log("[loadPaymentsFromAPI]   -  :",d.id),!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(I=>I.id)),f=s.filter(I=>!d.has(I.id)),y=[...m.map(I=>({...I,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),n({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),n({payments:s})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const s=`temp_${Date.now()}`,r={...t,id:s,_addedAt:Date.now(),_tempId:s};n(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",s);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await vs.createPayment(u),d=String(m.id);return n(f=>({payments:f.payments.map(h=>h._tempId===s?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),n(o=>({payments:o.payments.filter(l=>l._tempId!==s)})),i}},updatePaymentInAPI:async(t,s)=>{try{if(s.status&&Object.keys(s).length===1)await vs.updatePaymentStatus(t,s.status);else{let r=s.project;if(s.project){const o=e().projects.find(l=>l.name===s.project);r=o?o.id:s.project}await vs.updatePayment(t,{projectId:r,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,materialAmount:s.materialAmount,laborAmount:s.laborAmount,originalMaterialAmount:s.originalMaterialAmount,originalLaborAmount:s.originalLaborAmount,category:s.category,urgency:s.urgency,bankInfo:s.bankInfo,notes:s.notes,requestDate:s.requestDate,includesVAT:s.includesVAT,applyTaxDeduction:s.applyTaxDeduction})}n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await vs.deletePayment(t),n(s=>({payments:s.payments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete payment from API:",s),s}},loadSchedulesFromAPI:async()=>{try{const t=await gl.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const s=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});s.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),n({schedules:s})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const s=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:s};n(l=>({schedules:[...l.schedules,r]}));try{const l=await gl.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};n(f=>({schedules:f.schedules.map(h=>h.id===s?d:h)}))}catch(l){throw console.error("Failed to add schedule to API:",l),n(u=>({schedules:u.schedules.filter(m=>m.id!==s)})),l}},updateScheduleInAPI:async(t,s)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:s});const l={};s.project!==void 0&&(l.project=s.project),s.title!==void 0&&(l.title=s.title),s.type!==void 0&&(l.type=s.type),s.start!==void 0&&(l.startDate=s.start),s.end!==void 0&&(l.endDate=s.end),s.location!==void 0&&(l.location=s.location),s.description!==void 0&&(l.description=s.description),s.attendees!==void 0&&(l.assignedTo=s.attendees),s.time!==void 0&&(l.time=s.time),console.log(" Sending update data:",l);const u=await gl.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};n(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:s}=e(),r=s.find(o=>o.id===t);if(r){n(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await gl.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&n(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const s=(await so.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});n({projects:s})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var s,r;try{const i=await so.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:i.manager||"",team:[],description:i.description||"",meetingNotes:((s=i.meetingNotes)==null?void 0:s.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};n(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,s)=>{var r,i;try{const o=await so.updateProject(t,s),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};n(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await so.deleteProject(t),n(s=>({projects:s.projects.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete project from API:",s),s}},loadContractorsFromAPI:async()=>{try{const s=(await tr.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));n({contractors:s})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const s=await tr.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:s._id,rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)};n(i=>({contractors:[r,...i.contractors]}))}catch(s){throw console.error("Failed to add contractor to API:",s),s}},updateContractorInAPI:async(t,s)=>{try{const r=await tr.updateContractor(t,{rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};n(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await tr.deleteContractor(t),n(s=>({contractors:s.contractors.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete contractor from API:",s),s}},loadConstructionPaymentsFromAPI:async()=>{try{const s=(await yl.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});n({constructionPayments:s})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var s;try{const r=await yl.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((s=r.payments)==null?void 0:s.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};n(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,s)=>{var r;try{const i=await yl.updateConstructionPayment(t,s);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};n(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await yl.deleteConstructionPayment(t),n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete construction payment from API:",s),s}},loadASRequestsFromAPI:async()=>{try{const s=(await ia.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));n({asRequests:s})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const s=await ia.createASRequest(t),r={id:s._id,project:s.project,client:s.client,requestDate:new Date(s.requestDate),siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,scheduledVisitDate:s.scheduledVisitDate?new Date(s.scheduledVisitDate):void 0,scheduledVisitTime:s.scheduledVisitTime,assignedTo:Array.isArray(s.assignedTo)?s.assignedTo:[],completionDate:s.completionDate?new Date(s.completionDate):void 0,notes:s.notes};return n(i=>({asRequests:[r,...i.asRequests]})),r}catch(s){throw console.error("Failed to add AS request to API:",s),s}},updateASRequestInAPI:async(t,s)=>{try{const r=await ia.updateASRequest(t,s),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};n(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await ia.deleteASRequest(t),n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete AS request from API:",s),s}},loadExecutionRecordsFromAPI:async()=>{try{const t=await bl.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const s=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));n({executionRecords:s})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const s=await bl.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(s.id),project:s.project_name,author:s.author||void 0,date:new Date(s.date),process:s.process||void 0,itemName:s.item_name,materialCost:s.material_cost||0,laborCost:s.labor_cost||0,vatAmount:s.vat_amount||0,totalAmount:s.total_amount||0,notes:s.notes||void 0,paymentId:s.payment_id?String(s.payment_id):void 0,includesTaxDeduction:s.includes_tax_deduction===1,includesVat:s.includes_vat===1,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",s.includes_vat),n(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(s){throw console.error("Failed to add execution record to API:",s),s}},updateExecutionRecordInAPI:async(t,s)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",s);try{let r;if(s.date){const i=s.date instanceof Date?s.date:new Date(s.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:s.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat),await bl.updateRecord(t,{project_name:s.project,author:s.author,date:r,process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,images:s.images,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),n(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...s,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await bl.deleteRecord(t),n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete execution record from API:",s),s}}}),{name:"interior-management-storage",partialize:n=>({...n,payments:n.payments.map(e=>{const{images:t,...s}=e;return s}),executionRecords:n.executionRecords.map(e=>{const{images:t,...s}=e;return s})}),storage:{getItem:n=>{var u,m,d,f,h,y,I;const e=localStorage.getItem(n);if(!e)return null;const{state:t}=JSON.parse(e),s=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var w;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((w=v.payments)==null?void 0:w.map(R=>({...R,date:new Date(R.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=s.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:s,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((h=t.contractors)==null?void 0:h.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((y=t.asRequests)==null?void 0:y.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((I=t.executionRecords)==null?void 0:I.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(n,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(n,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:n=>localStorage.removeItem(n)}}));var Ya=n=>n.type==="checkbox",pi=n=>n instanceof Date,Kn=n=>n==null;const BN=n=>typeof n=="object";var xn=n=>!Kn(n)&&!Array.isArray(n)&&BN(n)&&!pi(n),J1=n=>xn(n)&&n.target?Ya(n.target)?n.target.checked:n.target.value:n,Z1=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,eC=(n,e)=>n.has(Z1(e)),tC=n=>{const e=n.constructor&&n.constructor.prototype;return xn(e)&&e.hasOwnProperty("isPrototypeOf")},Yd=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function wn(n){let e;const t=Array.isArray(n),s=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(Yd&&(n instanceof Blob||s))&&(t||xn(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!tC(n))e=n;else for(const r in n)n.hasOwnProperty(r)&&(e[r]=wn(n[r]));else return n;return e}var tu=n=>/^\w*$/.test(n),hn=n=>n===void 0,Xd=n=>Array.isArray(n)?n.filter(Boolean):[],Jd=n=>Xd(n.replace(/["|']|\]/g,"").split(/\.|\[/)),Le=(n,e,t)=>{if(!e||!xn(n))return t;const s=(tu(e)?[e]:Jd(e)).reduce((r,i)=>Kn(r)?r:r[i],n);return hn(s)||s===n?hn(n[e])?t:n[e]:s},js=n=>typeof n=="boolean",Jt=(n,e,t)=>{let s=-1;const r=tu(e)?[e]:Jd(e),i=r.length,o=i-1;for(;++s<i;){const l=r[s];let u=t;if(s!==o){const m=n[l];u=xn(m)||Array.isArray(m)?m:isNaN(+r[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=u,n=n[l]}};const wh={BLUR:"blur",FOCUS_OUT:"focusout"},_s={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ys={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},nC=ot.createContext(null);nC.displayName="HookFormContext";var sC=(n,e,t,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in n)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==_s.all&&(e._proxyFormState[o]=!s||_s.all),n[o]}});return r};const rC=typeof window<"u"?ot.useLayoutEffect:ot.useEffect;var os=n=>typeof n=="string",iC=(n,e,t,s,r)=>os(n)?(s&&e.watch.add(n),Le(t,n,r)):Array.isArray(n)?n.map(i=>(s&&e.watch.add(i),Le(t,i))):(s&&(e.watchAll=!0),t),Tm=n=>Kn(n)||!BN(n);function Cr(n,e,t=new WeakSet){if(Tm(n)||Tm(e))return n===e;if(pi(n)&&pi(e))return n.getTime()===e.getTime();const s=Object.keys(n),r=Object.keys(e);if(s.length!==r.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const i of s){const o=n[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(pi(o)&&pi(l)||xn(o)&&xn(l)||Array.isArray(o)&&Array.isArray(l)?!Cr(o,l,t):o!==l)return!1}}return!0}var oC=(n,e,t,s,r)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[s]:r||!0}}:{},ga=n=>Array.isArray(n)?n:[n],Ih=()=>{let n=[];return{get observers(){return n},next:r=>{for(const i of n)i.next&&i.next(r)},subscribe:r=>(n.push(r),{unsubscribe:()=>{n=n.filter(i=>i!==r)}}),unsubscribe:()=>{n=[]}}};function UN(n,e){const t={};for(const s in n)if(n.hasOwnProperty(s)){const r=n[s],i=e[s];if(r&&xn(r)&&i){const o=UN(r,i);xn(o)&&(t[s]=o)}else n[s]&&(t[s]=i)}return t}var es=n=>xn(n)&&!Object.keys(n).length,Zd=n=>n.type==="file",Ds=n=>typeof n=="function",Nc=n=>{if(!Yd)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},HN=n=>n.type==="select-multiple",ef=n=>n.type==="radio",aC=n=>ef(n)||Ya(n),Bu=n=>Nc(n)&&n.isConnected;function lC(n,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)n=hn(n)?s++:n[e[s++]];return n}function cC(n){for(const e in n)if(n.hasOwnProperty(e)&&!hn(n[e]))return!1;return!0}function fn(n,e){const t=Array.isArray(e)?e:tu(e)?[e]:Jd(e),s=t.length===1?n:lC(n,t),r=t.length-1,i=t[r];return s&&delete s[i],r!==0&&(xn(s)&&es(s)||Array.isArray(s)&&cC(s))&&fn(n,t.slice(0,-1)),n}var uC=n=>{for(const e in n)if(Ds(n[e]))return!0;return!1};function MN(n){return Array.isArray(n)||xn(n)&&!uC(n)}function Sm(n,e={}){for(const t in n)MN(n[t])?(e[t]=Array.isArray(n[t])?[]:{},Sm(n[t],e[t])):Kn(n[t])||(e[t]=!0);return e}function to(n,e,t){t||(t=Sm(e));for(const s in n)MN(n[s])?hn(e)||Tm(t[s])?t[s]=Sm(n[s],Array.isArray(n[s])?[]:{}):to(n[s],Kn(e)?{}:e[s],t[s]):t[s]=!Cr(n[s],e[s]);return t}const Th={value:!1,isValid:!1},Sh={value:!0,isValid:!0};var FN=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!hn(n[0].attributes.value)?hn(n[0].value)||n[0].value===""?Sh:{value:n[0].value,isValid:!0}:Sh:Th}return Th},ON=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>hn(n)?n:e?n===""?NaN:n&&+n:t&&os(n)?new Date(n):s?s(n):n;const Ph={isValid:!1,value:null};var qN=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Ph):Ph;function Lh(n){const e=n.ref;return Zd(e)?e.files:ef(e)?qN(n.refs).value:HN(e)?[...e.selectedOptions].map(({value:t})=>t):Ya(e)?FN(n.refs).value:ON(hn(e.value)?n.ref.value:e.value,n)}var mC=(n,e,t,s)=>{const r={};for(const i of n){const o=Le(e,i);o&&Jt(r,i,o._f)}return{criteriaMode:t,names:[...n],fields:r,shouldUseNativeValidation:s}},xc=n=>n instanceof RegExp,Go=n=>hn(n)?n:xc(n)?n.source:xn(n)?xc(n.value)?n.value.source:n.value:n,jh=n=>({isOnSubmit:!n||n===_s.onSubmit,isOnBlur:n===_s.onBlur,isOnChange:n===_s.onChange,isOnAll:n===_s.all,isOnTouch:n===_s.onTouched});const Rh="AsyncFunction";var dC=n=>!!n&&!!n.validate&&!!(Ds(n.validate)&&n.validate.constructor.name===Rh||xn(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===Rh)),fC=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),Bh=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(s=>n.startsWith(s)&&/^\.\w+/.test(n.slice(s.length))));const ya=(n,e,t,s)=>{for(const r of t||Object.keys(n)){const i=Le(n,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(ya(l,e))break}else if(xn(l)&&ya(l,e))break}}};function Uh(n,e,t){const s=Le(n,t);if(s||tu(t))return{error:s,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Le(e,i),l=Le(n,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var pC=(n,e,t,s)=>{t(n);const{name:r,...i}=n;return es(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||_s.all))},hC=(n,e,t)=>!n||!e||n===e||ga(n).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),gC=(n,e,t,s,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||n):(t?s.isOnBlur:r.isOnBlur)?!n:(t?s.isOnChange:r.isOnChange)?n:!0,yC=(n,e)=>!Xd(Le(n,e)).length&&fn(n,e),bC=(n,e,t)=>{const s=ga(Le(n,t));return Jt(s,"root",e[t]),Jt(n,t,s),n};function Hh(n,e,t="validate"){if(os(n)||Array.isArray(n)&&n.every(os)||js(n)&&!n)return{type:t,message:os(n)?n:"",ref:e}}var Ki=n=>xn(n)&&!xc(n)?n:{value:n,message:""},Mh=async(n,e,t,s,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:h,pattern:y,validate:I,name:v,valueAsNumber:w,mount:R}=n._f,P=Le(t,v);if(!R||e.has(v))return{};const F=l?l[0]:o,re=T=>{r&&F.reportValidity&&(F.setCustomValidity(js(T)?"":T||""),F.reportValidity())},Z={},M=ef(o),A=Ya(o),N=M||A,C=(w||Zd(o))&&hn(o.value)&&hn(P)||Nc(o)&&o.value===""||P===""||Array.isArray(P)&&!P.length,j=oC.bind(null,v,s,Z),S=(T,E,De,He=Ys.maxLength,fe=Ys.minLength)=>{const je=T?E:De;Z[v]={type:T?He:fe,message:je,ref:o,...j(T?He:fe,je)}};if(i?!Array.isArray(P)||!P.length:u&&(!N&&(C||Kn(P))||js(P)&&!P||A&&!FN(l).isValid||M&&!qN(l).isValid)){const{value:T,message:E}=os(u)?{value:!!u,message:u}:Ki(u);if(T&&(Z[v]={type:Ys.required,message:E,ref:F,...j(Ys.required,E)},!s))return re(E),Z}if(!C&&(!Kn(f)||!Kn(h))){let T,E;const De=Ki(h),He=Ki(f);if(!Kn(P)&&!isNaN(P)){const fe=o.valueAsNumber||P&&+P;Kn(De.value)||(T=fe>De.value),Kn(He.value)||(E=fe<He.value)}else{const fe=o.valueAsDate||new Date(P),je=Rt=>new Date(new Date().toDateString()+" "+Rt),ut=o.type=="time",Ft=o.type=="week";os(De.value)&&P&&(T=ut?je(P)>je(De.value):Ft?P>De.value:fe>new Date(De.value)),os(He.value)&&P&&(E=ut?je(P)<je(He.value):Ft?P<He.value:fe<new Date(He.value))}if((T||E)&&(S(!!T,De.message,He.message,Ys.max,Ys.min),!s))return re(Z[v].message),Z}if((m||d)&&!C&&(os(P)||i&&Array.isArray(P))){const T=Ki(m),E=Ki(d),De=!Kn(T.value)&&P.length>+T.value,He=!Kn(E.value)&&P.length<+E.value;if((De||He)&&(S(De,T.message,E.message),!s))return re(Z[v].message),Z}if(y&&!C&&os(P)){const{value:T,message:E}=Ki(y);if(xc(T)&&!P.match(T)&&(Z[v]={type:Ys.pattern,message:E,ref:o,...j(Ys.pattern,E)},!s))return re(E),Z}if(I){if(Ds(I)){const T=await I(P,t),E=Hh(T,F);if(E&&(Z[v]={...E,...j(Ys.validate,E.message)},!s))return re(E.message),Z}else if(xn(I)){let T={};for(const E in I){if(!es(T)&&!s)break;const De=Hh(await I[E](P,t),F,E);De&&(T={...De,...j(E,De.message)},re(De.message),s&&(Z[v]=T))}if(!es(T)&&(Z[v]={ref:F,...T},!s))return Z}}return re(!0),Z};const NC={mode:_s.onSubmit,reValidateMode:_s.onChange,shouldFocusError:!0};function xC(n={}){let e={...NC,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ds(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=xn(e.defaultValues)||xn(e.values)?wn(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:wn(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:Ih(),state:Ih()},y=e.criteriaMode===_s.all,I=L=>q=>{clearTimeout(m),m=setTimeout(L,q)},v=async L=>{if(!e.disabled&&(d.isValid||f.isValid||L)){const q=e.resolver?es((await A()).errors):await C(s,!0);q!==t.isValid&&h.state.next({isValid:q})}},w=(L,q)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((L||Array.from(l.mount)).forEach(ee=>{ee&&(q?Jt(t.validatingFields,ee,q):fn(t.validatingFields,ee))}),h.state.next({validatingFields:t.validatingFields,isValidating:!es(t.validatingFields)}))},R=(L,q=[],ee,ye,ce=!0,me=!0)=>{if(ye&&ee&&!e.disabled){if(o.action=!0,me&&Array.isArray(Le(s,L))){const Ce=ee(Le(s,L),ye.argA,ye.argB);ce&&Jt(s,L,Ce)}if(me&&Array.isArray(Le(t.errors,L))){const Ce=ee(Le(t.errors,L),ye.argA,ye.argB);ce&&Jt(t.errors,L,Ce),yC(t.errors,L)}if((d.touchedFields||f.touchedFields)&&me&&Array.isArray(Le(t.touchedFields,L))){const Ce=ee(Le(t.touchedFields,L),ye.argA,ye.argB);ce&&Jt(t.touchedFields,L,Ce)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=to(r,i)),h.state.next({name:L,isDirty:S(L,q),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else Jt(i,L,q)},P=(L,q)=>{Jt(t.errors,L,q),h.state.next({errors:t.errors})},F=L=>{t.errors=L,h.state.next({errors:t.errors,isValid:!1})},re=(L,q,ee,ye)=>{const ce=Le(s,L);if(ce){const me=Le(i,L,hn(ee)?Le(r,L):ee);hn(me)||ye&&ye.defaultChecked||q?Jt(i,L,q?me:Lh(ce._f)):De(L,me),o.mount&&v()}},Z=(L,q,ee,ye,ce)=>{let me=!1,Ce=!1;const Fe={name:L};if(!e.disabled){if(!ee||ye){(d.isDirty||f.isDirty)&&(Ce=t.isDirty,t.isDirty=Fe.isDirty=S(),me=Ce!==Fe.isDirty);const Ze=Cr(Le(r,L),q);Ce=!!Le(t.dirtyFields,L),Ze?fn(t.dirtyFields,L):Jt(t.dirtyFields,L,!0),Fe.dirtyFields=t.dirtyFields,me=me||(d.dirtyFields||f.dirtyFields)&&Ce!==!Ze}if(ee){const Ze=Le(t.touchedFields,L);Ze||(Jt(t.touchedFields,L,ee),Fe.touchedFields=t.touchedFields,me=me||(d.touchedFields||f.touchedFields)&&Ze!==ee)}me&&ce&&h.state.next(Fe)}return me?Fe:{}},M=(L,q,ee,ye)=>{const ce=Le(t.errors,L),me=(d.isValid||f.isValid)&&js(q)&&t.isValid!==q;if(e.delayError&&ee?(u=I(()=>P(L,ee)),u(e.delayError)):(clearTimeout(m),u=null,ee?Jt(t.errors,L,ee):fn(t.errors,L)),(ee?!Cr(ce,ee):ce)||!es(ye)||me){const Ce={...ye,...me&&js(q)?{isValid:q}:{},errors:t.errors,name:L};t={...t,...Ce},h.state.next(Ce)}},A=async L=>{w(L,!0);const q=await e.resolver(i,e.context,mC(L||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return w(L),q},N=async L=>{const{errors:q}=await A(L);if(L)for(const ee of L){const ye=Le(q,ee);ye?Jt(t.errors,ee,ye):fn(t.errors,ee)}else t.errors=q;return q},C=async(L,q,ee={valid:!0})=>{for(const ye in L){const ce=L[ye];if(ce){const{_f:me,...Ce}=ce;if(me){const Fe=l.array.has(me.name),Ze=ce._f&&dC(ce._f);Ze&&d.validatingFields&&w([me.name],!0);const Ee=await Mh(ce,l.disabled,i,y,e.shouldUseNativeValidation&&!q,Fe);if(Ze&&d.validatingFields&&w([me.name]),Ee[me.name]&&(ee.valid=!1,q))break;!q&&(Le(Ee,me.name)?Fe?bC(t.errors,Ee,me.name):Jt(t.errors,me.name,Ee[me.name]):fn(t.errors,me.name))}!es(Ce)&&await C(Ce,q,ee)}}return ee.valid},j=()=>{for(const L of l.unMount){const q=Le(s,L);q&&(q._f.refs?q._f.refs.every(ee=>!Bu(ee)):!Bu(q._f.ref))&&st(L)}l.unMount=new Set},S=(L,q)=>!e.disabled&&(L&&q&&Jt(i,L,q),!Cr(Rt(),r)),T=(L,q,ee)=>iC(L,l,{...o.mount?i:hn(q)?r:os(L)?{[L]:q}:q},ee,q),E=L=>Xd(Le(o.mount?i:r,L,e.shouldUnregister?Le(r,L,[]):[])),De=(L,q,ee={})=>{const ye=Le(s,L);let ce=q;if(ye){const me=ye._f;me&&(!me.disabled&&Jt(i,L,ON(q,me)),ce=Nc(me.ref)&&Kn(q)?"":q,HN(me.ref)?[...me.ref.options].forEach(Ce=>Ce.selected=ce.includes(Ce.value)):me.refs?Ya(me.ref)?me.refs.forEach(Ce=>{(!Ce.defaultChecked||!Ce.disabled)&&(Array.isArray(ce)?Ce.checked=!!ce.find(Fe=>Fe===Ce.value):Ce.checked=ce===Ce.value||!!ce)}):me.refs.forEach(Ce=>Ce.checked=Ce.value===ce):Zd(me.ref)?me.ref.value="":(me.ref.value=ce,me.ref.type||h.state.next({name:L,values:wn(i)})))}(ee.shouldDirty||ee.shouldTouch)&&Z(L,ce,ee.shouldTouch,ee.shouldDirty,!0),ee.shouldValidate&&Ft(L)},He=(L,q,ee)=>{for(const ye in q){if(!q.hasOwnProperty(ye))return;const ce=q[ye],me=L+"."+ye,Ce=Le(s,me);(l.array.has(L)||xn(ce)||Ce&&!Ce._f)&&!pi(ce)?He(me,ce,ee):De(me,ce,ee)}},fe=(L,q,ee={})=>{const ye=Le(s,L),ce=l.array.has(L),me=wn(q);Jt(i,L,me),ce?(h.array.next({name:L,values:wn(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&ee.shouldDirty&&h.state.next({name:L,dirtyFields:to(r,i),isDirty:S(L,me)})):ye&&!ye._f&&!Kn(me)?He(L,me,ee):De(L,me,ee),Bh(L,l)&&h.state.next({...t,name:L}),h.state.next({name:o.mount?L:void 0,values:wn(i)})},je=async L=>{o.mount=!0;const q=L.target;let ee=q.name,ye=!0;const ce=Le(s,ee),me=Ze=>{ye=Number.isNaN(Ze)||pi(Ze)&&isNaN(Ze.getTime())||Cr(Ze,Le(i,ee,Ze))},Ce=jh(e.mode),Fe=jh(e.reValidateMode);if(ce){let Ze,Ee;const Sn=q.type?Lh(ce._f):J1(L),jt=L.type===wh.BLUR||L.type===wh.FOCUS_OUT,te=!fC(ce._f)&&!e.resolver&&!Le(t.errors,ee)&&!ce._f.deps||gC(jt,Le(t.touchedFields,ee),t.isSubmitted,Fe,Ce),Ye=Bh(ee,l,jt);Jt(i,ee,Sn),jt?(!q||!q.readOnly)&&(ce._f.onBlur&&ce._f.onBlur(L),u&&u(0)):ce._f.onChange&&ce._f.onChange(L);const O=Z(ee,Sn,jt),be=!es(O)||Ye;if(!jt&&h.state.next({name:ee,type:L.type,values:wn(i)}),te)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?jt&&v():jt||v()),be&&h.state.next({name:ee,...Ye?{}:O});if(!jt&&Ye&&h.state.next({...t}),e.resolver){const{errors:ke}=await A([ee]);if(me(Sn),ye){const Se=Uh(t.errors,s,ee),ae=Uh(ke,s,Se.name||ee);Ze=ae.error,ee=ae.name,Ee=es(ke)}}else w([ee],!0),Ze=(await Mh(ce,l.disabled,i,y,e.shouldUseNativeValidation))[ee],w([ee]),me(Sn),ye&&(Ze?Ee=!1:(d.isValid||f.isValid)&&(Ee=await C(s,!0)));ye&&(ce._f.deps&&(!Array.isArray(ce._f.deps)||ce._f.deps.length>0)&&Ft(ce._f.deps),M(ee,Ee,Ze,O))}},ut=(L,q)=>{if(Le(t.errors,q)&&L.focus)return L.focus(),1},Ft=async(L,q={})=>{let ee,ye;const ce=ga(L);if(e.resolver){const me=await N(hn(L)?L:ce);ee=es(me),ye=L?!ce.some(Ce=>Le(me,Ce)):ee}else L?(ye=(await Promise.all(ce.map(async me=>{const Ce=Le(s,me);return await C(Ce&&Ce._f?{[me]:Ce}:Ce)}))).every(Boolean),!(!ye&&!t.isValid)&&v()):ye=ee=await C(s);return h.state.next({...!os(L)||(d.isValid||f.isValid)&&ee!==t.isValid?{}:{name:L},...e.resolver||!L?{isValid:ee}:{},errors:t.errors}),q.shouldFocus&&!ye&&ya(s,ut,L?ce:l.mount),ye},Rt=(L,q)=>{let ee={...o.mount?i:r};return q&&(ee=UN(q.dirtyFields?t.dirtyFields:t.touchedFields,ee)),hn(L)?ee:os(L)?Le(ee,L):L.map(ye=>Le(ee,ye))},oe=(L,q)=>({invalid:!!Le((q||t).errors,L),isDirty:!!Le((q||t).dirtyFields,L),error:Le((q||t).errors,L),isValidating:!!Le(t.validatingFields,L),isTouched:!!Le((q||t).touchedFields,L)}),Me=L=>{L&&ga(L).forEach(q=>fn(t.errors,q)),h.state.next({errors:L?t.errors:{}})},ue=(L,q,ee)=>{const ye=(Le(s,L,{_f:{}})._f||{}).ref,ce=Le(t.errors,L)||{},{ref:me,message:Ce,type:Fe,...Ze}=ce;Jt(t.errors,L,{...Ze,...q,ref:ye}),h.state.next({name:L,errors:t.errors,isValid:!1}),ee&&ee.shouldFocus&&ye&&ye.focus&&ye.focus()},Pe=(L,q)=>Ds(L)?h.state.subscribe({next:ee=>"values"in ee&&L(T(void 0,q),ee)}):T(L,q,!0),We=L=>h.state.subscribe({next:q=>{hC(L.name,q.name,L.exact)&&pC(q,L.formState||d,Ct,L.reRenderRoot)&&L.callback({values:{...i},...t,...q,defaultValues:r})}}).unsubscribe,bt=L=>(o.mount=!0,f={...f,...L.formState},We({...L,formState:f})),st=(L,q={})=>{for(const ee of L?ga(L):l.mount)l.mount.delete(ee),l.array.delete(ee),q.keepValue||(fn(s,ee),fn(i,ee)),!q.keepError&&fn(t.errors,ee),!q.keepDirty&&fn(t.dirtyFields,ee),!q.keepTouched&&fn(t.touchedFields,ee),!q.keepIsValidating&&fn(t.validatingFields,ee),!e.shouldUnregister&&!q.keepDefaultValue&&fn(r,ee);h.state.next({values:wn(i)}),h.state.next({...t,...q.keepDirty?{isDirty:S()}:{}}),!q.keepIsValid&&v()},At=({disabled:L,name:q})=>{(js(L)&&o.mount||L||l.disabled.has(q))&&(L?l.disabled.add(q):l.disabled.delete(q))},nt=(L,q={})=>{let ee=Le(s,L);const ye=js(q.disabled)||js(e.disabled);return Jt(s,L,{...ee||{},_f:{...ee&&ee._f?ee._f:{ref:{name:L}},name:L,mount:!0,...q}}),l.mount.add(L),ee?At({disabled:js(q.disabled)?q.disabled:e.disabled,name:L}):re(L,!0,q.value),{...ye?{disabled:q.disabled||e.disabled}:{},...e.progressive?{required:!!q.required,min:Go(q.min),max:Go(q.max),minLength:Go(q.minLength),maxLength:Go(q.maxLength),pattern:Go(q.pattern)}:{},name:L,onChange:je,onBlur:je,ref:ce=>{if(ce){nt(L,q),ee=Le(s,L);const me=hn(ce.value)&&ce.querySelectorAll&&ce.querySelectorAll("input,select,textarea")[0]||ce,Ce=aC(me),Fe=ee._f.refs||[];if(Ce?Fe.find(Ze=>Ze===me):me===ee._f.ref)return;Jt(s,L,{_f:{...ee._f,...Ce?{refs:[...Fe.filter(Bu),me,...Array.isArray(Le(r,L))?[{}]:[]],ref:{type:me.type,name:L}}:{ref:me}}}),re(L,!1,void 0,me)}else ee=Le(s,L,{}),ee._f&&(ee._f.mount=!1),(e.shouldUnregister||q.shouldUnregister)&&!(eC(l.array,L)&&o.action)&&l.unMount.add(L)}}},lt=()=>e.shouldFocusError&&ya(s,ut,l.mount),an=L=>{js(L)&&(h.state.next({disabled:L}),ya(s,(q,ee)=>{const ye=Le(s,ee);ye&&(q.disabled=ye._f.disabled||L,Array.isArray(ye._f.refs)&&ye._f.refs.forEach(ce=>{ce.disabled=ye._f.disabled||L}))},0,!1))},G=(L,q)=>async ee=>{let ye;ee&&(ee.preventDefault&&ee.preventDefault(),ee.persist&&ee.persist());let ce=wn(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:me,values:Ce}=await A();t.errors=me,ce=wn(Ce)}else await C(s);if(l.disabled.size)for(const me of l.disabled)fn(ce,me);if(fn(t.errors,"root"),es(t.errors)){h.state.next({errors:{}});try{await L(ce,ee)}catch(me){ye=me}}else q&&await q({...t.errors},ee),lt(),setTimeout(lt);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:es(t.errors)&&!ye,submitCount:t.submitCount+1,errors:t.errors}),ye)throw ye},Te=(L,q={})=>{Le(s,L)&&(hn(q.defaultValue)?fe(L,wn(Le(r,L))):(fe(L,q.defaultValue),Jt(r,L,wn(q.defaultValue))),q.keepTouched||fn(t.touchedFields,L),q.keepDirty||(fn(t.dirtyFields,L),t.isDirty=q.defaultValue?S(L,wn(Le(r,L))):S()),q.keepError||(fn(t.errors,L),d.isValid&&v()),h.state.next({...t}))},Re=(L,q={})=>{const ee=L?wn(L):r,ye=wn(ee),ce=es(L),me=ce?r:ye;if(q.keepDefaultValues||(r=ee),!q.keepValues){if(q.keepDirtyValues){const Ce=new Set([...l.mount,...Object.keys(to(r,i))]);for(const Fe of Array.from(Ce))Le(t.dirtyFields,Fe)?Jt(me,Fe,Le(i,Fe)):fe(Fe,Le(me,Fe))}else{if(Yd&&hn(L))for(const Ce of l.mount){const Fe=Le(s,Ce);if(Fe&&Fe._f){const Ze=Array.isArray(Fe._f.refs)?Fe._f.refs[0]:Fe._f.ref;if(Nc(Ze)){const Ee=Ze.closest("form");if(Ee){Ee.reset();break}}}}if(q.keepFieldsRef)for(const Ce of l.mount)fe(Ce,Le(me,Ce));else s={}}i=e.shouldUnregister?q.keepDefaultValues?wn(r):{}:wn(me),h.array.next({values:{...me}}),h.state.next({values:{...me}})}l={mount:q.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!q.keepIsValid||!!q.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:q.keepSubmitCount?t.submitCount:0,isDirty:ce?!1:q.keepDirty?t.isDirty:!!(q.keepDefaultValues&&!Cr(L,r)),isSubmitted:q.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ce?{}:q.keepDirtyValues?q.keepDefaultValues&&i?to(r,i):t.dirtyFields:q.keepDefaultValues&&L?to(r,L):q.keepDirty?t.dirtyFields:{},touchedFields:q.keepTouched?t.touchedFields:{},errors:q.keepErrors?t.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},we=(L,q)=>Re(Ds(L)?L(i):L,q),Qe=(L,q={})=>{const ee=Le(s,L),ye=ee&&ee._f;if(ye){const ce=ye.refs?ye.refs[0]:ye.ref;ce.focus&&(ce.focus(),q.shouldSelect&&Ds(ce.select)&&ce.select())}},Ct=L=>{t={...t,...L}},at={control:{register:nt,unregister:st,getFieldState:oe,handleSubmit:G,setError:ue,_subscribe:We,_runSchema:A,_focusError:lt,_getWatch:T,_getDirty:S,_setValid:v,_setFieldArray:R,_setDisabledField:At,_setErrors:F,_getFieldArray:E,_reset:Re,_resetDefaultValues:()=>Ds(e.defaultValues)&&e.defaultValues().then(L=>{we(L,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:an,_subjects:h,_proxyFormState:d,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(L){o=L},get _defaultValues(){return r},get _names(){return l},set _names(L){l=L},get _formState(){return t},get _options(){return e},set _options(L){e={...e,...L}}},subscribe:bt,trigger:Ft,register:nt,handleSubmit:G,watch:Pe,setValue:fe,getValues:Rt,reset:we,resetField:Te,clearErrors:Me,unregister:st,setError:ue,setFocus:Qe,getFieldState:oe};return{...at,formControl:at}}function tf(n={}){const e=ot.useRef(void 0),t=ot.useRef(void 0),[s,r]=ot.useState({isDirty:!1,isValidating:!1,isLoading:Ds(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:Ds(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:s},n.defaultValues&&!Ds(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=xC(n);e.current={...l,formState:s}}const i=e.current.control;return i._options=n,rC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),ot.useEffect(()=>i._disableForm(n.disabled),[i,n.disabled]),ot.useEffect(()=>{n.mode&&(i._options.mode=n.mode),n.reValidateMode&&(i._options.reValidateMode=n.reValidateMode)},[i,n.mode,n.reValidateMode]),ot.useEffect(()=>{n.errors&&(i._setErrors(n.errors),i._focusError())},[i,n.errors]),ot.useEffect(()=>{n.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,n.shouldUnregister]),ot.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),ot.useEffect(()=>{n.values&&!Cr(n.values,t.current)?(i._reset(n.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=n.values,r(o=>({...o}))):i._resetDefaultValues()},[i,n.values]),ot.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=sC(s,i),e.current}const Fh=["","","","","","",""],$N=({event:n,slotInfo:e,defaultProjectName:t,onClose:s,onSave:r,onDelete:i})=>{const[o,l]=V.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:h},reset:y}=tf({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:I}=Or(),[v,w]=V.useState([]),[R,P]=V.useState(""),[F,re]=V.useState(!1),[Z,M]=V.useState(""),[A,N]=V.useState(9),[C,j]=V.useState(0),[S,T]=V.useState(""),E=f("projectId");V.useEffect(()=>{if(E){const oe=I.find(Me=>Me.id===E||Me.id===parseInt(E)||Me.id.toString()===E.toString());console.log(" Selected project:",oe==null?void 0:oe.name),console.log(" Project team:",oe==null?void 0:oe.team),console.log(" Current selectedMembers:",v)}},[E,I,v]),V.useEffect(()=>{console.log(" Modal mount - initializing states"),w([]),T(""),P("")},[]),V.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!n,eventId:n==null?void 0:n.id,hasSlotInfo:!!e,hasMergedEvents:!!(n!=null&&n.mergedEventIds)}),n&&n.id){console.log(" ScheduleModal processing event:",{title:n.title,projectId:n.projectId,projectName:n.projectName,start:n.start,assignedTo:n.assignedTo,time:n.time});const oe=n.originalTitle||n.title,Me=/ - (|) \d{1,2}$/,ue=oe.replace(Me,"");if(d("title",ue,{shouldValidate:!1,shouldDirty:!1}),d("date",Ut(n.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",n.description||"",{shouldValidate:!1,shouldDirty:!1}),n.projectId&&n.projectId!==""&&n.projectId!=="undefined")console.log(" Setting projectId from event:",n.projectId),d("projectId",n.projectId,{shouldValidate:!1,shouldDirty:!1}),T("");else if(n.projectName){const We=I.find(bt=>bt.name===n.projectName);console.log(" Finding project by name:",n.projectName,"found:",We),We?(console.log(" Setting projectId from found project:",We.id),d("projectId",We.id,{shouldValidate:!1,shouldDirty:!1}),T("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),T(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),T("");const Pe=n.assignedTo||n.attendees||[];if(console.log(" Setting selectedMembers to:",Pe),w(Array.isArray(Pe)?Pe:[]),n.time&&n.time!=="-"){console.log(" Setting time from event:",{eventTime:n.time,parsedHours:n.time.split(":")[0],parsedMinutes:n.time.split(":")[1]}),re(!0);const[We,bt]=n.time.split(":"),st=parseInt(We,10),At=parseInt(bt,10);st>=12?(M(""),N(st===12?12:st-12)):(M(""),N(st===0?12:st)),j(At),console.log(" Time state set:",{hasTime:!0,period:st>=12?"":"",hour:st>=12?st===12?12:st-12:st===0?12:st,minute:At})}else console.log(" No time in event, setting hasTime to false"),re(!1),M(""),N(9),j(0)}else if(e&&!n&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:Ut(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),w([]),T(""),t)){const oe=I.find(Me=>Me.name===t);oe&&d("projectId",oe.id,{shouldValidate:!1,shouldDirty:!1})}},[n==null?void 0:n.id]);const De=oe=>{console.log(" toggleMember called with:",oe),console.log(" Current selectedMembers before toggle:",v),w(Me=>{console.log(" Previous members in setState:",Me);const ue=Me.includes(oe)?Me.filter(Pe=>Pe!==oe):[...Me,oe];return console.log(" Updated members after toggle:",ue),ue})},He=()=>{const oe="HV LAB";v.includes(oe)?w(Me=>Me.filter(ue=>ue!==oe)):w(Me=>[...Me.filter(ue=>ue!==""),oe])},fe=()=>{const oe="";v.includes(oe)?w(Me=>Me.filter(ue=>ue!==oe)):w(Me=>[...Me,oe])},je=()=>{const oe="";v.includes(oe)?w(Me=>Me.filter(ue=>ue!==oe)):w(Me=>[...Me,oe])},ut=()=>{R.trim()&&!v.includes(R.trim())&&(w(oe=>[...oe,R.trim()]),P(""))},Ft=oe=>{w(Me=>Me.filter(ue=>ue!==oe))},Rt=async oe=>{console.log(" Form onSubmit called with data:",oe),console.log(" selectedMembers:",v),console.log(" hasTime state:",F),console.log(" timePeriod:",Z,"timeHour:",A,"timeMinute:",C),console.log(" Available projects:",I.map(nt=>({id:nt.id,name:nt.name,idType:typeof nt.id}))),console.log(" Merged event IDs:",n==null?void 0:n.mergedEventIds);const Me=/ - (|) \d{1,2}$/,ue=oe.title.replace(Me,"").trim();let Pe="",We="";if(oe.projectId){const nt=I.find(lt=>lt.id===oe.projectId||lt.id===parseInt(oe.projectId)||lt.id.toString()===oe.projectId.toString());console.log(" Looking for project with id:",oe.projectId,"type:",typeof oe.projectId),console.log(" Found project:",nt),Pe=(nt==null?void 0:nt.name)||"",We=oe.projectId}else Pe="",We="";console.log(" Final projectId:",We,"projectName:",Pe,"cleanedTitle:",ue);const bt=new Date(oe.date);let st="-";if(F){let nt=A;Z===""&&A!==12?nt=A+12:Z===""&&A===12&&(nt=0),st=`${nt.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`,console.log(" Time calculated:",st)}else console.log(" No time set (hasTime is false)");const At={...n,title:ue,start:bt,end:bt,projectId:We,projectName:Pe,assignedTo:v,description:oe.description||"",time:st,mergedEventIds:n==null?void 0:n.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",At);try{await r(At),console.log(" onSave completed successfully")}catch(nt){throw console.error(" onSave failed:",nt),nt}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(yn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Rt),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),I.filter(oe=>n!=null&&n.isASVisit?!0:oe.status!=="completed").map(oe=>a.jsxDEV("option",{value:oe.id,children:oe.name},oe.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>re(!F),className:`px-3 py-1.5 text-xs rounded border transition-colors ${F?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),F&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${Z===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${Z===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:A,onChange:oe=>N(parseInt(oe.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(oe=>a.jsxDEV("option",{value:oe,children:[oe,""]},oe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:C,onChange:oe=>j(parseInt(oe.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(oe=>a.jsxDEV("option",{value:oe,children:[oe,""]},oe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:He,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:fe,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:je,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Fh.map(oe=>a.jsxDEV("button",{type:"button",onClick:()=>De(oe),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(oe)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:oe},oe,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(oe=>!Fh.includes(oe)&&oe!=="HV LAB"&&oe!==""&&oe!=="").map(oe=>a.jsxDEV("button",{type:"button",onClick:()=>Ft(oe),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[oe," "]},oe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:oe=>P(oe.target.value),onKeyPress:oe=>{oe.key==="Enter"&&(oe.preventDefault(),ut())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ut,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:n&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(n.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(xi,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:s,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},Pm=n=>{if(!n||n==="-")return"";const[e,t]=n.split(":"),s=parseInt(e,10),r=parseInt(t,10),i=s>=12?"":"",o=s%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},vc=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],ba=n=>{if(!n)return n;const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of vc)if(s===r)return t.slice(0,-1).join(" ").trim()}for(const s of vc)if(e.endsWith(s))return e.substring(0,e.length-s.length).trim()||e;return e},Nl=n=>{const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of vc)if(s===r)return r}for(const s of vc)if(e.endsWith(s))return s;return""},vC=["","","","","","",""],_C=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Uu=["","","/","","","","","","","","","","","","",""],DC={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},kC={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Oh=vC,EC=()=>{const{schedules:n,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:s}=Or(),{user:r}=zr(),[i,o]=V.useState(!1),l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...Oh.filter(d=>d!==l)]:Oh,m=d=>{const f=n.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),h=v=>{const w=new Set;return v.filter(R=>{const F=`${Ut(new Date(R.start),"yyyy-MM-dd")}|${R.project}|${R.title}`;return w.has(F)?!1:(w.add(F),!0)})},y=h(f.filter(v=>Tf(new Date(v.start)))),I=h(f.filter(v=>Vx(new Date(v.start))&&!Tf(new Date(v.start))).sort((v,w)=>new Date(v.start).getTime()-new Date(w.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:I,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=m(d),y=f.length+h.length,I=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${I?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:113,columnNumber:21},void 0),I&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:112,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[I&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV(ro,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${I&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:131,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(cg,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:141,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:142,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:140,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((w,R)=>{const P=R.project||"-";return w[P]||(w[P]=[]),w[P].push(R),w},{});return Object.entries(v).map(([w,R])=>{const P=d===l;return a.jsxDEV("div",{className:`border-l-3 ${P?"border-gray-400":"border-gray-900"} ${P?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${P?"bg-amber-100":"bg-gray-100"} border-b ${P?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:164,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:163,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:R.map(F=>{const re=F.time&&F.time!=="-"?` - ${Pm(F.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",F.title,re]},F.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:31},void 0)]},w,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:159,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:19},void 0),h.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(px,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:188,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:189,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:187,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((w,R)=>{const P=Ut(new Date(R.start),"MM.dd",{locale:gn}),F=R.project||"-",re=`${P}|${F}`;return w[re]||(w[re]={date:P,project:F,schedules:[]}),w[re].schedules.push(R),w},{});return Object.values(v).map(({date:w,project:R,schedules:P})=>{const re=P.length>0&&Ex(new Date(P[0].start))?`${w} ()`:w;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:R},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:211,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:re},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:212,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:210,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:P.map(Z=>{const M=Z.time&&Z.time!=="-"?` - ${Pm(Z.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",Z.title,M]},Z.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:214,columnNumber:31},void 0)]},`${w}-${R}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:209,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:191,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:186,columnNumber:19},void 0),y===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:234,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:109,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:101,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:100,columnNumber:7},void 0),i&&a.jsxDEV($N,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await s(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:246,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:98,columnNumber:5},void 0)},nu=()=>{const{user:n}=zr(),{projects:e}=Or();return V.useMemo(()=>n?n.name===""?e.filter(s=>{const i=(s.manager?s.manager.split(",").map(l=>l.trim()):[]).includes(""),o=s.team&&Array.isArray(s.team)&&s.team.includes("");return i||o}):e:[],[n,e])},VC=({value:n,detailValue:e="",onChange:t,onDetailChange:s,placeholder:r=" ",error:i})=>{const[o,l]=V.useState(!1),[u,m]=V.useState(n),[d,f]=V.useState(e),h=V.useRef(null);V.useEffect(()=>{const R=P=>{h.current&&!h.current.contains(P.target)&&l(!1)};return o&&document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[o]),V.useEffect(()=>{m(n)},[n]),V.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((R,P)=>{if(window.daum&&window.daum.Postcode){R(!0);return}const F=document.createElement("script");F.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",F.async=!0,F.onload=()=>R(!0),F.onerror=()=>P(new Error("Kakao Postcode   ")),document.head.appendChild(F)}),I=R=>{const P=R.roadAddr||R.jibunAddr;m(P),t(P,d),l(!1)},v=R=>{const P=R.target.value;f(P),s&&s(P),u&&t(u,P)},w=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(R){const P={roadAddr:R.roadAddress,jibunAddr:R.jibunAddress||R.autoJibunAddress||"",zipNo:R.zonecode,bdNm:R.buildingName,siNm:R.sido,sggNm:R.sigungu,emdNm:R.bname,rn:R.roadname};I(P)}}).open()}catch(R){console.error("  :",R),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>w(),onChange:R=>{m(R.target.value),t(R.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(ug,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},qh=["","","","","","",""],AC=({project:n,onClose:e,onSave:t})=>{const{register:s,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=tf({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=V.useState([]),[d,f]=V.useState(""),[h,y]=V.useState(""),[I,v]=V.useState(""),[w,R]=V.useState(!1);V.useEffect(()=>{var M;if(n){const A=n.location?n.location.split(","):["",""],N=((M=A[0])==null?void 0:M.trim())||n.location||"",C=A.length>1?A.slice(1).join(",").trim():"";o({name:n.name,client:n.client||"",location:N,detailLocation:C,startDate:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:"",endDate:n.endDate?new Date(n.endDate).toISOString().split("T")[0]:""}),y(N),v(C);const j=n.manager?n.manager.split(",").map(S=>S.trim()).filter(S=>S&&S!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),v(""),m([])},[n,o]);const P=M=>{m(A=>A.includes(M)?A.filter(N=>N!==M):[...A,M])},F=()=>{d.trim()&&!u.includes(d.trim())&&(m(M=>[...M,d.trim()]),f(""))},re=M=>{m(A=>A.filter(N=>N!==M))},Z=async M=>{if(w)return;R(!0),console.log(" ProjectModal onSubmit - Raw form data:",M);const A=h&&I?`${h}, ${I}`:h||M.location,N={name:M.name,client:M.client,location:A,manager:u.join(", "),contractAmount:(n==null?void 0:n.contractAmount)??0,spent:(n==null?void 0:n.spent)??0,status:(n==null?void 0:n.status)??"planning",progress:(n==null?void 0:n.progress)??0,description:(n==null?void 0:n.description)??"",meetingNotes:(n==null?void 0:n.meetingNotes)??[],customerRequests:(n==null?void 0:n.customerRequests)??[],entrancePassword:(n==null?void 0:n.entrancePassword)??"",sitePassword:(n==null?void 0:n.sitePassword)??""};if(M.startDate&&M.startDate!=="")N.startDate=M.startDate,console.log(" Setting startDate from form:",M.startDate);else if(n!=null&&n.startDate){const C=typeof n.startDate=="string"&&n.startDate.includes("T")?n.startDate.split("T")[0]:n.startDate;N.startDate=C,console.log(" Keeping existing startDate:",N.startDate)}if(M.endDate&&M.endDate!=="")N.endDate=M.endDate,console.log(" Setting endDate from form:",M.endDate);else if(n!=null&&n.endDate){const C=typeof n.endDate=="string"&&n.endDate.includes("T")?n.endDate.split("T")[0]:n.endDate;N.endDate=C,console.log(" Keeping existing endDate:",N.endDate)}console.log(" ProjectModal onSubmit - Final formData:",N);try{await t(N)}catch(C){throw R(!1),C}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(yn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(Z),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...s("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...s("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(VC,{value:h,detailValue:I,onChange:(M,A)=>{y(M),v(A||""),i("location",M),i("detailLocation",A||"")},onDetailChange:M=>{v(M),i("detailLocation",M)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...s("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...s("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[qh.map(M=>a.jsxDEV("button",{type:"button",onClick:()=>P(M),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(M)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:M},M,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(M=>!qh.includes(M)).map(M=>a.jsxDEV("button",{type:"button",onClick:()=>re(M),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[M," "]},M,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyPress:M=>{M.key==="Enter"&&(M.preventDefault(),F())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:F,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:w,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:w?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},CC=({projectName:n,meetingNotes:e,onClose:t,onSave:s,onDelete:r})=>{const[i,o]=V.useState(""),[l,u]=V.useState(new Date().toISOString().split("T")[0]),[m,d]=V.useState(!1),[f,h]=V.useState(!1),y=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},I=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}h(!0);try{await s(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},w=R=>{window.confirm("   ?")&&r(R)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:R=>R.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(yn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:R=>u(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:R=>o(R.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:I,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(R=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Ut(new Date(R.date),"yyyy.MM.dd (eee)",{locale:gn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:R.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>w(R.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},R.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},wC=({projectName:n,customerRequests:e,onClose:t,onSave:s,onToggleComplete:r,onDelete:i})=>{const[o,l]=V.useState(""),[u,m]=V.useState(new Date().toISOString().split("T")[0]),[d,f]=V.useState(!1),[h,y]=V.useState(!1),I=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!h){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}y(!0);try{await s(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},w=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},R=Z=>{window.confirm("  ?")&&i(Z)},P=Z=>{r(Z)},F=e.filter(Z=>!Z.completed),re=e.filter(Z=>Z.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:Z=>Z.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(yn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:I,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:Z=>m(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:Z=>l(Z.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:w,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[F.map(Z=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>P(Z.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(hx,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:Z.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Ut(new Date(Z.createdAt),"yyyy.MM.dd",{locale:gn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>R(Z.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},Z.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),re.map(Z=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>P(Z.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(gx,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:Z.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ut(new Date(Z.createdAt),"yyyy.MM.dd",{locale:gn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>R(Z.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},Z.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},IC=({projectName:n,entrancePassword:e,sitePassword:t,onClose:s,onSave:r})=>{const[i,o]=V.useState(e||""),[l,u]=V.useState(t||""),[m,d]=V.useState(!1),[f,h]=V.useState(!1),y=()=>{d(!0)},I=async()=>{if(!f){h(!0);try{await r(i,l),d(!1)}finally{h(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:w=>w.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(yn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:w=>o(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:w=>u(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:I,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:s,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},TC=({projectName:n,onClose:e})=>{var o;const[t,s]=V.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(yn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>s({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>s({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>s({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>s({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>s({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>s({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&s({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>s({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(mg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[Ut(new Date(t.startDate),"yyyy",{locale:gn}),"",Ut(new Date(t.startDate),"MM",{locale:gn}),"",Ut(new Date(t.startDate),"dd",{locale:gn})," ~ ",Ut(new Date(t.endDate),"yyyy",{locale:gn}),"",Ut(new Date(t.endDate),"MM",{locale:gn}),"",Ut(new Date(t.endDate),"dd",{locale:gn})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},SC=()=>{const{loadProjectsFromAPI:n,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:s}=Or(),{user:r}=zr(),i=nu(),[o,l]=V.useState("in-progress"),[u,m]=V.useState("grid"),[d,f]=V.useState(!1),[h,y]=V.useState(null),[I,v]=V.useState(!1),[w,R]=V.useState(!1),[P,F]=V.useState(!1),[re,Z]=V.useState(!1),[M,A]=V.useState(null),N=(G,Te)=>`lastViewed_${r==null?void 0:r.id}_${G}_${Te}`,C=(G,Te)=>{const Re=N(G,Te),we=localStorage.getItem(Re);return we?parseInt(we,10):0},j=(G,Te)=>{const Re=N(G,Te);localStorage.setItem(Re,Date.now().toString())},S=(G,Te)=>{const Re=C(G.id,Te);return Te==="meeting"?(G.meetingNotes||[]).some(Qe=>(Qe.createdAt?new Date(Qe.createdAt).getTime():new Date(Qe.date).getTime())>Re):(G.customerRequests||[]).some(Qe=>!Qe.completed)};V.useEffect(()=>{n().catch(G=>{console.error("Failed to load projects:",G),ie.error("   ")})},[n]),V.useEffect(()=>{const G=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",G),()=>window.removeEventListener("headerAddButtonClick",G)},[]);const T=(G,Te)=>{if(!G||!Te)return 0;const Re=new Date,we=new Date(G),Qe=new Date(Te);if(Re<we)return 0;if(Re>Qe)return 100;const Ct=Math.ceil((Qe.getTime()-we.getTime())/(1e3*60*60*24)),Ot=Math.ceil((Re.getTime()-we.getTime())/(1e3*60*60*24)),at=Math.round(Ot/Ct*100);return Math.min(100,Math.max(0,at))},E=G=>{y(G),f(!0)},De=async(G,Te)=>{if(window.confirm(`"${Te}"  ?

    .`))try{await s(G),ie.success(" ")}catch(Re){console.error("Failed to delete project:",Re),ie.error("  ")}},He=async G=>{try{if(h)await t(h.id,G),ie.success(" ");else{const Te={id:"",...G,team:G.team||[]};await e(Te),ie.success(" "),l(G.status||"planning")}f(!1),y(null)}catch(Te){console.error("Failed to save project:",Te),ie.error("  ")}},fe=async(G,Te)=>{try{await t(G,{status:Te}),ie.success(" ")}catch(Re){console.error("Failed to update project status:",Re),ie.error("  ")}},je=G=>{A(G),v(!0),j(G.id,"meeting")},ut=G=>{A(G),R(!0),j(G.id,"request")},Ft=G=>{A(G),F(!0)},Rt=G=>{A(G),Z(!0)},oe=async(G,Te)=>{if(!M)return;const Re=M.entrancePassword,we=M.sitePassword;A({...M,entrancePassword:G,sitePassword:Te});try{await t(M.id,{entrancePassword:G,sitePassword:Te}),ie.success(" ")}catch(Qe){console.error("Failed to save passwords:",Qe),ie.error("  "),A({...M,entrancePassword:Re,sitePassword:we})}},Me=async(G,Te)=>{if(!M)return;const Re={id:Date.now().toString(),content:G,date:Te,createdAt:new Date},we=[...M.meetingNotes||[],Re];A({...M,meetingNotes:we});try{await t(M.id,{meetingNotes:we}),ie.success("  ")}catch(Qe){console.error("Failed to save meeting note:",Qe),ie.error("   "),A({...M,meetingNotes:M.meetingNotes||[]})}},ue=async(G,Te)=>{if(!M)return;const Re={id:Date.now().toString(),content:G,completed:!1,createdAt:Te},we=[...M.customerRequests||[],Re];A({...M,customerRequests:we});try{await t(M.id,{customerRequests:we}),ie.success("  ")}catch(Qe){console.error("Failed to save customer request:",Qe),ie.error("   "),A({...M,customerRequests:M.customerRequests||[]})}},Pe=async G=>{if(!M)return;const Te=M.customerRequests||[],Re=Te.map(we=>we.id===G?{...we,completed:!we.completed}:we);A({...M,customerRequests:Re});try{await t(M.id,{customerRequests:Re}),ie.success("  ")}catch(we){console.error("Failed to toggle request:",we),ie.error("  "),A({...M,customerRequests:Te})}},We=async G=>{if(!M)return;const Te=M.meetingNotes||[],Re=Te.filter(we=>we.id!==G);A({...M,meetingNotes:Re});try{await t(M.id,{meetingNotes:Re}),ie.success("  ")}catch(we){console.error("Failed to delete meeting note:",we),ie.error(" "),A({...M,meetingNotes:Te})}},bt=async G=>{if(!M)return;const Te=M.customerRequests||[],Re=Te.filter(we=>we.id!==G);A({...M,customerRequests:Re});try{await t(M.id,{customerRequests:Re}),ie.success("  ")}catch(we){console.error("Failed to delete customer request:",we),ie.error(" "),A({...M,customerRequests:Te})}},st=({project:G})=>{const Re={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[G.status];return a.jsxDEV("select",{value:G.status,onChange:we=>fe(G.id,we.target.value),className:Ns("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Re.color),onClick:we=>we.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},nt=(()=>{let G=i;return o!=="all"&&(G=G.filter(Te=>Te.status===o)),r!=null&&r.name&&(G=[...G].sort((Te,Re)=>{var Ct,Ot;const we=Te.manager===r.name||((Ct=Te.team)==null?void 0:Ct.includes(r.name)),Qe=Re.manager===r.name||((Ot=Re.team)==null?void 0:Ot.includes(r.name));return we&&!Qe?-1:!we&&Qe?1:0})),G})(),lt={planning:i.filter(G=>G.status==="planning").length,inProgress:i.filter(G=>G.status==="in-progress").length,completed:i.filter(G=>G.status==="completed").length,onHold:i.filter(G=>G.status==="on-hold").length},an=({project:G})=>{var Re,we,Qe;const Te=T(G.startDate,G.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:G.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[G.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[G.status==="planning"&&a.jsxDEV("button",{onClick:()=>Rt(G),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(st,{project:G},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>E(G),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",G.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",G.startDate&&G.endDate?`${Ut(G.startDate,"MM.dd (eee)",{locale:gn})} - ${Ut(G.endDate,"MM.dd (eee)",{locale:gn})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",G.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>Ft(G),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Te,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Te}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>je(G),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Re=G.meetingNotes)==null?void 0:Re.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(we=G.meetingNotes)==null?void 0:we.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),S(G,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),G.meetingNotes&&G.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Qe=G.meetingNotes[G.meetingNotes.length-1])==null?void 0:Qe.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var at;const Ct=((at=G.customerRequests)==null?void 0:at.filter(L=>!L.completed))||[],Ot=Ct[Ct.length-1];return a.jsxDEV("div",{onClick:()=>ut(G),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",Ct.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Ct.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),S(G,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Ot?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Ot.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>De(G.id,G.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:lt.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:lt.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:lt.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(G=>a.jsxDEV("button",{onClick:()=>l(G.id),className:Ns("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===G.id?`border-gray-700 ${G.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[G.label,a.jsxDEV("span",{className:Ns("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===G.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:G.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},G.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Ns("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Ns("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV(ro,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:nt.map(G=>a.jsxDEV(an,{project:G},G.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:nt.map(G=>{var Re,we,Qe,Ct;const Te=T(G.startDate,G.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:G.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:G.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[G.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:G.startDate&&G.endDate?a.jsxDEV(a.Fragment,{children:[Ut(G.startDate,"yyyy.MM.dd (eee)",{locale:gn})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Ut(G.endDate,"yyyy.MM.dd (eee)",{locale:gn})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[G.status==="planning"&&a.jsxDEV("button",{onClick:()=>Rt(G),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(st,{project:G},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>Ft(G),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Te}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Te,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>je(G),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Re=G.meetingNotes)==null?void 0:Re.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(we=G.meetingNotes)==null?void 0:we.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),S(G,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Qe=G.meetingNotes)!=null&&Qe.length?((Ct=G.meetingNotes[G.meetingNotes.length-1])==null?void 0:Ct.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var L;const Ot=((L=G.customerRequests)==null?void 0:L.filter(q=>!q.completed))||[],at=Ot[Ot.length-1];return a.jsxDEV("div",{onClick:()=>ut(G),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Ot.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Ot.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),S(G,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:at?at.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>E(G),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>De(G.id,G.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},G.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(AC,{project:h,onClose:()=>{f(!1),y(null)},onSave:He},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),I&&M&&a.jsxDEV(CC,{projectName:M.name,meetingNotes:M.meetingNotes||[],onClose:()=>{v(!1),A(null)},onSave:Me,onDelete:We},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),w&&M&&a.jsxDEV(wC,{projectName:M.name,customerRequests:M.customerRequests||[],onClose:()=>{R(!1),A(null)},onSave:ue,onToggleComplete:Pe,onDelete:bt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),P&&M&&a.jsxDEV(IC,{projectName:M.name,entrancePassword:M.entrancePassword||"",sitePassword:M.sitePassword||"",onClose:()=>{F(!1),A(null)},onSave:oe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),re&&M&&a.jsxDEV(TC,{projectName:M.name,onClose:()=>{Z(!1),A(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var nf={},zN={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(zN);var zn=zN.exports,sf={},WN={exports:{}},KN={exports:{}},GN={exports:{}},QN={exports:{}};(function(n){function e(t){"@babel/helpers - typeof";return n.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(QN);var Co=QN.exports,YN={exports:{}};(function(n){var e=Co.default;function t(s,r){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var o=i.call(s,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(YN);var PC=YN.exports;(function(n){var e=Co.default,t=PC;function s(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(GN);var XN=GN.exports;(function(n){var e=XN;function t(s,r,i){return(r=e(r))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(KN);var JN=KN.exports;(function(n){var e=JN;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function s(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(WN);var Qr=WN.exports,ZN={exports:{}},e0={exports:{}};(function(n){function e(t,s){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(s.indexOf(i)!==-1)continue;r[i]=t[i]}return r}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(e0);var LC=e0.exports;(function(n){var e=LC;function t(s,r){if(s==null)return{};var i,o,l=e(s,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(s);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(l[i]=s[i])}return l}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(ZN);var rf=ZN.exports,t0={exports:{}};(function(n){function e(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(t0);var Si=t0.exports,n0={exports:{}};(function(n){var e=XN;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function s(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(n0);var Pi=n0.exports,s0={exports:{}},r0={exports:{}};(function(n){function e(t){return n.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(r0);var jC=r0.exports,i0={exports:{}};(function(n){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n.exports=e=function(){return!!t},n.exports.__esModule=!0,n.exports.default=n.exports)()}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(i0);var RC=i0.exports,o0={exports:{}},a0={exports:{}};(function(n){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(a0);var BC=a0.exports;(function(n){var e=Co.default,t=BC;function s(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(o0);var UC=o0.exports;(function(n){var e=jC,t=RC,s=UC;function r(i,o,l){return o=e(o),s(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports})(s0);var wo=s0.exports,l0={exports:{}},c0={exports:{}};(function(n){function e(t,s){return n.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},n.exports.__esModule=!0,n.exports.default=n.exports,e(t,s)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(c0);var HC=c0.exports;(function(n){var e=HC;function t(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),r&&e(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(l0);var Io=l0.exports;const Xa=Ua(Ax);var ks={},_o={};Object.defineProperty(_o,"__esModule",{value:!0});_o.views=_o.navigate=void 0;_o.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};_o.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var MC=zn.default;Object.defineProperty(ks,"__esModule",{value:!0});ks.views=ks.dateRangeFormat=ks.dateFormat=ks.accessor=ks.DayLayoutAlgorithmPropType=void 0;var ts=MC(dg),$h=_o,zh=Object.keys($h.views).map(function(n){return $h.views[n]});ks.accessor=ts.default.oneOfType([ts.default.string,ts.default.func]);ks.dateFormat=ts.default.any;ks.dateRangeFormat=ts.default.func;ks.views=ts.default.oneOfType([ts.default.arrayOf(ts.default.oneOf(zh)),ts.default.objectOf(function(n,e){var t=zh.indexOf(e)!==-1&&typeof n[e]=="boolean";if(t)return null;for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return ts.default.elementType.apply(ts.default,[n,e].concat(r))})]);ks.DayLayoutAlgorithmPropType=ts.default.oneOfType([ts.default.oneOf(["overlap","no-overlap"]),ts.default.func]);var su={},To={},FC=zn.default;Object.defineProperty(To,"__esModule",{value:!0});To.accessor=u0;To.wrapAccessor=void 0;var OC=FC(Co);function u0(n,e){var t=null;return typeof e=="function"?t=e(n):typeof e=="string"&&(0,OC.default)(n)==="object"&&n!=null&&e in n&&(t=n[e]),t}To.wrapAccessor=function(e){return function(t){return u0(t,e)}};var Li={},qC=zn.default;Object.defineProperty(Li,"__esModule",{value:!0});Li.DnDContext=void 0;var $C=qC(V);Li.DnDContext=$C.default.createContext();var ji=zn.default;Object.defineProperty(su,"__esModule",{value:!0});su.default=void 0;var zC=ji(Qr),WC=ji(Si),KC=ji(Pi),GC=ji(wo),QC=ji(Io),Gi=ji(V),Wh=ji(Xa),Kh=To,YC=Li,m0=function(n){function e(){var t;(0,WC.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,GC.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,zC.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,QC.default)(e,n),(0,KC.default)(e,[{key:"renderAnchor",value:function(s){var r=s==="Up"||s==="Down"?"ns":"ew";return Gi.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(s)]},Gi.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var s=this.props,r=s.event,i=s.type,o=s.continuesPrior,l=s.continuesAfter,u=s.resizable,m=this.props.children;if(r.__isPreview)return Gi.default.cloneElement(m,{className:(0,Wh.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,y=f?!!(0,Kh.accessor)(r,f):!0;if(!y)return m;var I=u&&(h?!!(0,Kh.accessor)(r,h):!0);if(I||y){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(I){var w=null,R=null;i==="date"?(w=!o&&this.renderAnchor("Left"),R=!l&&this.renderAnchor("Right")):(w=!o&&this.renderAnchor("Up"),R=!l&&this.renderAnchor("Down")),v.children=Gi.default.createElement("div",{className:"rbc-addons-dnd-resizable"},w,m.props.children,R)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Wh.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=Gi.default.cloneElement(m,v)}return m}}])}(Gi.default.Component);m0.contextType=YC.DnDContext;su.default=m0;var ru={},d0={exports:{}};(function(n){var e=Co.default;function t(s,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(n.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,h={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return h;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,h)}for(var y in u)y!=="default"&&{}.hasOwnProperty.call(u,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,y))&&(f.get||f.set)?d(h,y,f):h[y]=u[y]);return h},n.exports.__esModule=!0,n.exports.default=n.exports)(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(d0);var f0=d0.exports;function of(n,e,t,s){if(t===void 0&&(t=!1),s===void 0&&(s=!0),n){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,s),n.dispatchEvent(r)}}function XC(n){var e=xs(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function JC(n,e,t){t===void 0&&(t=5);var s=!1,r=setTimeout(function(){s||of(n,"transitionend",!0)},e+t),i=_c(n,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),i()}}function af(n,e,t,s){t==null&&(t=XC(n)||0);var r=JC(n,t,s),i=_c(n,"transitionend",e);return function(){r(),i()}}var Gh={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Qh(n){var e=n.node,t=n.properties,s=n.duration,r=s===void 0?200:s,i=n.easing,o=n.callback,l=[],u={},m="";Object.keys(t).forEach(function(h){var y=t[h];Cx(h)?m+=h+"("+y+") ":(u[h]=y,l.push(wx(h)))}),m&&(u.transform=m,l.push("transform"));function d(h){h.target===h.currentTarget&&(xs(e,Gh),o&&o.call(this,h))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=af(e,d,r);return e.clientLeft,xs(e,u),{cancel:function(){f(),xs(e,Gh)}}}function p0(n,e,t,s,r){if(!("nodeType"in n))return Qh(n);if(!e)throw new Error("must include properties to animate");return typeof s=="function"&&(r=s,s=""),Qh({node:n,properties:e,duration:t,easing:s,callback:r})}function h0(n,e,t){if(n){if(typeof t>"u")return n.getAttribute(e);!t&&t!==""?n.removeAttribute(e):n.setAttribute(e,String(t))}}function g0(n){return n?Array.from(n.children):[]}function y0(n){if(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}return null}var ZC=Function.prototype.bind.call(Function.prototype.call,[].slice);function b0(n){return n?ZC(n.childNodes):[]}function N0(n,e){return function(s){var r=s.currentTarget,i=s.target,o=Hm(r,n);o.some(function(l){return Mm(l,i)})&&e.call(this,s)}}function x0(n,e){return n&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(n,e.nextSibling):e.parentNode.appendChild(n),n):null}var ew=/^(?:input|select|textarea|button)$/i;function v0(n){return n?ew.test(n.nodeName):!1}function _0(n){return n?!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length):!1}function D0(n,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var s=[];n;n=n.nextElementSibling)if(n!==e){if(t&&Fm(n,t))break;s.push(n)}return s}function k0(n,e){return D0(n,n,e)}function tw(n,e){var t=null,s=[];for(t=n?n[e]:null;t&&t.nodeType!==9;)s.push(t),t=t[e]||null;return s}function E0(n){return tw(n,"parentElement")}function V0(n,e){return n&&e?(e.firstElementChild?e.insertBefore(n,e.firstElementChild):e.appendChild(n),n):null}function A0(n){return n&&n.parentNode?(n.parentNode.removeChild(n),n):null}function lf(n,e){var t=xs(n,"position"),s=t==="absolute",r=n.ownerDocument;if(t==="fixed")return r||document;for(;(n=n.parentNode)&&!Ix(n);){var i=s&&xs(n,"position")==="static",o=(xs(n,"overflow")||"")+(xs(n,"overflow-y")||"")+xs(n,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||Dc(n)<n.scrollHeight))return n}return r||document}function C0(n,e){var t=zl(n),s={top:0,left:0};if(n){var r=e||lf(n),i=Tx(r),o=Wl(r),l=Dc(r,!0);i||(s=zl(r)),t={top:t.top-s.top,left:t.left-s.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=Om(function(){return Wl(r,o)});return function(){return qm(f)}}}function w0(n){return D0(n&&n.parentElement?n.parentElement.firstElementChild:null,n)}var nw=/&nbsp;/gi,sw=/\xA0/g,rw=/\s+([^\s])/gm;function I0(n,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var s="";return n&&(s=(n.textContent||"").replace(nw," ").replace(sw," "),e&&(s=s.trim()),t&&(s=s.replace(rw," $1"))),s}function T0(n,e){n.classList?n.classList.toggle(e):$m(n,e)?zm(n,e):Wm(n,e)}const iw={addEventListener:kg,removeEventListener:Dg,triggerEvent:of,animate:p0,filter:N0,listen:_c,style:xs,getComputedStyle:_g,attribute:h0,activeElement:vg,ownerDocument:xg,ownerWindow:Ng,requestAnimationFrame:Om,cancelAnimationFrame:qm,matches:Fm,height:Dc,width:bg,offset:zl,offsetParent:yg,position:gg,contains:Mm,scrollbarSize:hg,scrollLeft:pg,scrollParent:lf,scrollTo:C0,scrollTop:Wl,querySelectorAll:Hm,closest:fg,addClass:Wm,removeClass:zm,hasClass:$m,toggleClass:T0,transitionEnd:af,childNodes:b0,childElements:g0,nextUntil:k0,parents:E0,siblings:w0,clear:y0,insertAfter:x0,isInput:v0,isVisible:_0,prepend:V0,remove:A0,text:I0},ow=Object.freeze(Object.defineProperty({__proto__:null,activeElement:vg,addClass:Wm,addEventListener:kg,animate:p0,attribute:h0,cancelAnimationFrame:qm,childElements:g0,childNodes:b0,clear:y0,closest:fg,contains:Mm,default:iw,filter:N0,getComputedStyle:_g,hasClass:$m,height:Dc,insertAfter:x0,isInput:v0,isVisible:_0,listen:_c,matches:Fm,nextUntil:k0,offset:zl,offsetParent:yg,ownerDocument:xg,ownerWindow:Ng,parents:E0,position:gg,prepend:V0,querySelectorAll:Hm,remove:A0,removeClass:zm,removeEventListener:Dg,requestAnimationFrame:Om,scrollLeft:pg,scrollParent:lf,scrollTo:C0,scrollTop:Wl,scrollbarSize:hg,siblings:w0,style:xs,text:I0,toggleClass:T0,transitionEnd:af,triggerEvent:of,width:bg},Symbol.toStringTag,{value:"Module"})),aw=Ua(ow);var Lm={exports:{}};(function(n,e){e.__esModule=!0,e.default=s;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(r,i){return t(r.querySelectorAll(i))}n.exports=e.default})(Lm,Lm.exports);var lw=Lm.exports,As={};const cw=Ua(Sx),uw=Ua(Px),mw=Ua(Lx);var So=zn.default;Object.defineProperty(As,"__esModule",{value:!0});As.default=void 0;As.getBoundsForNode=Ba;As.getEventNodeFromPoint=P0;As.getShowMoreNodeFromPoint=L0;As.isEvent=yw;As.isShowMore=bw;As.objectsCollide=Rm;var dw=So(Co),fw=So(Si),pw=So(Pi),jm=So(cw),S0=So(uw),hw=So(mw);function Mn(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,hw.default)(t,n,e,{passive:!1})}function gw(n,e,t){return!n||(0,jm.default)(n,document.elementFromPoint(e,t))}function P0(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,S0.default)(r,".rbc-event",n)}function L0(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,S0.default)(r,".rbc-show-more",n)}function yw(n,e){return!!P0(n,e)}function bw(n,e){return!!L0(n,e)}function Qo(n){var e=n;return n.touches&&n.touches.length&&(e=n.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Yh=5,Nw=250,xw=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t.global,r=s===void 0?!1:s,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,fw.default)(this,n),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Mn("touchmove",function(){},window),this._removeKeyDownListener=Mn("keydown",this._keyListener),this._removeKeyUpListener=Mn("keyup",this._keyListener),this._removeDropFromOutsideListener=Mn("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Mn("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,pw.default)(n,[{key:"on",value:function(t,s){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(s),{remove:function(){var o=r.indexOf(s);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var s=this._selectRect;return!s||!this.selecting?!1:Rm(s,Ba(t))}},{key:"filter",value:function(t){var s=this._selectRect;return!s||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,s){var r=this,i=null,o=null,l=null,u=function(h){i=setTimeout(function(){d(),t(h)},r.longPressThreshold),o=Mn("touchmove",function(){return d()}),l=Mn("touchend",function(){return d()})},m=Mn("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return s&&u(s),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,s=Mn("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=Mn("mousedown",t._handleInitialEvent)}),r=Mn("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){s(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var s=Qo(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var s=Qo(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var s=Qo(t),r=s.clientX,i=s.clientY,o=s.pageX,l=s.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!gw(u,r,i))){if(!this.globalMouse&&u&&!(0,jm.default)(u,t.target)){var f=vw(0),h=f.top,y=f.left,I=f.bottom,v=f.right;if(d=Ba(u),m=Rm({top:d.top-h,left:d.left-y,bottom:d.bottom+I,right:d.right+v},{top:l,left:o}),!m)return}var w=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(w!==!1)switch(t.type){case"mousedown":this._removeEndListener=Mn("mouseup",this._handleTerminatingEvent),this._onEscListener=Mn("keydown",this._handleTerminatingEvent),this._removeMoveListener=Mn("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Mn("touchend",this._handleTerminatingEvent),this._removeMoveListener=Mn("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var s=t.target,r=this.validContainers;return!r||!r.length||!s?!0:r.some(function(i){return!!s.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var s=this.selecting,r=this._selectRect;if(!s&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,jm.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!s&&i?this._handleClickEvent(t):s?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var s=Qo(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<Nw?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var s=this._initialEventData,r=s.x,i=s.y,o=Qo(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),h=Math.min(u,i),y=this.selecting,I=this.isClick(l,u);I&&!y&&!(m||d)||(!y&&!I&&this.emit("selectStart",this._initialEventData),I||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:u,right:f+m,bottom:h+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,s){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Yh&&Math.abs(s-o)<=Yh}}])}();function vw(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,dw.default)(n)!=="object"&&(n={top:n,left:n,right:n,bottom:n}),n}function Rm(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=Ba(n),r=s.top,i=s.left,o=s.right,l=o===void 0?i:o,u=s.bottom,m=u===void 0?r:u,d=Ba(e),f=d.top,h=d.left,y=d.right,I=y===void 0?h:y,v=d.bottom,w=v===void 0?f:v;return!(m-t<f||r+t>w||l-t<h||i+t>I)}function Ba(n){if(!n.getBoundingClientRect)return n;var e=n.getBoundingClientRect(),t=e.left+Xh("left"),s=e.top+Xh("top");return{top:s,left:t,right:(n.offsetWidth||0)+t,bottom:(n.offsetHeight||0)+s}}function Xh(n){if(n==="left")return window.pageXOffset||document.body.scrollLeft||0;if(n==="top")return window.pageYOffset||document.body.scrollTop||0}As.default=xw;var iu={},ou=zn.default;Object.defineProperty(iu,"__esModule",{value:!0});iu.default=void 0;var _w=ou(JN),Jh=ou(Qr),Dw=ou(Xa),Yo=ou(V);function xl(n){return typeof n=="string"?n:n+"%"}function kw(n){var e=n.style,t=n.className,s=n.event,r=n.accessors,i=n.rtl,o=n.selected,l=n.label,u=n.continuesPrior,m=n.continuesAfter,d=n.getters,f=n.onClick,h=n.onDoubleClick,y=n.isBackgroundEvent,I=n.onKeyPress,v=n.components,w=v.event,R=v.eventWrapper,P=r.title(s),F=r.tooltip(s),re=r.end(s),Z=r.start(s),M=d.eventProp(s,Z,re,o),A=[Yo.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Yo.default.createElement("div",{key:"2",className:"rbc-event-content"},w?Yo.default.createElement(w,{event:s,title:P}):P)],N=e.height,C=e.top,j=e.width,S=e.xOffset,T=(0,Jh.default)((0,Jh.default)({},M.style),{},(0,_w.default)({top:xl(C),height:xl(N),width:xl(j)},i?"right":"left",xl(S)));return Yo.default.createElement(R,Object.assign({type:"time"},n),Yo.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:T,onKeyDown:I,title:F?(typeof l=="string"?l+": ":"")+F:void 0,className:(0,Dw.default)(y?"rbc-background-event":"rbc-event",t,M.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},A))}iu.default=kw;var lr={},j0=zn.default;Object.defineProperty(lr,"__esModule",{value:!0});lr.dragAccessors=void 0;lr.eventTimes=Sw;lr.mergeComponents=Iw;lr.pointInColumn=Tw;var Ew=j0(Qr),Vw=j0(rf),Zh=To,Aw=V,Cw=["children"];lr.dragAccessors={start:(0,Zh.wrapAccessor)(function(n){return n.start}),end:(0,Zh.wrapAccessor)(function(n){return n.end})};function ww(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var s=function(i){var o=i.children,l=(0,Vw.default)(i,Cw);return e.filter(Boolean).reduceRight(function(u,m){return(0,Aw.createElement)(m,l,u)},o)};return s}function Iw(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),s=(0,Ew.default)({},n);return t.forEach(function(r){s[r]=n[r]?ww(n[r],e[r]):e[r]}),s}function Tw(n,e){var t=n.left,s=n.right,r=n.top,i=e.x,o=e.y;return i<s+10&&i>t&&o>r}function Sw(n,e,t){var s=e.start(n),r=e.end(n),i=t.eq(s,r,"minutes")&&t.diff(s,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(s,r,"milliseconds");return{start:s,end:r,duration:o}}var Pw=f0.default,Yr=zn.default;Object.defineProperty(ru,"__esModule",{value:!0});ru.default=void 0;var vr=Yr(Qr),Lw=Yr(Si),jw=Yr(Pi),Rw=Yr(wo),Bw=Yr(Io),Hu=aw,Uw=Yr(lw),ii=Yr(V),Hw=Li,_r=Pw(As),Mw=Yr(iu),Xs=lr,R0=function(n){function e(){var t;(0,Lw.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,Rw.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,Xs.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,h=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),y=(0,Xs.eventTimes)(u,d,t.props.localizer),I=y.duration,v=t.props.localizer.add(h,I,"milliseconds");t.update(u,f.getRange(h,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),h=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),h=(0,Xs.eventTimes)(f,u,d),y=h.duration,I=m.nextSlot(o),v=!isNaN(y);if(v){var w=d.add(o,y,"milliseconds");I=new Date(Math.max(w,I))}return I},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,Uw.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Hu.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Hu.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new _r.default(function(){return o.closest(".rbc-time-view")}),d=(0,Hu.scrollParent)(o);m.on("beforeSelect",function(f){var h=t.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,Xs.pointInColumn)((0,_r.getBoundsForNode)(l),f);var y=(0,_r.getEventNodeFromPoint)(l,f);if(!y)return!1;t.eventOffsetTop=f.y-(0,_r.getBoundsForNode)(y).top}),m.on("selecting",function(f){var h=(0,_r.getBoundsForNode)(l),y=t.context.draggable.dragAndDropAction;y.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,h)),y.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,h))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var h=(0,_r.getBoundsForNode)(l);(0,Xs.pointInColumn)(h,f)&&t.handleDropFromOutside(f,h)}}),m.on("dragOverFromOutside",function(f){var h=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(h){var y=(0,_r.getBoundsForNode)(l);if(!(0,Xs.pointInColumn)(y,f))return t.reset();t.handleDragOverFromOutside(f,y)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var h=(0,_r.getBoundsForNode)(l);u=!1;var y=t.context.draggable.dragAndDropAction;if(y.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,Xs.pointInColumn)(h,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=ii.default.createRef(),t}return(0,Bw.default)(e,n),(0,jw.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(s,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,vr.default)((0,vr.default)({},s),{},{start:i,end:o})})}},{key:"handleResize",value:function(s,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,h=l.closestSlotFromPoint(s,r),y=(0,Xs.eventTimes)(d,o,u),I=y.start,v=y.end,w;if(f==="UP"){var R=u.min(h,l.closestSlotFromDate(v,-1));w=l.getRange(R,v),w=(0,vr.default)((0,vr.default)({},w),{},{endDate:v})}else if(f==="DOWN"){var P=u.max(h,l.closestSlotFromDate(I));w=l.getRange(I,P),w=(0,vr.default)((0,vr.default)({},w),{},{startDate:I})}this.update(d,w)}},{key:"renderContent",value:function(){var s=this.props,r=s.children,i=s.accessors,o=s.components,l=s.getters,u=s.slotMetrics,m=s.localizer,d=this.state,f=d.event,h=d.top,y=d.height;if(!f)return r;var I=r.props.children,v=f.start,w=f.end,R,P="eventTimeRangeFormat",F=u.startsBeforeDay(v),re=u.startsAfterDay(w);return F?P="eventTimeRangeEndFormat":re&&(P="eventTimeRangeStartFormat"),F&&re?R=m.messages.allDay:R=m.format({start:v,end:w},P),ii.default.cloneElement(r,{children:ii.default.createElement(ii.default.Fragment,null,I,f&&ii.default.createElement(Mw.default,{event:f,label:R,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:y,width:100},getters:l,components:o,accessors:(0,vr.default)((0,vr.default)({},i),Xs.dragAccessors),continuesPrior:F,continuesAfter:re}))})}},{key:"render",value:function(){return ii.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(ii.default.Component);R0.contextType=Hw.DnDContext;ru.default=R0;var au={},B0={exports:{}},U0={exports:{}},H0={exports:{}};(function(n){function e(t,s){(s==null||s>t.length)&&(s=t.length);for(var r=0,i=Array(s);r<s;r++)i[r]=t[r];return i}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(H0);var M0=H0.exports;(function(n){var e=M0;function t(s){if(Array.isArray(s))return e(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(U0);var Fw=U0.exports,F0={exports:{}};(function(n){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(F0);var Ow=F0.exports,O0={exports:{}};(function(n){var e=M0;function t(s,r){if(s){if(typeof s=="string")return e(s,r);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,r):void 0}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(O0);var qw=O0.exports,q0={exports:{}};(function(n){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(q0);var $w=q0.exports;(function(n){var e=Fw,t=Ow,s=qw,r=$w;function i(o){return e(o)||t(o)||s(o)||r()}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports})(B0);var $0=B0.exports,lu={},cu={},uu={},Xr=zn.default;Object.defineProperty(uu,"__esModule",{value:!0});uu.default=void 0;var eg=Xr(Qr),zw=Xr(rf),Ww=Xr(Si),Kw=Xr(Pi),Gw=Xr(wo),Qw=Xr(Io),Xo=Xr(V),Yw=Xr(Xa),Xw=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],Jw=function(n){function e(){return(0,Ww.default)(this,e),(0,Gw.default)(this,e,arguments)}return(0,Qw.default)(e,n),(0,Kw.default)(e,[{key:"render",value:function(){var s=this.props,r=s.style,i=s.className,o=s.event,l=s.selected,u=s.isAllDay,m=s.onSelect,d=s.onDoubleClick,f=s.onKeyPress,h=s.localizer,y=s.continuesPrior,I=s.continuesAfter,v=s.accessors,w=s.getters,R=s.children,P=s.components,F=P.event,re=P.eventWrapper,Z=s.slotStart,M=s.slotEnd,A=(0,zw.default)(s,Xw);delete A.resizable;var N=v.title(o),C=v.tooltip(o),j=v.end(o),S=v.start(o),T=v.allDay(o),E=u||T||h.diff(S,h.ceil(j,"day"),"day")>1,De=w.eventProp(o,S,j,l),He=Xo.default.createElement("div",{className:"rbc-event-content",title:C||void 0},F?Xo.default.createElement(F,{event:o,continuesPrior:y,continuesAfter:I,title:N,isAllDay:T,localizer:h,slotStart:Z,slotEnd:M}):N);return Xo.default.createElement(re,Object.assign({},this.props,{type:"date"}),Xo.default.createElement("div",Object.assign({},A,{style:(0,eg.default)((0,eg.default)({},De.style),r),className:(0,Yw.default)("rbc-event",i,De.className,{"rbc-selected":l,"rbc-event-allday":E,"rbc-event-continues-prior":y,"rbc-event-continues-after":I}),onClick:function(je){return m&&m(o,je)},onDoubleClick:function(je){return d&&d(o,je)},onKeyDown:function(je){return f&&f(o,je)}}),typeof R=="function"?R(He):He))}}])}(Xo.default.Component);uu.default=Jw;var Jr={},Zw=zn.default;Object.defineProperty(Jr,"__esModule",{value:!0});Jr.dateCellSelection=s2;Jr.getSlotAtX=z0;Jr.isSelected=t2;Jr.pointInBox=n2;Jr.slotWidth=cf;var e2=Zw(jx);function t2(n,e){return!n||e==null?!1:(0,e2.default)(n,e)}function cf(n,e){var t=n.right-n.left,s=t/e;return s}function z0(n,e,t,s){var r=cf(n,s);return t?s-1-Math.floor((e-n.left)/r):Math.floor((e-n.left)/r)}function n2(n,e){var t=e.x,s=e.y;return s>=n.top&&s<=n.bottom&&t>=n.left&&t<=n.right}function s2(n,e,t,s,r){var i=-1,o=-1,l=s-1,u=cf(e,s),m=z0(e,t.x,r,s),d=e.top<t.y&&e.bottom>t.y,f=e.top<n.y&&e.bottom>n.y,h=n.y>e.bottom,y=e.top>n.y,I=t.top<e.top&&t.bottom>e.bottom;return I&&(i=0,o=l),d&&(y?(i=0,o=m):h&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((n.x-e.left)/u):Math.floor((n.x-e.left)/u),d?m<i?i=m:o=m:n.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var uf=zn.default;Object.defineProperty(cu,"__esModule",{value:!0});cu.default=void 0;var Ps=uf(dg),tg=uf(V),r2=uf(uu),i2=Jr;cu.default={propTypes:{slotMetrics:Ps.default.object.isRequired,selected:Ps.default.object,isAllDay:Ps.default.bool,accessors:Ps.default.object.isRequired,localizer:Ps.default.object.isRequired,components:Ps.default.object.isRequired,getters:Ps.default.object.isRequired,onSelect:Ps.default.func,onDoubleClick:Ps.default.func,onKeyPress:Ps.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var s=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,y=d.continuesPrior(t),I=d.continuesAfter(t);return tg.default.createElement(r2.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:y,continuesAfter:I,slotStart:d.first,slotEnd:d.last,selected:(0,i2.isSelected)(t,s),resizable:h})},renderSpan:function(e,t,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return tg.default.createElement("div",{key:s,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Zr=zn.default;Object.defineProperty(lu,"__esModule",{value:!0});lu.default=void 0;var o2=Zr(Qr),a2=Zr(Si),l2=Zr(Pi),c2=Zr(wo),u2=Zr(Io),m2=Zr(Xa),ng=Zr(V),$l=Zr(cu),W0=function(n){function e(){return(0,a2.default)(this,e),(0,c2.default)(this,e,arguments)}return(0,u2.default)(e,n),(0,l2.default)(e,[{key:"render",value:function(){var s=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return ng.default.createElement("div",{className:(0,m2.default)(l,"rbc-row")},i.reduce(function(m,d,f){var h=d.event,y=d.left,I=d.right,v=d.span,w="_lvl_"+f,R=y-u,P=$l.default.renderEvent(s.props,h);return R&&m.push($l.default.renderSpan(o,R,"".concat(w,"_gap"))),m.push($l.default.renderSpan(o,v,w,P)),u=I+1,m},[]))}}])}(ng.default.Component);W0.defaultProps=(0,o2.default)({},$l.default.defaultProps);lu.default=W0;var cr={},K0=zn.default;Object.defineProperty(cr,"__esModule",{value:!0});cr.endOfRange=G0;cr.eventLevels=p2;cr.eventSegments=f2;cr.inRange=h2;cr.segsOverlap=Q0;cr.sortEvents=Bm;cr.sortWeekEvents=g2;var Mu=K0($0),d2=K0(Rx);function G0(n){var e=n.dateRange,t=n.unit,s=t===void 0?"day":t,r=n.localizer;return{first:e[0],last:r.add(e[e.length-1],1,s)}}function f2(n,e,t,s){var r=G0({dateRange:e,localizer:s}),i=r.first,o=r.last,l=s.diff(i,o,"day"),u=s.max(s.startOf(t.start(n),"day"),i),m=s.min(s.ceil(t.end(n),"day"),o),d=(0,d2.default)(e,function(h){return s.isSameDate(h,u)}),f=s.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-s.segmentOffset,1),{event:n,span:f,left:d+1,right:Math.max(d+f,1)}}function p2(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,s,r,i=[],o=[];for(t=0;t<n.length;t++){for(r=n[t],s=0;s<i.length&&Q0(r,i[s]);s++);s>=e?o.push(r):(i[s]||(i[s]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function h2(n,e,t,s,r){var i={start:s.start(n),end:s.end(n)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function Q0(n,e){return e.some(function(t){return t.left<=n.right&&t.right>=n.left})}function g2(n,e,t){var s=(0,Mu.default)(n),r=[],i=[];s.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return Bm(u,m,e,t)}),l=i.sort(function(u,m){return Bm(u,m,e,t)});return[].concat((0,Mu.default)(o),(0,Mu.default)(l))}function Bm(n,e,t,s){var r={start:t.start(n),end:t.end(n),allDay:t.allDay(n)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return s.sortEvents({evtA:r,evtB:i})}var y2=f0.default,ei=zn.default;Object.defineProperty(au,"__esModule",{value:!0});au.default=void 0;var vl=ei(Qr),b2=ei($0),N2=ei(Si),x2=ei(Pi),v2=ei(wo),_2=ei(Io),_l=ei(V),D2=ei(lu),Qi=y2(As),k2=cr,Dr=Jr,Dl=lr,E2=Li,Y0=function(n){function e(){var t;(0,N2.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,v2.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,Dr.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,h=d.slotMetrics,y=d.rtl,I=d.localizer,v=(0,Dr.getSlotAtX)(l,o.x,y,h.slots),w=h.getDateForSlot(v),R=(0,Dl.eventTimes)(m,f,I),P=R.start,F=R.duration;P=I.merge(w,P);var re=I.add(P,F,"milliseconds");t.update(m,P,re)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,h=(0,Dr.getSlotAtX)(l,o.x,d,m.slots),y=m.getDateForSlot(h);t.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new Qi.default(function(){return l},{validContainers:(0,b2.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,h=t.context.draggable.dragAndDropAction.action,y=(0,Qi.getBoundsForNode)(o),I=(0,Dr.pointInBox)(y,d);return h==="move"||h==="resize"&&(!f||I)}),m.on("selecting",function(d){var f=(0,Qi.getBoundsForNode)(o),h=t.context.draggable.dragAndDropAction;h.action==="move"&&t.handleMove(d,f),h.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,Qi.getBoundsForNode)(o);t.state.segment&&((0,Dr.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,Qi.getBoundsForNode)(o);(0,Dr.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,Qi.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=_l.default.createRef(),t}return(0,_2.default)(e,n),(0,x2.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(s,r,i){var o=(0,k2.eventSegments)((0,vl.default)((0,vl.default)({},s),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Dl.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(s,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,h=u.localizer,y=(0,Dl.eventTimes)(o,m,h),I=y.start,v=y.end,w=(0,Dr.getSlotAtX)(r,s.x,f,d.slots),R=d.getDateForSlot(w),P=(0,Dr.pointInBox)(r,s);if(l==="RIGHT"){if(P){if(d.last<I)return this.reset();h.eq(h.startOf(v,"day"),v)?v=h.add(R,1,"day"):v=R}else if(h.inRange(I,d.first,d.last)||r.bottom<s.y&&+d.first>+I)v=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var F=m.end(o);v=h.merge(v,F),h.lt(v,I)&&(v=F)}else if(l==="LEFT"){if(P){if(d.first>v)return this.reset();I=R}else if(h.inRange(v,d.first,d.last)||r.top>s.y&&h.lt(d.last,v))I=h.add(d.first,-1,"milliseconds");else{this.reset();return}var re=m.start(o);I=h.merge(I,re),h.gt(I,v)&&(I=re)}this.update(o,I,v)}},{key:"render",value:function(){var s=this.props,r=s.children,i=s.accessors,o=this.state.segment;return _l.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&_l.default.createElement(D2.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,vl.default)((0,vl.default)({},i),Dl.dragAccessors)})))}}])}(_l.default.Component);Y0.contextType=E2.DnDContext;au.default=Y0;var Cs=zn.default;Object.defineProperty(sf,"__esModule",{value:!0});sf.default=U2;var kl=Cs(Qr),V2=Cs(rf),A2=Cs(Si),C2=Cs(Pi),w2=Cs(wo),I2=Cs(Io),Fu=Cs(V),T2=Cs(Xa),S2=Cs(su),P2=Cs(ru),L2=Cs(au),j2=lr,R2=Li,B2=["selectable","elementProps","components"];function U2(n){var e=function(t){function s(){var r;(0,A2.default)(this,s);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,w2.default)(this,s,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var h=r.props,y=h.onEventDrop,I=h.onEventResize;d==="move"&&y&&y(u),d==="resize"&&I&&I(u)}},r.state={interacting:!1},r}return(0,I2.default)(s,t),(0,C2.default)(s,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,V2.default)(i,B2),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,j2.mergeComponents)(u,{eventWrapper:S2.default,eventContainerWrapper:P2.default,weekWrapper:L2.default});var f=this.props.onDropFromOutside?(0,kl.default)((0,kl.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,T2.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return Fu.default.createElement(R2.DnDContext.Provider,{value:h},Fu.default.createElement(n,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(Fu.default.Component);return e.defaultProps=(0,kl.default)((0,kl.default)({},n.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var H2=zn.default;Object.defineProperty(nf,"__esModule",{value:!0});var X0=nf.default=void 0,M2=H2(sf);X0=nf.default=M2.default;const F2=X0(Bx),O2=_C;rt.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:n=>n<12?"":"",week:{dow:0,doy:1}});rt.locale("ko");const q2=Ux(rt),sg=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],$2=ot.memo(({onSave:n,onCancel:e,processList:t})=>{const[s,r]=V.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=V.useState(i);V.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:s,onChange:m=>r(m.target.value),onBlur:()=>{s.trim()?n(s.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?s.trim()?n(s.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),rg=n=>n,Na={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},z2=ot.memo(({date:n,label:e,filteredEvents:t,selectedDate:s,user:r,isMobileView:i})=>{const o=rt(n).format("YYYY-MM-DD"),l=Na[o],u=!!Na[o],m=s&&rt(n).isSame(s,"day"),d=t.filter(M=>rt(M.start).isSame(n,"day")),f=d.length,h=d.filter(M=>M.assignedTo&&M.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-h,I=e.replace(/^0/,""),v=n.getDay()===0,w=n.getDay()===6;let R="#000000";u||v?R="#dc2626":w&&(R="#3b82f6");const P=rt(n).isSame(rt(),"day");let F="#d1d5db";u||v?F="#fecaca":w&&(F="#bfdbfe");const re=I.length===2,Z=i?{backgroundColor:"transparent",color:R,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:P?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:R,fontWeight:P?"700":"400",paddingLeft:re?"0px":"4px",...P&&{backgroundColor:F,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:Z,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:I},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((M,A)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((M,A)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:Z,children:I},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),W2=ot.memo(({event:n,user:e,filterProject:t,isEditing:s,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const h=t&&t!=="all",y=n.assignedTo||[],[I,v]=V.useState(!1),w=ot.useRef(null),R=()=>{const fe=window.innerWidth,je=window.innerHeight;return fe>=768&&fe<1024||fe>=1024&&je>fe},[P,F]=V.useState(R),[re,Z]=V.useState(!1);ot.useRef(null),ot.useRef(!1);const[M,A]=V.useState(r||""),N=ot.useRef(s);V.useEffect(()=>{s&&!N.current&&r!==void 0&&A(r),N.current=s},[s,r]);const C=e!=null&&e.name?e.name.slice(-2):null,j=C&&["",""].includes(C),S=C&&["","",""].includes(C),T=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&S||y.includes("")&&j);V.useEffect(()=>{const fe=()=>{F(R())};return window.addEventListener("resize",fe),()=>window.removeEventListener("resize",fe)},[]);const E=fe=>{A(fe)},De=()=>{M!=null&&M.trim()&&o&&(i&&i(M),o()),u&&u()},He=fe=>{fe.stopPropagation(),(fe.key==="Enter"||fe.key==="Escape")&&fe.currentTarget.blur()};return P?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{Z(!0),v(!0)},onMouseLeave:()=>{Z(!1),v(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[I&&h&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:w,onMouseDown:fe=>{fe.stopPropagation(),fe.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!n.isASVisit&&n.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",rg(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&y.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((fe,je)=>{const ut=fe==="HV LAB"||fe===""&&j||fe===""&&S||fe===(e==null?void 0:e.name);return a.jsxDEV(ot.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:ut?"bold":"normal"},children:fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),je<y.length-1&&""]},fe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:fe=>E(fe.target.value),onBlur:De,onKeyDown:He,onClick:fe=>fe.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:T?"underline":"none",textDecorationColor:T?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:n.title,children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),re&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),n.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",n.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!n.isASVisit&&n.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",rg(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:fe=>E(fe.target.value),onBlur:De,onKeyDown:He,onClick:fe=>fe.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:T?"underline":"none",textDecorationColor:T?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&y.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((fe,je)=>{const ut=fe==="HV LAB"||fe===""&&j||fe===""&&S||fe===(e==null?void 0:e.name);return a.jsxDEV(ot.Fragment,{children:[a.jsxDEV("span",{className:ut?"font-bold":"",children:fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),je<y.length-1&&""]},fe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),I&&h&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:w,onMouseDown:fe=>{fe.stopPropagation(),fe.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&s&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(fe=>a.jsxDEV("option",{value:fe},fe,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),K2=()=>{const{schedules:n,setSchedules:e,addSchedule:t,deleteSchedule:s,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=Or(),{user:y}=zr(),I=nu(),[v,w]=V.useState(!1);V.useEffect(()=>{const b=()=>{const H=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;w(H)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const R=b=>!b||b==="-"?"":v?b:Pm(b),P=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",P);const F=ot.useRef(!1);V.useEffect(()=>{F.current||(F.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),ie.error("  ")}))},[r]);const[re,Z]=V.useState([]);V.useEffect(()=>{const b=async H=>{if((H.ctrlKey||H.metaKey)&&H.key==="z"){const Q=H.target;if(Q.tagName==="INPUT"||Q.tagName==="TEXTAREA"||Q.isContentEditable)return;if(re.length>0){H.preventDefault();const K=re[re.length-1];try{const le=K.type==="as_visit"||K.type==="expected_payment"?"other":K.type;await i({id:"",title:K.originalTitle||K.title,start:K.start,end:K.end,type:le,project:K.originalProjectName||K.projectName,attendees:K.assignedTo||[],time:K.time,description:K.description}),Z(ge=>ge.slice(0,-1)),ie.success(" ")}catch(le){console.error("  :",le),ie.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[re,i]);const[M,A]=V.useState([]),[N,C]=V.useState(!1),[j,S]=V.useState(""),[T,E]=V.useState(null),[De,He]=V.useState(""),[fe,je]=V.useState(!1),[ut,Ft]=V.useState(null),[Rt,oe]=V.useState(null),Me=V.useCallback(async()=>{je(!0);try{const b=await Ae.get("/processes");A(b.data)}catch(b){console.error("   :",b),A([])}finally{je(!1)}},[]);V.useEffect(()=>{Me()},[Me]);const ue=V.useMemo(()=>M.length>0?M.map(b=>b.name):O2,[M]),Pe=async()=>{if(j.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(b.ok)S(""),Me(),ie.success(" ");else{const H=await b.json();ie.error(H.error||"  ")}}catch(b){console.error("  :",b),ie.error("  ")}},We=async()=>{if(!(!T||!De.trim()))try{const b=await fetch(`/api/processes/${T.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:De.trim()})});if(b.ok)E(null),He(""),Me(),ie.success(" ");else{const H=await b.json();ie.error(H.error||"  ")}}catch(b){console.error("  :",b),ie.error("  ")}},bt=async b=>{if(confirm("   ?"))try{const H=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(H.ok)Me(),ie.success(" ");else{const Q=await H.json();ie.error(Q.error||"  ")}}catch(H){console.error("  :",H),ie.error("  ")}},st=b=>{Ft(b)},At=(b,H)=>{b.preventDefault(),ut!==null&&ut!==H&&oe(H)},nt=async()=>{if(ut!==null&&Rt!==null&&ut!==Rt){const b=[...M],[H]=b.splice(ut,1);b.splice(Rt,0,H),A(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(K=>({id:K.id}))})})).ok||(Me(),ie.error("  "))}catch(Q){console.error("  :",Q),Me(),ie.error("  ")}}Ft(null),oe(null)},lt=b=>{const H=I.findIndex(Q=>Q.name===b);return H>=0?sg[H%sg.length]:"#e8e2ea"},an=I.map(b=>b.name),G=n.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||an.includes(b.project):!0).map(b=>{const H=I.find(he=>he.name===b.project);let Q=b.project===""?"[]":b.project;if(H&&b.project!==""){const he=H.name.length>2?H.name.substring(0,2):H.name,pt=(H.location||"").match(/([A-Za-z]?\d+)/),dn=pt?pt[1]:"";Q=dn?`${he}_${dn}`:he}const K=b.time,le=K&&K!=="-"?` - ${R(K)}`:"",ge=b.attendees||[];return{id:b.id,title:b.title+le,originalTitle:b.title,start:b.start,end:b.end,projectId:(H==null?void 0:H.id)||"",projectName:Q||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:ge,priority:"medium",allDay:!K||K==="-",color:lt(b.project||""),isASVisit:!1,time:K,description:b.description}}),Te=u.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?an.includes(b.project):!0).map(b=>{const H=b.scheduledVisitTime,Q=H&&H!=="-"?` - ${R(H)}`:"",K=I.find(he=>he.name===b.project);let le=b.project;if(K){const he=K.name.length>2?K.name.substring(0,2):K.name,pt=(K.location||"").match(/([A-Za-z]?\d+)/),dn=pt?pt[1]:"";le=dn?`${he}_${dn}`:he}const ge=`[AS] ${le}`;return{id:`as-${b.id}`,title:ge+Q,originalTitle:ge,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(K==null?void 0:K.id)||"",projectName:le,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(he=>he.trim()):[],priority:"high",allDay:!H||H==="-",color:"#FEF3C7",isASVisit:!0,time:H,description:b.description}}),Re=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var ge,he,it,pt,dn,It,Tt,nn;const H=I.find(_n=>_n.name===b.project);if(!H){const _n=[],kt=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),Xt=new Set(b.payments.flatMap(un=>{var $t;return(($t=un.type)==null?void 0:$t.split(", ").map(zt=>zt.trim()))||[]}));return!Xt.has("")&&((ge=b.expectedPaymentDates)!=null&&ge.contract)&&_n.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(kt*.1).toLocaleString()}`}),!Xt.has("")&&((he=b.expectedPaymentDates)!=null&&he.start)&&_n.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(kt*.4).toLocaleString()}`}),!Xt.has("")&&((it=b.expectedPaymentDates)!=null&&it.middle)&&_n.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(kt*.4).toLocaleString()}`}),!Xt.has("")&&((pt=b.expectedPaymentDates)!=null&&pt.final)&&_n.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(kt*.1).toLocaleString()}`}),_n}if(!H.startDate||!H.endDate)return[];const Q=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),K=new Set(b.payments.flatMap(_n=>{var kt;return((kt=_n.type)==null?void 0:kt.split(", ").map(Xt=>Xt.trim()))||[]})),le=[];return!K.has("")&&((dn=b.expectedPaymentDates)!=null&&dn.contract)&&le.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Q*.1).toLocaleString()}`}),!K.has("")&&((It=b.expectedPaymentDates)!=null&&It.start)&&le.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Q*.4).toLocaleString()}`}),!K.has("")&&((Tt=b.expectedPaymentDates)!=null&&Tt.middle)&&le.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Q*.4).toLocaleString()}`}),!K.has("")&&((nn=b.expectedPaymentDates)!=null&&nn.final)&&le.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Q*.1).toLocaleString()}`}),le}):[],we=[...G,...Te,...Re],Qe=V.useCallback(b=>{if(!(y!=null&&y.name))return!1;const H=b.assignedTo||[],Q=y.name.slice(-2),K=["",""].includes(Q),le=["","",""].includes(Q);return H.includes(y.name)||H.includes("HV LAB")||H.includes("")&&le||H.includes("")&&K},[y==null?void 0:y.name]),Ct=(b,H)=>{if(!H)return[...b].sort((le,ge)=>{const he=Qe(le),it=Qe(ge);return he&&!it?-1:!he&&it?1:le.start.getTime()-ge.start.getTime()});const Q=new Map;b.forEach(le=>{const ge=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||ge){const he=`single_${le.id}`;Q.set(he,[le])}else{const he=le.start.toISOString().split("T")[0],it=[...le.assignedTo].sort().join(","),pt=`${he}_${le.projectName}_${it}`;Q.has(pt)||Q.set(pt,[]),Q.get(pt).push(le)}});const K=[];return Q.forEach(le=>{if(le.length===1)K.push(le[0]);else{const ge=le[0],he=le.map(Tt=>Tt.originalTitle||Tt.title),it=[...new Set(he)],pt=le.map(Tt=>{const nn=Tt.originalTitle||Tt.title;return nn.startsWith(ge.projectName+" - ")?nn.substring(ge.projectName.length+3):nn}),dn=[...new Set(pt)],It={...ge,id:le[0].id,title:dn.join(", "),originalTitle:it.join(", "),description:le.map(Tt=>Tt.description||Tt.originalTitle||Tt.title).join(`
`),assignedTo:[...new Set(le.flatMap(Tt=>Tt.assignedTo))],mergedEventIds:le.map(Tt=>Tt.id)};K.push(It)}}),K.sort((le,ge)=>{const he=Qe(le),it=Qe(ge);return he&&!it?-1:!he&&it?1:le.start.getTime()-ge.start.getTime()})},[Ot,at]=V.useState("month"),[L,q]=V.useState(new Date),[ee,ye]=V.useState(!1),[ce,me]=V.useState(null),[Ce,Fe]=V.useState(null),Ze=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[Ee,Sn]=V.useState(()=>{const b=localStorage.getItem(Ze);return b||((y==null?void 0:y.name)===""&&I.length>0?I[0].name:"all")});V.useEffect(()=>{localStorage.setItem(Ze,Ee)},[Ee,Ze]),V.useCallback(()=>{document.body.classList.add("printing-schedule");const b=Ee==="all"?" ":Ee,H=rt(L).format("YYYY MM"),Q=document.title;document.title=`${b} - ${H} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Q},100)},[Ee,L]);const jt=Ct(we,Ee==="all"),[te,Ye]=V.useState(window.innerWidth<768?new Date:null),[O,be]=V.useState(null),ke=ot.useRef(null),Se=ot.useRef(!1),[ae,yt]=V.useState(null),_t=ot.useRef(!1),Kt=ot.useRef(!1);V.useEffect(()=>{const b=K=>{K.key==="Control"&&(Kt.current=!0)},H=K=>{K.key==="Control"&&(Kt.current=!1)},Q=()=>{Kt.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",H),window.addEventListener("blur",Q),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",H),window.removeEventListener("blur",Q)}},[]),V.useEffect(()=>{if(!O)return;let b=null;const H=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy")},Q=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy");const it=ge.target.closest(".rbc-day-bg");b&&b!==it&&(b.style.backgroundColor=""),it&&(it.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=it)},K=()=>{b&&(b.style.backgroundColor="",b=null)},le=ge=>{ge.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",H),document.addEventListener("dragover",Q),document.addEventListener("dragend",K),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",H),document.removeEventListener("dragover",Q),document.removeEventListener("dragend",K),document.removeEventListener("drop",le),b&&(b.style.backgroundColor="")}},[O]);const[Nt,ln]=V.useState(null),[tn,An]=V.useState(null),[cs,Wn]=V.useState(""),[us,ti]=V.useState(!1),[ws,Xn]=V.useState(null),[Is,Pn]=V.useState(!1),[_,x]=V.useState(""),[k,U]=V.useState(null),[B,Y]=V.useState({x:0,y:0}),[ne,W]=V.useState({x:0,y:0}),[X,de]=V.useState(!1),Be=8;V.useEffect(()=>{if(!k)return;const b=Q=>{Y({x:Q.clientX,y:Q.clientY});const K=Math.abs(Q.clientX-ne.x),le=Math.abs(Q.clientY-ne.y);(K>Be||le>Be)&&de(!0)},H=()=>{U(null),de(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",H),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",H)}},[k,ne]);const Ke=ot.useRef(!1),Xe=V.useCallback(async({event:b,start:H,end:Q})=>{if(b.isASVisit||b.isExpectedPayment){ie.error("    ");return}const K=H instanceof Date?H:new Date(H),le=Q instanceof Date?Q:new Date(Q);if(Kt.current)try{const he=b.mergedEventIds||[b.id],it=n.filter(pt=>he.includes(pt.id));for(const pt of it)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:pt.title,start:K,end:le,project:pt.project,attendees:pt.attendees||[],time:pt.time,priority:pt.priority||"medium"});ie.success(" ")}catch(he){console.error("  :",he),ie.error("  ")}else{const he=b.mergedEventIds||[b.id];try{for(const it of he)await o(it,{start:K,end:le})}catch(it){console.error("  :",it),ie.error("  "),r()}}},[n,o,i,r]),_e=V.useCallback(({event:b,action:H})=>{var K;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const Q=document.querySelectorAll(".rbc-event");for(const le of Q)if((K=le.textContent)!=null&&K.includes(b.originalTitle||b.title)){const ge=le.getBoundingClientRect();W({x:ge.left,y:ge.top}),Y({x:ge.left,y:ge.top});break}de(!1),U(b)},[]),Ge=V.useCallback(async(b,H,Q=!1)=>{if(Ee==="all"){ie.error("  ");return}const K={id:"",title:b,start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(K)}catch(le){console.error("  :",le),ie.error("  ")}},[Ee,i,y]),wt=V.useCallback(({start:b})=>{const H=O||ke.current;H&&Ee!=="all"&&(Se.current=!0,_t.current=!0,requestAnimationFrame(()=>{_t.current=!1}),ln(null),An(null),Wn(""),Ge(H,b),requestAnimationFrame(()=>{be(null),ke.current=null,Se.current=!1}))},[O,Ee,Ge]),Gt=V.useCallback(()=>{const b=O||ke.current;return b?{title:b}:null},[O]),Bn=V.useCallback(async b=>{if(!b.trim()||!Nt||Ee==="all"){ln(null);return}const H=Nt;ln(null);const Q={id:"",title:b.trim(),start:H,end:H,type:"construction",project:Ee,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(Q)}catch(K){console.error("  :",K),ie.error("  ")}},[Nt,Ee,i,y]),Yt=V.useCallback(()=>{ln(null)},[]),Jn=V.useCallback(async()=>{var b;if(!tn||!cs.trim()){An(null),Wn("");return}try{const H=((b=tn.mergedEventIds)==null?void 0:b[0])||tn.id;await o(H,{title:cs.trim()})}catch(H){console.error("  :",H),ie.error("  ")}An(null),Wn("")},[tn,cs,o]),Un=V.useCallback(async b=>{Z(Q=>[...Q,b]);const H=b.mergedEventIds||[b.id];ie.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(H.map(Q=>l(Q)))}catch(Q){console.error("  :",Q),ie.error("  "),Z(K=>K.slice(0,-1))}An(null),Wn("")},[l]),qt=Ee==="all"?jt:jt.filter(b=>(b.originalProjectName||b.projectName)===Ee),Oe=ot.useMemo(()=>{const b=Ee!=="all",H=new Map;qt.forEach(K=>{const le=rt(K.start).format("YYYY-MM-DD");H.has(le)||H.set(le,[]),H.get(le).push(K)});const Q=[];return H.forEach(K=>{if(b)K.forEach((le,ge)=>{const he=rt(le.start).startOf("day").add(ge,"milliseconds").toDate();Q.push({...le,start:he,allDay:!1})});else{const le=[],ge=[];K.forEach(he=>{Qe(he)?le.push(he):ge.push(he)}),le.forEach((he,it)=>{const pt=rt(he.start).startOf("day").add(it,"milliseconds").toDate();Q.push({...he,start:pt,allDay:!1})}),ge.forEach((he,it)=>{const pt=rt(he.start).startOf("day").add(1e3+it,"milliseconds").toDate();Q.push({...he,start:pt,allDay:!1})})}}),Q.sort((K,le)=>K.start.getTime()-le.start.getTime())},[qt,Qe,Ee]),xe=ot.useMemo(()=>{if(Nt&&Ee!=="all"){const b=rt(Nt).format("YYYY-MM-DD"),H=Oe.filter(ge=>rt(ge.start).format("YYYY-MM-DD")===b),Q=H.length>0?Math.max(...H.map(ge=>ge.start.getTime())):rt(Nt).startOf("day").valueOf(),K=new Date(Q+1),le={id:"__inline_add__",title:"",start:K,end:K,projectId:"",projectName:Ee,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Oe,le]}return Oe},[Oe,Nt,Ee]);V.useEffect(()=>{(y==null?void 0:y.name)===""&&I.length>0&&(Ee==="all"||!I.find(b=>b.name===Ee))&&Sn(I[0].name)},[I,y]),V.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.opacity="0",he.style.pointerEvents="none",he.style.position="absolute",he.style.left="-9999px",he.style.top="-9999px",he.style.zIndex="-1"})};b();const H=new MutationObserver(b),Q=document.querySelector(".rbc-calendar");Q&&H.observe(Q,{childList:!0,subtree:!0});const K=new MutationObserver(b);return K.observe(document.body,{childList:!0,subtree:!0}),()=>{H.disconnect(),K.disconnect()}},[Ot,L]);const[$e,mt]=V.useState({date:null,projectId:"",title:""}),xt=ot.useRef(!1),qe=ot.useRef(null),Je=b=>{if(Ke.current){Ke.current=!1;return}if(b.id==="__inline_add__")return;xt.current=!0,qe.current&&clearTimeout(qe.current);const H=Ee!=="all",Q=window.innerWidth<768;if(H&&!Q&&!b.isASVisit&&!b.isExpectedPayment)ln(null),An(b),Wn(b.originalTitle||b.title);else{const K={...b,title:b.originalTitle||b.title};Fe(null),me(K),ye(!0)}qe.current=setTimeout(()=>{xt.current=!1,qe.current=null},300)},dt=b=>{const H=window.innerWidth,Q=H<768,K=H>=768&&H<1024,le=Ee==="all";if(_t.current)return;if(Q){if(b.start){Ye(b.start);const he=document.querySelector(".md\\:hidden.mt-3.bg-white");he&&he.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const ge=b.action==="click"||b.action==="select";if(!(K&&!ge)){if(le){xt.current=!1,An(null),Wn(""),ln(null),Fe(b),me(null),ye(!0);return}if(!xt.current){if(ae){Ge(ae,b.start,!0);return}An(null),Wn(""),ln(b.start)}}},mn=async()=>{if(!$e.projectId||!$e.title.trim()){alert("  ");return}const b=I.find(H=>H.id===$e.projectId);if(!(!b||!$e.date))try{await i({id:Date.now().toString(),title:$e.title,start:$e.date,end:$e.date,type:"other",project:b.name,location:"",attendees:[],description:""}),mt({date:null,projectId:"",title:""}),Ye(null)}catch(H){console.error("Failed to add schedule:",H),ie.error("  ")}},cn=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let H=b.color||"#E0E7FF",Q="#1f2937";if(b.isASVisit)H="#E8F5E9",Q="#1f2937";else{const K=b.assignedTo&&b.assignedTo.includes("HV LAB"),le=b.assignedTo&&b.assignedTo.includes("")&&P&&["",""].includes(P),ge=b.assignedTo&&b.assignedTo.includes("")&&P&&["","",""].includes(P);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||K||le||ge?(H="#FEF3C7",Q="#1f2937"):b.color||(H="#e8e2ea")}return{style:{backgroundColor:H,"--event-bg-color":H,borderRadius:"6px",color:Q,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},ur=ot.useCallback(b=>{const H=rt(b).format("YYYY-MM-DD"),Q=!!Na[H],K=te&&rt(b).isSame(te,"day"),le=window.innerWidth<768;let ge="";K&&(ge+="selected-date "),Q&&(ge+="holiday-date ");const he=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:ge.trim(),style:he}},[te]),[ft,Ri]=V.useState(window.innerWidth<768);V.useEffect(()=>{const b=()=>{Ri(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),V.useEffect(()=>{const b=()=>{const H=te||new Date;Fe({start:H,end:H}),me(null),ye(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[te]);const mr=ot.useCallback(({date:b,label:H})=>a.jsxDEV(z2,{date:b,label:H,filteredEvents:xe,selectedDate:te,user:y,isMobileView:ft},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[xe,te,y,ft]),dr=ot.useRef(cs);dr.current=cs;const Ja=ot.useCallback(b=>{Wn(b)},[]),Po=ot.useCallback(()=>{An(null),Wn("")},[]),Za=ot.useCallback(({event:b})=>{if(b.id==="__inline_add__")return a.jsxDEV($2,{onSave:Bn,onCancel:Yt,processList:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const H=(tn==null?void 0:tn.id)===b.id||(tn==null?void 0:tn.mergedEventIds)&&tn.mergedEventIds.includes(b.id);return a.jsxDEV(W2,{event:b,user:y,filterProject:Ee,isEditing:H,editTitle:H?dr.current:void 0,onEditTitleChange:H?Ja:void 0,onEditSave:H?Jn:void 0,onEditDelete:H?()=>Un(b):void 0,onEditCancel:H?Po:void 0,onHoverDelete:()=>Un(b),onDeleteAction:()=>{Ke.current=!0},processList:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,Ee,tn,Jn,Un,Bn,Yt,Ja,Po,ue]),mu=({onNavigate:b})=>{const[H,Q]=ot.useState(!1),[K,le]=ot.useState(rt(L).year()),[ge,he]=ot.useState(rt(L).month()),it=window.innerWidth<768,pt=()=>{le(rt(L).year()),he(rt(L).month()),Q(!0)},dn=()=>{q(rt().year(K).month(ge).toDate()),Q(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${it?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:pt,children:[a.jsxDEV("span",{children:rt(L).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ee==="all"?" ":Ee]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ee,onChange:It=>{Sn(It.target.value),yt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),I.filter(It=>It.status!=="completed").map(It=>a.jsxDEV("option",{value:It.name,children:It.name},It.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),H&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Q(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(K-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[K,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(K+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(It=>{const Tt=ge===It-1,nn=rt().year()===K&&rt().month()===It-1;return a.jsxDEV("button",{onClick:()=>he(It-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${Tt?"bg-gray-900 text-white":nn?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[It,""]},It,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{q(new Date),Q(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:dn,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},du=()=>null,fu=V.useMemo(()=>({toolbar:mu,event:Za,month:{dateHeader:mr,showMore:du}}),[mr,Za]),fr=ot.useMemo(()=>{if(!te)return[];let b;if(ft)b=xe.filter(Q=>rt(Q.start).isSame(te,"day"));else{const Q=rt(te).startOf("week"),K=rt(te).endOf("week");b=xe.filter(le=>{const ge=rt(le.start);return ge.isSameOrAfter(Q,"day")&&ge.isSameOrBefore(K,"day")})}const H=[...b].sort((Q,K)=>{const le=Q.assignedTo&&Q.assignedTo.includes("HV LAB"),ge=Q.assignedTo&&Q.assignedTo.includes("")&&P&&["",""].includes(P),he=Q.assignedTo&&Q.assignedTo.includes("")&&P&&["","",""].includes(P),it=Q.assignedTo&&P&&Q.assignedTo.includes(P)||Q.assignedTo&&(y==null?void 0:y.name)&&Q.assignedTo.includes(y.name)||le||ge||he,pt=K.assignedTo&&K.assignedTo.includes("HV LAB"),dn=K.assignedTo&&K.assignedTo.includes("")&&P&&["",""].includes(P),It=K.assignedTo&&K.assignedTo.includes("")&&P&&["","",""].includes(P),Tt=K.assignedTo&&P&&K.assignedTo.includes(P)||K.assignedTo&&(y==null?void 0:y.name)&&K.assignedTo.includes(y.name)||pt||dn||It;return it&&!Tt?-1:!it&&Tt?1:new Date(Q.start).getTime()-new Date(K.start).getTime()});return console.log("Sorted events:",H.map(Q=>({title:Q.title,assignedTo:Q.assignedTo,user:y==null?void 0:y.name,userShort:P}))),H},[te,xe,y,P,ft]);return V.useEffect(()=>{const H=setTimeout(()=>{const Q=ft?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),K=document.querySelectorAll(".rbc-month-row"),le=[];K.forEach((kt,Xt)=>{const un=kt.querySelectorAll(".rbc-date-cell");let $t=0;un.forEach(zt=>{const ht=zt.querySelector("button");let Qt=ht==null?void 0:ht.textContent;if(!Qt){const hs=zt.querySelector("span");Qt=hs==null?void 0:hs.textContent}if(Qt&&!isNaN(parseInt(Qt))){const hs=rt(L).date(parseInt(Qt)),Ts=xe.filter(Bi=>rt(Bi.start).isSame(hs,"day"));$t=Math.max($t,Ts.length)}}),le.push($t)});const ge=Ee&&Ee!=="all",he=100,it=ge?60:18,pt=25,dn=Math.floor((he-pt)/it),It=le.length,Tt=he*It,nn=le.map(kt=>kt<=dn?he:pt+kt*it+10),_n=nn.reduce((kt,Xt)=>kt+Xt,0);if(_n>Tt){const kt=nn.map(($t,zt)=>({index:zt,height:$t,overflow:$t>he})),Xt=kt.filter($t=>$t.overflow).reduce(($t,zt)=>$t+(zt.height-he),0),un=kt.filter($t=>!$t.overflow);if(un.length>0){const $t=Tt-Xt-un.length*he,zt=Math.max(50,he+$t/un.length);K.forEach((ht,Qt)=>{const Ts=nn[Qt]>he?nn[Qt]:zt;ht.style.height=`${Ts}px`,ht.style.minHeight=`${Ts}px`})}else{const $t=Tt/_n;K.forEach((zt,ht)=>{const Qt=Math.max(80,nn[ht]*$t);zt.style.height=`${Qt}px`,zt.style.minHeight=`${Qt}px`})}}else{const kt=nn.reduce((zt,ht)=>zt+(ht>he?ht:0),0),Xt=nn.filter(zt=>zt<=he).length,un=Tt-kt,$t=Xt>0?un/Xt:he;K.forEach((zt,ht)=>{const Qt=nn[ht]>he?nn[ht]:$t;zt.style.height=`${Qt}px`,zt.style.minHeight=`${Qt}px`})}Q.forEach(kt=>{const Xt=kt.querySelector("button");let un=Xt==null?void 0:Xt.textContent;if(!un){const Qt=kt.querySelector("span");un=Qt==null?void 0:Qt.textContent}if(!un||isNaN(parseInt(un)))return;const $t=rt(L).date(parseInt(un)),zt=xe.filter(Qt=>rt(Qt.start).isSame($t,"day"));zt.length>0?kt.setAttribute("data-event-count",zt.length.toString()):kt.removeAttribute("data-event-count");const ht=$t.clone().toDate();if(te&&rt(ht).isSame(te,"day")?kt.classList.add("selected-date"):kt.classList.remove("selected-date"),ft){const Qt=kt,hs=Qt._mobileClickHandler;hs&&kt.removeEventListener("click",hs);const Ts=Bi=>{if(Bi.target.closest(".rbc-event"))return;const Ui=$t.clone().toDate();Ye(Ui);const gs=document.querySelector(".md\\:hidden.mt-3.bg-white");gs&&gs.scrollIntoView({behavior:"smooth",block:"nearest"})};Qt._mobileClickHandler=Ts,kt.addEventListener("click",Ts,!0),kt.style.cursor="pointer",kt.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(H),ft&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(K=>{const le=K,ge=le._mobileClickHandler;ge&&(K.removeEventListener("click",ge),delete le._mobileClickHandler)})}},[xe,L,ft,te,Ee]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[$e.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:rt($e.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:$e.projectId,onChange:b=>mt({...$e,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:I.filter(b=>b.status!=="completed").map(b=>a.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:$e.title,onChange:b=>mt({...$e,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&mn()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:mn,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{mt({date:null,projectId:"",title:""}),Ye(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[Ee!=="all"&&!ft&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>C(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),ae&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:ue.map(b=>a.jsxDEV("div",{draggable:!0,onClick:()=>{yt(ae===b?null:b)},onDragStart:H=>{Se.current=!1,yt(null),be(b),ke.current=b,H.dataTransfer.setData("text/plain",b),H.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Se.current||(be(null),ke.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${ae===b?"bg-blue-500 text-white ring-2 ring-blue-300":O===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ee!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(F2,{localizer:q2,events:xe,startAccessor:"start",endAccessor:"end",view:Ot,onView:at,date:L,onNavigate:q,onSelectEvent:Je,onSelectSlot:dt,onEventDrop:Ee!=="all"?Xe:void 0,onDragStart:Ee!=="all"?_e:void 0,onDropFromOutside:Ee!=="all"?wt:void 0,dragFromOutsideItem:Ee!=="all"?Gt:void 0,draggableAccessor:b=>Ee!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:cn,dayPropGetter:ur,components:fu,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${Ee}-${(te==null?void 0:te.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),te&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:ft?rt(te).format("MM DD (ddd)"):`${rt(te).startOf("week").format("MM DD")} - ${rt(te).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Na[rt(te).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Na[rt(te).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[Ee!=="all"&&a.jsxDEV("button",{onClick:()=>Pn(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Ye(null),Xn(null),Pn(!1),x("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:fr.length===0?a.jsxDEV("div",{className:"p-4",children:Ee!=="all"&&Is?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:_,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&_.trim()){const H=te||new Date,Q={id:"",title:_.trim(),start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Q).then(()=>{Pn(!1),x("")}).catch(K=>{console.error("  :",K),ie.error("  ")})}else b.key==="Escape"&&(Pn(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(_.trim()){const b=te||new Date,H={id:"",title:_.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Pn(!1),x("")}).catch(Q=>{console.error("  :",Q),ie.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{Pn(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const b=fr.reduce((Q,K)=>{const le=rt(K.start).format("YYYY-MM-DD");return Q[le]||(Q[le]=[]),Q[le].push(K),Q},{});return Object.keys(b).sort().map(Q=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!ft&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:rt(Q).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[Q].map(K=>{const le=K.assignedTo&&K.assignedTo.includes("HV LAB"),ge=K.assignedTo&&K.assignedTo.includes("")&&P&&["",""].includes(P),he=K.assignedTo&&K.assignedTo.includes("")&&P&&["","",""].includes(P),pt=K.assignedTo&&(K.assignedTo.includes((y==null?void 0:y.name)||"")||P&&K.assignedTo.includes(P))||le||ge||he,dn=!K.color&&!pt,It=!K.isASVisit&&!K.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const Tt={...K,title:K.originalTitle||K.title};Je(Tt)},className:`p-3 cursor-pointer ${pt?"bg-yellow-50":""}`,style:dn?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:pt?"#FEF3C7":K.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:K.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),K.assignedTo&&K.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(_n=>K.assignedTo.includes(_n))?"":K.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),K.projectName&&Ee==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:K.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),It?a.jsxDEV("button",{onClick:Tt=>{Tt.stopPropagation(),Xn(K)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ee!=="all"&&Is&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:_,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&_.trim()){const H=te||new Date,Q={id:"",title:_.trim(),start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Q).then(()=>{Pn(!1),x("")}).catch(K=>{console.error("  :",K),ie.error("  ")})}else b.key==="Escape"&&(Pn(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(_.trim()){const b=te||new Date,H={id:"",title:_.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Pn(!1),x("")}).catch(Q=>{console.error("  :",Q),ie.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{Pn(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),ft&&Ee!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:ue.map(b=>a.jsxDEV("button",{onClick:async()=>{const H=te||new Date;if(Ee!=="all"){const Q={id:"",title:b,start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(Q)}catch(K){console.error("  :",K),ie.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),ee&&a.jsxDEV($N,{event:ce,slotInfo:Ce,defaultProjectName:Ee!=="all"?Ee:void 0,onClose:()=>{ye(!1),me(null),Fe(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(ce)if(ce.id.startsWith("as-")){const H=ce.id.replace("as-","");let Q="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?Q=b.assignedTo.join(", "):ce.assignedTo&&Array.isArray(ce.assignedTo)?Q=ce.assignedTo.join(", "):typeof ce.assignedTo=="string"&&(Q=ce.assignedTo),await m(H,{project:b.title||ce.title,assignedTo:Q,scheduledVisitDate:b.start,scheduledVisitTime:b.time||ce.time}),await d(),ye(!1)}else if(ce.id.startsWith("payment-")){const H=ce.id.split("-"),Q=H[1],K=H[2],le=f.find(ge=>ge.id===Q);if(le){const ge={...le.expectedPaymentDates};ge[K]=b.start,await h(Q,{expectedPaymentDates:ge})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let H=b.title;const Q=/ - (|) \d{1,2}( \d{1,2})?$/;if(H=H.replace(Q,""),ce.mergedEventIds&&ce.mergedEventIds.length>0){console.log(" Updating merged schedules:",ce.mergedEventIds);const K=(ce.originalTitle||ce.title).split(", "),le=H.split(", ");for(let ge=0;ge<ce.mergedEventIds.length;ge++){const he=ce.mergedEventIds[ge],it=le[ge]||K[ge]||H;await o(he,{title:it.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await o(ce.id,{title:H,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const H={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(H)}ye(!1)}catch(H){console.error("Failed to save schedule:",H),ie.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const H=b.split("-"),Q=H[1],K=H[2],le=f.find(ge=>ge.id===Q);if(le){const ge={...le.expectedPaymentDates};delete ge[K],await h(Q,{expectedPaymentDates:ge})}}else if(b.startsWith("as-")){const H=b.replace("as-","");await m(H,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const H=jt.find(Q=>Q.id===b);if(H!=null&&H.mergedEventIds&&H.mergedEventIds.length>0){console.log("Deleting merged schedules:",H.mergedEventIds);for(const Q of H.mergedEventIds)await l(Q)}else await l(b)}ye(!1)}catch(H){console.error("Failed to delete schedule:",H),ie.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),k&&X&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:B.x-50,top:B.y-15,backgroundColor:k.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:k.originalTitle||k.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),ws&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>Xn(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:ws.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>Xn(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const b=ws.mergedEventIds||[ws.id];await Promise.all(b.map(H=>l(H)))}catch(b){console.error("  :",b),ie.error(" ")}Xn(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),N&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{C(!1),E(null),S("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{C(!1),E(null),S("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:b=>S(b.target.value),onKeyDown:b=>b.key==="Enter"&&Pe(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Pe,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:fe?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):M.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:M.map((b,H)=>a.jsxDEV("div",{draggable:(T==null?void 0:T.id)!==b.id,onDragStart:()=>st(H),onDragOver:Q=>At(Q,H),onDragEnd:nt,onDragLeave:()=>oe(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${ut===H?"opacity-50 bg-gray-100":""} ${Rt===H?"border-t-2 border-gray-400":""} ${(T==null?void 0:T.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(T==null?void 0:T.id)===b.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:De,onChange:Q=>He(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&We(),Q.key==="Escape"&&(E(null),He(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:We,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{E(null),He("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:H+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{E(b),He(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>bt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),M.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},G2=({projectName:n,onClose:e,type:t="cash"})=>{const s=t==="cash",r=s?"":"",i=s?"      .":"      .",[o,l]=V.useState({receiptDate:Ut(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],y=["","","",""],I=["","","","","","","","","",""];let v="",w=0;for(;f>0;){const R=f%1e4;if(R>0){let P="",F=R,re=0;for(;F>0;){const Z=F%10;Z>0&&(P=I[Z]+y[re]+P),F=Math.floor(F/10),re++}v=P+h[w]+v}f=Math.floor(f/1e4),w++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(yn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&l({...o,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(mg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:s?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:Ut(new Date(o.receiptDate),"yyyy MM dd",{locale:gn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:Ut(new Date(o.receiptDate),"yyyy MM dd",{locale:gn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},Q2="HVLabImageDB",Y2=1,qr="paymentRecordImages";let El=null;const mf=()=>new Promise((n,e)=>{if(El){n(El);return}const t=indexedDB.open(Q2,Y2);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{El=t.result,n(El)},t.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains(qr)||r.createObjectStore(qr,{keyPath:"id"})}}),X2=async()=>{try{const n=await mf();return new Promise((e,t)=>{const i=n.transaction(qr,"readonly").objectStore(qr).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(n){console.error("IndexedDB , localStorage :",n);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},J2=async(n,e)=>{try{const t=await mf();return new Promise((s,r)=>{const l=t.transaction(qr,"readwrite").objectStore(qr).put({id:n,images:e});l.onsuccess=()=>s(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},Z2=async n=>{try{const e=await mf();return new Promise((t,s)=>{const r=e.transaction(qr,"readwrite"),i=r.objectStore(qr);i.clear(),Object.entries(n).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),s(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},eI=async()=>{try{const n=localStorage.getItem("paymentRecordImages");if(n){const e=JSON.parse(n);Object.keys(e).length>0&&(await Z2(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(n){console.error(" :",n)}},Vl=n=>{if(!n)return 0;try{const t=new Date(n).getTime();return isNaN(t)?0:t}catch{return 0}},ig=(n,e,t)=>{if(!n)return null;try{const s=new Date(n);return isNaN(s.getTime())?null:Ut(s,e,t)}catch{return null}},tI=()=>{const{payments:n,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:s,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=Or(),{user:l}=zr(),u=nu(),[m,d]=V.useState(""),[f,h]=V.useState(null),[y,I]=V.useState(null),[v,w]=V.useState(!1),[R,P]=V.useState(!1),[F,re]=V.useState(!1),[Z,M]=V.useState(!1),[A,N]=V.useState(""),[C,j]=V.useState("form"),[S,T]=V.useState(!1),[E,De]=V.useState(!1),He=V.useRef(null),[fe,je]=V.useState("pending"),[ut,Ft]=V.useState("all"),[Rt,oe]=V.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[Me,ue]=V.useState(!1),[Pe,We]=V.useState(null),[bt,st]=V.useState(!1),[At,nt]=V.useState(""),[lt,an]=V.useState(!1),G=V.useRef(!1),Te=V.useRef(!1),Re=V.useRef(null),[we,Qe]=V.useState([]),[Ct,Ot]=V.useState([]),[at,L]=V.useState(null),[q,ee]=V.useState([]),[ye,ce]=V.useState([]),[me,Ce]=V.useState(!1),[Fe,Ze]=V.useState({}),[Ee,Sn]=V.useState(!1),jt=()=>{const _=localStorage.getItem("lastSelectedProject"),x=u.filter(k=>k.status!=="completed");return _&&x.some(k=>k.name===_)?_:x.length>0?x[0].name:""},[te,Ye]=V.useState({project:"",date:Ut(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});V.useEffect(()=>{(async()=>{try{const x=await tr.getAllContractors();Qe(x.map(k=>({id:k._id||k.id,rank:k.rank,companyName:k.companyName,name:k.name,process:k.process,contact:k.contact,accountNumber:k.accountNumber,bankName:k.bankName,notes:k.notes,createdAt:new Date(k.createdAt),updatedAt:new Date(k.updatedAt)})))}catch(x){console.error("Failed to load contractors:",x)}})()},[]),V.useEffect(()=>{Ft("all"),t().catch(x=>{console.error("Failed to load projects:",x)}),e().catch(x=>{console.error("Failed to load payments:",x)});const _=()=>{T(window.innerWidth<1024)};if(_(),window.addEventListener("resize",_),u.length>0&&!te.project&&!Te.current){const x=jt();x&&(Ye(k=>({...k,project:x})),localStorage.setItem("lastSelectedProject",x))}return()=>window.removeEventListener("resize",_)},[]),V.useEffect(()=>{const _=setInterval(()=>{if(Re.current){console.log("[ ]     - ");return}console.log("[ ]    ..."),e().catch(k=>{console.error("[ ] :",k)})},3e4),x=()=>{if(document.visibilityState==="visible"){if(Re.current){console.log("[ ]     - ");return}console.log("[ ]   -    ..."),e().catch(k=>{console.error("[ ] :",k)})}};return document.addEventListener("visibilitychange",x),()=>{clearInterval(_),document.removeEventListener("visibilitychange",x)}},[e]),V.useEffect(()=>{let _=Er.getSocket(),x=0,k=null;const U=Y=>{if(console.log(" [ ]    :",Y),Re.current&&String(Y.paymentId)===Re.current){console.log(" [ ]    -  ");return}console.log(" [ ] loadPaymentsFromAPI  (  )"),e().catch(ne=>{console.error("[ ]  :",ne)})},B=()=>(_=Er.getSocket(),_?(console.log(" [Payments] Socket  , payment:refresh  "),_.on("payment:refresh",U),k&&(clearInterval(k),k=null),!0):!1);return B()||(console.log(" [Payments] Socket  ..."),k=setInterval(()=>{x++,(B()||x>=10)&&(k&&(clearInterval(k),k=null),x>=10&&!Er.getSocket()&&console.warn(" [Payments] Socket   -   "))},500)),()=>{k&&clearInterval(k);const Y=Er.getSocket();Y&&Y.off("payment:refresh",U)}},[e]),V.useEffect(()=>{(async()=>{var U,B,Y,ne;if(G.current)return;const x=new URLSearchParams(window.location.search),k=x.get("complete")||x.get("c");if(k){if(!l){console.log("[ ]   -  ");return}G.current=!0,console.log("[ ]  :",k),window.history.replaceState({},"","/payments"),Te.current=!0,j("list"),je("completed"),Ft("all"),Ye(W=>({...W,project:""})),o(String(k),{status:"completed",completionDate:new Date}),ie.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(k),{status:"completed"}),await e();const W=Er.getSocket();W&&W.emit("payment:refresh",{paymentId:k,status:"completed",updatedAt:new Date().toISOString()})}catch(W){console.error("[ ]  :",W),o(String(k),{status:"pending",completionDate:void 0}),je("pending");let X="  ";((U=W.response)==null?void 0:U.status)===401?X=" .  ":((B=W.response)==null?void 0:B.status)===404?X="     (ID: "+k+")":(ne=(Y=W.response)==null?void 0:Y.data)!=null&&ne.error?X=W.response.data.error:W.message&&(X+=": "+W.message),ie.error(X)}}})()},[e,i,o,l]),V.useEffect(()=>{if(te.process){const _=new Set(n.filter(B=>{var Y;return B.status==="completed"&&((Y=B.bankInfo)==null?void 0:Y.accountHolder)}).map(B=>B.bankInfo.accountHolder.trim().toLowerCase())),x=(B,Y)=>{const ne=B.toLowerCase(),W=Y.toLowerCase();if(ne.includes(W)||W.includes(ne))return!0;const X=ne.split("/").map(Be=>Be.trim()),de=W.replace(/$/,"").trim();for(const Be of X)if(Be===de||de.includes(Be)||Be.includes(de))return!0;return!1},U=we.filter(B=>{if(!x(te.process,B.process))return!1;const ne=B.accountNumber&&B.accountNumber.trim()!=="",W=B.name.trim().toLowerCase(),X=_.has(W);return ne||X}).sort((B,Y)=>{const ne=B.accountNumber&&B.accountNumber.trim()!=="",W=Y.accountNumber&&Y.accountNumber.trim()!=="";return ne&&!W?-1:!ne&&W?1:0});Ot(U)}else Ot([])},[te.process,we,n]),V.useEffect(()=>{if(te.process){const _=(U,B)=>{if(!B)return!1;const Y=U.toLowerCase(),ne=B.toLowerCase();if(Y.includes(ne)||ne.includes(Y))return!0;const W=Y.split("/").map(de=>de.trim()),X=ne.replace(/$/,"").trim();for(const de of W)if(de===X||X.includes(de)||de.includes(X))return!0;return!1},x=n.filter(U=>{var B,Y,ne;return U.status==="completed"&&U.process&&_(te.process,U.process)&&((B=U.bankInfo)==null?void 0:B.accountHolder)&&((Y=U.bankInfo)==null?void 0:Y.bankName)&&((ne=U.bankInfo)==null?void 0:ne.accountNumber)}),k=new Map;x.forEach(U=>{const B=`${U.bankInfo.accountHolder}_${U.bankInfo.bankName}_${U.bankInfo.accountNumber}`;k.has(B)||k.set(B,{accountHolder:U.bankInfo.accountHolder,bankName:U.bankInfo.bankName,accountNumber:U.bankInfo.accountNumber,itemName:U.itemName||"",amount:U.amount||0})}),ee(Array.from(k.values()))}else ee([])},[te.process,n]),V.useEffect(()=>{var x;const _=((x=te.accountHolder)==null?void 0:x.trim())||"";if(_.length>=1&&me){const k=[],U=new Set;we.filter(B=>B.accountNumber&&B.accountNumber.trim()!=="").forEach(B=>{const Y=B.name.trim(),ne=Y.toLowerCase(),W=_.toLowerCase();ne.startsWith(W)&&!U.has(ne)&&(U.add(ne),k.push({name:Y,bankName:B.bankName||"",accountNumber:B.accountNumber||"",source:"contractor"}))}),n.filter(B=>{var Y;return B.status==="completed"&&((Y=B.bankInfo)==null?void 0:Y.accountHolder)}).forEach(B=>{const Y=B.bankInfo.accountHolder.trim(),ne=Y.toLowerCase(),W=_.toLowerCase();ne.startsWith(W)&&!U.has(ne)&&(U.add(ne),k.push({name:Y,bankName:B.bankInfo.bankName||"",accountNumber:B.bankInfo.accountNumber||"",source:"payment"}))}),ce(k)}else ce([])},[te.accountHolder,me,we,n]);const O=_=>{const x=_.split(`
`).map(W=>W.trim()).filter(W=>W),k={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},U=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],B=W=>{const X=["","","","","","","",""];for(const de of X)if(W.endsWith(de)&&W.length>de.length+1)return W.slice(0,-de.length);return W},Y=W=>{if(!W||W.length<2||W.length>5||!/^[-]{2,5}$/.test(W)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(W)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(W))return!1;if(W.length>=2){const Be=W.charAt(0),Ke=W.substring(0,2);if(["","","","","","",""].includes(Ke)||U.includes(Be))return!0}return W.length>=2&&W.length<=4},ne=x.some(W=>W.includes(" ")||W.includes(""));if(x.forEach((W,X)=>{if(W.includes("")&&W.includes(":")){const de=W.match(/\s*:\s*(.+)/);de&&(k.itemName=de[1].trim())}if(W.includes("")&&W.includes(":")){const de=W.match(/\s*:\s*(.+)/);de&&(k.bankInfo.accountHolder=de[1].trim())}if(W.includes("")&&W.includes(":")){const de=W.match(/\s*:\s*(.+)/);de&&(k.bankInfo.bankName=de[1].trim())}if(W.includes("")&&W.includes(":")){const de=W.match(/\s*:\s*(.+)/);de&&(k.bankInfo.accountNumber=de[1].trim())}if(W.includes("")&&W.includes(":")){const de=W.match(/\s*:\s*([\d,]+)?/);de&&(k.amounts.total=parseInt(de[1].replace(/,/g,"")))}}),!ne){let W=-1;if(x.forEach(X=>{const de=X.match(/\[([^\]]+)\]/);de&&!k.itemName&&(k.itemName=de[1].trim())}),x.forEach((X,de)=>{if(X.includes("")||X.includes(" ")||X.includes("()")){k.includeVat=!0;const Oe=X.match(/(\d+)\s*\s*(\d+)\s*\s*?/),xe=X.match(/(\d+)\s*\s*?/),$e=X.match(/([\d,]+)\s*/);if(Oe){const mt=parseInt(Oe[1])*1e4+parseInt(Oe[2])*1e3;k.amounts.total=mt}else if(xe){const mt=parseInt(xe[1])*1e4;k.amounts.total=mt}else if($e){const mt=parseInt($e[1].replace(/,/g,""));mt>=1e3&&(k.amounts.total=mt)}return}const Ke=X.match(/=\s*([\d,]+)\s*?/);let Xe=null;if(Ke){const Oe=parseInt(Ke[1].replace(/,/g,""));Oe>=1e3&&(k.amounts.total=Oe)}else{const Oe=X.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(Oe){const xe=parseInt(Oe[1])*1e4,$e=parseInt(Oe[2])*1e3,mt=xe+$e;X.includes("")||X.includes("")?k.amounts.material=mt:X.includes("")||X.includes("")?k.amounts.labor=mt:k.amounts.total||(k.amounts.total=mt),X=X.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Xe=Oe}else if(Xe=X.match(/(\d+)\s*\s*?/),Xe){const xe=parseInt(Xe[1])*1e4;X.includes("")||X.includes("")?k.amounts.material=xe:X.includes("")||X.includes("")?k.amounts.labor=xe:k.amounts.total||(k.amounts.total=xe),X=X.replace(/(\d+)\s*\s*?/g,"")}}X.includes("/")&&X.split("/").forEach(xe=>{const $e=xe.trim();$e.startsWith("[")||$e.endsWith("]")||(/^[\d\-]+$/.test($e)&&$e.replace(/\-/g,"").length>=10?k.bankInfo.accountNumber||(k.bankInfo.accountNumber=$e):Y($e)&&!k.bankInfo.accountHolder&&(k.bankInfo.accountHolder=$e))});const _e=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let Ge="",wt=-1;for(const Oe of _e){const xe=X.match(Oe);if(xe&&!k.bankInfo.accountNumber){Ge=xe[0],wt=xe.index||-1,k.bankInfo.accountNumber=xe[0].trim().replace(/\s+/g,"-");const mt=X.substring(wt+Ge.length).trim().split(/\s+/);for(const xt of mt){if(xt.startsWith("[")||xt.endsWith("]"))continue;const qe=B(xt);if(Y(qe)){k.bankInfo.accountHolder=qe;break}}if(!k.bankInfo.accountHolder&&de>0){const qe=x[de-1].split(/\s+/);for(const Je of qe){if(Je.startsWith("[")||Je.endsWith("]"))continue;const dt=B(Je);if(Y(dt)){k.bankInfo.accountHolder=dt;break}}}if(!k.bankInfo.accountHolder&&de+1<x.length){const xt=x[de+1],qe=xt.split(/\s+/);for(const Je of qe){if(Je.startsWith("[")||Je.endsWith("]"))continue;const dt=B(Je);if(Y(dt)){k.bankInfo.accountHolder=dt;break}}if(!k.bankInfo.accountHolder){const Je=xt.match(/^([-]{2,6})/);if(Je){const dt=B(Je[1].trim());Y(dt)&&(k.bankInfo.accountHolder=dt)}}}break}}const Gt=X.match(/[\d,]+/g);if(Gt){const Oe=Ge?Ge.split(/[\s\-]+/).filter(xe=>xe):[];Gt.forEach(xe=>{const $e=parseInt(xe.replace(/,/g,"")),mt=xe.replace(/,/g,""),xt=Oe.some(qe=>qe===mt);!k.bankInfo.accountNumber&&mt.length>=10&&mt.length<=20?(k.bankInfo.accountNumber=mt,Ge=mt):$e>=1e3&&!Xe&&!xt&&(X.includes("")||X.includes("")?k.amounts.material=$e:X.includes("")||X.includes("")?k.amounts.labor=$e:k.amounts.total||(k.amounts.total=$e))})}const Bn={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},Yt=Object.keys(Bn).sort((Oe,xe)=>xe.length-Oe.length);for(const Oe of Yt)if(X.includes(Oe)){const xe=Bn[Oe];k.bankInfo.bankName=xe,W=de;const $e=new RegExp(`${Oe}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),mt=X.match($e);if(mt){const xt=B(mt[1]);xt&&!/^\d+$/.test(xt)&&xt!==""&&(k.bankInfo.accountHolder=xt)}break}if(!k.bankInfo.bankName){const Oe=X.match(/([-]+)(|)/);Oe&&(k.bankInfo.bankName=Oe[0])}const Jn=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const Oe of Jn){const xe=X.match(Oe);if(xe&&!k.bankInfo.accountHolder){k.bankInfo.accountHolder=xe[0].trim();break}}const Un=X.match(/\(([-]{2,5})\)/);if(Un&&!k.bankInfo.accountHolder){const Oe=Un[1];Y(Oe)&&!["","",""].includes(Oe)&&(k.bankInfo.accountHolder=Oe)}if(!k.bankInfo.accountHolder){const Oe=/[-]{2,6}/g,xe=X.match(Oe);if(xe){const $e=X.match(/\d{10,}/)||X.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),mt=X.match(/||||/);xe.forEach(xt=>{const qe=B(xt),Je=_.split(`
`)[de];if(Je&&Je.includes(`[${xt}]`)||!Y(qe)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(qe))return;const mn=X.indexOf(xt);if(mn>0){const cn=X[mn-1];if(/[-]/.test(cn))return}if(mn+xt.length<X.length){const cn=X[mn+xt.length];if(/[-]/.test(cn))return}if(!(Un&&qe===Un[1])){if(($e||mt)&&!k.bankInfo.accountHolder)k.bankInfo.accountHolder=qe;else if(!k.bankInfo.accountHolder){const cn=/||||/,ur=/\d{6,}/;(de>0&&(ur.test(x[de-1])||cn.test(x[de-1]))||de<x.length-1&&(ur.test(x[de+1])||cn.test(x[de+1]))||cn.test(X))&&(k.bankInfo.accountHolder=qe)}}})}}const qt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[Oe,xe]of Object.entries(qt))if(X.includes(Oe)){k.vendor=xe;break}if(de===0&&!k.itemName){const Oe=X.replace(/[\[\]{}()<>]/g,"").trim();Oe&&!Oe.includes(" ")&&(Y(Oe)||(k.itemName=Oe.substring(0,50)))}}),W>=0&&W+1<x.length){const X=x[W+1],de=X.trim();if(/^[-]{2,5}$/.test(de)&&Y(de))k.bankInfo.accountHolder=de;else{const Be=X.split(/\s+/);for(const Ke of Be){const Xe=B(Ke);if(Y(Xe)){k.bankInfo.accountHolder=Xe;break}}}}}if(k.itemName&&k.itemName.includes("")&&(k.vendor=""),k.itemName){const W=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],X=k.itemName.toLowerCase(),de=W.some(_e=>X===_e.toLowerCase()||X.startsWith(_e.toLowerCase()+" ")||X.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Be=/^[\d\-\s]/.test(k.itemName),Ke=/^\d{2,}[\s\-]?\d+/.test(k.itemName.replace(/[-]/g,"").trim()),Xe=k.bankInfo.accountHolder&&(k.itemName===k.bankInfo.accountHolder||k.itemName.includes(k.bankInfo.accountHolder));(de||Be||Ke||Xe)&&(k.itemName=void 0)}return k},be=async()=>{var _,x,k,U,B,Y,ne,W,X,de,Be;try{const Ke=te.quickText;if(!Ke.trim())return;let Xe=n;n.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(xe=>setTimeout(xe,100)),Xe=Or.getState().payments,console.log("payments  :",Xe.length,""));const _e=O(Ke);console.log("  :",_e);const Ge={project:te.project,date:te.date,quickText:te.quickText,quickImages:te.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};L(null),P(!1),re(!1);let wt=0;_e.amounts.material&&(wt+=_e.amounts.material),_e.amounts.labor&&(wt+=_e.amounts.labor),_e.amounts.total&&!_e.amounts.material&&!_e.amounts.labor&&(wt=_e.amounts.total),wt>0&&(Ge.amount=wt),_e.bankInfo.bankName&&(Ge.bankName=_e.bankInfo.bankName),_e.bankInfo.accountHolder&&(Ge.accountHolder=_e.bankInfo.accountHolder),_e.bankInfo.accountNumber&&(Ge.accountNumber=_e.bankInfo.accountNumber);const Gt=xe=>xe?xe.replace(/[^0-9]/g,""):"",Bn=(xe,$e)=>{if(!xe||!$e)return!1;const mt=Gt(xe),xt=Gt($e);if(!mt||!xt)return!1;const qe=6;return mt.length<qe||xt.length<qe?mt===xt:xt.includes(mt)||mt.includes(xt)},Yt=Gt(_e.bankInfo.accountNumber||""),Jn=_e.bankInfo.accountHolder||"";let Un=!1;console.log("===    ==="),console.log(" :",_e.bankInfo.accountNumber),console.log(" :",Yt),console.log(" :",Jn),console.log(" :",we.length),console.log("  :",Xe.filter(xe=>xe.status==="completed").length);let qt=we.find(xe=>{const $e=Gt(xe.accountNumber||"");return $e&&$e===Yt});if(!qt&&Yt&&(qt=we.find(xe=>{const $e=Gt(xe.accountNumber||"");return Bn(Yt,$e)})),qt&&(Un=!0),!qt&&Jn&&(qt=we.find(xe=>xe.name===Jn),qt)){console.log("  :",qt.name);const xe=((_=qt.accountNumber)==null?void 0:_.replace(/[-\s]/g,""))||"";Yt&&!Bn(Yt,xe)?(console.log("    ( ) -  "),Un=!1):Un=!0}if(qt&&(qt.name&&(Ge.accountHolder=qt.name,console.log("  :",qt.name)),qt.bankName?Ge.bankName=qt.bankName:_e.bankInfo.bankName&&(Ge.bankName=_e.bankInfo.bankName),Un&&(Ge.accountNumber=qt.accountNumber||_e.bankInfo.accountNumber),L(qt.id||qt._id||null),qt.process&&(Ge.process=qt.process)),!qt){let xe=!1;console.log("===     ==="),console.log("  payments :",Xe.length,""),console.log(" :",Yt),console.log(" :",Jn);const $e=Xe.filter(Je=>Je.status==="completed");console.log(" :",$e.length);const mt=[...new Set($e.map(Je=>{var dt;return(dt=Je.bankInfo)==null?void 0:dt.accountHolder}).filter(Boolean))];console.log("   ( 20):",mt.slice(0,20)),console.log("  ():",Yt);const xt=$e.filter(Je=>{var dt;return(dt=Je.bankInfo)==null?void 0:dt.accountNumber}).map(Je=>{var dt,mn,cn;return{holder:(dt=Je.bankInfo)==null?void 0:dt.accountHolder,account:(mn=Je.bankInfo)==null?void 0:mn.accountNumber,clean:Gt(((cn=Je.bankInfo)==null?void 0:cn.accountNumber)||"")}}).filter(Je=>Je.clean.includes(Yt.substring(0,6))||Yt.includes(Je.clean.substring(0,6)));console.log("  :",xt);let qe=Xe.find(Je=>{var cn;const dt=Gt(((cn=Je.bankInfo)==null?void 0:cn.accountNumber)||"");return dt&&dt===Yt&&Je.status==="completed"});if(qe&&console.log("   :",(x=qe.bankInfo)==null?void 0:x.accountHolder,qe.process),!qe&&Yt&&(qe=Xe.find(Je=>{var mn;const dt=Gt(((mn=Je.bankInfo)==null?void 0:mn.accountNumber)||"");return Bn(Yt,dt)&&Je.status==="completed"}),qe&&console.log("   :",(k=qe.bankInfo)==null?void 0:k.accountHolder,qe.process)),qe&&(xe=!0),!qe&&Jn&&(qe=Xe.find(Je=>{var dt;return((dt=Je.bankInfo)==null?void 0:dt.accountHolder)===Jn&&Je.status==="completed"}),qe)){console.log("    :",(U=qe.bankInfo)==null?void 0:U.accountHolder,":",qe.process);const Je=Gt(((B=qe.bankInfo)==null?void 0:B.accountNumber)||"");Yt&&!Bn(Yt,Je)?(console.log("    ( ) -  "),xe=!1):xe=!0}qe?(console.log(" :",{accountHolder:(Y=qe.bankInfo)==null?void 0:Y.accountHolder,accountNumber:(ne=qe.bankInfo)==null?void 0:ne.accountNumber,bankName:(W=qe.bankInfo)==null?void 0:W.bankName,process:qe.process,status:qe.status,paymentMatchedByAccountNumber:xe}),(X=qe.bankInfo)!=null&&X.accountHolder&&(Ge.accountHolder=qe.bankInfo.accountHolder,console.log("  :",qe.bankInfo.accountHolder)),(de=qe.bankInfo)!=null&&de.bankName?Ge.bankName=qe.bankInfo.bankName:_e.bankInfo.bankName&&(Ge.bankName=_e.bankInfo.bankName),xe&&(Ge.accountNumber=((Be=qe.bankInfo)==null?void 0:Be.accountNumber)||_e.bankInfo.accountNumber),qe.process&&!Ge.process?(Ge.process=qe.process,console.log("    :",qe.process)):console.log("   - process:",qe.process,"updatedFormData.process:",Ge.process)):console.log("  ")}if(_e.vendor&&(Ge.process=_e.vendor),!Ge.process){const xe=Ke.toLowerCase();for(const $e of Uu)if(xe.includes($e.toLowerCase())){Ge.process=$e;break}}_e.itemName&&(Ge.itemName=_e.itemName),Ye(Ge),_e.includeVat&&(P(!0),re(!1));const Oe=[];if(_e.amounts.material||_e.amounts.labor||_e.amounts.total){const xe=[];_e.amounts.material&&xe.push(`: ${_e.amounts.material.toLocaleString()}`),_e.amounts.labor&&xe.push(`: ${_e.amounts.labor.toLocaleString()}`),_e.amounts.total&&!_e.amounts.material&&!_e.amounts.labor&&xe.push(`: ${_e.amounts.total.toLocaleString()}`),Oe.push(xe.join(", "))}if(_e.bankInfo.bankName||_e.bankInfo.accountHolder){const xe=[];_e.bankInfo.bankName&&xe.push(_e.bankInfo.bankName),_e.bankInfo.accountHolder&&xe.push(_e.bankInfo.accountHolder),_e.bankInfo.accountNumber&&xe.push(_e.bankInfo.accountNumber),xe.length>0&&Oe.push(`: ${xe.join(" ")}`)}_e.vendor&&Oe.push(`: ${_e.vendor}`),_e.includeVat&&Oe.push("  "),Oe.length>0?ie.success(`  !
${Oe.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):ie.info("  ...    .")}catch(Ke){console.error(" :",Ke),ie.error("   .")}};V.useEffect(()=>{(async()=>{try{await eI();const x=await X2();Ze(x),Sn(!0)}catch(x){console.error("  :",x),Sn(!0)}})()},[]);const ke=V.useRef({});V.useEffect(()=>{Ee&&(Object.entries(Fe).forEach(([_,x])=>{JSON.stringify(ke.current[_])!==JSON.stringify(x)&&J2(_,x).catch(k=>{console.error("  :",k),ie.error("  ")})}),ke.current={...Fe})},[Fe,Ee]);const Se=V.useCallback(async _=>{var U;const x=(U=_.clipboardData)==null?void 0:U.items;if(!x)return;let k=!1;for(let B=0;B<x.length;B++)if(x[B].type.indexOf("image")!==-1){k=!0;break}if(k){if(!f){const B=document.activeElement;(B==null?void 0:B.tagName)==="INPUT"||(B==null?void 0:B.tagName)==="TEXTAREA"||(B==null?void 0:B.classList.contains("form-input"))||ie.error("  ");return}for(let B=0;B<x.length;B++)if(x[B].type.indexOf("image")!==-1){_.preventDefault();const Y=x[B].getAsFile();if(Y){const ne=new FileReader;ne.onload=async W=>{var de;const X=(de=W.target)==null?void 0:de.result;if(X)try{const Be=n.find(_e=>_e.id===f),Xe=[...(Be==null?void 0:Be.images)||Fe[f]||[],X];await vs.updatePaymentImages(f,Xe),Ze(_e=>({..._e,[f]:Xe})),await e(),ie.success(" ")}catch(Be){console.error("  :",Be),ie.error("  ")}},ne.readAsDataURL(Y)}}}},[f,n,Fe,e]);V.useEffect(()=>(document.addEventListener("paste",Se),()=>document.removeEventListener("paste",Se)),[Se]);const ae=(l==null?void 0:l.name)===""?n.filter(_=>u.some(x=>x.name===_.project)):n,yt=[...ae].sort((_,x)=>new Date(x.requestDate).getTime()-new Date(_.requestDate).getTime()),_t=yt.filter(_=>_.status==="pending").length,Kt=[...new Set(yt.map(_=>_.status))];console.log("[ ]",{" payments":n.length,"  ":ae.length," (pending)":_t," (completed)":n.filter(_=>_.status==="completed").length," statusFilter":fe," status ":Kt," ":l==null?void 0:l.name," ":u.length,allRecords:yt.length});const Nt=yt.filter(_=>{var Y,ne,W;if(!_||!_.id)return!1;const x=m===""||((Y=_.purpose)==null?void 0:Y.toLowerCase().includes(m.toLowerCase()))||((ne=_.itemName)==null?void 0:ne.toLowerCase().includes(m.toLowerCase()))||((W=_.process)==null?void 0:W.toLowerCase().includes(m.toLowerCase())),k=fe==="pending"?_.status!=="completed":_.status==="completed",U=ut==="all"||!ut||_.project===ut,B=!Rt||fe!=="completed"||_.requestedBy===(l==null?void 0:l.name);return x&&k&&U&&B}).sort((_,x)=>!_&&!x?0:_?x?fe==="completed"?Vl(x.completionDate)-Vl(_.completionDate):Vl(x.requestDate)-Vl(_.requestDate):-1:1),ln=_=>{const x=_.id||_._id||null;if(at===x){L(null);const Y=document.querySelector('input[placeholder=" "]');Y&&setTimeout(()=>{Y.focus()},100);return}L(x);const k=ba(_.name);let U=_.bankName||"",B=_.accountNumber||"";if(B&&!U){const Y=B.trim().split(/\s+/);if(Y.length>=2){const ne=Y[0];(ne.includes("")||ne.includes("")||ne.includes("")||ne.includes("")||ne.includes(""))&&(U=ne,B=Y.slice(1).join(""))}}Ye(Y=>({...Y,accountHolder:k,bankName:U,accountNumber:B}))};Nt.reduce((_,x)=>{const k=x.materialAmount||0,U=x.laborAmount||0,B=x.amount||0;let Y=k,ne=U,W=0;return k===0&&U===0&&B>0?x.includesVAT?(Y=Math.round(B/1.1),W=B-Y):(Y=B,W=0):x.includesVAT?(k>0&&(Y=Math.round(k/1.1)),U>0&&(ne=Math.round(U/1.1)),W=B-(Y+ne)):W=0,_.material+=Y,_.labor+=ne,_.vat+=W,_.total+=B,_},{material:0,labor:0,vat:0,total:0});const tn=async()=>{var x;if(lt){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",te),!te.project){ie.error(" ");return}if(!te.itemName){ie.error(" ");return}const _=Number(te.amount)||0;if(_===0){ie.error(" ");return}an(!0);try{const k=F?Math.round(_*.967):_,U=new Date;if(y){const B={project:te.project,requestDate:new Date(te.date),purpose:te.itemName,amount:k,category:"material",urgency:"normal",process:te.process,itemName:te.itemName,includesVAT:R,applyTaxDeduction:F,materialAmount:k,laborAmount:0,originalLaborAmount:0,accountHolder:te.accountHolder,bank:te.bankName,accountNumber:te.accountNumber,bankInfo:te.accountHolder||te.bankName||te.accountNumber?{accountHolder:te.accountHolder,bankName:te.bankName,accountNumber:te.accountNumber}:void 0,updatedAt:U};console.log(" Updating payment:",B),await i(y,B),ie.success(" "),I(null)}else{const B=te.project||"",Y={id:`payment_${Date.now()}`,project:B,requestDate:new Date(te.date),requestedBy:(l==null?void 0:l.name)||"  ",purpose:te.itemName,amount:k,status:"pending",category:"material",urgency:"normal",process:te.process,itemName:te.itemName,includesVAT:R,applyTaxDeduction:F,materialAmount:k,laborAmount:0,originalLaborAmount:0,accountHolder:te.accountHolder,bank:te.bankName,accountNumber:te.accountNumber,bankInfo:te.accountHolder||te.bankName||te.accountNumber?{accountHolder:te.accountHolder,bankName:te.bankName,accountNumber:te.accountNumber}:void 0,quickText:te.quickText||"",images:te.quickImages,attachments:[],createdAt:U,updatedAt:U};console.log(" Creating payment:",Y),console.log(" Images in payment:",((x=te.quickImages)==null?void 0:x.length)||0,"");const ne=await s(Y);if(Re.current=ne,setTimeout(()=>{Re.current=null},1e4),ie.success(" "),te.accountHolder&&te.bankName&&te.accountNumber){const W=R||F?"01074088864":"01089423283";try{await Ae.post("/payments/send-toss-payment-sms",{recipientPhone:W,accountHolder:te.accountHolder,bankName:te.bankName,accountNumber:te.accountNumber,amount:k,projectName:B,itemName:te.itemName,process:te.process,paymentId:ne}),ie.success("   ")}catch(X){console.error("SMS  :",X)}}}Ye(B=>({project:B.project,date:Ut(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),P(!1),re(!1),L(null),window.innerWidth<768&&j("list")}catch(k){console.error(" Payment save error:",k),ie.error("  : "+k.message)}finally{an(!1)}},An=_=>{var x,k,U,B;try{console.log("[handleEdit] Starting edit for payment:",_.id);const Y=_.originalMaterialAmount!==void 0?_.originalMaterialAmount:_.materialAmount||0,ne=_.originalLaborAmount!==void 0?_.originalLaborAmount:_.laborAmount||0,W={project:_.project||"",date:_.requestDate?Ut(new Date(_.requestDate),"yyyy-MM-dd"):Ut(new Date,"yyyy-MM-dd"),process:_.process||"",itemName:_.itemName||_.purpose||"",materialCost:Y>0?Y.toString():"",laborCost:ne>0?ne.toString():"",amount:((x=_.amount)==null?void 0:x.toString())||"",accountHolder:((k=_.bankInfo)==null?void 0:k.accountHolder)||"",bankName:((U=_.bankInfo)==null?void 0:U.bankName)||"",accountNumber:((B=_.bankInfo)==null?void 0:B.accountNumber)||"",images:_.attachments||[],quickText:_.quickText||"",quickImages:_.images||[]};console.log("[handleEdit] Setting form data:",W),Ye(W),P(_.includesVAT||!1),re(_.applyTaxDeduction||!1),h(_.id),I(_.id),S&&j("form"),console.log("[handleEdit] Edit setup complete"),ie.success("  ")}catch(Y){console.error("[handleEdit] Error:",Y),ie.error("     ")}},cs=async _=>{var x,k,U;try{const B=((x=_.bankInfo)==null?void 0:x.accountHolder)||_.accountHolder,Y=((k=_.bankInfo)==null?void 0:k.bankName)||_.bank,ne=((U=_.bankInfo)==null?void 0:U.accountNumber)||_.accountNumber;if(!B||!Y||!ne){ie.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${Y}
: ${ne}
: ${_.amount.toLocaleString()}`))return;const X=ne.replace(/[-\s]/g,""),de=kC[Y]||Y,Be=DC[Y]||"004",Ke="",Xe=`supertoss://send?amount=${_.amount}&bankCode=${Be}&bank=${encodeURIComponent(de)}&accountNo=${X}&receiverName=${encodeURIComponent(Ke)}&toName=${encodeURIComponent(Ke)}`;let _e=!1;try{window.location.href=Xe,_e=!0,ie.success("  ...",{duration:3e3}),setTimeout(()=>{const Ge=/iPhone|iPad|iPod/i.test(navigator.userAgent),wt=/Android/i.test(navigator.userAgent);(Ge||wt)&&ie(`      .

: 
: ${ne}
: ${_.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(Ge){console.error("   :",Ge),ie(`   .

: 
: ${Y}
: ${ne}
: ${_.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(B){console.error(" :",B),ie.error(`   : ${B.message}`)}},Wn=async _=>{const x=n.find(k=>k.id===_);if(x&&x.quickText){const k=localStorage.getItem("executionMemos"),U=k?JSON.parse(k):{};U[_]=x.quickText,localStorage.setItem("executionMemos",JSON.stringify(U))}o(_,{status:"completed",completionDate:new Date}),ue(!1),je("completed"),ie.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(_,{status:"completed"});const k=Er.getSocket();k&&k.emit("payment:refresh",{paymentId:_,status:"completed"})}catch(k){console.error(" API :",k),o(_,{status:"pending",completionDate:void 0}),je("pending"),ie.error("   -  ")}},us=async _=>{var U;if(!f){ie.error("  ");return}const k=Array.from(((U=_.target)==null?void 0:U.files)||[]).filter(B=>B.type.startsWith("image/"));if(k.length!==0){try{const B=await Promise.all(k.map(X=>new Promise((de,Be)=>{const Ke=new FileReader;Ke.onload=Xe=>{var Ge;const _e=(Ge=Xe.target)==null?void 0:Ge.result;_e?de(_e):Be(new Error("  "))},Ke.onerror=()=>Be(new Error("FileReader ")),Ke.readAsDataURL(X)}))),Y=n.find(X=>X.id===f),W=[...(Y==null?void 0:Y.images)||Fe[f]||[],...B];await vs.updatePaymentImages(f,W),Ze(X=>({...X,[f]:W})),await e(),ie.success(`${B.length}  `)}catch(B){console.error("  :",B),ie.error("  ")}_.target.value=""}},ti=async _=>{if(f)try{const x=n.find(B=>B.id===f),U=((x==null?void 0:x.images)||Fe[f]||[]).filter((B,Y)=>Y!==_);await vs.updatePaymentImages(f,U),Ze(B=>({...B,[f]:U})),await e()}catch(x){console.error("  :",x),ie.error("  ")}},ws=_=>{N(_),M(!0)},Xn=_=>{_.preventDefault(),w(!0)},Is=_=>{_.preventDefault(),w(!1)},Pn=async _=>{if(_.preventDefault(),w(!1),!f){ie.error("  ");return}const k=Array.from(_.dataTransfer.files).filter(U=>U.type.startsWith("image/"));if(k.length!==0)try{const U=await Promise.all(k.map(W=>new Promise((X,de)=>{const Be=new FileReader;Be.onload=Ke=>{var _e;const Xe=(_e=Ke.target)==null?void 0:_e.result;Xe?X(Xe):de(new Error("  "))},Be.onerror=()=>de(new Error("FileReader ")),Be.readAsDataURL(W)}))),B=n.find(W=>W.id===f),ne=[...(B==null?void 0:B.images)||Fe[f]||[],...U];await vs.updatePaymentImages(f,ne),Ze(W=>({...W,[f]:ne})),await e(),ie.success(`${U.length}  `)}catch(U){console.error("  :",U),ie.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:te.project,onChange:_=>{Ye({...te,project:_.target.value}),_.target.value&&localStorage.setItem("lastSelectedProject",_.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2478,columnNumber:35},void 0),u.filter(_=>_.status!=="completed").map(_=>a.jsxDEV("option",{value:_.name,children:_.name},_.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2480,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2468,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2467,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${C==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2489,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${C==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2499,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${C==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2509,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2487,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2486,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${C!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:te.project,onChange:_=>{Ye({...te,project:_.target.value}),_.target.value&&localStorage.setItem("lastSelectedProject",_.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2544,columnNumber:43},void 0),u.filter(_=>_.status!=="completed").map(_=>a.jsxDEV("option",{value:_.name,children:_.name},_.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2546,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2534,columnNumber:17},void 0),a.jsxDEV("select",{value:te.bankName,onChange:_=>Ye({...te,bankName:_.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2554,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2555,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2556,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2558,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2559,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2560,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2561,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2562,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2563,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2564,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2565,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2566,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2532,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:te.quickText,onChange:_=>Ye({...te,quickText:_.target.value}),onPaste:_=>{var k;const x=(k=_.clipboardData)==null?void 0:k.items;if(x){for(let U=0;U<x.length;U++)if(x[U].type.indexOf("image")!==-1){_.preventDefault();const B=x[U].getAsFile();if(B){const Y=new FileReader;Y.onload=ne=>{var X;const W=(X=ne.target)==null?void 0:X.result;Ye(de=>({...de,quickImages:[...de.quickImages,W]}))},Y.readAsDataURL(B)}break}}},onDragOver:_=>{_.preventDefault(),_.stopPropagation()},onDrop:_=>{_.preventDefault(),_.stopPropagation(),Array.from(_.dataTransfer.files).filter(U=>U.type.startsWith("image/")).forEach(U=>{const B=new FileReader;B.onload=Y=>{var W;const ne=(W=Y.target)==null?void 0:W.result;Ye(X=>({...X,quickImages:[...X.quickImages,ne]}))},B.readAsDataURL(U)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:S?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2573,columnNumber:15},void 0),te.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:te.quickImages.map((_,x)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:_,alt:` ${x+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2628,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Ye(k=>({...k,quickImages:k.quickImages.filter((U,B)=>B!==x)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2633,columnNumber:23},void 0)]},x,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2627,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2625,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:_=>{Array.from(_.target.files||[]).forEach(k=>{const U=new FileReader;U.onload=B=>{var ne;const Y=(ne=B.target)==null?void 0:ne.result;Ye(W=>({...W,quickImages:[...W.quickImages,Y]}))},U.readAsDataURL(k)}),_.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2652,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2651,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:be,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2677,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2650,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2572,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",te.date&&`(${Ut(new Date(te.date),"E",{locale:gn})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2690,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:te.date,onChange:_=>Ye({...te,date:_.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2693,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2689,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2709,columnNumber:17},void 0),a.jsxDEV("button",{ref:He,type:"button",onClick:()=>De(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:te.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2716,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2710,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2708,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2688,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2723,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:te.itemName,onChange:_=>Ye({...te,itemName:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2724,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2722,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2735,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:te.amount?Number(te.amount).toLocaleString():"",onChange:_=>{const x=_.target.value.replace(/[^0-9]/g,"");Ye({...te,amount:x})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2748,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2736,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2734,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:_=>_.preventDefault(),onClick:()=>{R||re(!1),P(!R)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${R?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:R&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2766,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2765,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2754,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:_=>_.preventDefault(),onClick:()=>{F||P(!1),re(!F)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${F?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:F&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2784,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2783,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2786,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2772,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2753,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2733,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(Ct.length>0||q.length>0&&!at)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${Ct.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2802,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:Ct.map(_=>{const x=_.id||_._id,k=at===x;return a.jsxDEV("button",{type:"button",onClick:()=>ln(_),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${k?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:ba(_.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2818,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[_.bankName||""," ",_.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2821,columnNumber:29},void 0)]},x,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2808,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2803,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2799,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${q.length===0||at?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2834,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:q.map((_,x)=>a.jsxDEV("button",{type:"button",onClick:()=>{Ye(k=>({...k,accountHolder:_.accountHolder,bankName:_.bankName,accountNumber:_.accountNumber})),ee([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:_.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[_.bankName," ",_.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2854,columnNumber:27},void 0)]},x,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2837,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2835,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2831,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2797,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2866,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:te.accountHolder,onChange:_=>Ye({...te,accountHolder:_.target.value}),onFocus:()=>Ce(!0),onBlur:()=>setTimeout(()=>Ce(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2867,columnNumber:17},void 0),me&&ye.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:ye.map((_,x)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:k=>k.preventDefault(),onClick:()=>{let k=_.bankName||"",U=_.accountNumber||"";const B=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],Y={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const ne of B)if(U.includes(ne)){k||(k=Y[ne]||ne),U=U.replace(ne,"").trim();break}for(const ne of B)if(k.includes(ne)){const W=Y[ne]||ne,X=k.replace(ne,"").trim();X&&/\d/.test(X)&&(U=X),k=W;break}U=U.replace(/[^\d\-]/g,"").trim(),Ye({...te,accountHolder:_.name,bankName:k||te.bankName,accountNumber:U||te.accountNumber}),Ce(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:_.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2967,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:_.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2968,columnNumber:25},void 0)]},`${_.name}-${x}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2880,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2878,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2865,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2979,columnNumber:17},void 0),a.jsxDEV("select",{value:te.bankName,onChange:_=>Ye({...te,bankName:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2985,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2986,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2987,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2988,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2989,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2990,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2991,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2992,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2993,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2994,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2995,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2996,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2997,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2998,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2999,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3e3,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3001,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3002,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3003,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3004,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3005,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3006,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3007,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2980,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2978,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3012,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:te.accountNumber,onChange:_=>Ye({...te,accountNumber:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3013,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3011,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3024,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(R||F)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",R&&" ",F&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3027,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const _=Number(te.amount)||0;let x=_;return F&&(x=Math.round(_*.967)),x.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3031,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3025,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3023,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3022,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&a.jsxDEV("button",{onClick:()=>{I(null),Ye(_=>({project:_.project,date:Ut(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),P(!1),re(!1),L(null),ie.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3050,columnNumber:19},void 0),a.jsxDEV("button",{onClick:_=>{console.log(" Payment button clicked!",_),console.log(" Button element:",_.currentTarget),console.log(" Form data:",te),tn()},disabled:lt,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${lt?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:lt?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3079,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3048,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2794,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2530,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2527,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${C!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>je("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${fe==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${fe==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:yt.filter(_=>_&&_.id&&_.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3118,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3109,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{je("completed"),Ye(_=>({..._,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${fe==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${fe==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:yt.filter(_=>_&&_.id&&_.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3137,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3124,columnNumber:17},void 0),fe==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Rt,onChange:_=>{oe(_.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(_.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3146,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3145,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3108,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3107,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3106,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3161,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:Nt.length>0?a.jsxDEV("div",{className:"space-y-4",children:Nt.map(_=>{var ne,W,X;const x=_.amount||0,k=((ne=_.bankInfo)==null?void 0:ne.accountHolder)||_.accountHolder||"",U=((W=_.bankInfo)==null?void 0:W.bankName)||_.bank||"",B=((X=_.bankInfo)==null?void 0:X.accountNumber)||_.accountNumber||"",Y=k&&U&&B?`${k} | ${U} ${B}`:" ";return a.jsxDEV("div",{onClick:()=>h(_.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===_.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[_.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",_.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3193,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:_.purpose||_.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3195,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3191,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:_.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3199,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3190,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[x.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3202,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[_.requestedBy||"-","  ",ig(_.requestDate,"MM/dd",{locale:gn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3205,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3201,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3189,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(_.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3213,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3214,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(_.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3215,columnNumber:25},void 0),_.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3218,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3219,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3217,columnNumber:27},void 0),_.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3224,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3225,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3223,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3212,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:Y},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3232,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:de=>{de.stopPropagation(),An(_)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(yx,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3244,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3236,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async de=>{de.stopPropagation(),window.confirm("  ?")&&(await r(_.id),ie.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(xi,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3257,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3246,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3235,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3231,columnNumber:23},void 0),fe==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:de=>{if(de.stopPropagation(),_.status==="completed"){ie.info("   ");return}cs(_)},disabled:_.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${_.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:_.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3266,columnNumber:27},void 0),a.jsxDEV("button",{onClick:de=>{de.stopPropagation(),Wn(_.id)},disabled:_.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${_.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:_.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:de=>{_.status!=="completed"&&(de.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:de=>{_.status!=="completed"&&(de.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3284,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3265,columnNumber:25},void 0)]},_.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3179,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3165,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3315,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3163,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3102,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${C!=="image"?"hidden lg:flex":""}`,onDragOver:Xn,onDragLeave:Is,onDrop:Pn,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:us,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3331,columnNumber:11},void 0),S&&f&&C==="image"&&(()=>{const _=yt.find(x=>x.id===f);return _?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:_.purpose||_.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3348,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[_.process||"-","  ",ig(_.requestDate,"yyyy.MM.dd",{locale:gn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3349,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3347,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(_.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3353,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3346,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3345,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:_=>{var k;const x=_.target;if(!x.closest("img")&&!x.closest("button")&&f){const U=yt.find(W=>W.id===f),B=(U==null?void 0:U.images)||[],Y=Fe[f]||[];(B.length>0?B:Y).length>0&&((k=document.getElementById("image-file-input"))==null||k.click())}},children:f?(()=>{const _=yt.find(B=>B.id===f),x=(_==null?void 0:_.images)||[],k=Fe[f]||[],U=x.length>0?x:k;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3389,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(_==null?void 0:_.quickText)||(_==null?void 0:_.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3390,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3388,columnNumber:19},void 0),U.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:U.map((B,Y)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:B,alt:` ${Y+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:ne=>{ne.stopPropagation(),ws(B)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3404,columnNumber:27},void 0),a.jsxDEV("button",{onClick:ne=>{ne.stopPropagation(),ti(Y)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(yn,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3420,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3413,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[Y+1,"/",U.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3422,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3403,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3401,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${U.length>0?"":"flex-1"}`,onClick:B=>B.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${U.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(Ou,{className:`mx-auto text-gray-400 mb-1 ${U.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3441,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:U.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3442,columnNumber:23},void 0),U.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3446,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3436,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3431,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3386,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(Jo,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3455,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3456,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3454,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3453,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3363,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3323,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2524,columnNumber:7},void 0),E&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3471,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>De(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(yn,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3476,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3472,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3470,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Uu.map(_=>a.jsxDEV("button",{onClick:()=>{Ye({...te,process:_}),De(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${te.process===_?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:_},_,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3483,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3481,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ye({...te,process:""}),De(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3500,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3480,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3469,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>De(!1),children:a.jsxDEV("div",{onClick:_=>_.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:He.current?`${He.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:He.current?`${He.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3524,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>De(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(yn,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3529,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3525,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3523,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Uu.map(_=>a.jsxDEV("button",{onClick:()=>{Ye({...te,process:_}),De(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${te.process===_?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:_},_,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3536,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3534,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ye({...te,process:""}),De(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3553,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3533,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3515,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3466,columnNumber:9},void 0),Z&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>M(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:_=>{_.stopPropagation(),M(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(yn,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3582,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3575,columnNumber:13},void 0),a.jsxDEV("img",{src:A,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:_=>_.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3584,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3574,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3570,columnNumber:9},void 0),bt&&a.jsxDEV(G2,{projectName:At,onClose:()=>st(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3596,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2465,columnNumber:5},void 0)},nI=()=>{var te,Ye;const{user:n}=zr(),{loadProjectsFromAPI:e,projects:t}=Or(),s=nu(),[r,i]=V.useState([]),[o,l]=V.useState(!0),[u,m]=V.useState(null),[d,f]=V.useState([]),[h,y]=V.useState(!1),[I,v]=V.useState(""),[w,R]=V.useState(""),[P,F]=V.useState(null),[re,Z]=V.useState(null),[M,A]=V.useState(""),[N,C]=V.useState(null),[j,S]=V.useState(""),[T,E]=V.useState(null),[De,He]=V.useState(new Set),fe=V.useRef(null),[je,ut]=V.useState(window.innerWidth<768),[Ft,Rt]=V.useState(!1),[oe,Me]=V.useState(null),[ue,Pe]=V.useState(new Set),[We,bt]=V.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[st,At]=V.useState(!1),[nt,lt]=V.useState(!1),[an,G]=V.useState(new Set);V.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(We))},[We]),V.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const be=()=>{ut(window.innerWidth<768)};return window.addEventListener("resize",be),()=>window.removeEventListener("resize",be)},[]),V.useEffect(()=>{o||Te()},[s,o]),V.useEffect(()=>{u!==null&&Re()},[u]),V.useEffect(()=>{u!==null&&(n!=null&&n.id)&&localStorage.setItem(`finishCheck_selectedProject_${n.id}`,u.toString())},[u,n==null?void 0:n.id]),V.useEffect(()=>{if(!je&&T){const O=async be=>{var Se;const ke=(Se=be.clipboardData)==null?void 0:Se.items;if(ke){for(let ae=0;ae<ke.length;ae++)if(ke[ae].type.indexOf("image")!==-1){be.preventDefault();const yt=ke[ae].getAsFile();yt&&await Ce(T,yt)}}};return document.addEventListener("paste",O),()=>document.removeEventListener("paste",O)}},[T,je]);const Te=async()=>{try{const O=s.map(ke=>({id:ke.id,title:ke.name}));i(O);const be=n!=null&&n.id?localStorage.getItem(`finishCheck_selectedProject_${n.id}`):null;be&&O.some(ke=>ke.id===Number(be))?m(Number(be)):O.length>0&&m(O[0].id)}catch(O){console.error("Failed to load projects:",O),ie.error("   ")}},Re=async()=>{try{d.length===0&&y(!0);const O=u?`/finish-check/spaces?project_id=${u}`:"/finish-check/spaces",ke=(await Ae.get(O)).data.map(Se=>({...Se,items:Se.items.map(ae=>({...ae,images:ae.images||[]}))}));f(ke)}catch(O){console.error("Failed to load spaces:",O),ie.error("   ")}finally{y(!1)}},we=async O=>{if(an.has(O))return null;try{G(Se=>new Set(Se).add(O));const ke=(await Ae.get(`/finish-check/images/${O}`)).data.image_data;return f(Se=>Se.map(ae=>({...ae,items:ae.items.map(yt=>({...yt,images:yt.images.map(_t=>_t.id===O?{..._t,image_data:ke}:_t)}))}))),ke}catch(be){return console.error("   :",be),null}finally{G(be=>{const ke=new Set(be);return ke.delete(O),ke})}},Qe=async O=>{const be=d.find(ae=>ae.items.some(yt=>yt.id===O)),ke=be==null?void 0:be.items.find(ae=>ae.id===O);if(!ke)return;const Se=ke.images.filter(ae=>!ae.image_data);await Promise.all(Se.map(ae=>we(ae.id)))},Ct=async()=>{if(!nt){if(!I.trim()){ie.error("  ");return}if(!u){ie.error(" ");return}lt(!0);try{const O=await Ae.post("/finish-check/spaces",{name:I.trim(),project_id:u}),be={...O.data,items:O.data.items||[]};f([...d,be]),v(""),At(!1),ie.success(" ")}catch(O){console.error("Failed to add space:",O),ie.error("  ")}finally{lt(!1)}}},Ot=async(O,be)=>{if(!be.trim()){ie.error("  ");return}try{await Ae.put(`/finish-check/spaces/${O}`,{name:be.trim()}),f(d.map(ke=>ke.id===O?{...ke,name:be.trim()}:ke)),Z(null),A(""),ie.success("  ")}catch(ke){console.error("Failed to update space:",ke),ie.error("  ")}},at=O=>{Me(O),Pe(new Set)},L=async()=>{if(oe!==null){if(ue.size===0){ie.error("  ");return}try{await Promise.all(Array.from(ue).map(O=>Ae.delete(`/finish-check/items/${O}`))),f(d.map(O=>O.id===oe?{...O,items:O.items.filter(be=>!ue.has(be.id))}:O)),ie.success(`${ue.size}  `),Me(null),Pe(new Set)}catch(O){console.error("Failed to delete items:",O),ie.error("  ")}}},q=async()=>{if(oe===null)return;const O=d.find(be=>be.id===oe);if(O&&confirm(`"${O.name}"  ?

        .`))try{await Ae.delete(`/finish-check/spaces/${oe}`),f(d.filter(be=>be.id!==oe)),ie.success(" "),Me(null),Pe(new Set)}catch(be){console.error("Failed to delete space:",be),ie.error("  ")}},ee=async O=>{if(!w.trim()){ie.error("  ");return}const be=-Date.now(),ke={id:be,space_id:O,content:w.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(ae=>ae.id===O?{...ae,items:[...ae.items,ke]}:ae));const Se=w.trim();R(""),F(null);try{const ae=await Ae.post("/finish-check/items",{space_id:O,content:Se});f(yt=>yt.map(_t=>_t.id===O?{..._t,items:_t.items.map(Kt=>Kt.id===be?{...ae.data,images:[]}:Kt)}:_t))}catch(ae){console.error("Failed to add item:",ae),f(yt=>yt.map(_t=>_t.id===O?{..._t,items:_t.items.filter(Kt=>Kt.id!==be)}:_t)),ie.error("  ")}},ye=async O=>{try{const be=await Ae.put(`/finish-check/items/${O}/toggle`);f(d.map(ke=>({...ke,items:ke.items.map(Se=>Se.id===O?{...Se,...be.data}:Se)})))}catch(be){console.error("Failed to toggle item:",be),ie.error("   ")}},ce=async O=>{try{const be=await Ae.put(`/finish-check/items/${O}/toggle-priority`);f(d.map(ke=>({...ke,items:ke.items.map(Se=>Se.id===O?{...Se,is_priority:be.data.is_priority}:Se)})))}catch(be){console.error("Failed to toggle priority:",be),ie.error("  ")}},me=O=>new Promise((be,ke)=>{const Se=new FileReader;Se.readAsDataURL(O),Se.onload=()=>be(Se.result),Se.onerror=ae=>ke(ae)}),Ce=async(O,be)=>{var ae,yt;if(!["image/jpeg","image/png","image/webp"].includes(be.type)){ie.error("JPEG, PNG, WebP    ");return}const Se=5*1024*1024;if(be.size>Se){ie.error("  5MB  ");return}try{He(Nt=>new Set([...Nt,O]));const _t=await me(be),Kt=await Ae.post(`/finish-check/items/${O}/images`,{image_data:_t,filename:be.name});f(d.map(Nt=>({...Nt,items:Nt.items.map(ln=>ln.id===O?{...ln,images:[...ln.images,Kt.data]}:ln)}))),ie.success(" ")}catch(_t){console.error("Failed to upload image:",_t),ie.error(((yt=(ae=_t.response)==null?void 0:ae.data)==null?void 0:yt.error)||"  ")}finally{He(_t=>{const Kt=new Set(_t);return Kt.delete(O),Kt})}},Fe=async(O,be)=>{const ke=be.target.files;if(!(!ke||ke.length===0)){for(let Se=0;Se<ke.length;Se++)await Ce(O,ke[Se]);fe.current&&(fe.current.value="")}},Ze=async(O,be)=>{if(confirm("  ?"))try{await Ae.delete(`/finish-check/images/${be}`),f(d.map(ke=>({...ke,items:ke.items.map(Se=>Se.id===O?{...Se,images:Se.images.filter(ae=>ae.id!==be)}:Se)}))),ie.success(" ")}catch(ke){console.error("Failed to delete image:",ke),ie.error("  ")}},Ee=async(O,be)=>{O.preventDefault(),O.stopPropagation();const ke=O.dataTransfer.files;if(!(!ke||ke.length===0))for(let Se=0;Se<ke.length;Se++)ke[Se].type.startsWith("image/")&&await Ce(be,ke[Se])},Sn=O=>{O.preventDefault(),O.stopPropagation()};if(h)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:613,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:7},void 0);const jt=T?d.flatMap(O=>O.items).find(O=>O.id===T):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:fe,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:O=>{T&&Fe(T,O)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:625,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:je?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:O=>{const be=O.target.value?Number(O.target.value):null;m(be)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:655,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:646,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>bt(!We),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${We?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:We?" ":" ",children:We?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:665,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>At(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV(ro,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:683,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:678,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:644,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:691,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:O=>{const be=O.target.value?Number(O.target.value):null;m(be)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:700,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:702,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:692,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:690,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:711,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:I,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&Ct()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:713,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Ct,disabled:nt,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV(ro,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:731,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:725,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:710,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>bt(!We),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${We?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:We?" ":" ",children:We?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:738,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:737,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:641,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:757,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((O,be)=>{const ke=O.items.filter(ae=>!ae.is_completed).sort((ae,yt)=>(yt.is_priority||0)-(ae.is_priority||0)),Se=O.items.filter(ae=>ae.is_completed);return We&&ke.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[re===O.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:M,onChange:ae=>A(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"?Ot(O.id,M):ae.key==="Escape"&&(Z(null),A(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:776,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Ot(O.id,M),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(lg,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:795,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:791,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{Z(null),A("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(yn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:797,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:775,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:be+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0),O.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:810,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[Se.length,"/",O.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:816,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:809,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{P===O.id?(F(null),R("")):F(O.id)},className:`p-1 transition-colors ${P===O.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV(ro,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:837,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{Z(O.id),A(O.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(qu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:839,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>at(O.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:849,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:808,columnNumber:23},void 0),P===O.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:w,onChange:ae=>R(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&w.trim()&&ee(O.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:864,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>ee(O.id),disabled:!w.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:877,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:863,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:862,columnNumber:23},void 0),ke.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:ke.map(ae=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>ye(ae.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:897,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!je&&T===ae.id?"font-semibold":""}`,onClick:async()=>{je||(E(ae.id),ae.images&&ae.images.length>0&&await Qe(ae.id))},style:{cursor:je?"default":"pointer"},children:[ae.content,ae.images&&ae.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ae.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:918,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:904,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{E(ae.id),je&&Rt(!0),ae.images&&ae.images.length>0&&await Qe(ae.id)},className:`p-1 transition-colors ${ae.images&&ae.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:942,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ae.id),className:`p-1 transition-colors ${ae.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Cf,{className:`w-4 h-4 ${ae.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:953,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:944,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:923,columnNumber:31},void 0)]},ae.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:893,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:891,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:890,columnNumber:23},void 0),!We&&Se.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:Se.map(ae=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>ye(ae.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:971,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!je&&T===ae.id?"font-semibold":""}`,onClick:async()=>{je||(E(ae.id),ae.images&&ae.images.length>0&&await Qe(ae.id))},style:{cursor:je?"default":"pointer"},children:[ae.content,ae.images&&ae.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ae.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:992,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:978,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{E(ae.id),je&&Rt(!0),ae.images&&ae.images.length>0&&await Qe(ae.id)},className:`p-1 transition-colors ${ae.images&&ae.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1016,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:998,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ae.id),className:`p-1 transition-colors ${ae.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Cf,{className:`w-4 h-4 ${ae.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1027,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1018,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:997,columnNumber:31},void 0)]},ae.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:967,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:965,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:964,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:772,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:755,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:639,columnNumber:7},void 0),!je&&T&&jt&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1048,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>E(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(yn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1054,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1047,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1057,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=fe.current)==null?void 0:O.click()},disabled:De.has(T),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(Ou,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1063,columnNumber:15},void 0),De.has(T)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1066,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1046,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:O=>Ee(O,T),onDragOver:Sn,children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(Jo,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(O=>a.jsxDEV("div",{className:"relative group",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1086,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1093,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1092,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>Ze(T,O.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(wf,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:21},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1084,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1082,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1071,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1045,columnNumber:9},void 0),je&&Ft&&T&&jt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Rt(!1),E(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(yn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1130,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1121,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1133,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=fe.current)==null?void 0:O.click()},disabled:De.has(T),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(Ou,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1139,columnNumber:17},void 0),De.has(T)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1120,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(Jo,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(O=>a.jsxDEV("div",{className:"relative",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1155,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1162,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1161,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Ze(T,O.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(wf,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1169,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1165,columnNumber:23},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1172,columnNumber:25},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1153,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:9},void 0),oe!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(te=d.find(O=>O.id===oe))==null?void 0:te.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1191,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Me(null),Pe(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(yn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1201,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1194,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1189,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1207,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Ye=d.find(O=>O.id===oe))==null?void 0:Ye.items.map(O=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const be=new Set(ue);be.has(O.id)?be.delete(O.id):be.add(O.id),Pe(be)},children:[a.jsxDEV("input",{type:"checkbox",checked:ue.has(O.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1227,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${O.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:O.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1214,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1210,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:L,disabled:ue.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",ue.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1242,columnNumber:15},void 0),a.jsxDEV("button",{onClick:q,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1249,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{Me(null),Pe(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1255,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1241,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1188,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1187,columnNumber:9},void 0),st&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1275,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{At(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(yn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1283,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1276,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1274,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1290,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:I,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&I.trim()&&Ct()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1291,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1289,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{At(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1307,columnNumber:17},void 0),a.jsxDEV("button",{onClick:Ct,disabled:!I.trim()||nt,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:nt?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1316,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1306,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1288,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1272,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1271,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:623,columnNumber:5},void 0)};function sI(){const[n,e]=V.useState([]),[t,s]=V.useState(!1),[r,i]=V.useState(null),[o,l]=V.useState(!1),[u,m]=V.useState(null),[d,f]=V.useState(""),[h,y]=V.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[I,v]=V.useState(!1);V.useEffect(()=>{w()},[]),V.useEffect(()=>{const N=()=>{R()};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[]);const w=async()=>{var N,C;try{n.length===0&&s(!0),i(null);const j=await tr.getAllContractors();e(j.map(S=>({id:S._id,rank:S.rank,companyName:S.companyName,name:S.name,position:S.position,process:S.process,contact:S.contact,accountNumber:S.accountNumber,notes:S.notes,createdAt:new Date(S.createdAt),updatedAt:new Date(S.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const S=j instanceof Error&&((C=(N=j.response)==null?void 0:N.data)==null?void 0:C.message);i(S||"   .")}finally{s(!1)}},R=N=>{if(N){m(N);let C="",j=N.accountNumber||"";if(N.accountNumber){const E=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const De of E)if(N.accountNumber.startsWith(De)){C=De,j=N.accountNumber.substring(De.length).trim();break}}let S=N.name,T=N.position||"";T||(T=Nl(N.name),S=ba(N.name)),y({rank:N.rank||"",companyName:N.companyName||"",name:S,position:T,process:N.process,contact:N.contact||"",bankName:C,accountNumber:j,notes:N.notes||""})}else m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},P=()=>{l(!1),m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},F=async N=>{var j,S;if(N.preventDefault(),I)return;v(!0);const C=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const T={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:C,notes:h.notes};u?await tr.updateContractor(u.id,T):await tr.createContractor(T),await w(),P()}catch(T){console.error("Failed to save contractor:",T);const E=T instanceof Error&&((S=(j=T.response)==null?void 0:j.data)==null?void 0:S.message);alert(E||"  .")}finally{v(!1)}},re=async N=>{var C,j;if(window.confirm("   ?"))try{await tr.deleteContractor(N),await w()}catch(S){console.error("Failed to delete contractor:",S);const T=S instanceof Error&&((j=(C=S.response)==null?void 0:C.data)==null?void 0:j.message);alert(T||"  .")}},Z=()=>"border-gray-200 text-gray-600 bg-gray-50",M=N=>N?N==="1"?1:N==="1()"?2:N==="2"?3:N==="2()"?4:N==="3"?5:N==="3()"?6:N===""?100:N===""?200:999:999,A=n.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())||N.process.toLowerCase().includes(d.toLowerCase())||N.accountNumber.toLowerCase().includes(d.toLowerCase())||N.contact&&N.contact.toLowerCase().includes(d.toLowerCase())||N.rank&&N.rank.toLowerCase().includes(d.toLowerCase())||N.companyName&&N.companyName.toLowerCase().includes(d.toLowerCase())).sort((N,C)=>{const j=M(N.rank)-M(C.rank);if(j!==0)return j;const S=N.process.localeCompare(C.process,"ko");return S!==0?S:N.name.localeCompare(C.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>R(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(ug,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):A.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):A.map(N=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${Z(N.rank)}`,children:N.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:ba(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.position||Nl(N.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:N.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>R(N),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(qu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):A.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):A.map(N=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[N.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${Z(N.rank)}`,children:N.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),N.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:N.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:ba(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>R(N),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(qu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(N.position||Nl(N.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.position||Nl(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),N.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),N.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:N.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:P,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(yn,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:F,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:h.rank,onChange:N=>y({...h,rank:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.companyName,onChange:N=>y({...h,companyName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:N=>y({...h,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.position,onChange:N=>y({...h,position:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:N=>y({...h,process:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.contact,onChange:N=>y({...h,contact:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:h.bankName,onChange:N=>y({...h,bankName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:N=>y({...h,accountNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:h.notes,onChange:N=>y({...h,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:P,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:I,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:I?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const rI=()=>{const[n,e]=V.useState([]),[t,s]=V.useState(null),[r,i]=V.useState(!1);V.useEffect(()=>{o()},[]);const o=async()=>{try{n.length===0&&i(!0);const f=await Ae.get("/quote-inquiries");e(f.data)}catch(f){console.error("Failed to load inquiries:",f),ie.error("  ")}finally{i(!1)}},l=async f=>{try{await Ae.put(`/quote-inquiries/${f}/read`),e(h=>h.map(y=>y.id===f?{...y,isRead:!0}:y)),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},u=f=>{s(f),f.isRead||l(f.id)},m=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await Ae.delete(`/quote-inquiries/${f}`),e(y=>y.filter(I=>I.id!==f)),(t==null?void 0:t.id)===f&&s(null),ie.success(" ")}catch(y){console.error("Failed to delete inquiry:",y),ie.error("  ")}},d=n.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:93,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:92,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:106,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:103,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:115,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:n.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:135,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:Ut(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:139,columnNumber:25},void 0),a.jsxDEV("button",{onClick:h=>m(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:147,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:142,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(If,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:157,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:127,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:121,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:101,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>s(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:Ut(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(bx,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:194,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:193,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(If,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Nx,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:204,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:202,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(xx,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:208,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:209,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:207,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:197,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:192,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(vx,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:219,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:218,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:225,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:224,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:231,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:217,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:241,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:240,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:249,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:169,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:99,columnNumber:5},void 0)},iI=()=>{const{login:n}=zr(),[e,t]=V.useState(!1),{register:s,handleSubmit:r,setValue:i,formState:{errors:o}}=tf(),l=async m=>{t(!0);try{await n(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...s("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...s("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(_x,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},oI=V.lazy(()=>Ks(()=>import("./Drawings-nH3_VtDb.js"),__vite__mapDeps([0,1,2,3,4,5]))),aI=V.lazy(()=>Ks(()=>import("./SiteLog-DdmuQSbR.js"),__vite__mapDeps([6,1,4,2,3,5]))),lI=V.lazy(()=>Ks(()=>import("./AfterService-DZ7YrAsO.js"),__vite__mapDeps([7,1,2,4,3,5]))),cI=V.lazy(()=>Ks(()=>import("./AdditionalWork-Bqr94ZOC.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),uI=V.lazy(()=>Ks(()=>import("./ConstructionPayment-ByFfoaPG.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),mI=V.lazy(()=>Ks(()=>import("./WorkRequest-n8PxFLsR.js"),__vite__mapDeps([11,1,2,4,3,5]))),dI=V.lazy(()=>Ks(()=>import("./Specbook-Dc86oDF7.js"),__vite__mapDeps([12,1,2,3,4,5]))),fI=V.lazy(()=>Ks(()=>import("./EstimatePreview-Dwv1Dbfk.js"),__vite__mapDeps([13,1,2,3,4,5]))),pI=V.lazy(()=>Ks(()=>import("./ExecutionHistory-BgFn1jRY.js"),__vite__mapDeps([14,1,4,2,3,5]))),hI=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),gI=new lx({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function yI(){const[n,e]=V.useState(!1);return V.useEffect(()=>{const t=__({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),ie.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{ie.dismiss(),ie.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});X1();const s=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(s,5e3);const r=setInterval(s,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=oa(u,{transports:["websocket","polling"]}),Er.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;Y1(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(cx,{client:gI,children:a.jsxDEV(ix,{children:a.jsxDEV(A_,{children:[a.jsxDEV(V.Suspense,{fallback:a.jsxDEV(hI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(ox,{children:[a.jsxDEV(kn,{path:"/login",element:a.jsxDEV(iI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(kn,{path:"/",element:a.jsxDEV(K1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(kn,{index:!0,element:a.jsxDEV(ag,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(kn,{path:"dashboard",element:a.jsxDEV(EC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(kn,{path:"projects",element:a.jsxDEV(SC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(kn,{path:"schedule",element:a.jsxDEV(K2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(kn,{path:"drawings",element:a.jsxDEV(oI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(kn,{path:"site-log",element:a.jsxDEV(aI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(kn,{path:"after-service",element:a.jsxDEV(lI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(kn,{path:"additional-work",element:a.jsxDEV(cI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(kn,{path:"construction-payment",element:a.jsxDEV(uI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(kn,{path:"contractors",element:a.jsxDEV(sI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(kn,{path:"work-request",element:a.jsxDEV(mI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(kn,{path:"finish-check",element:a.jsxDEV(nI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(kn,{path:"specbook",element:a.jsxDEV(dI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(kn,{path:"estimate-preview",element:a.jsxDEV(fI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(kn,{path:"execution-history",element:a.jsxDEV(pI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(kn,{path:"payments",element:a.jsxDEV(tI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(kn,{path:"quote-inquiry",element:a.jsxDEV(rI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(Cv,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(n){for(const e of n)e.update()});Vg(document.getElementById("root")).render(a.jsxDEV(V.StrictMode,{children:a.jsxDEV(yI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{Bt as C,Uu as P,Ae as a,nu as b,Or as c,tf as d,V_ as e,Pm as f,VI as g,X2 as h,a as j,gn as l,eI as m,vs as p,J2 as s,zr as u,cD as w,ie as z};
