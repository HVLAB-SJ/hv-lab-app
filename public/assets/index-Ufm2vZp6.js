const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-DvZgKMQA.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-x04iISBj.js","assets/AfterService-BhIA4x_T.js","assets/AdditionalWork-QoSdEI0x.js","assets/additionalWorkService-DiQGKfKt.js","assets/ConstructionPayment-CJ-nqHZM.js","assets/WorkRequest-aQrQ-UYV.js","assets/Specbook-BswDR6Ft.js","assets/EstimatePreview-E_xxix-1.js","assets/ExecutionHistory-GOXgFkPt.js"])))=>i.map(i=>d[i]);
var yv=Object.defineProperty;var bv=(n,e,t)=>e in n?yv(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ep=(n,e,t)=>bv(n,typeof e!="symbol"?e+"":e,t);import{r as E,b as Nv,u as oy,d as xv,N as ay,e as im,O as vv,R as mt,f as bl,B as _v,h as Dv,i as Ln}from"./vendor-react-DN7YJcfR.js";import{a as kv,c as Sd,Q as Ev,b as Av}from"./vendor-data-DrLf5NIQ.js";import{B as om,X as wn,C as ly,T as Ti,a as wv,b as cy,W as Vv,c as Cv,d as Ls,P as Io,R as Iv,e as Sv,S as uy,f as Tv,g as Pv,h as my,i as Lv,U as Pm,I as Ta,j as Lm,k as Ap,l as wp,m as Vp,n as jv,M as Rv,o as Bv,p as Uv,L as Hv}from"./vendor-ui-D8A9iq7X.js";import{k as am,l as ma,m as da,n as Mv,o as Fv,p as qt,q as Ov,r as Cp,s as qv,t as ct}from"./vendor-date-DbWJ9m7c.js";import{c as $v,p as dy,l as du,s as js,i as zv,h as Wv,q as Td,a as Pd,m as Ld,b as Kv,d as fu,o as Rc,e as Gv,f as Bc,r as jd,g as Rd,j as Bd,k as Ud,n as Hd,t as fy,u as py,v as hy,w as gy,x as yy,y as by,z as Ny,A as xy,B as vy,C as _y,D as Dy,E as ky,F as Qv,G as Yv,H as Xv,I as Jv,J as Zv,K as e_,L as t_}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var Ey={exports:{}},jm={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var n=E,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),C=Symbol.iterator,v="@@iterator";function w(x){if(x===null||typeof x!="object")return null;var L=C&&x[C]||x[v];return typeof L=="function"?L:null}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function I(x){{for(var L=arguments.length,U=new Array(L>1?L-1:0),X=1;X<L;X++)U[X-1]=arguments[X];F("error",x,U)}}function F(x,L,U){{var X=R.ReactDebugCurrentFrame,G=X.getStackAddendum();G!==""&&(L+="%s",U=U.concat([G]));var Z=U.map(function(ie){return String(ie)});Z.unshift("Warning: "+L),Function.prototype.apply.call(console[x],console,Z)}}var re=!1,ee=!1,M=!1,A=!1,N=!1,V;V=Symbol.for("react.module.reference");function j(x){return!!(typeof x=="string"||typeof x=="function"||x===s||x===i||N||x===r||x===m||x===d||A||x===y||re||ee||M||typeof x=="object"&&x!==null&&(x.$$typeof===p||x.$$typeof===f||x.$$typeof===o||x.$$typeof===l||x.$$typeof===u||x.$$typeof===V||x.getModuleId!==void 0))}function T(x,L,U){var X=x.displayName;if(X)return X;var G=L.displayName||L.name||"";return G!==""?U+"("+G+")":U}function S(x){return x.displayName||"Context"}function k(x){if(x==null)return null;if(typeof x.tag=="number"&&I("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case s:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case l:var L=x;return S(L)+".Consumer";case o:var U=x;return S(U._context)+".Provider";case u:return T(x,x.render,"ForwardRef");case f:var X=x.displayName||null;return X!==null?X:k(x.type)||"Memo";case p:{var G=x,Z=G._payload,ie=G._init;try{return k(ie(Z))}catch{return null}}}return null}var Ee=Object.assign,qe=0,ge,Ue,ht,Kt,Ot,le,$e;function de(){}de.__reactDisabledLog=!0;function Re(){{if(qe===0){ge=console.log,Ue=console.info,ht=console.warn,Kt=console.error,Ot=console.group,le=console.groupCollapsed,$e=console.groupEnd;var x={configurable:!0,enumerable:!0,value:de,writable:!0};Object.defineProperties(console,{info:x,log:x,warn:x,error:x,group:x,groupCollapsed:x,groupEnd:x})}qe++}}function Ye(){{if(qe--,qe===0){var x={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:Ee({},x,{value:ge}),info:Ee({},x,{value:Ue}),warn:Ee({},x,{value:ht}),error:Ee({},x,{value:Kt}),group:Ee({},x,{value:Ot}),groupCollapsed:Ee({},x,{value:le}),groupEnd:Ee({},x,{value:$e})})}qe<0&&I("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var vt=R.ReactCurrentDispatcher,lt;function It(x,L,U){{if(lt===void 0)try{throw Error()}catch(G){var X=G.stack.trim().match(/\n( *(at )?)/);lt=X&&X[1]||""}return`
`+lt+x}}var at=!1,ft;{var bn=typeof WeakMap=="function"?WeakMap:Map;ft=new bn}function K(x,L){if(!x||at)return"";{var U=ft.get(x);if(U!==void 0)return U}var X;at=!0;var G=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Z;Z=vt.current,vt.current=null,Re();try{if(L){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Mt){X=Mt}Reflect.construct(x,[],ie)}else{try{ie.call()}catch(Mt){X=Mt}x.call(ie.prototype)}}else{try{throw Error()}catch(Mt){X=Mt}x()}}catch(Mt){if(Mt&&X&&typeof Mt.stack=="string"){for(var Ce=Mt.stack.split(`
`),Ze=X.stack.split(`
`),Fe=Ce.length-1,pe=Ze.length-1;Fe>=1&&pe>=0&&Ce[Fe]!==Ze[pe];)pe--;for(;Fe>=1&&pe>=0;Fe--,pe--)if(Ce[Fe]!==Ze[pe]){if(Fe!==1||pe!==1)do if(Fe--,pe--,pe<0||Ce[Fe]!==Ze[pe]){var We=`
`+Ce[Fe].replace(" at new "," at ");return x.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",x.displayName)),typeof x=="function"&&ft.set(x,We),We}while(Fe>=1&&pe>=0);break}}}finally{at=!1,vt.current=Z,Ye(),Error.prepareStackTrace=G}var fn=x?x.displayName||x.name:"",Qt=fn?It(fn):"";return typeof x=="function"&&ft.set(x,Qt),Qt}function Le(x,L,U){return K(x,!1)}function He(x){var L=x.prototype;return!!(L&&L.isReactComponent)}function Se(x,L,U){if(x==null)return"";if(typeof x=="function")return K(x,He(x));if(typeof x=="string")return It(x);switch(x){case m:return It("Suspense");case d:return It("SuspenseList")}if(typeof x=="object")switch(x.$$typeof){case u:return Le(x.render);case f:return Se(x.type,L,U);case p:{var X=x,G=X._payload,Z=X._init;try{return Se(Z(G),L,U)}catch{}}}return""}var Xe=Object.prototype.hasOwnProperty,St={},Gt=R.ReactDebugCurrentFrame;function dt(x){if(x){var L=x._owner,U=Se(x.type,x._source,L?L.type:null);Gt.setExtraStackFrame(U)}else Gt.setExtraStackFrame(null)}function P(x,L,U,X,G){{var Z=Function.call.bind(Xe);for(var ie in x)if(Z(x,ie)){var Ce=void 0;try{if(typeof x[ie]!="function"){var Ze=Error((X||"React class")+": "+U+" type `"+ie+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof x[ie]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Ze.name="Invariant Violation",Ze}Ce=x[ie](L,ie,X,U,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Fe){Ce=Fe}Ce&&!(Ce instanceof Error)&&(dt(G),I("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",X||"React class",U,ie,typeof Ce),dt(null)),Ce instanceof Error&&!(Ce.message in St)&&(St[Ce.message]=!0,dt(G),I("Failed %s type: %s",U,Ce.message),dt(null))}}}var q=Array.isArray;function te(x){return q(x)}function xe(x){{var L=typeof Symbol=="function"&&Symbol.toStringTag,U=L&&x[Symbol.toStringTag]||x.constructor.name||"Object";return U}}function ue(x){try{return fe(x),!1}catch{return!0}}function fe(x){return""+x}function Ie(x){if(ue(x))return I("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",xe(x)),fe(x)}var ze=R.ReactCurrentOwner,tt={key:!0,ref:!0,__self:!0,__source:!0},Ae,On,Ht;Ht={};function ne(x){if(Xe.call(x,"ref")){var L=Object.getOwnPropertyDescriptor(x,"ref").get;if(L&&L.isReactWarning)return!1}return x.ref!==void 0}function Je(x){if(Xe.call(x,"key")){var L=Object.getOwnPropertyDescriptor(x,"key").get;if(L&&L.isReactWarning)return!1}return x.key!==void 0}function O(x,L){if(typeof x.ref=="string"&&ze.current&&L&&ze.current.stateNode!==L){var U=k(ze.current.type);Ht[U]||(I('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(ze.current.type),x.ref),Ht[U]=!0)}}function ve(x,L){{var U=function(){Ae||(Ae=!0,I("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"key",{get:U,configurable:!0})}}function ke(x,L){{var U=function(){On||(On=!0,I("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"ref",{get:U,configurable:!0})}}var je=function(x,L,U,X,G,Z,ie){var Ce={$$typeof:e,type:x,key:L,ref:U,props:ie,_owner:Z};return Ce._store={},Object.defineProperty(Ce._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Ce,"_self",{configurable:!1,enumerable:!1,writable:!1,value:X}),Object.defineProperty(Ce,"_source",{configurable:!1,enumerable:!1,writable:!1,value:G}),Object.freeze&&(Object.freeze(Ce.props),Object.freeze(Ce)),Ce};function me(x,L,U,X,G){{var Z,ie={},Ce=null,Ze=null;U!==void 0&&(Ie(U),Ce=""+U),Je(L)&&(Ie(L.key),Ce=""+L.key),ne(L)&&(Ze=L.ref,O(L,G));for(Z in L)Xe.call(L,Z)&&!tt.hasOwnProperty(Z)&&(ie[Z]=L[Z]);if(x&&x.defaultProps){var Fe=x.defaultProps;for(Z in Fe)ie[Z]===void 0&&(ie[Z]=Fe[Z])}if(Ce||Ze){var pe=typeof x=="function"?x.displayName||x.name||"Unknown":x;Ce&&ve(ie,pe),Ze&&ke(ie,pe)}return je(x,Ce,Ze,G,X,ze.current,ie)}}var kt=R.ReactCurrentOwner,xt=R.ReactDebugCurrentFrame;function tn(x){if(x){var L=x._owner,U=Se(x.type,x._source,L?L.type:null);xt.setExtraStackFrame(U)}else xt.setExtraStackFrame(null)}var At;At=!1;function Nn(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function cn(){{if(kt.current){var x=k(kt.current.type);if(x)return`

Check the render method of \``+x+"`."}return""}}function Un(x){{if(x!==void 0){var L=x.fileName.replace(/^.*[\\\/]/,""),U=x.lineNumber;return`

Check your code at `+L+":"+U+"."}return""}}var xs={};function ss(x){{var L=cn();if(!L){var U=typeof x=="string"?x:x.displayName||x.name;U&&(L=`

Check the top-level render call using <`+U+">.")}return L}}function vs(x,L){{if(!x._store||x._store.validated||x.key!=null)return;x._store.validated=!0;var U=ss(L);if(xs[U])return;xs[U]=!0;var X="";x&&x._owner&&x._owner!==kt.current&&(X=" It was passed a child from "+k(x._owner.type)+"."),tn(x),I('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',U,X),tn(null)}}function ui(x,L){{if(typeof x!="object")return;if(te(x))for(var U=0;U<x.length;U++){var X=x[U];Nn(X)&&vs(X,L)}else if(Nn(x))x._store&&(x._store.validated=!0);else if(x){var G=w(x);if(typeof G=="function"&&G!==x.entries)for(var Z=G.call(x),ie;!(ie=Z.next()).done;)Nn(ie.value)&&vs(ie.value,L)}}}function Os(x){{var L=x.type;if(L==null||typeof L=="string")return;var U;if(typeof L=="function")U=L.propTypes;else if(typeof L=="object"&&(L.$$typeof===u||L.$$typeof===f))U=L.propTypes;else return;if(U){var X=k(L);P(U,x.props,"prop",X,x)}else if(L.PropTypes!==void 0&&!At){At=!0;var G=k(L);I("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",G||"Unknown")}typeof L.getDefaultProps=="function"&&!L.getDefaultProps.isReactClassApproved&&I("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ls(x){{for(var L=Object.keys(x.props),U=0;U<L.length;U++){var X=L[U];if(X!=="children"&&X!=="key"){tn(x),I("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",X),tn(null);break}}x.ref!==null&&(tn(x),I("Invalid attribute `ref` supplied to `React.Fragment`."),tn(null))}}var D={};function Q(x,L,U,X,G,Z){{var ie=j(x);if(!ie){var Ce="";(x===void 0||typeof x=="object"&&x!==null&&Object.keys(x).length===0)&&(Ce+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Ze=Un(G);Ze?Ce+=Ze:Ce+=cn();var Fe;x===null?Fe="null":te(x)?Fe="array":x!==void 0&&x.$$typeof===e?(Fe="<"+(k(x.type)||"Unknown")+" />",Ce=" Did you accidentally export a JSX literal instead of a component?"):Fe=typeof x,I("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Fe,Ce)}var pe=me(x,L,U,G,Z);if(pe==null)return pe;if(ie){var We=L.children;if(We!==void 0)if(X)if(te(We)){for(var fn=0;fn<We.length;fn++)ui(We[fn],x);Object.freeze&&Object.freeze(We)}else I("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ui(We,x)}if(Xe.call(L,"key")){var Qt=k(x),Mt=Object.keys(L).filter(function(Qn){return Qn!=="key"}),Bt=Mt.length>0?"{key: someKey, "+Mt.join(": ..., ")+": ...}":"{key: someKey}";if(!D[Qt+Bt]){var qn=Mt.length>0?"{"+Mt.join(": ..., ")+": ...}":"{}";I(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Bt,Qt,qn,Qt),D[Qt+Bt]=!0}}return x===s?ls(pe):Os(pe),pe}}var B=Q;jm.Fragment=s,jm.jsxDEV=B})();Ey.exports=jm;var a=Ey.exports,Ay,Ip=Nv;{var Sp=Ip.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Ay=function(n,e){Sp.usingClientEntryPoint=!0;try{return Ip.createRoot(n,e)}finally{Sp.usingClientEntryPoint=!1}}}const n_="modulepreload",s_=function(n){return"/"+n},Tp={},rr=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=s_(u),u in Tp)return;Tp[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":n_,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((p,y)=>{f.addEventListener("load",p),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let r_={data:""},i_=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||r_},o_=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,a_=/\/\*[^]*?\*\/|  +/g,Pp=/\n+/g,jr=(n,e)=>{let t="",s="",r="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":s+=i[1]=="f"?jr(o,i):i+"{"+jr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=jr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=jr.p?jr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+s},ir={},wy=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+wy(n[t]);return e}return n},l_=(n,e,t,s,r)=>{let i=wy(n),o=ir[i]||(ir[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!ir[o]){let u=i!==n?n:(m=>{let d,f,p=[{}];for(;d=o_.exec(m.replace(a_,""));)d[4]?p.shift():d[3]?(f=d[3].replace(Pp," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][d[1]]=d[2].replace(Pp," ").trim();return p[0]})(n);ir[o]=jr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&ir.g?ir.g:null;return t&&(ir.g=ir[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(ir[o],e,s,l),o},c_=(n,e,t)=>n.reduce((s,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":jr(l,""):l===!1?"":l}return s+r+(o??"")},"");function pu(n){let e=this||{},t=n.call?n(e.p):n;return l_(t.unshift?t.raw?c_(t,[].slice.call(arguments,1),e.p):t.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):t,i_(e.target),e.g,e.o,e.k)}let Vy,Rm,Bm;pu.bind({g:1});let mr=pu.bind({k:1});function u_(n,e,t,s){jr.p=e,Vy=n,Rm=t,Bm=s}function Zr(n,e){let t=this||{};return function(){let s=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:Rm&&Rm()},l),t.o=/ *go\d+/.test(u),l.className=pu.apply(t,s)+(u?" "+u:"");let m=n;return n[0]&&(m=l.as||n,delete l.as),Bm&&m[0]&&Bm(l),Vy(m,l)}return r}}var m_=n=>typeof n=="function",Uc=(n,e)=>m_(n)?n(e):n,d_=(()=>{let n=0;return()=>(++n).toString()})(),Cy=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),f_=20,Md="default",Iy=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:s}=e;return Iy(n,{type:n.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...n,toasts:n.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},gc=[],Sy={toasts:[],pausedAt:void 0,settings:{toastLimit:f_}},Gs={},Ty=(n,e=Md)=>{Gs[e]=Iy(Gs[e]||Sy,n),gc.forEach(([t,s])=>{t===e&&s(Gs[e])})},Py=n=>Object.keys(Gs).forEach(e=>Ty(n,e)),p_=n=>Object.keys(Gs).find(e=>Gs[e].toasts.some(t=>t.id===n)),hu=(n=Md)=>e=>{Ty(e,n)},h_={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},g_=(n={},e=Md)=>{let[t,s]=E.useState(Gs[e]||Sy),r=E.useRef(Gs[e]);E.useEffect(()=>(r.current!==Gs[e]&&s(Gs[e]),gc.push([e,s]),()=>{let o=gc.findIndex(([l])=>l===e);o>-1&&gc.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((l=n[o.type])==null?void 0:l.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((u=n[o.type])==null?void 0:u.duration)||(n==null?void 0:n.duration)||h_[o.type],style:{...n.style,...(m=n[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},y_=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||d_()}),Nl=n=>(e,t)=>{let s=y_(e,n,t);return hu(s.toasterId||p_(s.id))({type:2,toast:s}),s.id},jn=(n,e)=>Nl("blank")(n,e);jn.error=Nl("error");jn.success=Nl("success");jn.loading=Nl("loading");jn.custom=Nl("custom");jn.dismiss=(n,e)=>{let t={type:3,toastId:n};e?hu(e)(t):Py(t)};jn.dismissAll=n=>jn.dismiss(void 0,n);jn.remove=(n,e)=>{let t={type:4,toastId:n};e?hu(e)(t):Py(t)};jn.removeAll=n=>jn.remove(void 0,n);jn.promise=(n,e,t)=>{let s=jn.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(r=>{let i=e.success?Uc(e.success,r):void 0;return i?jn.success(i,{id:s,...t,...t==null?void 0:t.success}):jn.dismiss(s),r}).catch(r=>{let i=e.error?Uc(e.error,r):void 0;i?jn.error(i,{id:s,...t,...t==null?void 0:t.error}):jn.dismiss(s)}),n};var b_=1e3,N_=(n,e="default")=>{let{toasts:t,pausedAt:s}=g_(n,e),r=E.useRef(new Map).current,i=E.useCallback((f,p=b_)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},p);r.set(f,y)},[]);E.useEffect(()=>{if(s)return;let f=Date.now(),p=t.map(y=>{if(y.duration===1/0)return;let C=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(C<0){y.visible&&jn.dismiss(y.id);return}return setTimeout(()=>jn.dismiss(y.id,e),C)});return()=>{p.forEach(y=>y&&clearTimeout(y))}},[t,s,e]);let o=E.useCallback(hu(e),[e]),l=E.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=E.useCallback((f,p)=>{o({type:1,toast:{id:f,height:p}})},[o]),m=E.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),d=E.useCallback((f,p)=>{let{reverseOrder:y=!1,gutter:C=8,defaultPosition:v}=p||{},w=t.filter(F=>(F.position||v)===(f.position||v)&&F.height),R=w.findIndex(F=>F.id===f.id),I=w.filter((F,re)=>re<R&&F.visible).length;return w.filter(F=>F.visible).slice(...y?[I+1]:[0,I]).reduce((F,re)=>F+(re.height||0)+C,0)},[t]);return E.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let p=r.get(f.id);p&&(clearTimeout(p),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},x_=mr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,v_=mr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,__=mr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,D_=Zr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${x_} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${v_} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${__} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,k_=mr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,E_=Zr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${k_} 1s linear infinite;
`,A_=mr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,w_=mr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,V_=Zr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${A_} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${w_} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,C_=Zr("div")`
  position: absolute;
`,I_=Zr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,S_=mr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,T_=Zr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${S_} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,P_=({toast:n})=>{let{icon:e,type:t,iconTheme:s}=n;return e!==void 0?typeof e=="string"?E.createElement(T_,null,e):e:t==="blank"?null:E.createElement(I_,null,E.createElement(E_,{...s}),t!=="loading"&&E.createElement(C_,null,t==="error"?E.createElement(D_,{...s}):E.createElement(V_,{...s})))},L_=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,j_=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,R_="0%{opacity:0;} 100%{opacity:1;}",B_="0%{opacity:1;} 100%{opacity:0;}",U_=Zr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,H_=Zr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,M_=(n,e)=>{let t=n.includes("top")?1:-1,[s,r]=Cy()?[R_,B_]:[L_(t),j_(t)];return{animation:e?`${mr(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${mr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},F_=E.memo(({toast:n,position:e,style:t,children:s})=>{let r=n.height?M_(n.position||e||"top-center",n.visible):{opacity:0},i=E.createElement(P_,{toast:n}),o=E.createElement(H_,{...n.ariaProps},Uc(n.message,n));return E.createElement(U_,{className:n.className,style:{...r,...t,...n.style}},typeof s=="function"?s({icon:i,message:o}):E.createElement(E.Fragment,null,i,o))});u_(E.createElement);var O_=({id:n,className:e,style:t,onHeightUpdate:s,children:r})=>{let i=E.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;s(n,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,s]);return E.createElement("div",{ref:i,className:e,style:t},r)},q_=(n,e)=>{let t=n.includes("top"),s=t?{top:0}:{bottom:0},r=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Cy()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...s,...r}},$_=pu`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,zl=16,z_=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:s,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=N_(t,i);return E.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:zl,left:zl,right:zl,bottom:zl,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,p=m.calculateOffset(d,{reverseOrder:n,gutter:s,defaultPosition:e}),y=q_(f,p);return E.createElement(O_,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?$_:"",style:y},d.type==="custom"?Uc(d.message,d):r?r(d):E.createElement(F_,{toast:d,position:f}))}))},oe=jn;const nr=Object.create(null);nr.open="0";nr.close="1";nr.ping="2";nr.pong="3";nr.message="4";nr.upgrade="5";nr.noop="6";const yc=Object.create(null);Object.keys(nr).forEach(n=>{yc[nr[n]]=n});const Um={type:"error",data:"parser error"},Ly=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",jy=typeof ArrayBuffer=="function",Ry=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Fd=({type:n,data:e},t,s)=>Ly&&e instanceof Blob?t?s(e):Lp(e,s):jy&&(e instanceof ArrayBuffer||Ry(e))?t?s(e):Lp(new Blob([e]),s):s(nr[n]+(e||"")),Lp=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function jp(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let lm;function W_(n,e){if(Ly&&n.data instanceof Blob)return n.data.arrayBuffer().then(jp).then(e);if(jy&&(n.data instanceof ArrayBuffer||Ry(n.data)))return e(jp(n.data));Fd(n,!1,t=>{lm||(lm=new TextEncoder),e(lm.encode(t))})}const Rp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Rp.length;n++)Pa[Rp.charCodeAt(n)]=n;const K_=n=>{let e=n.length*.75,t=n.length,s,r=0,i,o,l,u;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(s=0;s<t;s+=4)i=Pa[n.charCodeAt(s)],o=Pa[n.charCodeAt(s+1)],l=Pa[n.charCodeAt(s+2)],u=Pa[n.charCodeAt(s+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},G_=typeof ArrayBuffer=="function",Od=(n,e)=>{if(typeof n!="string")return{type:"message",data:By(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:Q_(n.substring(1),e)}:yc[t]?n.length>1?{type:yc[t],data:n.substring(1)}:{type:yc[t]}:Um},Q_=(n,e)=>{if(G_){const t=K_(n);return By(t,e)}else return{base64:!0,data:n}},By=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},Uy="",Y_=(n,e)=>{const t=n.length,s=new Array(t);let r=0;n.forEach((i,o)=>{Fd(i,!1,l=>{s[o]=l,++r===t&&e(s.join(Uy))})})},X_=(n,e)=>{const t=n.split(Uy),s=[];for(let r=0;r<t.length;r++){const i=Od(t[r],e);if(s.push(i),i.type==="error")break}return s};function J_(){return new TransformStream({transform(n,e){W_(n,t=>{const s=t.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let cm;function Wl(n){return n.reduce((e,t)=>e+t.length,0)}function Kl(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)t[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function Z_(n,e){cm||(cm=new TextDecoder);const t=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(s===0){if(Wl(t)<1)break;const u=Kl(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(Wl(t)<2)break;const u=Kl(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),s=3}else if(s===2){if(Wl(t)<8)break;const u=Kl(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(Um);break}r=d*Math.pow(2,32)+m.getUint32(4),s=3}else{if(Wl(t)<r)break;const u=Kl(t,r);l.enqueue(Od(i?u:cm.decode(u),e)),s=0}if(r===0||r>n){l.enqueue(Um);break}}}})}const Hy=4;function Vn(n){if(n)return eD(n)}function eD(n){for(var e in Vn.prototype)n[e]=Vn.prototype[e];return n}Vn.prototype.on=Vn.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};Vn.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};Vn.prototype.off=Vn.prototype.removeListener=Vn.prototype.removeAllListeners=Vn.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<t.length;r++)if(s=t[r],s===e||s.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};Vn.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,r=t.length;s<r;++s)t[s].apply(this,e)}return this};Vn.prototype.emitReserved=Vn.prototype.emit;Vn.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};Vn.prototype.hasListeners=function(n){return!!this.listeners(n).length};const gu=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Ds=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),tD="arraybuffer";function My(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const nD=Ds.setTimeout,sD=Ds.clearTimeout;function yu(n,e){e.useNativeTimers?(n.setTimeoutFn=nD.bind(Ds),n.clearTimeoutFn=sD.bind(Ds)):(n.setTimeoutFn=Ds.setTimeout.bind(Ds),n.clearTimeoutFn=Ds.clearTimeout.bind(Ds))}const rD=1.33;function iD(n){return typeof n=="string"?oD(n):Math.ceil((n.byteLength||n.size)*rD)}function oD(n){let e=0,t=0;for(let s=0,r=n.length;s<r;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function Fy(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function aD(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function lD(n){let e={},t=n.split("&");for(let s=0,r=t.length;s<r;s++){let i=t[s].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class cD extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class qd extends Vn{constructor(e){super(),this.writable=!1,yu(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new cD(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Od(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=aD(e);return t.length?"?"+t:""}}class uD extends qd{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};X_(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Y_(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Fy()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Oy=!1;try{Oy=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const mD=Oy;function dD(){}class fD extends uD{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}let So=class bc extends Vn{constructor(e,t,s){super(),this.createRequest=e,yu(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=My(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=bc.requestsCount++,bc.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=dD,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete bc.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};So.requestsCount=0;So.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Bp);else if(typeof addEventListener=="function"){const n="onpagehide"in Ds?"pagehide":"unload";addEventListener(n,Bp,!1)}}function Bp(){for(let n in So.requests)So.requests.hasOwnProperty(n)&&So.requests[n].abort()}const pD=function(){const n=qy({xdomain:!1});return n&&n.responseType!==null}();class hD extends fD{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=pD&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new So(qy,this.uri(),e)}}function qy(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||mD))return new XMLHttpRequest}catch{}if(!e)try{return new Ds[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const $y=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class gD extends qd{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=$y?{}:My(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;Fd(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&gu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Fy()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const um=Ds.WebSocket||Ds.MozWebSocket;class yD extends gD{createSocket(e,t,s){return $y?new um(e,t,s):t?new um(e,t):new um(e)}doWrite(e,t){this.ws.send(t)}}class bD extends qd{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Z_(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),r=J_();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;this._writer.write(s).then(()=>{r&&gu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const ND={websocket:yD,webtransport:bD,polling:hD},xD=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,vD=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Hm(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let r=xD.exec(n||""),i={},o=14;for(;o--;)i[vD[o]]=r[o]||"";return t!=-1&&s!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=_D(i,i.path),i.queryKey=DD(i,i.query),i}function _D(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function DD(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(t[r]=i)}),t}const Mm=typeof addEventListener=="function"&&typeof removeEventListener=="function",Nc=[];Mm&&addEventListener("offline",()=>{Nc.forEach(n=>n())},!1);class Mr extends Vn{constructor(e,t){if(super(),this.binaryType=tD,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=Hm(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=Hm(t.host).host);yu(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=lD(this.opts.query)),Mm&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Nc.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Hy,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Mr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Mr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(t+=iD(r)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,gu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,r){if(typeof t=="function"&&(r=t,t=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:e,data:t,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(Mr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Mm&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Nc.indexOf(this._offlineEventListener);s!==-1&&Nc.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Mr.protocol=Hy;class kD extends Mr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;Mr.priorWebsocketSuccess=!1;const r=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!s)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Mr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=t.name,this.emitReserved("upgradeError",p)}}))};function i(){s||(s=!0,d(),t.close(),t=null)}const o=f=>{const p=new Error("probe error: "+f);p.transport=t.name,i(),this.emitReserved("upgradeError",p)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let ED=class extends kD{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>ND[r]).filter(r=>!!r)),super(e,s)}};function AD(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=Hm(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+e,s.href=s.protocol+"://"+i+(t&&t.port===s.port?"":":"+s.port),s}const wD=typeof ArrayBuffer=="function",VD=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,zy=Object.prototype.toString,CD=typeof Blob=="function"||typeof Blob<"u"&&zy.call(Blob)==="[object BlobConstructor]",ID=typeof File=="function"||typeof File<"u"&&zy.call(File)==="[object FileConstructor]";function $d(n){return wD&&(n instanceof ArrayBuffer||VD(n))||CD&&n instanceof Blob||ID&&n instanceof File}function xc(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(xc(n[t]))return!0;return!1}if($d(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return xc(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&xc(n[t]))return!0;return!1}function SD(n){const e=[],t=n.data,s=n;return s.data=Fm(t,e),s.attachments=e.length,{packet:s,buffers:e}}function Fm(n,e){if(!n)return n;if($d(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=Fm(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=Fm(n[s],e));return t}return n}function TD(n,e){return n.data=Om(n.data,e),delete n.attachments,n}function Om(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=Om(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=Om(n[t],e));return n}const PD=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],LD=5;var Et;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(Et||(Et={}));class jD{constructor(e){this.replacer=e}encode(e){return(e.type===Et.EVENT||e.type===Et.ACK)&&xc(e)?this.encodeAsBinary({type:e.type===Et.EVENT?Et.BINARY_EVENT:Et.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Et.BINARY_EVENT||e.type===Et.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=SD(e),s=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(s),r}}function Up(n){return Object.prototype.toString.call(n)==="[object Object]"}class zd extends Vn{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===Et.BINARY_EVENT;s||t.type===Et.BINARY_ACK?(t.type=s?Et.EVENT:Et.ACK,this.reconstructor=new RD(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if($d(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(Et[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Et.BINARY_EVENT||s.type===Et.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(i,t)}else s.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(zd.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Et.CONNECT:return Up(t);case Et.DISCONNECT:return t===void 0;case Et.CONNECT_ERROR:return typeof t=="string"||Up(t);case Et.EVENT:case Et.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&PD.indexOf(t[0])===-1);case Et.ACK:case Et.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class RD{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=TD(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const BD=Object.freeze(Object.defineProperty({__proto__:null,Decoder:zd,Encoder:jD,get PacketType(){return Et},protocol:LD},Symbol.toStringTag,{value:"Module"}));function Ts(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const UD=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Wy extends Vn{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ts(e,"open",this.onopen.bind(this)),Ts(e,"packet",this.onpacket.bind(this)),Ts(e,"error",this.onerror.bind(this)),Ts(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,r,i;if(UD.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:Et.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((s,r)=>{const i=(o,l)=>o?r(o):s(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Et.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Et.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Et.EVENT:case Et.BINARY_EVENT:this.onevent(e);break;case Et.ACK:case Et.BINARY_ACK:this.onack(e);break;case Et.DISCONNECT:this.ondisconnect();break;case Et.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...r){s||(s=!0,t.packet({type:Et.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Et.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function Xo(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Xo.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};Xo.prototype.reset=function(){this.attempts=0};Xo.prototype.setMin=function(n){this.ms=n};Xo.prototype.setMax=function(n){this.max=n};Xo.prototype.setJitter=function(n){this.jitter=n};class qm extends Vn{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,yu(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Xo({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||BD;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ED(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=Ts(t,"open",function(){s.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=Ts(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ts(e,"ping",this.onping.bind(this)),Ts(e,"data",this.ondata.bind(this)),Ts(e,"error",this.onerror.bind(this)),Ts(e,"close",this.onclose.bind(this)),Ts(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){gu(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new Wy(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const fa={};function Ma(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=AD(n,e.path||"/socket.io"),s=t.source,r=t.id,i=t.path,o=fa[r]&&i in fa[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new qm(s,e):(fa[r]||(fa[r]=new qm(s,e)),u=fa[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Ma,{Manager:qm,Socket:Wy,io:Ma,connect:Ma});function HD(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=n;let l,u,m;const d=async(p=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await rr(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/sw.js",{scope:"/",type:"classic"})).catch(p=>{o==null||o(p)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let p=!1;const y=()=>{p=!0,l==null||l.addEventListener("controlling",C=>{C.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",C=>{typeof C.isUpdate>"u"?typeof C.isExternal<"u"?C.isExternal?y():!p&&(s==null||s()):C.isExternal?window.location.reload():!p&&(s==null||s()):C.isUpdate||s==null||s()}),l.addEventListener("waiting",y),l.addEventListener("externalwaiting",y)}l.register({immediate:e}).then(p=>{i?i("/sw.js",p):r==null||r(p)}).catch(p=>{o==null||o(p)})}}return u=f(),d}const MD=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},FD=MD(),To=kv.create({baseURL:FD,headers:{"Content-Type":"application/json"}});To.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers.Authorization=`Bearer ${e}`),n},n=>Promise.reject(n));To.interceptors.response.use(n=>n,n=>{var e,t,s;return((e=n.response)==null?void 0:e.status)===401&&!((s=(t=n.config)==null?void 0:t.url)!=null&&s.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(n)});const OD=()=>{};var Hp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},qD=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Gy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,m=u?n[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let p=(l&15)<<2|m>>6,y=m&63;u||(y=64,o||(p=64)),s.push(t[d],t[f],t[p],t[y])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ky(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const m=r<n.length?t[n.charAt(r)]:64;++r;const f=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new $D;const p=i<<2|l>>4;if(s.push(p),m!==64){const y=l<<4&240|m>>2;if(s.push(y),f!==64){const C=m<<6&192|f;s.push(C)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class $D extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zD=function(n){const e=Ky(n);return Gy.encodeByteArray(e,!0)},Hc=function(n){return zD(n).replace(/\./g,"")},WD=function(n){try{return Gy.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD=()=>Qy().__FIREBASE_DEFAULTS__,GD=()=>{if(typeof process>"u"||typeof Hp>"u")return;const n=Hp.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},QD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&WD(n[1]);return e&&JSON.parse(e)},Wd=()=>{try{return OD()||KD()||GD()||QD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},YD=n=>{var e,t;return(t=(e=Wd())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Yy=n=>{const e=YD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},Xy=()=>{var n;return(n=Wd())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Jy(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zy(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Hc(JSON.stringify(t)),Hc(JSON.stringify(o)),""].join(".")}const Fa={};function JD(){const n={prod:[],emulator:[]};for(const e of Object.keys(Fa))Fa[e]?n.emulator.push(e):n.prod.push(e);return n}function ZD(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Mp=!1;function eb(n,e){if(typeof window>"u"||typeof document>"u"||!xl(window.location.host)||Fa[n]===e||Fa[n]||Mp)return;Fa[n]=e;function t(p){return`__firebase__banner__${p}`}const s="__firebase__banner",i=JD().prod.length>0;function o(){const p=document.getElementById(s);p&&p.remove()}function l(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,y){p.setAttribute("width","24"),p.setAttribute("id",y),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function m(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Mp=!0,o()},p}function d(p,y){p.setAttribute("id",y),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=ZD(s),y=t("text"),C=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),w=document.getElementById(v)||document.createElement("a"),R=t("preprendIcon"),I=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const F=p.element;l(F),d(w,v);const re=m();u(I,R),F.append(I,C,w,re),document.body.appendChild(F)}i?(C.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tb(){var e;const n=(e=Wd())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nb(){return!tb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sb(){return!tb()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function rb(){try{return typeof indexedDB=="object"}catch{return!1}}function ek(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk="FirebaseError";class qi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=tk,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ib.prototype.create)}}class ib{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?nk(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new qi(r,l,s)}}function nk(n,e){return n.replace(sk,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const sk=/\{\$([^}]+)}/g;function Fc(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(Fp(i)&&Fp(o)){if(!Fc(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function Fp(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gn(n){return n&&n._delegate?n._delegate:n}class Lo{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new XD;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ok(e))try{this.getOrInitializeService({instanceIdentifier:gi})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=gi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=gi){return this.instances.has(e)}getOptions(e=gi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:ik(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=gi){return this.component?this.component.multipleInstances?e:gi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ik(n){return n===gi?void 0:n}function ok(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new rk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ct||(Ct={}));const lk={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},ck=Ct.INFO,uk={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},mk=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=uk[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ob{constructor(e){this.name=e,this._logLevel=ck,this._logHandler=mk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const dk=(n,e)=>e.some(t=>n instanceof t);let Op,qp;function fk(){return Op||(Op=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pk(){return qp||(qp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ab=new WeakMap,$m=new WeakMap,lb=new WeakMap,mm=new WeakMap,Kd=new WeakMap;function hk(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Fr(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&ab.set(t,n)}).catch(()=>{}),Kd.set(e,n),e}function gk(n){if($m.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});$m.set(n,e)}let zm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return $m.get(n);if(e==="objectStoreNames")return n.objectStoreNames||lb.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function yk(n){zm=n(zm)}function bk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(dm(this),e,...t);return lb.set(s,e.sort?e.sort():[e]),Fr(s)}:pk().includes(n)?function(...e){return n.apply(dm(this),e),Fr(ab.get(this))}:function(...e){return Fr(n.apply(dm(this),e))}}function Nk(n){return typeof n=="function"?bk(n):(n instanceof IDBTransaction&&gk(n),dk(n,fk())?new Proxy(n,zm):n)}function Fr(n){if(n instanceof IDBRequest)return hk(n);if(mm.has(n))return mm.get(n);const e=Nk(n);return e!==n&&(mm.set(n,e),Kd.set(e,n)),e}const dm=n=>Kd.get(n);function xk(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),l=Fr(o);return s&&o.addEventListener("upgradeneeded",u=>{s(Fr(o.result),u.oldVersion,u.newVersion,Fr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const vk=["get","getKey","getAll","getAllKeys","count"],_k=["put","add","delete","clear"],fm=new Map;function $p(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(fm.get(e))return fm.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=_k.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||vk.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return s&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return fm.set(e,i),i}yk(n=>({...n,get:(e,t,s)=>$p(e,t)||n.get(e,t,s),has:(e,t)=>!!$p(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(kk(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function kk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Wm="@firebase/app",zp="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr=new ob("@firebase/app"),Ek="@firebase/app-compat",Ak="@firebase/analytics-compat",wk="@firebase/analytics",Vk="@firebase/app-check-compat",Ck="@firebase/app-check",Ik="@firebase/auth",Sk="@firebase/auth-compat",Tk="@firebase/database",Pk="@firebase/data-connect",Lk="@firebase/database-compat",jk="@firebase/functions",Rk="@firebase/functions-compat",Bk="@firebase/installations",Uk="@firebase/installations-compat",Hk="@firebase/messaging",Mk="@firebase/messaging-compat",Fk="@firebase/performance",Ok="@firebase/performance-compat",qk="@firebase/remote-config",$k="@firebase/remote-config-compat",zk="@firebase/storage",Wk="@firebase/storage-compat",Kk="@firebase/firestore",Gk="@firebase/ai",Qk="@firebase/firestore-compat",Yk="firebase",Xk="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="[DEFAULT]",Jk={[Wm]:"fire-core",[Ek]:"fire-core-compat",[wk]:"fire-analytics",[Ak]:"fire-analytics-compat",[Ck]:"fire-app-check",[Vk]:"fire-app-check-compat",[Ik]:"fire-auth",[Sk]:"fire-auth-compat",[Tk]:"fire-rtdb",[Pk]:"fire-data-connect",[Lk]:"fire-rtdb-compat",[jk]:"fire-fn",[Rk]:"fire-fn-compat",[Bk]:"fire-iid",[Uk]:"fire-iid-compat",[Hk]:"fire-fcm",[Mk]:"fire-fcm-compat",[Fk]:"fire-perf",[Ok]:"fire-perf-compat",[qk]:"fire-rc",[$k]:"fire-rc-compat",[zk]:"fire-gcs",[Wk]:"fire-gcs-compat",[Kk]:"fire-fst",[Qk]:"fire-fst-compat",[Gk]:"fire-vertex","fire-js":"fire-js",[Yk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc=new Map,Zk=new Map,Gm=new Map;function Wp(n,e){try{n.container.addComponent(e)}catch(t){dr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function tl(n){const e=n.name;if(Gm.has(e))return dr.debug(`There were multiple attempts to register component ${e}.`),!1;Gm.set(e,n);for(const t of Oc.values())Wp(t,n);for(const t of Zk.values())Wp(t,n);return!0}function cb(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ub(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Or=new ib("app","Firebase",eE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Or.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=Xk;function db(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Km,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Or.create("bad-app-name",{appName:String(r)});if(t||(t=Xy()),!t)throw Or.create("no-options");const i=Oc.get(r);if(i){if(Fc(t,i.options)&&Fc(s,i.config))return i;throw Or.create("duplicate-app",{appName:r})}const o=new ak(r);for(const u of Gm.values())o.addComponent(u);const l=new tE(t,s,o);return Oc.set(r,l),l}function fb(n=Km){const e=Oc.get(n);if(!e&&n===Km&&Xy())return db();if(!e)throw Or.create("no-app",{appName:n});return e}function qr(n,e,t){let s=Jk[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),dr.warn(o.join(" "));return}tl(new Lo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nE="firebase-heartbeat-database",sE=1,nl="firebase-heartbeat-store";let pm=null;function pb(){return pm||(pm=xk(nE,sE,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(nl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Or.create("idb-open",{originalErrorMessage:n.message})})),pm}async function rE(n){try{const t=(await pb()).transaction(nl),s=await t.objectStore(nl).get(hb(n));return await t.done,s}catch(e){if(e instanceof qi)dr.warn(e.message);else{const t=Or.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});dr.warn(t.message)}}}async function Kp(n,e){try{const s=(await pb()).transaction(nl,"readwrite");await s.objectStore(nl).put(e,hb(n)),await s.done}catch(t){if(t instanceof qi)dr.warn(t.message);else{const s=Or.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});dr.warn(s.message)}}}function hb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=1024,oE=30;class aE{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new cE(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Gp();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>oE){const o=uE(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){dr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Gp(),{heartbeatsToSend:s,unsentEntries:r}=lE(this._heartbeatsCache.heartbeats),i=Hc(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return dr.warn(t),""}}}function Gp(){return new Date().toISOString().substring(0,10)}function lE(n,e=iE){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Qp(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Qp(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class cE{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rb()?ek().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await rE(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Kp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Kp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Qp(n){return Hc(JSON.stringify({version:2,heartbeats:n})).length}function uE(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(n){tl(new Lo("platform-logger",e=>new Dk(e),"PRIVATE")),tl(new Lo("heartbeat",e=>new aE(e),"PRIVATE")),qr(Wm,zp,n),qr(Wm,zp,"esm2020"),qr("fire-js","")}mE("");var dE="firebase",fE="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qr(dE,fE,"app");var Yp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $r,gb;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,N){function V(){}V.prototype=N.prototype,A.F=N.prototype,A.prototype=new V,A.prototype.constructor=A,A.D=function(j,T,S){for(var k=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)k[Ee-2]=arguments[Ee];return N.prototype[T].apply(j,k)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(A,N,V){V||(V=0);const j=Array(16);if(typeof N=="string")for(var T=0;T<16;++T)j[T]=N.charCodeAt(V++)|N.charCodeAt(V++)<<8|N.charCodeAt(V++)<<16|N.charCodeAt(V++)<<24;else for(T=0;T<16;++T)j[T]=N[V++]|N[V++]<<8|N[V++]<<16|N[V++]<<24;N=A.g[0],V=A.g[1],T=A.g[2];let S=A.g[3],k;k=N+(S^V&(T^S))+j[0]+3614090360&4294967295,N=V+(k<<7&4294967295|k>>>25),k=S+(T^N&(V^T))+j[1]+3905402710&4294967295,S=N+(k<<12&4294967295|k>>>20),k=T+(V^S&(N^V))+j[2]+606105819&4294967295,T=S+(k<<17&4294967295|k>>>15),k=V+(N^T&(S^N))+j[3]+3250441966&4294967295,V=T+(k<<22&4294967295|k>>>10),k=N+(S^V&(T^S))+j[4]+4118548399&4294967295,N=V+(k<<7&4294967295|k>>>25),k=S+(T^N&(V^T))+j[5]+1200080426&4294967295,S=N+(k<<12&4294967295|k>>>20),k=T+(V^S&(N^V))+j[6]+2821735955&4294967295,T=S+(k<<17&4294967295|k>>>15),k=V+(N^T&(S^N))+j[7]+4249261313&4294967295,V=T+(k<<22&4294967295|k>>>10),k=N+(S^V&(T^S))+j[8]+1770035416&4294967295,N=V+(k<<7&4294967295|k>>>25),k=S+(T^N&(V^T))+j[9]+2336552879&4294967295,S=N+(k<<12&4294967295|k>>>20),k=T+(V^S&(N^V))+j[10]+4294925233&4294967295,T=S+(k<<17&4294967295|k>>>15),k=V+(N^T&(S^N))+j[11]+2304563134&4294967295,V=T+(k<<22&4294967295|k>>>10),k=N+(S^V&(T^S))+j[12]+1804603682&4294967295,N=V+(k<<7&4294967295|k>>>25),k=S+(T^N&(V^T))+j[13]+4254626195&4294967295,S=N+(k<<12&4294967295|k>>>20),k=T+(V^S&(N^V))+j[14]+2792965006&4294967295,T=S+(k<<17&4294967295|k>>>15),k=V+(N^T&(S^N))+j[15]+1236535329&4294967295,V=T+(k<<22&4294967295|k>>>10),k=N+(T^S&(V^T))+j[1]+4129170786&4294967295,N=V+(k<<5&4294967295|k>>>27),k=S+(V^T&(N^V))+j[6]+3225465664&4294967295,S=N+(k<<9&4294967295|k>>>23),k=T+(N^V&(S^N))+j[11]+643717713&4294967295,T=S+(k<<14&4294967295|k>>>18),k=V+(S^N&(T^S))+j[0]+3921069994&4294967295,V=T+(k<<20&4294967295|k>>>12),k=N+(T^S&(V^T))+j[5]+3593408605&4294967295,N=V+(k<<5&4294967295|k>>>27),k=S+(V^T&(N^V))+j[10]+38016083&4294967295,S=N+(k<<9&4294967295|k>>>23),k=T+(N^V&(S^N))+j[15]+3634488961&4294967295,T=S+(k<<14&4294967295|k>>>18),k=V+(S^N&(T^S))+j[4]+3889429448&4294967295,V=T+(k<<20&4294967295|k>>>12),k=N+(T^S&(V^T))+j[9]+568446438&4294967295,N=V+(k<<5&4294967295|k>>>27),k=S+(V^T&(N^V))+j[14]+3275163606&4294967295,S=N+(k<<9&4294967295|k>>>23),k=T+(N^V&(S^N))+j[3]+4107603335&4294967295,T=S+(k<<14&4294967295|k>>>18),k=V+(S^N&(T^S))+j[8]+1163531501&4294967295,V=T+(k<<20&4294967295|k>>>12),k=N+(T^S&(V^T))+j[13]+2850285829&4294967295,N=V+(k<<5&4294967295|k>>>27),k=S+(V^T&(N^V))+j[2]+4243563512&4294967295,S=N+(k<<9&4294967295|k>>>23),k=T+(N^V&(S^N))+j[7]+1735328473&4294967295,T=S+(k<<14&4294967295|k>>>18),k=V+(S^N&(T^S))+j[12]+2368359562&4294967295,V=T+(k<<20&4294967295|k>>>12),k=N+(V^T^S)+j[5]+4294588738&4294967295,N=V+(k<<4&4294967295|k>>>28),k=S+(N^V^T)+j[8]+2272392833&4294967295,S=N+(k<<11&4294967295|k>>>21),k=T+(S^N^V)+j[11]+1839030562&4294967295,T=S+(k<<16&4294967295|k>>>16),k=V+(T^S^N)+j[14]+4259657740&4294967295,V=T+(k<<23&4294967295|k>>>9),k=N+(V^T^S)+j[1]+2763975236&4294967295,N=V+(k<<4&4294967295|k>>>28),k=S+(N^V^T)+j[4]+1272893353&4294967295,S=N+(k<<11&4294967295|k>>>21),k=T+(S^N^V)+j[7]+4139469664&4294967295,T=S+(k<<16&4294967295|k>>>16),k=V+(T^S^N)+j[10]+3200236656&4294967295,V=T+(k<<23&4294967295|k>>>9),k=N+(V^T^S)+j[13]+681279174&4294967295,N=V+(k<<4&4294967295|k>>>28),k=S+(N^V^T)+j[0]+3936430074&4294967295,S=N+(k<<11&4294967295|k>>>21),k=T+(S^N^V)+j[3]+3572445317&4294967295,T=S+(k<<16&4294967295|k>>>16),k=V+(T^S^N)+j[6]+76029189&4294967295,V=T+(k<<23&4294967295|k>>>9),k=N+(V^T^S)+j[9]+3654602809&4294967295,N=V+(k<<4&4294967295|k>>>28),k=S+(N^V^T)+j[12]+3873151461&4294967295,S=N+(k<<11&4294967295|k>>>21),k=T+(S^N^V)+j[15]+530742520&4294967295,T=S+(k<<16&4294967295|k>>>16),k=V+(T^S^N)+j[2]+3299628645&4294967295,V=T+(k<<23&4294967295|k>>>9),k=N+(T^(V|~S))+j[0]+4096336452&4294967295,N=V+(k<<6&4294967295|k>>>26),k=S+(V^(N|~T))+j[7]+1126891415&4294967295,S=N+(k<<10&4294967295|k>>>22),k=T+(N^(S|~V))+j[14]+2878612391&4294967295,T=S+(k<<15&4294967295|k>>>17),k=V+(S^(T|~N))+j[5]+4237533241&4294967295,V=T+(k<<21&4294967295|k>>>11),k=N+(T^(V|~S))+j[12]+1700485571&4294967295,N=V+(k<<6&4294967295|k>>>26),k=S+(V^(N|~T))+j[3]+2399980690&4294967295,S=N+(k<<10&4294967295|k>>>22),k=T+(N^(S|~V))+j[10]+4293915773&4294967295,T=S+(k<<15&4294967295|k>>>17),k=V+(S^(T|~N))+j[1]+2240044497&4294967295,V=T+(k<<21&4294967295|k>>>11),k=N+(T^(V|~S))+j[8]+1873313359&4294967295,N=V+(k<<6&4294967295|k>>>26),k=S+(V^(N|~T))+j[15]+4264355552&4294967295,S=N+(k<<10&4294967295|k>>>22),k=T+(N^(S|~V))+j[6]+2734768916&4294967295,T=S+(k<<15&4294967295|k>>>17),k=V+(S^(T|~N))+j[13]+1309151649&4294967295,V=T+(k<<21&4294967295|k>>>11),k=N+(T^(V|~S))+j[4]+4149444226&4294967295,N=V+(k<<6&4294967295|k>>>26),k=S+(V^(N|~T))+j[11]+3174756917&4294967295,S=N+(k<<10&4294967295|k>>>22),k=T+(N^(S|~V))+j[2]+718787259&4294967295,T=S+(k<<15&4294967295|k>>>17),k=V+(S^(T|~N))+j[9]+3951481745&4294967295,A.g[0]=A.g[0]+N&4294967295,A.g[1]=A.g[1]+(T+(k<<21&4294967295|k>>>11))&4294967295,A.g[2]=A.g[2]+T&4294967295,A.g[3]=A.g[3]+S&4294967295}s.prototype.v=function(A,N){N===void 0&&(N=A.length);const V=N-this.blockSize,j=this.C;let T=this.h,S=0;for(;S<N;){if(T==0)for(;S<=V;)r(this,A,S),S+=this.blockSize;if(typeof A=="string"){for(;S<N;)if(j[T++]=A.charCodeAt(S++),T==this.blockSize){r(this,j),T=0;break}}else for(;S<N;)if(j[T++]=A[S++],T==this.blockSize){r(this,j),T=0;break}}this.h=T,this.o+=N},s.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var N=1;N<A.length-8;++N)A[N]=0;N=this.o*8;for(var V=A.length-8;V<A.length;++V)A[V]=N&255,N/=256;for(this.v(A),A=Array(16),N=0,V=0;V<4;++V)for(let j=0;j<32;j+=8)A[N++]=this.g[V]>>>j&255;return A};function i(A,N){var V=l;return Object.prototype.hasOwnProperty.call(V,A)?V[A]:V[A]=N(A)}function o(A,N){this.h=N;const V=[];let j=!0;for(let T=A.length-1;T>=0;T--){const S=A[T]|0;j&&S==N||(V[T]=S,j=!1)}this.g=V}var l={};function u(A){return-128<=A&&A<128?i(A,function(N){return new o([N|0],N<0?-1:0)}):new o([A|0],A<0?-1:0)}function m(A){if(isNaN(A)||!isFinite(A))return f;if(A<0)return w(m(-A));const N=[];let V=1;for(let j=0;A>=V;j++)N[j]=A/V|0,V*=4294967296;return new o(N,0)}function d(A,N){if(A.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(A.charAt(0)=="-")return w(d(A.substring(1),N));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const V=m(Math.pow(N,8));let j=f;for(let S=0;S<A.length;S+=8){var T=Math.min(8,A.length-S);const k=parseInt(A.substring(S,S+T),N);T<8?(T=m(Math.pow(N,T)),j=j.j(T).add(m(k))):(j=j.j(V),j=j.add(m(k)))}return j}var f=u(0),p=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();let A=0,N=1;for(let V=0;V<this.g.length;V++){const j=this.i(V);A+=(j>=0?j:4294967296+j)*N,N*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(C(this))return"0";if(v(this))return"-"+w(this).toString(A);const N=m(Math.pow(A,6));var V=this;let j="";for(;;){const T=re(V,N).g;V=R(V,T.j(N));let S=((V.g.length>0?V.g[0]:V.h)>>>0).toString(A);if(V=T,C(V))return S+j;for(;S.length<6;)S="0"+S;j=S+j}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function C(A){if(A.h!=0)return!1;for(let N=0;N<A.g.length;N++)if(A.g[N]!=0)return!1;return!0}function v(A){return A.h==-1}n.l=function(A){return A=R(this,A),v(A)?-1:C(A)?0:1};function w(A){const N=A.g.length,V=[];for(let j=0;j<N;j++)V[j]=~A.g[j];return new o(V,~A.h).add(p)}n.abs=function(){return v(this)?w(this):this},n.add=function(A){const N=Math.max(this.g.length,A.g.length),V=[];let j=0;for(let T=0;T<=N;T++){let S=j+(this.i(T)&65535)+(A.i(T)&65535),k=(S>>>16)+(this.i(T)>>>16)+(A.i(T)>>>16);j=k>>>16,S&=65535,k&=65535,V[T]=k<<16|S}return new o(V,V[V.length-1]&-2147483648?-1:0)};function R(A,N){return A.add(w(N))}n.j=function(A){if(C(this)||C(A))return f;if(v(this))return v(A)?w(this).j(w(A)):w(w(this).j(A));if(v(A))return w(this.j(w(A)));if(this.l(y)<0&&A.l(y)<0)return m(this.m()*A.m());const N=this.g.length+A.g.length,V=[];for(var j=0;j<2*N;j++)V[j]=0;for(j=0;j<this.g.length;j++)for(let T=0;T<A.g.length;T++){const S=this.i(j)>>>16,k=this.i(j)&65535,Ee=A.i(T)>>>16,qe=A.i(T)&65535;V[2*j+2*T]+=k*qe,I(V,2*j+2*T),V[2*j+2*T+1]+=S*qe,I(V,2*j+2*T+1),V[2*j+2*T+1]+=k*Ee,I(V,2*j+2*T+1),V[2*j+2*T+2]+=S*Ee,I(V,2*j+2*T+2)}for(A=0;A<N;A++)V[A]=V[2*A+1]<<16|V[2*A];for(A=N;A<2*N;A++)V[A]=0;return new o(V,0)};function I(A,N){for(;(A[N]&65535)!=A[N];)A[N+1]+=A[N]>>>16,A[N]&=65535,N++}function F(A,N){this.g=A,this.h=N}function re(A,N){if(C(N))throw Error("division by zero");if(C(A))return new F(f,f);if(v(A))return N=re(w(A),N),new F(w(N.g),w(N.h));if(v(N))return N=re(A,w(N)),new F(w(N.g),N.h);if(A.g.length>30){if(v(A)||v(N))throw Error("slowDivide_ only works with positive integers.");for(var V=p,j=N;j.l(A)<=0;)V=ee(V),j=ee(j);var T=M(V,1),S=M(j,1);for(j=M(j,2),V=M(V,2);!C(j);){var k=S.add(j);k.l(A)<=0&&(T=T.add(V),S=k),j=M(j,1),V=M(V,1)}return N=R(A,T.j(N)),new F(T,N)}for(T=f;A.l(N)>=0;){for(V=Math.max(1,Math.floor(A.m()/N.m())),j=Math.ceil(Math.log(V)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),S=m(V),k=S.j(N);v(k)||k.l(A)>0;)V-=j,S=m(V),k=S.j(N);C(S)&&(S=p),T=T.add(S),A=R(A,k)}return new F(T,A)}n.B=function(A){return re(this,A).h},n.and=function(A){const N=Math.max(this.g.length,A.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)&A.i(j);return new o(V,this.h&A.h)},n.or=function(A){const N=Math.max(this.g.length,A.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)|A.i(j);return new o(V,this.h|A.h)},n.xor=function(A){const N=Math.max(this.g.length,A.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)^A.i(j);return new o(V,this.h^A.h)};function ee(A){const N=A.g.length+1,V=[];for(let j=0;j<N;j++)V[j]=A.i(j)<<1|A.i(j-1)>>>31;return new o(V,A.h)}function M(A,N){const V=N>>5;N%=32;const j=A.g.length-V,T=[];for(let S=0;S<j;S++)T[S]=N>0?A.i(S+V)>>>N|A.i(S+V+1)<<32-N:A.i(S+V);return new o(T,A.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,gb=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,$r=o}).apply(typeof Yp<"u"?Yp:typeof self<"u"?self:typeof window<"u"?window:{});var Gl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yb,La,bb,vc,Qm,Nb,xb,vb;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gl=="object"&&Gl];for(var h=0;h<c.length;++h){var g=c[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=t(this);function r(c,h){if(h)e:{var g=s;c=c.split(".");for(var _=0;_<c.length-1;_++){var z=c[_];if(!(z in g))break e;g=g[z]}c=c[c.length-1],_=g[c],h=h(_),h!=_&&h!=null&&e(g,c,{configurable:!0,writable:!0,value:h})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(h){var g=[],_;for(_ in h)Object.prototype.hasOwnProperty.call(h,_)&&g.push([_,h[_]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var h=typeof c;return h=="object"&&c!=null||h=="function"}function u(c,h,g){return c.call.apply(c.bind,arguments)}function m(c,h,g){return m=u,m.apply(null,arguments)}function d(c,h){var g=Array.prototype.slice.call(arguments,1);return function(){var _=g.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function f(c,h){function g(){}g.prototype=h.prototype,c.Z=h.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(_,z,J){for(var De=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)De[pt-2]=arguments[pt];return h.prototype[z].apply(_,De)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const h=c.length;if(h>0){const g=Array(h);for(let _=0;_<h;_++)g[_]=c[_];return g}return[]}function C(c,h){for(let _=1;_<arguments.length;_++){const z=arguments[_];var g=typeof z;if(g=g!="object"?g:z?Array.isArray(z)?"array":g:"null",g=="array"||g=="object"&&typeof z.length=="number"){g=c.length||0;const J=z.length||0;c.length=g+J;for(let De=0;De<J;De++)c[g+De]=z[De]}else c.push(z)}}class v{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function w(c){o.setTimeout(()=>{throw c},0)}function R(){var c=A;let h=null;return c.g&&(h=c.g,c.g=c.g.next,c.g||(c.h=null),h.next=null),h}class I{constructor(){this.h=this.g=null}add(h,g){const _=F.get();_.set(h,g),this.h?this.h.next=_:this.g=_,this.h=_}}var F=new v(()=>new re,c=>c.reset());class re{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,M=!1,A=new I,N=()=>{const c=Promise.resolve(void 0);ee=()=>{c.then(V)}};function V(){for(var c;c=R();){try{c.h.call(c.g)}catch(g){w(g)}var h=F;h.j(c),h.h<100&&(h.h++,c.next=h.g,h.g=c)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(c,h){this.type=c,this.g=this.target=h,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,h=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,h),o.removeEventListener("test",g,h)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function Ee(c,h){T.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,h)}f(Ee,T),Ee.prototype.init=function(c,h){const g=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=h,h=c.relatedTarget,h||(g=="mouseover"?h=c.fromElement:g=="mouseout"&&(h=c.toElement)),this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Ee.Z.h.call(this)},Ee.prototype.h=function(){Ee.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var qe="closure_listenable_"+(Math.random()*1e6|0),ge=0;function Ue(c,h,g,_,z){this.listener=c,this.proxy=null,this.src=h,this.type=g,this.capture=!!_,this.ha=z,this.key=++ge,this.da=this.fa=!1}function ht(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Kt(c,h,g){for(const _ in c)h.call(g,c[_],_,c)}function Ot(c,h){for(const g in c)h.call(void 0,c[g],g,c)}function le(c){const h={};for(const g in c)h[g]=c[g];return h}const $e="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(c,h){let g,_;for(let z=1;z<arguments.length;z++){_=arguments[z];for(g in _)c[g]=_[g];for(let J=0;J<$e.length;J++)g=$e[J],Object.prototype.hasOwnProperty.call(_,g)&&(c[g]=_[g])}}function Re(c){this.src=c,this.g={},this.h=0}Re.prototype.add=function(c,h,g,_,z){const J=c.toString();c=this.g[J],c||(c=this.g[J]=[],this.h++);const De=vt(c,h,_,z);return De>-1?(h=c[De],g||(h.fa=!1)):(h=new Ue(h,this.src,J,!!_,z),h.fa=g,c.push(h)),h};function Ye(c,h){const g=h.type;if(g in c.g){var _=c.g[g],z=Array.prototype.indexOf.call(_,h,void 0),J;(J=z>=0)&&Array.prototype.splice.call(_,z,1),J&&(ht(h),c.g[g].length==0&&(delete c.g[g],c.h--))}}function vt(c,h,g,_){for(let z=0;z<c.length;++z){const J=c[z];if(!J.da&&J.listener==h&&J.capture==!!g&&J.ha==_)return z}return-1}var lt="closure_lm_"+(Math.random()*1e6|0),It={};function at(c,h,g,_,z){if(Array.isArray(h)){for(let J=0;J<h.length;J++)at(c,h[J],g,_,z);return null}return g=Gt(g),c&&c[qe]?c.J(h,g,l(_)?!!_.capture:!1,z):ft(c,h,g,!1,_,z)}function ft(c,h,g,_,z,J){if(!h)throw Error("Invalid event type");const De=l(z)?!!z.capture:!!z;let pt=Xe(c);if(pt||(c[lt]=pt=new Re(c)),g=pt.add(h,g,_,De,J),g.proxy)return g;if(_=bn(),g.proxy=_,_.src=c,_.listener=g,c.addEventListener)S||(z=De),z===void 0&&(z=!1),c.addEventListener(h.toString(),_,z);else if(c.attachEvent)c.attachEvent(He(h.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return g}function bn(){function c(g){return h.call(c.src,c.listener,g)}const h=Se;return c}function K(c,h,g,_,z){if(Array.isArray(h))for(var J=0;J<h.length;J++)K(c,h[J],g,_,z);else _=l(_)?!!_.capture:!!_,g=Gt(g),c&&c[qe]?(c=c.i,J=String(h).toString(),J in c.g&&(h=c.g[J],g=vt(h,g,_,z),g>-1&&(ht(h[g]),Array.prototype.splice.call(h,g,1),h.length==0&&(delete c.g[J],c.h--)))):c&&(c=Xe(c))&&(h=c.g[h.toString()],c=-1,h&&(c=vt(h,g,_,z)),(g=c>-1?h[c]:null)&&Le(g))}function Le(c){if(typeof c!="number"&&c&&!c.da){var h=c.src;if(h&&h[qe])Ye(h.i,c);else{var g=c.type,_=c.proxy;h.removeEventListener?h.removeEventListener(g,_,c.capture):h.detachEvent?h.detachEvent(He(g),_):h.addListener&&h.removeListener&&h.removeListener(_),(g=Xe(h))?(Ye(g,c),g.h==0&&(g.src=null,h[lt]=null)):ht(c)}}}function He(c){return c in It?It[c]:It[c]="on"+c}function Se(c,h){if(c.da)c=!0;else{h=new Ee(h,this);const g=c.listener,_=c.ha||c.src;c.fa&&Le(c),c=g.call(_,h)}return c}function Xe(c){return c=c[lt],c instanceof Re?c:null}var St="__closure_events_fn_"+(Math.random()*1e9>>>0);function Gt(c){return typeof c=="function"?c:(c[St]||(c[St]=function(h){return c.handleEvent(h)}),c[St])}function dt(){j.call(this),this.i=new Re(this),this.M=this,this.G=null}f(dt,j),dt.prototype[qe]=!0,dt.prototype.removeEventListener=function(c,h,g,_){K(this,c,h,g,_)};function P(c,h){var g,_=c.G;if(_)for(g=[];_;_=_.G)g.push(_);if(c=c.M,_=h.type||h,typeof h=="string")h=new T(h,c);else if(h instanceof T)h.target=h.target||c;else{var z=h;h=new T(_,c),de(h,z)}z=!0;let J,De;if(g)for(De=g.length-1;De>=0;De--)J=h.g=g[De],z=q(J,_,!0,h)&&z;if(J=h.g=c,z=q(J,_,!0,h)&&z,z=q(J,_,!1,h)&&z,g)for(De=0;De<g.length;De++)J=h.g=g[De],z=q(J,_,!1,h)&&z}dt.prototype.N=function(){if(dt.Z.N.call(this),this.i){var c=this.i;for(const h in c.g){const g=c.g[h];for(let _=0;_<g.length;_++)ht(g[_]);delete c.g[h],c.h--}}this.G=null},dt.prototype.J=function(c,h,g,_){return this.i.add(String(c),h,!1,g,_)},dt.prototype.K=function(c,h,g,_){return this.i.add(String(c),h,!0,g,_)};function q(c,h,g,_){if(h=c.i.g[String(h)],!h)return!0;h=h.concat();let z=!0;for(let J=0;J<h.length;++J){const De=h[J];if(De&&!De.da&&De.capture==g){const pt=De.listener,Pn=De.ha||De.src;De.fa&&Ye(c.i,De),z=pt.call(Pn,_)!==!1&&z}}return z&&!_.defaultPrevented}function te(c,h){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(c,h||0)}function xe(c){c.g=te(()=>{c.g=null,c.i&&(c.i=!1,xe(c))},c.l);const h=c.h;c.h=null,c.m.apply(null,h)}class ue extends j{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:xe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fe(c){j.call(this),this.h=c,this.g={}}f(fe,j);var Ie=[];function ze(c){Kt(c.g,function(h,g){this.g.hasOwnProperty(g)&&Le(h)},c),c.g={}}fe.prototype.N=function(){fe.Z.N.call(this),ze(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var tt=o.JSON.stringify,Ae=o.JSON.parse,On=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Ht(){}function ne(){}var Je={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function O(){T.call(this,"d")}f(O,T);function ve(){T.call(this,"c")}f(ve,T);var ke={},je=null;function me(){return je=je||new dt}ke.Ia="serverreachability";function kt(c){T.call(this,ke.Ia,c)}f(kt,T);function xt(c){const h=me();P(h,new kt(h))}ke.STAT_EVENT="statevent";function tn(c,h){T.call(this,ke.STAT_EVENT,c),this.stat=h}f(tn,T);function At(c){const h=me();P(h,new tn(h,c))}ke.Ja="timingevent";function Nn(c,h){T.call(this,ke.Ja,c),this.size=h}f(Nn,T);function cn(c,h){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},h)}function Un(){this.g=!0}Un.prototype.ua=function(){this.g=!1};function xs(c,h,g,_,z,J){c.info(function(){if(c.g)if(J){var De="",pt=J.split("&");for(let en=0;en<pt.length;en++){var Pn=pt[en].split("=");if(Pn.length>1){const Hn=Pn[0];Pn=Pn[1];const $s=Hn.split("_");De=$s.length>=2&&$s[1]=="type"?De+(Hn+"="+Pn+"&"):De+(Hn+"=redacted&")}}}else De=null;else De=J;return"XMLHTTP REQ ("+_+") [attempt "+z+"]: "+h+`
`+g+`
`+De})}function ss(c,h,g,_,z,J,De){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+z+"]: "+h+`
`+g+`
`+J+" "+De})}function vs(c,h,g,_){c.info(function(){return"XMLHTTP TEXT ("+h+"): "+Os(c,g)+(_?" "+_:"")})}function ui(c,h){c.info(function(){return"TIMEOUT: "+h})}Un.prototype.info=function(){};function Os(c,h){if(!c.g)return h;if(!h)return null;try{const J=JSON.parse(h);if(J){for(c=0;c<J.length;c++)if(Array.isArray(J[c])){var g=J[c];if(!(g.length<2)){var _=g[1];if(Array.isArray(_)&&!(_.length<1)){var z=_[0];if(z!="noop"&&z!="stop"&&z!="close")for(let De=1;De<_.length;De++)_[De]=""}}}}return tt(J)}catch{return h}}var ls={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},D={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Q;function B(){}f(B,Ht),B.prototype.g=function(){return new XMLHttpRequest},Q=new B;function x(c){return encodeURIComponent(String(c))}function L(c){var h=1;c=c.split(":");const g=[];for(;h>0&&c.length;)g.push(c.shift()),h--;return c.length&&g.push(c.join(":")),g}function U(c,h,g,_){this.j=c,this.i=h,this.l=g,this.S=_||1,this.V=new fe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var G={},Z={};function ie(c,h,g){c.M=1,c.A=Yi(nn(h)),c.u=g,c.R=!0,Ce(c,null)}function Ce(c,h){c.F=Date.now(),We(c),c.B=nn(c.A);var g=c.B,_=c.S;Array.isArray(_)||(_=[String(_)]),ce(g.i,"t",_),c.C=0,g=c.j.L,c.h=new X,c.g=vp(c.j,g?h:null,!c.u),c.P>0&&(c.O=new ue(m(c.Y,c,c.g),c.P)),h=c.V,g=c.g,_=c.ba;var z="readystatechange";Array.isArray(z)||(z&&(Ie[0]=z.toString()),z=Ie);for(let J=0;J<z.length;J++){const De=at(g,z[J],_||h.handleEvent,!1,h.h||h);if(!De)break;h.g[De.key]=De}h=c.J?le(c.J):{},c.u?(c.v||(c.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,h)):(c.v="GET",c.g.ea(c.B,c.v,null,h)),xt(),xs(c.i,c.v,c.B,c.l,c.S,c.u)}U.prototype.ba=function(c){c=c.target;const h=this.O;h&&Is(c)==3?h.j():this.Y(c)},U.prototype.Y=function(c){try{if(c==this.g)e:{const pt=Is(this.g),Pn=this.g.ya(),en=this.g.ca();if(!(pt<3)&&(pt!=3||this.g&&(this.h.h||this.g.la()||up(this.g)))){this.K||pt!=4||Pn==7||(Pn==8||en<=0?xt(3):xt(2)),Qt(this);var h=this.g.ca();this.X=h;var g=Ze(this);if(this.o=h==200,ss(this.i,this.v,this.B,this.l,this.S,pt,h),this.o){if(this.U&&!this.L){t:{if(this.g){var _,z=this.g;if((_=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_)){var J=_;break t}}J=null}if(c=J)vs(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qn(this,c);else{this.o=!1,this.m=3,At(12),Bt(this),Mt(this);break e}}if(this.R){c=!0;let Hn;for(;!this.K&&this.C<g.length;)if(Hn=pe(this,g),Hn==Z){pt==4&&(this.m=4,At(14),c=!1),vs(this.i,this.l,null,"[Incomplete Response]");break}else if(Hn==G){this.m=4,At(15),vs(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else vs(this.i,this.l,Hn,null),qn(this,Hn);if(Fe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||g.length!=0||this.h.h||(this.m=1,At(16),c=!1),this.o=this.o&&c,!c)vs(this.i,this.l,g,"[Invalid Chunked Response]"),Bt(this),Mt(this);else if(g.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),sm(De),De.P=!0,At(11))}}else vs(this.i,this.l,g,null),qn(this,g);pt==4&&Bt(this),this.o&&!this.K&&(pt==4?yp(this.j,this):(this.o=!1,We(this)))}else hv(this.g),h==400&&g.indexOf("Unknown SID")>0?(this.m=3,At(12)):(this.m=0,At(13)),Bt(this),Mt(this)}}}catch{}finally{}};function Ze(c){if(!Fe(c))return c.g.la();const h=up(c.g);if(h==="")return"";let g="";const _=h.length,z=Is(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Bt(c),Mt(c),"";c.h.i=new o.TextDecoder}for(let J=0;J<_;J++)c.h.h=!0,g+=c.h.i.decode(h[J],{stream:!(z&&J==_-1)});return h.length=0,c.h.g+=g,c.C=0,c.h.g}function Fe(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function pe(c,h){var g=c.C,_=h.indexOf(`
`,g);return _==-1?Z:(g=Number(h.substring(g,_)),isNaN(g)?G:(_+=1,_+g>h.length?Z:(h=h.slice(_,_+g),c.C=_+g,h)))}U.prototype.cancel=function(){this.K=!0,Bt(this)};function We(c){c.T=Date.now()+c.H,fn(c,c.H)}function fn(c,h){if(c.D!=null)throw Error("WatchDog timer not null");c.D=cn(m(c.aa,c),h)}function Qt(c){c.D&&(o.clearTimeout(c.D),c.D=null)}U.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(ui(this.i,this.B),this.M!=2&&(xt(),At(17)),Bt(this),this.m=2,Mt(this)):fn(this,this.T-c)};function Mt(c){c.j.I==0||c.K||yp(c.j,c)}function Bt(c){Qt(c);var h=c.O;h&&typeof h.dispose=="function"&&h.dispose(),c.O=null,ze(c.V),c.g&&(h=c.g,c.g=null,h.abort(),h.dispose())}function qn(c,h){try{var g=c.j;if(g.I!=0&&(g.g==c||et(g.h,c))){if(!c.L&&et(g.h,c)&&g.I==3){try{var _=g.Ba.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var z=_;if(z[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Ol(g),Ml(g);else break e;nm(g),At(18)}}else g.xa=z[1],0<g.xa-g.K&&z[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=cn(m(g.Va,g),6e3));Ve(g.h)<=1&&g.ta&&(g.ta=void 0)}else mi(g,11)}else if((c.L||g.g==c)&&Ol(g),!k(h))for(z=g.Ba.g.parse(h),h=0;h<z.length;h++){let en=z[h];const Hn=en[0];if(!(Hn<=g.K))if(g.K=Hn,en=en[1],g.I==2)if(en[0]=="c"){g.M=en[1],g.ba=en[2];const $s=en[3];$s!=null&&(g.ka=$s,g.j.info("VER="+g.ka));const di=en[4];di!=null&&(g.za=di,g.j.info("SVER="+g.za));const Dr=en[5];Dr!=null&&typeof Dr=="number"&&Dr>0&&(_=1.5*Dr,g.O=_,g.j.info("backChannelRequestTimeoutMs_="+_)),_=g;const kr=c.g;if(kr){const $l=kr.g?kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($l){var J=_.h;J.g||$l.indexOf("spdy")==-1&&$l.indexOf("quic")==-1&&$l.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(nt(J,J.h),J.h=null))}if(_.G){const rm=kr.g?kr.g.getResponseHeader("X-HTTP-Session-Id"):null;rm&&(_.wa=rm,Nt(_.J,_.G,rm))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),_=g;var De=c;if(_.na=xp(_,_.L?_.ba:null,_.W),De.L){st(_.h,De);var pt=De,Pn=_.O;Pn&&(pt.H=Pn),pt.D&&(Qt(pt),We(pt)),_.g=De}else hp(_);g.i.length>0&&Fl(g)}else en[0]!="stop"&&en[0]!="close"||mi(g,7);else g.I==3&&(en[0]=="stop"||en[0]=="close"?en[0]=="stop"?mi(g,7):tm(g):en[0]!="noop"&&g.l&&g.l.qa(en),g.A=0)}}xt(4)}catch{}}var Qn=class{constructor(c,h){this.g=c,this.map=h}};function Yt(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ke(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ve(c){return c.h?1:c.g?c.g.size:0}function et(c,h){return c.h?c.h==h:c.g?c.g.has(h):!1}function nt(c,h){c.g?c.g.add(h):c.h=h}function st(c,h){c.h&&c.h==h?c.h=null:c.g&&c.g.has(h)&&c.g.delete(h)}Yt.prototype.cancel=function(){if(this.i=Oe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Oe(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let h=c.i;for(const g of c.g.values())h=h.concat(g.G);return h}return y(c.i)}var rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Tt(c,h){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const _=c[g].indexOf("=");let z,J=null;_>=0?(z=c[g].substring(0,_),J=c[g].substring(_+1)):z=c[g],h(z,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function un(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;c instanceof un?(this.l=c.l,Vs(this,c.j),this.o=c.o,this.g=c.g,Nr(this,c.u),this.h=c.h,aa(this,Ne(c.i)),this.m=c.m):c&&(h=String(c).match(rt))?(this.l=!1,Vs(this,h[1]||"",!0),this.o=xr(h[2]||""),this.g=xr(h[3]||"",!0),Nr(this,h[4]),this.h=xr(h[5]||"",!0),aa(this,h[6]||"",!0),this.m=xr(h[7]||"")):(this.l=!1,this.i=new _r(null,this.l))}un.prototype.toString=function(){const c=[];var h=this.j;h&&c.push(vr(h,la,!0),":");var g=this.g;return(g||h=="file")&&(c.push("//"),(h=this.o)&&c.push(vr(h,la,!0),"@"),c.push(x(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(vr(g,g.charAt(0)=="/"?Xu:Hl,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",vr(g,Zu)),c.join("")},un.prototype.resolve=function(c){const h=nn(this);let g=!!c.j;g?Vs(h,c.j):g=!!c.o,g?h.o=c.o:g=!!c.g,g?h.g=c.g:g=c.u!=null;var _=c.h;if(g)Nr(h,c.u);else if(g=!!c.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var z=h.h.lastIndexOf("/");z!=-1&&(_=h.h.slice(0,z+1)+_)}if(z=_,z==".."||z==".")_="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){_=z.lastIndexOf("/",0)==0,z=z.split("/");const J=[];for(let De=0;De<z.length;){const pt=z[De++];pt=="."?_&&De==z.length&&J.push(""):pt==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),_&&De==z.length&&J.push("")):(J.push(pt),_=!0)}_=J.join("/")}else _=z}return g?h.h=_:g=c.i.toString()!=="",g?aa(h,Ne(c.i)):g=!!c.m,g&&(h.m=c.m),h};function nn(c){return new un(c)}function Vs(c,h,g){c.j=g?xr(h,!0):h,c.j&&(c.j=c.j.replace(/:$/,""))}function Nr(c,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);c.u=h}else c.u=null}function aa(c,h,g){h instanceof _r?(c.i=h,ut(c.i,c.l)):(g||(h=vr(h,Ju)),c.i=new _r(h,c.l))}function Nt(c,h,g){c.i.set(h,g)}function Yi(c){return Nt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function xr(c,h){return c?h?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function vr(c,h,g){return typeof c=="string"?(c=encodeURI(c).replace(h,Ul),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ul(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var la=/[#\/\?@]/g,Hl=/[#\?:]/g,Xu=/[#\?]/g,Ju=/[#\?@]/g,Zu=/#/g;function _r(c,h){this.h=this.g=null,this.i=c||null,this.j=!!h}function b(c){c.g||(c.g=new Map,c.h=0,c.i&&Tt(c.i,function(h,g){c.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}n=_r.prototype,n.add=function(c,h){b(this),this.i=null,c=ye(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(h),this.h+=1,this};function H(c,h){b(c),h=ye(c,h),c.g.has(h)&&(c.i=null,c.h-=c.g.get(h).length,c.g.delete(h))}function Y(c,h){return b(c),h=ye(c,h),c.g.has(h)}n.forEach=function(c,h){b(this),this.g.forEach(function(g,_){g.forEach(function(z){c.call(h,z,_,this)},this)},this)};function W(c,h){b(c);let g=[];if(typeof h=="string")Y(c,h)&&(g=g.concat(c.g.get(ye(c,h))));else for(c=Array.from(c.g.values()),h=0;h<c.length;h++)g=g.concat(c[h]);return g}n.set=function(c,h){return b(this),this.i=null,c=ye(this,c),Y(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[h]),this.h+=1,this},n.get=function(c,h){return c?(c=W(this,c),c.length>0?String(c[0]):h):h};function ce(c,h,g){H(c,h),g.length>0&&(c.i=null,c.g.set(ye(c,h),y(g)),c.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],h=Array.from(this.g.keys());for(let _=0;_<h.length;_++){var g=h[_];const z=x(g);g=W(this,g);for(let J=0;J<g.length;J++){let De=z;g[J]!==""&&(De+="="+x(g[J])),c.push(De)}}return this.i=c.join("&")};function Ne(c){const h=new _r;return h.i=c.i,c.g&&(h.g=new Map(c.g),h.h=c.h),h}function ye(c,h){return h=String(h),c.j&&(h=h.toLowerCase()),h}function ut(c,h){h&&!c.j&&(b(c),c.i=null,c.g.forEach(function(g,_){const z=_.toLowerCase();_!=z&&(H(this,_),ce(this,z,g))},c)),c.j=h}function gt(c,h){const g=new Un;if(o.Image){const _=new Image;_.onload=d(Pt,g,"TestLoadImage: loaded",!0,h,_),_.onerror=d(Pt,g,"TestLoadImage: error",!1,h,_),_.onabort=d(Pt,g,"TestLoadImage: abort",!1,h,_),_.ontimeout=d(Pt,g,"TestLoadImage: timeout",!1,h,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else h(!1)}function _n(c,h){const g=new Un,_=new AbortController,z=setTimeout(()=>{_.abort(),Pt(g,"TestPingServer: timeout",!1,h)},1e4);fetch(c,{signal:_.signal}).then(J=>{clearTimeout(z),J.ok?Pt(g,"TestPingServer: ok",!0,h):Pt(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(z),Pt(g,"TestPingServer: error",!1,h)})}function Pt(c,h,g,_,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),_(g)}catch{}}function Lt(){this.g=new On}function mn(c){this.i=c.Sb||null,this.h=c.ab||!1}f(mn,Ht),mn.prototype.g=function(){return new Tn(this.i,this.h)};function Tn(c,h){dt.call(this),this.H=c,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Tn,dt),n=Tn.prototype,n.open=function(c,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=h,this.readyState=1,xn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(h.body=c),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,rn(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,xn(this)),this.g&&(this.readyState=3,xn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wt(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function wt(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var h=c.value?c.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!c.done}))&&(this.response=this.responseText+=h)}c.done?rn(this):xn(this),this.readyState==3&&wt(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,rn(this))},n.Na=function(c){this.g&&(this.response=c,rn(this))},n.ga=function(){this.g&&rn(this)};function rn(c){c.readyState=4,c.l=null,c.j=null,c.B=null,xn(c)}n.setRequestHeader=function(c,h){this.A.append(c,h)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=h.next();return c.join(`\r
`)};function xn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Tn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Xt(c){let h="";return Kt(c,function(g,_){h+=_,h+=":",h+=g,h+=`\r
`}),h}function Zt(c,h,g){e:{for(_ in g){var _=!1;break e}_=!0}_||(g=Xt(g),typeof c=="string"?g!=null&&x(g):Nt(c,h,g))}function yt(c){dt.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(yt,dt);var sn=/^https?$/i,Cs=["POST","PUT"];n=yt.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,h,g,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);h=h?h.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Q.g(),this.g.onreadystatechange=p(m(this.Ca,this));try{this.B=!0,this.g.open(h,String(c),!0),this.B=!1}catch(J){qs(this,J);return}if(c=g||"",g=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var z in _)g.set(z,_[z]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const J of _.keys())g.set(J,_.get(J));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(g.keys()).find(J=>J.toLowerCase()=="content-type"),z=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Cs,h,void 0)>=0)||_||z||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,De]of g)this.g.setRequestHeader(J,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(J){qs(this,J)}};function qs(c,h){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=h,c.o=5,Xi(c),Ji(c)}function Xi(c){c.A||(c.A=!0,P(c,"complete"),P(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,P(this,"complete"),P(this,"abort"),Ji(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ji(this,!0)),yt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?em(this):this.Xa())},n.Xa=function(){em(this)};function em(c){if(c.h&&typeof i<"u"){if(c.v&&Is(c)==4)setTimeout(c.Ca.bind(c),0);else if(P(c,"readystatechange"),Is(c)==4){c.h=!1;try{const J=c.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var _;if(_=J===0){let De=String(c.D).match(rt)[1]||null;!De&&o.self&&o.self.location&&(De=o.self.location.protocol.slice(0,-1)),_=!sn.test(De?De.toLowerCase():"")}g=_}if(g)P(c,"complete"),P(c,"success");else{c.o=6;try{var z=Is(c)>2?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.ca()+"]",Xi(c)}}finally{Ji(c)}}}}function Ji(c,h){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,h||P(c,"ready");try{g.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Is(c){return c.g?c.g.readyState:0}n.ca=function(){try{return Is(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var h=this.g.responseText;return c&&h.indexOf(c)==0&&(h=h.substring(c.length)),Ae(h)}};function up(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function hv(c){const h={};c=(c.g&&Is(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(k(c[_]))continue;var g=L(c[_]);const z=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const J=h[z]||[];h[z]=J,J.push(g)}Ot(h,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ca(c,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||h}function mp(c){this.za=0,this.i=[],this.j=new Un,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ca("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ca("baseRetryDelayMs",5e3,c),this.Za=ca("retryDelaySeedMs",1e4,c),this.Ta=ca("forwardChannelMaxRetries",2,c),this.va=ca("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Yt(c&&c.concurrentRequestLimit),this.Ba=new Lt,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=mp.prototype,n.ka=8,n.I=1,n.connect=function(c,h,g,_){At(0),this.W=c,this.H=h||{},g&&_!==void 0&&(this.H.OSID=g,this.H.OAID=_),this.F=this.X,this.J=xp(this,null,this.W),Fl(this)};function tm(c){if(dp(c),c.I==3){var h=c.V++,g=nn(c.J);if(Nt(g,"SID",c.M),Nt(g,"RID",h),Nt(g,"TYPE","terminate"),ua(c,g),h=new U(c,c.j,h),h.M=2,h.A=Yi(nn(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=h.A,g=!0),g||(h.g=vp(h.j,null),h.g.ea(h.A)),h.F=Date.now(),We(h)}Np(c)}function Ml(c){c.g&&(sm(c),c.g.cancel(),c.g=null)}function dp(c){Ml(c),c.v&&(o.clearTimeout(c.v),c.v=null),Ol(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Fl(c){if(!Ke(c.h)&&!c.m){c.m=!0;var h=c.Ea;ee||N(),M||(ee(),M=!0),A.add(h,c),c.D=0}}function gv(c,h){return Ve(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=h.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=cn(m(c.Ea,c,h),bp(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const z=new U(this,this.j,c);let J=this.o;if(this.U&&(J?(J=le(J),de(J,this.U)):J=this.U),this.u!==null||this.R||(z.J=J,J=null),this.S)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var _=this.i[g];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,h>4096){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=pp(this,z,h),g=nn(this.J),Nt(g,"RID",c),Nt(g,"CVER",22),this.G&&Nt(g,"X-HTTP-Session-Id",this.G),ua(this,g),J&&(this.R?h="headers="+x(Xt(J))+"&"+h:this.u&&Zt(g,this.u,J)),nt(this.h,z),this.Ra&&Nt(g,"TYPE","init"),this.S?(Nt(g,"$req",h),Nt(g,"SID","null"),z.U=!0,ie(z,g,null)):ie(z,g,h),this.I=2}}else this.I==3&&(c?fp(this,c):this.i.length==0||Ke(this.h)||fp(this))};function fp(c,h){var g;h?g=h.l:g=c.V++;const _=nn(c.J);Nt(_,"SID",c.M),Nt(_,"RID",g),Nt(_,"AID",c.K),ua(c,_),c.u&&c.o&&Zt(_,c.u,c.o),g=new U(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),h&&(c.i=h.G.concat(c.i)),h=pp(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),nt(c.h,g),ie(g,_,h)}function ua(c,h){c.H&&Kt(c.H,function(g,_){Nt(h,_,g)}),c.l&&Kt({},function(g,_){Nt(h,_,g)})}function pp(c,h,g){g=Math.min(c.i.length,g);const _=c.l?m(c.l.Ka,c.l,c):null;e:{var z=c.i;let pt=-1;for(;;){const Pn=["count="+g];pt==-1?g>0?(pt=z[0].g,Pn.push("ofs="+pt)):pt=0:Pn.push("ofs="+pt);let en=!0;for(let Hn=0;Hn<g;Hn++){var J=z[Hn].g;const $s=z[Hn].map;if(J-=pt,J<0)pt=Math.max(0,z[Hn].g-100),en=!1;else try{J="req"+J+"_"||"";try{var De=$s instanceof Map?$s:Object.entries($s);for(const[di,Dr]of De){let kr=Dr;l(Dr)&&(kr=tt(Dr)),Pn.push(J+di+"="+encodeURIComponent(kr))}}catch(di){throw Pn.push(J+"type="+encodeURIComponent("_badmap")),di}}catch{_&&_($s)}}if(en){De=Pn.join("&");break e}}De=void 0}return c=c.i.splice(0,g),h.G=c,De}function hp(c){if(!c.g&&!c.v){c.Y=1;var h=c.Da;ee||N(),M||(ee(),M=!0),A.add(h,c),c.A=0}}function nm(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=cn(m(c.Da,c),bp(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,gp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=cn(m(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,At(10),Ml(this),gp(this))};function sm(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function gp(c){c.g=new U(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var h=nn(c.na);Nt(h,"RID","rpc"),Nt(h,"SID",c.M),Nt(h,"AID",c.K),Nt(h,"CI",c.F?"0":"1"),!c.F&&c.ia&&Nt(h,"TO",c.ia),Nt(h,"TYPE","xmlhttp"),ua(c,h),c.u&&c.o&&Zt(h,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Yi(nn(h)),g.u=null,g.R=!0,Ce(g,c)}n.Va=function(){this.C!=null&&(this.C=null,Ml(this),nm(this),At(19))};function Ol(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function yp(c,h){var g=null;if(c.g==h){Ol(c),sm(c),c.g=null;var _=2}else if(et(c.h,h))g=h.G,st(c.h,h),_=1;else return;if(c.I!=0){if(h.o)if(_==1){g=h.u?h.u.length:0,h=Date.now()-h.F;var z=c.D;_=me(),P(_,new Nn(_,g)),Fl(c)}else hp(c);else if(z=h.m,z==3||z==0&&h.X>0||!(_==1&&gv(c,h)||_==2&&nm(c)))switch(g&&g.length>0&&(h=c.h,h.i=h.i.concat(g)),z){case 1:mi(c,5);break;case 4:mi(c,10);break;case 3:mi(c,6);break;default:mi(c,2)}}}function bp(c,h){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*h}function mi(c,h){if(c.j.info("Error code "+h),h==2){var g=m(c.bb,c),_=c.Ua;const z=!_;_=new un(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Vs(_,"https"),Yi(_),z?gt(_.toString(),g):_n(_.toString(),g)}else At(2);c.I=0,c.l&&c.l.pa(h),Np(c),dp(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function Np(c){if(c.I=0,c.ja=[],c.l){const h=Oe(c.h);(h.length!=0||c.i.length!=0)&&(C(c.ja,h),C(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function xp(c,h,g){var _=g instanceof un?nn(g):new un(g);if(_.g!="")h&&(_.g=h+"."+_.g),Nr(_,_.u);else{var z=o.location;_=z.protocol,h=h?h+"."+z.hostname:z.hostname,z=+z.port;const J=new un(null);_&&Vs(J,_),h&&(J.g=h),z&&Nr(J,z),g&&(J.h=g),_=J}return g=c.G,h=c.wa,g&&h&&Nt(_,g,h),Nt(_,"VER",c.ka),ua(c,_),_}function vp(c,h,g){if(h&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=c.Aa&&!c.ma?new yt(new mn({ab:g})):new yt(c.ma),h.Fa(c.L),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function _p(){}n=_p.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ql(){}ql.prototype.g=function(c,h){return new fs(c,h)};function fs(c,h){dt.call(this),this.g=new mp(h),this.l=c,this.h=h&&h.messageUrlParams||null,c=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(c?c["X-WebChannel-Content-Type"]=h.messageContentType:c={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(c?c["X-WebChannel-Client-Profile"]=h.sa:c={"X-WebChannel-Client-Profile":h.sa}),this.g.U=c,(c=h&&h.Qb)&&!k(c)&&(this.g.u=c),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!k(h)&&(this.g.G=h,c=this.h,c!==null&&h in c&&(c=this.h,h in c&&delete c[h])),this.j=new Zi(this)}f(fs,dt),fs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fs.prototype.close=function(){tm(this.g)},fs.prototype.o=function(c){var h=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=tt(c),c=g);h.i.push(new Qn(h.Ya++,c)),h.I==3&&Fl(h)},fs.prototype.N=function(){this.g.l=null,delete this.j,tm(this.g),delete this.g,fs.Z.N.call(this)};function Dp(c){O.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var h=c.__sm__;if(h){e:{for(const g in h){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,h=h!==null&&c in h?h[c]:void 0),this.data=h}else this.data=c}f(Dp,O);function kp(){ve.call(this),this.status=1}f(kp,ve);function Zi(c){this.g=c}f(Zi,_p),Zi.prototype.ra=function(){P(this.g,"a")},Zi.prototype.qa=function(c){P(this.g,new Dp(c))},Zi.prototype.pa=function(c){P(this.g,new kp)},Zi.prototype.oa=function(){P(this.g,"b")},ql.prototype.createWebChannel=ql.prototype.g,fs.prototype.send=fs.prototype.o,fs.prototype.open=fs.prototype.m,fs.prototype.close=fs.prototype.close,vb=function(){return new ql},xb=function(){return me()},Nb=ke,Qm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ls.NO_ERROR=0,ls.TIMEOUT=8,ls.HTTP_ERROR=6,vc=ls,D.COMPLETE="complete",bb=D,ne.EventType=Je,Je.OPEN="a",Je.CLOSE="b",Je.ERROR="c",Je.MESSAGE="d",dt.prototype.listen=dt.prototype.J,La=ne,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,yb=yt}).apply(typeof Gl<"u"?Gl:typeof self<"u"?self:typeof window<"u"?window:{});const Xp="@firebase/firestore",Jp="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$n.UNAUTHENTICATED=new $n(null),$n.GOOGLE_CREDENTIALS=new $n("google-credentials-uid"),$n.FIRST_PARTY=new $n("first-party-uid"),$n.MOCK_USER=new $n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=new ob("@firebase/firestore");function _o(){return Pi.logLevel}function he(n,...e){if(Pi.logLevel<=Ct.DEBUG){const t=e.map(Gd);Pi.debug(`Firestore (${Jo}): ${n}`,...t)}}function os(n,...e){if(Pi.logLevel<=Ct.ERROR){const t=e.map(Gd);Pi.error(`Firestore (${Jo}): ${n}`,...t)}}function Li(n,...e){if(Pi.logLevel<=Ct.WARN){const t=e.map(Gd);Pi.warn(`Firestore (${Jo}): ${n}`,...t)}}function Gd(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,_b(n,s,t)}function _b(n,e,t){let s=`FIRESTORE (${Jo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw os(s),new Error(s)}function Me(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||_b(e,r,s)}function ot(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _e extends qi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class pE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t($n.UNAUTHENTICATED))}shutdown(){}}class hE{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class gE{constructor(e){this.t=e,this.currentUser=$n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Me(this.o===void 0,42304);let s=this.i;const r=u=>this.i!==s?(s=this.i,t(u)):Promise.resolve();let i=new Js;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Js,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Js)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Me(typeof s.accessToken=="string",31837,{l:s}),new Db(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string",2055,{h:e}),new $n(e)}}class yE{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=$n.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class bE{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new yE(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t($n.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Zp{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class NE{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ub(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Me(this.o===void 0,3512);const s=i=>{i.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,he("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Zp(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Me(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Zp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xE(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=xE(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function it(n,e){return n<e?-1:n>e?1:0}function Ym(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return hm(r)===hm(i)?it(r,i):hm(r)?1:-1}return it(n.length,e.length)}const vE=55296,_E=57343;function hm(n){const e=n.charCodeAt(0);return e>=vE&&e<=_E}function jo(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}function kb(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh="__name__";class Ws{constructor(e,t,s){t===void 0?t=0:t>e.length&&Pe(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Pe(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ws.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ws?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=Ws.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return it(e.length,t.length)}static compareSegments(e,t){const s=Ws.isNumericId(e),r=Ws.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Ws.extractNumericId(e).compare(Ws.extractNumericId(t)):Ym(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $r.fromString(e.substring(4,e.length-2))}}class Ut extends Ws{construct(e,t,s){return new Ut(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new _e(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new Ut(t)}static emptyPath(){return new Ut([])}}const DE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dn extends Ws{construct(e,t,s){return new dn(e,t,s)}static isValidIdentifier(e){return DE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===eh}static keyField(){return new dn([eh])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new _e(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new _e(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new _e(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(s+=l,r++):(i(),r++)}if(i(),o)throw new _e(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dn(t)}static emptyPath(){return new dn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(Ut.fromString(e))}static fromName(e){return new we(Ut.fromString(e).popFirst(5))}static empty(){return new we(Ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ut.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new Ut(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eb(n,e,t){if(!t)throw new _e(se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function kE(n,e,t,s){if(e===!0&&s===!0)throw new _e(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function th(n){if(!we.isDocumentKey(n))throw new _e(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function nh(n){if(we.isDocumentKey(n))throw new _e(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ab(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function bu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Pe(12329,{type:typeof n})}function es(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new _e(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=bu(n);throw new _e(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(n,e){const t={typeString:n};return e&&(t.value=e),t}function vl(n,e){if(!Ab(n))throw new _e(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const o=n[s];if(r&&typeof o!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new _e(se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=-62135596800,rh=1e6;class be{static now(){return be.fromMillis(Date.now())}static fromDate(e){return be.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*rh);return new be(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _e(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _e(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<sh)throw new _e(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _e(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rh}_compareTo(e){return this.seconds===e.seconds?it(this.nanoseconds,e.nanoseconds):it(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vl(e,be._jsonSchema))return new be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sh;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:Cn("string",be._jsonSchemaVersion),seconds:Cn("number"),nanoseconds:Cn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{static fromTimestamp(e){return new Ge(e)}static min(){return new Ge(new be(0,0))}static max(){return new Ge(new be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl=-1;class qc{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}}function Xm(n){return n.fields.find(e=>e.kind===2)}function yi(n){return n.fields.filter(e=>e.kind!==2)}qc.UNKNOWN_ID=-1;class _c{constructor(e,t){this.fieldPath=e,this.kind=t}}class rl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new rl(0,bs.min())}}function EE(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=Ge.fromTimestamp(s===1e9?new be(t+1,0):new be(t,s));return new bs(r,we.empty(),e)}function wb(n){return new bs(n.readTime,n.key,sl)}class bs{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new bs(Ge.min(),we.empty(),sl)}static max(){return new bs(Ge.max(),we.empty(),sl)}}function Yd(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(n.documentKey,e.documentKey),t!==0?t:it(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Cb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $i(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==Vb)throw n;he("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):$.reject(t)}static resolve(e){return new $((t,s)=>{t(e)})}static reject(e){return new $((t,s)=>{s(e)})}static waitFor(e){return new $((t,s)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>s(u))}),o=!0,i===r&&t()})}static or(e){let t=$.resolve(!1);for(const s of e)t=t.next(r=>r?$.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new $((s,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&s(o)},d=>r(d))}})}static doWhile(e,t){return new $((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps="SimpleDb";class Nu{static open(e,t,s,r){try{return new Nu(t,e.transaction(r,s))}catch(i){throw new Oa(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Js,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Oa(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const r=Xd(s.target.error);this.S.reject(new Oa(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(he(ps,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new wE(t)}}class zr{static delete(e){return he(ps,"Removing database:",e),Ni(Qy().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!rb())return!1;if(zr.F())return!0;const e=Mc(),t=zr.M(e),s=0<t&&t<10,r=Ib(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,zr.M(Mc())===12.2&&os("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(he(ps,"Opening database:",this.name),this.db=await new Promise((t,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;t(o)},r.onblocked=()=>{s(new Oa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new _e(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new _e(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new Oa(e,o))},r.onupgradeneeded=i=>{he(ps,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,r.transaction,i.oldVersion,this.version).next(()=>{he(ps,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,r){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Nu.open(this.db,e,i?"readonly":"readwrite",s),u=r(l).next(m=>(l.C(),m)).catch(m=>(l.abort(m),$.reject(m))).toPromise();return u.catch(()=>{}),await l.D,u}catch(l){const u=l,m=u.name!=="FirebaseError"&&o<3;if(he(ps,"Transaction failed with error:",u.message,"Retrying:",m),this.close(),!m)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ib(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class AE{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ni(this.U.delete())}}class Oa extends _e{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ei(n){return n.name==="IndexedDbTransactionError"}class wE{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(he(ps,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(he(ps,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Ni(s)}add(e){return he(ps,"ADD",this.store.name,e,e),Ni(this.store.add(e))}get(e){return Ni(this.store.get(e)).next(t=>(t===void 0&&(t=null),he(ps,"GET",this.store.name,e,t),t))}delete(e){return he(ps,"DELETE",this.store.name,e),Ni(this.store.delete(e))}count(){return he(ps,"COUNT",this.store.name),Ni(this.store.count())}J(e,t){const s=this.options(e,t),r=s.index?this.store.index(s.index):this.store;if(typeof r.getAll=="function"){const i=r.getAll(s.range);return new $((o,l)=>{i.onerror=u=>{l(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(s),o=[];return this.H(i,(l,u)=>{o.push(u)}).next(()=>o)}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new $((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Z(e,t){he(ps,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const r=this.cursor(s);return this.H(r,(i,o,l)=>l.delete())}ee(e,t){let s;t?s=e:(s={},t=e);const r=this.cursor(s);return this.H(r,t)}te(e){const t=this.cursor({});return new $((s,r)=>{t.onerror=i=>{const o=Xd(i.target.error);r(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}H(e,t){const s=[];return new $((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new AE(l),m=t(l.primaryKey,l.value,u);if(m instanceof $){const d=m.catch(f=>(u.done(),$.reject(f)));s.push(d)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}}).next(()=>$.waitFor(s))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ni(n){return new $((e,t)=>{n.onsuccess=s=>{const r=s.target.result;e(r)},n.onerror=s=>{const r=Xd(s.target.error);t(r)}})}let ih=!1;function Xd(n){const e=zr.M(Mc());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new _e("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ih||(ih=!0,setTimeout(()=>{throw s},0)),s}}return n}const qa="IndexBackfiller";class VE{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){he(qa,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();he(qa,`Documents written: ${t}`)}catch(t){ei(t)?he(qa,"Ignoring IndexedDB error during index backfill: ",t):await $i(t)}await this.re(6e4)})}}class CE{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const s=new Set;let r=t,i=!0;return $.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return he(qa,`Processing collection: ${o}`),this.oe(e,o,r).next(l=>{r-=l,s.add(o)});i=!1})).next(()=>t-r)}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(r,i)).next(l=>(he(qa,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}_e(e,t){let s=e;return t.changes.forEach((r,i)=>{const o=wb(i);Yd(o,s)>0&&(s=o)}),new bs(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}As.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=-1;function xu(n){return n==null}function il(n){return n===0&&1/n==-1/0}function IE(n){return typeof n=="number"&&Number.isInteger(n)&&!il(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c="";function ts(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=oh(e)),e=SE(n.get(t),e);return oh(e)}function SE(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case $c:t+="";break;default:t+=i}}return t}function oh(n){return n+$c+""}function Qs(n){const e=n.length;if(Me(e>=2,64408,{path:n}),e===2)return Me(n.charAt(0)===$c&&n.charAt(1)==="",56145,{path:n}),Ut.emptyPath();const t=e-2,s=[];let r="";for(let i=0;i<e;){const o=n.indexOf($c,i);switch((o<0||o>t)&&Pe(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(i,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),s.push(u);break;case"":r+=n.substring(i,o),r+="\0";break;case"":r+=n.substring(i,o+1);break;default:Pe(61167,{path:n})}i=o+2}return new Ut(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="remoteDocuments",_l="owner",eo="owner",ol="mutationQueues",TE="userId",Ps="mutations",ah="batchId",Di="userMutationsIndex",lh=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dc(n,e){return[n,ts(e)]}function Sb(n,e,t){return[n,ts(e),t]}const PE={},Ro="documentMutations",zc="remoteDocumentsV14",LE=["prefixPath","collectionGroup","readTime","documentId"],kc="documentKeyIndex",jE=["prefixPath","collectionGroup","documentId"],Tb="collectionGroupIndex",RE=["collectionGroup","readTime","prefixPath","documentId"],al="remoteDocumentGlobal",Jm="remoteDocumentGlobalKey",Bo="targets",Pb="queryTargetsIndex",BE=["canonicalId","targetId"],Uo="targetDocuments",UE=["targetId","path"],Jd="documentTargetsIndex",HE=["path","targetId"],Wc="targetGlobalKey",Ai="targetGlobal",ll="collectionParents",ME=["collectionId","parent"],Ho="clientMetadata",FE="clientId",vu="bundles",OE="bundleId",_u="namedQueries",qE="name",Zd="indexConfiguration",$E="indexId",Zm="collectionGroupIndex",zE="collectionGroup",$a="indexState",WE=["indexId","uid"],Lb="sequenceNumberIndex",KE=["uid","sequenceNumber"],za="indexEntries",GE=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jb="documentKeyIndex",QE=["indexId","uid","orderedDocumentKey"],Du="documentOverlays",YE=["userId","collectionPath","documentId"],ed="collectionPathOverlayIndex",XE=["userId","collectionPath","largestBatchId"],Rb="collectionGroupOverlayIndex",JE=["userId","collectionGroup","largestBatchId"],ef="globals",ZE="name",Bb=[ol,Ps,Ro,bi,Bo,_l,Ai,Uo,Ho,al,ll,vu,_u],eA=[...Bb,Du],Ub=[ol,Ps,Ro,zc,Bo,_l,Ai,Uo,Ho,al,ll,vu,_u,Du],Hb=Ub,tf=[...Hb,Zd,$a,za],tA=tf,Mb=[...tf,ef],nA=Mb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends Cb{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Bn(n,e){const t=ot(n);return zr.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ti(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Fb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,t){this.comparator=e,this.root=t||zn.EMPTY}insert(e,t){return new ln(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zn.BLACK,null,null))}remove(e){return new ln(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ql(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ql(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ql(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ql(this.root,e,this.comparator,!0)}}class Ql{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zn{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??zn.RED,this.left=r??zn.EMPTY,this.right=i??zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new zn(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return zn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}zn.EMPTY=null,zn.RED=!0,zn.BLACK=!1;zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new zn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.comparator=e,this.data=new ln(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uh(this.data.getIterator())}getIteratorFrom(e){return new uh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Wt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Wt(this.comparator);return t.data=e,t}}class uh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function to(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this.fields=e,e.sort(dn.comparator)}static empty(){return new ds([])}unionWith(e){let t=new Wt(dn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new ds(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return jo(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ob("Invalid base64 string: "+i):i}}(e);return new Sn(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Sn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return it(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sn.EMPTY_BYTE_STRING=new Sn("");const sA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fr(n){if(Me(!!n,39018),typeof n=="string"){let e=0;const t=sA.exec(n);if(Me(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:an(n.seconds),nanos:an(n.nanos)}}function an(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function pr(n){return typeof n=="string"?Sn.fromBase64String(n):Sn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="server_timestamp",$b="__type__",zb="__previous_value__",Wb="__local_write_time__";function nf(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[$b])==null?void 0:s.stringValue)===qb}function ku(n){const e=n.mapValue.fields[zb];return nf(e)?ku(e):e}function cl(n){const e=fr(n.mapValue.fields[Wb].timestampValue);return new be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,t,s,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const Kc="(default)";class ji{constructor(e,t){this.projectId=e,this.database=t||Kc}static empty(){return new ji("","")}get isDefaultDatabase(){return this.database===Kc}isEqual(e){return e instanceof ji&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="__type__",Kb="__max__",Hr={mapValue:{fields:{__type__:{stringValue:Kb}}}},rf="__vector__",Mo="value",Ec={nullValue:"NULL_VALUE"};function Kr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?nf(n)?4:Gb(n)?9007199254740991:Eu(n)?10:11:Pe(28295,{value:n})}function sr(n,e){if(n===e)return!0;const t=Kr(n);if(t!==Kr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return cl(n).isEqual(cl(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=fr(r.timestampValue),l=fr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return pr(r.bytesValue).isEqual(pr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return an(r.geoPointValue.latitude)===an(i.geoPointValue.latitude)&&an(r.geoPointValue.longitude)===an(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return an(r.integerValue)===an(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=an(r.doubleValue),l=an(i.doubleValue);return o===l?il(o)===il(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return jo(n.arrayValue.values||[],e.arrayValue.values||[],sr);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(ch(o)!==ch(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!sr(o[u],l[u])))return!1;return!0}(n,e);default:return Pe(52216,{left:n})}}function ul(n,e){return(n.values||[]).find(t=>sr(t,e))!==void 0}function Gr(n,e){if(n===e)return 0;const t=Kr(n),s=Kr(e);if(t!==s)return it(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return it(n.booleanValue,e.booleanValue);case 2:return function(i,o){const l=an(i.integerValue||i.doubleValue),u=an(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(n,e);case 3:return mh(n.timestampValue,e.timestampValue);case 4:return mh(cl(n),cl(e));case 5:return Ym(n.stringValue,e.stringValue);case 6:return function(i,o){const l=pr(i),u=pr(o);return l.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=it(l[m],u[m]);if(d!==0)return d}return it(l.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const l=it(an(i.latitude),an(o.latitude));return l!==0?l:it(an(i.longitude),an(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return dh(n.arrayValue,e.arrayValue);case 10:return function(i,o){var p,y,C,v;const l=i.fields||{},u=o.fields||{},m=(p=l[Mo])==null?void 0:p.arrayValue,d=(y=u[Mo])==null?void 0:y.arrayValue,f=it(((C=m==null?void 0:m.values)==null?void 0:C.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:dh(m,d)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Hr.mapValue&&o===Hr.mapValue)return 0;if(i===Hr.mapValue)return 1;if(o===Hr.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const p=Ym(u[f],d[f]);if(p!==0)return p;const y=Gr(l[u[f]],m[d[f]]);if(y!==0)return y}return it(u.length,d.length)}(n.mapValue,e.mapValue);default:throw Pe(23264,{he:t})}}function mh(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return it(n,e);const t=fr(n),s=fr(e),r=it(t.seconds,s.seconds);return r!==0?r:it(t.nanos,s.nanos)}function dh(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Gr(t[r],s[r]);if(i)return i}return it(t.length,s.length)}function Fo(n){return nd(n)}function nd(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=fr(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return pr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return we.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=nd(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${nd(t.fields[o])}`;return r+"}"}(n.mapValue):Pe(61005,{value:n})}function Ac(n){switch(Kr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ku(n);return e?16+Ac(e):16;case 5:return 2*n.stringValue.length;case 6:return pr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+Ac(i),0)}(n.arrayValue);case 10:case 11:return function(s){let r=0;return ti(s.fields,(i,o)=>{r+=i.length+Ac(o)}),r}(n.mapValue);default:throw Pe(13486,{value:n})}}function ml(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function sd(n){return!!n&&"integerValue"in n}function dl(n){return!!n&&"arrayValue"in n}function fh(n){return!!n&&"nullValue"in n}function ph(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function wc(n){return!!n&&"mapValue"in n}function Eu(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[sf])==null?void 0:s.stringValue)===rf}function Wa(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ti(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=Wa(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Wa(n.arrayValue.values[t]);return e}return{...n}}function Gb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Kb}const Qb={mapValue:{fields:{[sf]:{stringValue:rf},[Mo]:{arrayValue:{}}}}};function iA(n){return"nullValue"in n?Ec:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ml(ji.empty(),we.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Eu(n)?Qb:{mapValue:{}}:Pe(35942,{value:n})}function oA(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ml(ji.empty(),we.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Qb:"mapValue"in n?Eu(n)?{mapValue:{}}:Hr:Pe(61959,{value:n})}function hh(n,e){const t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function gh(n,e){const t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.value=e}static empty(){return new Zn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!wc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wa(t)}setAll(e){let t=dn.emptyPath(),s={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,s,r),s={},r=[],t=l.popLast()}o?s[l.lastSegment()]=Wa(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());wc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return sr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];wc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){ti(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Zn(Wa(this.value))}}function Yb(n){const e=[];return ti(n.fields,(t,s)=>{const r=new dn([t]);if(wc(s)){const i=Yb(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new ds(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,t,s,r,i,o,l){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new pn(e,0,Ge.min(),Ge.min(),Ge.min(),Zn.empty(),0)}static newFoundDocument(e,t,s,r){return new pn(e,1,t,Ge.min(),s,r,0)}static newNoDocument(e,t){return new pn(e,2,t,Ge.min(),Ge.min(),Zn.empty(),0)}static newUnknownDocument(e,t){return new pn(e,3,t,Ge.min(),Ge.min(),Zn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,t){this.position=e,this.inclusive=t}}function yh(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=we.comparator(we.fromName(o.referenceValue),t.key):s=Gr(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function bh(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!sr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t="asc"){this.field=e,this.dir=t}}function aA(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{}class Dt extends Xb{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new lA(e,t,s):t==="array-contains"?new mA(e,s):t==="in"?new sN(e,s):t==="not-in"?new dA(e,s):t==="array-contains-any"?new fA(e,s):new Dt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new cA(e,s):new uA(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Gr(t,this.value)):t!==null&&Kr(this.value)===Kr(t)&&this.matchesComparison(Gr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zt extends Xb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new zt(e,t)}matches(e){return qo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function qo(n){return n.op==="and"}function rd(n){return n.op==="or"}function of(n){return Jb(n)&&qo(n)}function Jb(n){for(const e of n.filters)if(e instanceof zt)return!1;return!0}function id(n){if(n instanceof Dt)return n.field.canonicalString()+n.op.toString()+Fo(n.value);if(of(n))return n.filters.map(e=>id(e)).join(",");{const e=n.filters.map(t=>id(t)).join(",");return`${n.op}(${e})`}}function Zb(n,e){return n instanceof Dt?function(s,r){return r instanceof Dt&&s.op===r.op&&s.field.isEqual(r.field)&&sr(s.value,r.value)}(n,e):n instanceof zt?function(s,r){return r instanceof zt&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,l)=>i&&Zb(o,r.filters[l]),!0):!1}(n,e):void Pe(19439)}function eN(n,e){const t=n.filters.concat(e);return zt.create(t,n.op)}function tN(n){return n instanceof Dt?function(t){return`${t.field.canonicalString()} ${t.op} ${Fo(t.value)}`}(n):n instanceof zt?function(t){return t.op.toString()+" {"+t.getFilters().map(tN).join(" ,")+"}"}(n):"Filter"}class lA extends Dt{constructor(e,t,s){super(e,t,s),this.key=we.fromName(s.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class cA extends Dt{constructor(e,t){super(e,"in",t),this.keys=nN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class uA extends Dt{constructor(e,t){super(e,"not-in",t),this.keys=nN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function nN(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(s=>we.fromName(s.referenceValue))}class mA extends Dt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dl(t)&&ul(t.arrayValue,this.value)}}class sN extends Dt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ul(this.value.arrayValue,t)}}class dA extends Dt{constructor(e,t){super(e,"not-in",t)}matches(e){if(ul(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ul(this.value.arrayValue,t)}}class fA extends Dt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>ul(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e,t=null,s=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function od(n,e=null,t=[],s=[],r=null,i=null,o=null){return new pA(n,e,t,s,r,i,o)}function Ri(n){const e=ot(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>id(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),xu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>Fo(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>Fo(s)).join(",")),e.Te=t}return e.Te}function Dl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!aA(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Zb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bh(n.startAt,e.startAt)&&bh(n.endAt,e.endAt)}function Gc(n){return we.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Qc(n,e){return n.filters.filter(t=>t instanceof Dt&&t.field.isEqual(e))}function Nh(n,e,t){let s=Ec,r=!0;for(const i of Qc(n,e)){let o=Ec,l=!0;switch(i.op){case"<":case"<=":o=iA(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Ec}hh({value:s,inclusive:r},{value:o,inclusive:l})<0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];hh({value:s,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}function xh(n,e,t){let s=Hr,r=!0;for(const i of Qc(n,e)){let o=Hr,l=!0;switch(i.op){case">=":case">":o=oA(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Hr}gh({value:s,inclusive:r},{value:o,inclusive:l})>0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];gh({value:s,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,t=null,s=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function hA(n,e,t,s,r,i,o,l){return new Zo(n,e,t,s,r,i,o,l)}function kl(n){return new Zo(n)}function vh(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function rN(n){return n.collectionGroup!==null}function Ka(n){const e=ot(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Wt(dn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new fl(i,s))}),t.has(dn.keyField().canonicalString())||e.Ie.push(new fl(dn.keyField(),s))}return e.Ie}function ws(n){const e=ot(n);return e.Ee||(e.Ee=gA(e,Ka(n))),e.Ee}function gA(n,e){if(n.limitType==="F")return od(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new fl(r.field,i)});const t=n.endAt?new Oo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Oo(n.startAt.position,n.startAt.inclusive):null;return od(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function ad(n,e){const t=n.filters.concat([e]);return new Zo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ld(n,e,t){return new Zo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Au(n,e){return Dl(ws(n),ws(e))&&n.limitType===e.limitType}function iN(n){return`${Ri(ws(n))}|lt:${n.limitType}`}function Do(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>tN(r)).join(", ")}]`),xu(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>Fo(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>Fo(r)).join(",")),`Target(${s})`}(ws(n))}; limitType=${n.limitType})`}function El(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):we.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of Ka(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(o,l,u){const m=yh(o,l,u);return o.inclusive?m<=0:m<0}(s.startAt,Ka(s),r)||s.endAt&&!function(o,l,u){const m=yh(o,l,u);return o.inclusive?m>=0:m>0}(s.endAt,Ka(s),r))}(n,e)}function yA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function oN(n){return(e,t)=>{let s=!1;for(const r of Ka(n)){const i=bA(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function bA(n,e,t){const s=n.field.isKeyField()?we.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Gr(u,m):Pe(42886)}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Pe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ti(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return Fb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=new ln(we.comparator);function gs(){return NA}const aN=new ln(we.comparator);function ja(...n){let e=aN;for(const t of n)e=e.insert(t.key,t);return e}function lN(n){let e=aN;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Ys(){return Ga()}function cN(){return Ga()}function Ga(){return new hr(n=>n.toString(),(n,e)=>n.isEqual(e))}const xA=new ln(we.comparator),vA=new Wt(we.comparator);function bt(...n){let e=vA;for(const t of n)e=e.add(t);return e}const _A=new Wt(it);function DA(){return _A}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:il(e)?"-0":e}}function uN(n){return{integerValue:""+n}}function kA(n,e){return IE(e)?uN(e):af(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(){this._=void 0}}function EA(n,e,t){return n instanceof $o?function(r,i){const o={fields:{[$b]:{stringValue:qb},[Wb]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&nf(i)&&(i=ku(i)),i&&(o.fields[zb]=i),{mapValue:o}}(t,e):n instanceof zo?dN(n,e):n instanceof Wo?fN(n,e):function(r,i){const o=mN(r,i),l=_h(o)+_h(r.Ae);return sd(o)&&sd(r.Ae)?uN(l):af(r.serializer,l)}(n,e)}function AA(n,e,t){return n instanceof zo?dN(n,e):n instanceof Wo?fN(n,e):t}function mN(n,e){return n instanceof pl?function(s){return sd(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class $o extends wu{}class zo extends wu{constructor(e){super(),this.elements=e}}function dN(n,e){const t=pN(e);for(const s of n.elements)t.some(r=>sr(r,s))||t.push(s);return{arrayValue:{values:t}}}class Wo extends wu{constructor(e){super(),this.elements=e}}function fN(n,e){let t=pN(e);for(const s of n.elements)t=t.filter(r=>!sr(r,s));return{arrayValue:{values:t}}}class pl extends wu{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function _h(n){return an(n.integerValue||n.doubleValue)}function pN(n){return dl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,t){this.field=e,this.transform=t}}function wA(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof zo&&r instanceof zo||s instanceof Wo&&r instanceof Wo?jo(s.elements,r.elements,sr):s instanceof pl&&r instanceof pl?sr(s.Ae,r.Ae):s instanceof $o&&r instanceof $o}(n.transform,e.transform)}class VA{constructor(e,t){this.version=e,this.transformResults=t}}class Rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rn}static exists(e){return new Rn(void 0,e)}static updateTime(e){return new Rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Vu{}function gN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Al(n.key,Rn.none()):new ea(n.key,n.data,Rn.none());{const t=n.data,s=Zn.empty();let r=new Wt(dn.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new gr(n.key,s,new ds(r.toArray()),Rn.none())}}function CA(n,e,t){n instanceof ea?function(r,i,o){const l=r.value.clone(),u=kh(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof gr?function(r,i,o){if(!Vc(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=kh(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(yN(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Qa(n,e,t,s){return n instanceof ea?function(i,o,l,u){if(!Vc(i.precondition,o))return l;const m=i.value.clone(),d=Eh(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(n,e,t,s):n instanceof gr?function(i,o,l,u){if(!Vc(i.precondition,o))return l;const m=Eh(i.fieldTransforms,u,o),d=o.data;return d.setAll(yN(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(i,o,l){return Vc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function IA(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=mN(s.transform,r||null);i!=null&&(t===null&&(t=Zn.empty()),t.set(s.field,i))}return t||null}function Dh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&jo(s,r,(i,o)=>wA(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ea extends Vu{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class gr extends Vu{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function yN(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function kh(n,e,t){const s=new Map;Me(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,l=e.data.field(i.field);s.set(i.field,AA(o,l,t[r]))}return s}function Eh(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,EA(i,o,e))}return s}class Al extends Vu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bN extends Vu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&CA(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Qa(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Qa(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=cN();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=gN(o,l);u!==null&&s.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Ge.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),bt())}isEqual(e){return this.batchId===e.batchId&&jo(this.mutations,e.mutations,(t,s)=>Dh(t,s))&&jo(this.baseMutations,e.baseMutations,(t,s)=>Dh(t,s))}}class cf{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){Me(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return xA}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new cf(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kn,Vt;function TA(n){switch(n){case se.OK:return Pe(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Pe(15467,{code:n})}}function NN(n){if(n===void 0)return os("GRPC error has no .code"),se.UNKNOWN;switch(n){case kn.OK:return se.OK;case kn.CANCELLED:return se.CANCELLED;case kn.UNKNOWN:return se.UNKNOWN;case kn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case kn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case kn.INTERNAL:return se.INTERNAL;case kn.UNAVAILABLE:return se.UNAVAILABLE;case kn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case kn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case kn.NOT_FOUND:return se.NOT_FOUND;case kn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case kn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case kn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case kn.ABORTED:return se.ABORTED;case kn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case kn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case kn.DATA_LOSS:return se.DATA_LOSS;default:return Pe(39323,{code:n})}}(Vt=kn||(kn={}))[Vt.OK=0]="OK",Vt[Vt.CANCELLED=1]="CANCELLED",Vt[Vt.UNKNOWN=2]="UNKNOWN",Vt[Vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vt[Vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vt[Vt.NOT_FOUND=5]="NOT_FOUND",Vt[Vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vt[Vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vt[Vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vt[Vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vt[Vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vt[Vt.ABORTED=10]="ABORTED",Vt[Vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vt[Vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vt[Vt.INTERNAL=13]="INTERNAL",Vt[Vt.UNAVAILABLE=14]="UNAVAILABLE",Vt[Vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA=new $r([4294967295,4294967295],0);function Ah(n){const e=PA().encode(n),t=new gb;return t.update(e),new Uint8Array(t.digest())}function wh(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new $r([t,s],0),new $r([r,i],0)]}class mf{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Ra(`Invalid padding: ${t}`);if(s<0)throw new Ra(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Ra(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Ra(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=$r.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply($r.fromNumber(s)));return r.compare(LA)===1&&(r=new $r([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ah(e),[s,r]=wh(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new mf(i,r,t);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Ah(e),[s,r]=wh(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Ra extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,wl.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Cu(Ge.min(),r,new ln(it),gs(),bt())}}class wl{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new wl(s,t,bt(),bt(),bt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class xN{constructor(e,t){this.targetId=e,this.Ce=t}}class vN{constructor(e,t,s=Sn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Vh{constructor(){this.ve=0,this.Fe=Ch(),this.Me=Sn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=bt(),t=bt(),s=bt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Pe(38017,{changeType:i})}}),new wl(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Ch()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Me(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class jA{constructor(e){this.Ge=e,this.ze=new Map,this.je=gs(),this.Je=Yl(),this.He=Yl(),this.Ye=new ln(it)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Pe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((s,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(Gc(i))if(s===0){const o=new we(i.path);this.et(t,o,pn.newNoDocument(o,Ge.min()))}else Me(s===1,20013,{expectedCount:s});else{const o=this._t(t);if(o!==s){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=pr(s).toUint8Array()}catch(u){if(u instanceof Ob)return Li("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new mf(o,r,i)}catch(u){return Li(u instanceof Ra?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&Gc(l.target)){const u=new we(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,pn.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let s=bt();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new Cu(e,t,this.Ye,this.je,s);return this.je=gs(),this.Je=Yl(),this.He=Yl(),this.Ye=new ln(it),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Vh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Wt(it),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Wt(it),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||he("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Vh),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Yl(){return new ln(we.comparator)}function Ch(){return new ln(we.comparator)}const RA={asc:"ASCENDING",desc:"DESCENDING"},BA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},UA={and:"AND",or:"OR"};class HA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function cd(n,e){return n.useProto3Json||xu(e)?e:{value:e}}function Ko(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _N(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function MA(n,e){return Ko(n,e.toTimestamp())}function as(n){return Me(!!n,49232),Ge.fromTimestamp(function(t){const s=fr(t);return new be(s.seconds,s.nanos)}(n))}function df(n,e){return ud(n,e).canonicalString()}function ud(n,e){const t=function(r){return new Ut(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function DN(n){const e=Ut.fromString(n);return Me(TN(e),10190,{key:e.toString()}),e}function Yc(n,e){return df(n.databaseId,e.path)}function wi(n,e){const t=DN(e);if(t.get(1)!==n.databaseId.projectId)throw new _e(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new _e(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new we(AN(t))}function kN(n,e){return df(n.databaseId,e)}function EN(n){const e=DN(n);return e.length===4?Ut.emptyPath():AN(e)}function md(n){return new Ut(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function AN(n){return Me(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ih(n,e,t){return{name:Yc(n,e),fields:t.value.mapValue.fields}}function FA(n,e,t){const s=wi(n,e.name),r=as(e.updateTime),i=e.createTime?as(e.createTime):Ge.min(),o=new Zn({mapValue:{fields:e.fields}}),l=pn.newFoundDocument(s,r,i,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function OA(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Pe(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Me(d===void 0||typeof d=="string",58123),Sn.fromBase64String(d||"")):(Me(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Sn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?se.UNKNOWN:NN(m.code);return new _e(d,m.message||"")}(o);t=new vN(s,r,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=wi(n,s.document.name),i=as(s.document.updateTime),o=s.document.createTime?as(s.document.createTime):Ge.min(),l=new Zn({mapValue:{fields:s.document.fields}}),u=pn.newFoundDocument(r,i,o,l),m=s.targetIds||[],d=s.removedTargetIds||[];t=new Cc(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=wi(n,s.document),i=s.readTime?as(s.readTime):Ge.min(),o=pn.newNoDocument(r,i),l=s.removedTargetIds||[];t=new Cc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=wi(n,s.document),i=s.removedTargetIds||[];t=new Cc([],i,r,null)}else{if(!("filter"in e))return Pe(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new SA(r,i),l=s.targetId;t=new xN(l,o)}}return t}function Xc(n,e){let t;if(e instanceof ea)t={update:Ih(n,e.key,e.value)};else if(e instanceof Al)t={delete:Yc(n,e.key)};else if(e instanceof gr)t={update:Ih(n,e.key,e.data),updateMask:GA(e.fieldMask)};else{if(!(e instanceof bN))return Pe(16599,{Vt:e.type});t={verify:Yc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const l=o.transform;if(l instanceof $o)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof zo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Wo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof pl)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Pe(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:MA(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Pe(27497)}(n,e.precondition)),t}function dd(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Rn.updateTime(as(i.updateTime)):i.exists!==void 0?Rn.exists(i.exists):Rn.none()}(e.currentDocument):Rn.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(o,l){let u=null;if("setToServerValue"in l)Me(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new $o;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];u=new zo(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];u=new Wo(d)}else"increment"in l?u=new pl(o,l.increment):Pe(16584,{proto:l});const m=dn.fromServerFormat(l.fieldPath);return new hN(m,u)}(n,r)):[];if(e.update){e.update.name;const r=wi(n,e.update.name),i=new Zn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const m=u.fieldPaths||[];return new ds(m.map(d=>dn.fromServerFormat(d)))}(e.updateMask);return new gr(r,i,o,t,s)}return new ea(r,i,t,s)}if(e.delete){const r=wi(n,e.delete);return new Al(r,t)}if(e.verify){const r=wi(n,e.verify);return new bN(r,t)}return Pe(1463,{proto:e})}function qA(n,e){return n&&n.length>0?(Me(e!==void 0,14353),n.map(t=>function(r,i){let o=r.updateTime?as(r.updateTime):as(i);return o.isEqual(Ge.min())&&(o=as(i)),new VA(o,r.transformResults||[])}(t,e))):[]}function wN(n,e){return{documents:[kN(n,e.path)]}}function VN(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=kN(n,r);const i=function(m){if(m.length!==0)return SN(zt.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(p){return{field:ko(p.field),direction:zA(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=cd(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function CN(n){let e=EN(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){Me(s===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const p=IN(f);return p instanceof zt&&of(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(C){return new fl(Eo(C.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(p))}(t.orderBy));let l=null;t.limit&&(l=function(f){let p;return p=typeof f=="object"?f.value:f,xu(p)?null:p}(t.limit));let u=null;t.startAt&&(u=function(f){const p=!!f.before,y=f.values||[];return new Oo(y,p)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const p=!f.before,y=f.values||[];return new Oo(y,p)}(t.endAt)),hA(e,r,o,i,l,"F",u,m)}function $A(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function IN(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Eo(t.unaryFilter.field);return Dt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Eo(t.unaryFilter.field);return Dt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Eo(t.unaryFilter.field);return Dt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Eo(t.unaryFilter.field);return Dt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}}(n):n.fieldFilter!==void 0?function(t){return Dt.create(Eo(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return zt.create(t.compositeFilter.filters.map(s=>IN(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}}(t.compositeFilter.op))}(n):Pe(30097,{filter:n})}function zA(n){return RA[n]}function WA(n){return BA[n]}function KA(n){return UA[n]}function ko(n){return{fieldPath:n.canonicalString()}}function Eo(n){return dn.fromServerFormat(n.fieldPath)}function SN(n){return n instanceof Dt?function(t){if(t.op==="=="){if(ph(t.value))return{unaryFilter:{field:ko(t.field),op:"IS_NAN"}};if(fh(t.value))return{unaryFilter:{field:ko(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ph(t.value))return{unaryFilter:{field:ko(t.field),op:"IS_NOT_NAN"}};if(fh(t.value))return{unaryFilter:{field:ko(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ko(t.field),op:WA(t.op),value:t.value}}}(n):n instanceof zt?function(t){const s=t.getFilters().map(r=>SN(r));return s.length===1?s[0]:{compositeFilter:{op:KA(t.op),filters:s}}}(n):Pe(54877,{filter:n})}function GA(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function TN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,t,s,r,i=Ge.min(),o=Ge.min(),l=Sn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new cr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new cr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e){this.yt=e}}function QA(n,e){let t;if(e.document)t=FA(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=we.fromSegments(e.noDocument.path),r=Ui(e.noDocument.readTime);t=pn.newNoDocument(s,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Pe(56709);{const s=we.fromSegments(e.unknownDocument.path),r=Ui(e.unknownDocument.version);t=pn.newUnknownDocument(s,r)}}return e.readTime&&t.setReadTime(function(r){const i=new be(r[0],r[1]);return Ge.fromTimestamp(i)}(e.readTime)),t}function Sh(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Jc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(i,o){return{name:Yc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ko(i,o.version.toTimestamp()),createTime:Ko(i,o.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:Bi(e.version)};else{if(!e.isUnknownDocument())return Pe(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:Bi(e.version)}}return s}function Jc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Bi(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ui(n){const e=new be(n.seconds,n.nanoseconds);return Ge.fromTimestamp(e)}function xi(n,e){const t=(e.baseMutations||[]).map(i=>dd(n.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>dd(n.yt,i)),r=be.fromMillis(e.localWriteTimeMs);return new lf(e.batchId,r,t,s)}function Ba(n){const e=Ui(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ui(n.lastLimboFreeSnapshotVersion):Ge.min();let s;return s=function(i){return i.documents!==void 0}(n.query)?function(i){const o=i.documents.length;return Me(o===1,1966,{count:o}),ws(kl(EN(i.documents[0])))}(n.query):function(i){return ws(CN(i))}(n.query),new cr(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Sn.fromBase64String(n.resumeToken))}function LN(n,e){const t=Bi(e.snapshotVersion),s=Bi(e.lastLimboFreeSnapshotVersion);let r;r=Gc(e.target)?wN(n.yt,e.target):VN(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ri(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function jN(n){const e=CN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ld(e,e.limit,"L"):e}function gm(n,e){return new uf(e.largestBatchId,dd(n.yt,e.overlayMutation))}function Th(n,e){const t=e.path.lastSegment();return[n,ts(e.path.popLast()),t]}function Ph(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:Bi(s.readTime),documentKey:ts(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{getBundleMetadata(e,t){return Lh(e).get(t).next(s=>{if(s)return function(i){return{id:i.bundleId,createTime:Ui(i.createTime),version:i.version}}(s)})}saveBundleMetadata(e,t){return Lh(e).put(function(r){return{bundleId:r.id,createTime:Bi(as(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return jh(e).get(t).next(s=>{if(s)return function(i){return{name:i.name,query:jN(i.bundledQuery),readTime:Ui(i.readTime)}}(s)})}saveNamedQuery(e,t){return jh(e).put(function(r){return{name:r.name,readTime:Bi(as(r.readTime)),bundledQuery:r.bundledQuery}}(t))}}function Lh(n){return Bn(n,vu)}function jh(n){return Bn(n,_u)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new Iu(e,s)}getOverlay(e,t){return pa(e).get(Th(this.userId,t)).next(s=>s?gm(this.serializer,s):null)}getOverlays(e,t){const s=Ys();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){const r=[];return s.forEach((i,o)=>{const l=new uf(t,o);r.push(this.St(e,l))}),$.waitFor(r)}removeOverlaysForBatchId(e,t,s){const r=new Set;t.forEach(o=>r.add(ts(o.getCollectionPath())));const i=[];return r.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(pa(e).Z(ed,l))}),$.waitFor(i)}getOverlaysForCollection(e,t,s){const r=Ys(),i=ts(t),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return pa(e).J(ed,o).next(l=>{for(const u of l){const m=gm(this.serializer,u);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,s,r){const i=Ys();let o;const l=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return pa(e).ee({index:Rb,range:l},(u,m,d)=>{const f=gm(this.serializer,m);i.size()<r||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}St(e,t){return pa(e).put(function(r,i,o){const[l,u,m]=Th(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:m,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Xc(r.yt,o.mutation)}}(this.serializer,this.userId,t))}}function pa(n){return Bn(n,Du)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{bt(e){return Bn(e,ef)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const s=t==null?void 0:t.value;return s?Sn.fromUint8Array(s):Sn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(an(e.integerValue));else if("doubleValue"in e){const s=an(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),il(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=fr(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(pr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?Gb(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Eu(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Pe(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const r of Object.keys(s))this.Ot(r,t),this.Ct(s[r],t)}kt(e,t){var o,l;const s=e.fields||{};this.Ft(t,53);const r=Mo,i=((l=(o=s[r].arrayValue)==null?void 0:o.values)==null?void 0:l.length)||0;this.Ft(t,15),t.Mt(an(i)),this.Ot(r,t),this.Ct(s[r],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const r of s)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),we.fromName(e).path.forEach(s=>{this.Ft(t,60),this.Ut(s,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}vi.Kt=new vi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=255;function JA(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Rh(n){const e=64-function(s){let r=0;for(let i=0;i<8;++i){const o=JA(255&s[i]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(e/8)}class ZA{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),s=Rh(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),s=Rh(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(no),this.sn(255)}_n(){this.an(no),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let r=1;r<t.length;++r)t[r]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===no?(this.sn(no),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===no?(this.an(no),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class ew{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class tw{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ha{constructor(){this.cn=new ZA,this.ln=new ew(this.cn),this.hn=new tw(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t,s,r){this.Tn=e,this.In=t,this.En=s,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new _i(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:Ic(this.En),directionalValue:Ic(this.dn),orderedDocumentKey:Ic(t),documentKey:s.path.toArray()}}Vn(e,t,s){const r=this.Rn(e,t,s);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Er(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=Bh(n.En,e.En),t!==0?t:(t=Bh(n.dn,e.dn),t!==0?t:we.comparator(n.In,e.In)))}function Bh(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function Ic(n){return sb()?function(t){let s="";for(let r=0;r<t.length;r++)s+=String.fromCharCode(t[r]);return s}(n):n}function Uh(n){return typeof n!="string"?n:function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(n)}class Hh{constructor(e){this.mn=new Wt((t,s)=>dn.comparator(t.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(Me(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Xm(e);if(t!==void 0&&!this.wn(t))return!1;const s=yi(e);let r=new Set,i=0,o=0;for(;i<s.length&&this.wn(s[i]);++i)r=r.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=s[i];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new Wt(dn.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new _c(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new _c(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new _c(s.field,s.dir==="asc"?0:1)));return new qc(qc.UNKNOWN_ID,this.collectionId,t,rl.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(n){var t,s;if(Me(n instanceof Dt||n instanceof zt,20012),n instanceof Dt){if(n instanceof sN){const r=((s=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:s.map(i=>Dt.create(n.field,"==",i)))||[];return zt.create(r,"or")}return n}const e=n.filters.map(r=>RN(r));return zt.create(e,n.op)}function nw(n){if(n.getFilters().length===0)return[];const e=hd(RN(n));return Me(BN(e),7391),fd(e)||pd(e)?[e]:e.getFilters()}function fd(n){return n instanceof Dt}function pd(n){return n instanceof zt&&of(n)}function BN(n){return fd(n)||pd(n)||function(t){if(t instanceof zt&&rd(t)){for(const s of t.getFilters())if(!fd(s)&&!pd(s))return!1;return!0}return!1}(n)}function hd(n){if(Me(n instanceof Dt||n instanceof zt,34018),n instanceof Dt)return n;if(n.filters.length===1)return hd(n.filters[0]);const e=n.filters.map(s=>hd(s));let t=zt.create(e,n.op);return t=Zc(t),BN(t)?t:(Me(t instanceof zt,64498),Me(qo(t),40251),Me(t.filters.length>1,57927),t.filters.reduce((s,r)=>ff(s,r)))}function ff(n,e){let t;return Me(n instanceof Dt||n instanceof zt,38388),Me(e instanceof Dt||e instanceof zt,25473),t=n instanceof Dt?e instanceof Dt?function(r,i){return zt.create([r,i],"and")}(n,e):Mh(n,e):e instanceof Dt?Mh(e,n):function(r,i){if(Me(r.filters.length>0&&i.filters.length>0,48005),qo(r)&&qo(i))return eN(r,i.getFilters());const o=rd(r)?r:i,l=rd(r)?i:r,u=o.filters.map(m=>ff(m,l));return zt.create(u,"or")}(n,e),Zc(t)}function Mh(n,e){if(qo(e))return eN(e,n.getFilters());{const t=e.filters.map(s=>ff(n,s));return zt.create(t,"or")}}function Zc(n){if(Me(n instanceof Dt||n instanceof zt,11850),n instanceof Dt)return n;const e=n.getFilters();if(e.length===1)return Zc(e[0]);if(Jb(n))return n;const t=e.map(r=>Zc(r)),s=[];return t.forEach(r=>{r instanceof Dt?s.push(r):r instanceof zt&&(r.op===n.op?s.push(...r.filters):s.push(r))}),s.length===1?s[0]:zt.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(){this.Cn=new pf}addToCollectionParentIndex(e,t){return this.Cn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(bs.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(bs.min())}updateCollectionGroup(e,t,s){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class pf{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Wt(Ut.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Wt(Ut.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="IndexedDbIndexManager",Xl=new Uint8Array(0);class rw{constructor(e,t){this.databaseId=t,this.vn=new pf,this.Fn=new hr(s=>Ri(s),(s,r)=>Dl(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:s,parent:ts(r)};return Oh(e).put(i)}return $.resolve()}getCollectionParents(e,t){const s=[],r=IDBKeyRange.bound([t,""],[kb(t),""],!1,!0);return Oh(e).J(r).next(i=>{for(const o of i){if(o.collectionId!==t)break;s.push(Qs(o.parent))}return s})}addFieldIndex(e,t){const s=ga(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete r.indexId;const i=s.add(r);if(t.indexState){const o=ro(e);return i.next(l=>{o.put(Ph(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const s=ga(e),r=ro(e),i=so(e);return s.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ga(e),s=so(e),r=ro(e);return t.Z().next(()=>s.Z()).next(()=>r.Z())}createTargetIndexes(e,t){return $.forEach(this.Mn(t),s=>this.getIndexType(e,s).next(r=>{if(r===0||r===1){const i=new Hh(s).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const s=so(e);let r=!0;const i=new Map;return $.forEach(this.Mn(t),o=>this.xn(e,o).next(l=>{r&&(r=!!l),i.set(o,l)})).next(()=>{if(r){let o=bt();const l=[];return $.forEach(i,(u,m)=>{he(Fh,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(re=>`${re.fieldPath}:${re.kind}`).join(",")}`}(u)} to execute ${Ri(t)}`);const d=function(F,re){const ee=Xm(re);if(ee===void 0)return null;for(const M of Qc(F,ee.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(m,u),f=function(F,re){const ee=new Map;for(const M of yi(re))for(const A of Qc(F,M.fieldPath))switch(A.op){case"==":case"in":ee.set(M.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return ee.set(M.fieldPath.canonicalString(),A.value),Array.from(ee.values())}return null}(m,u),p=function(F,re){const ee=[];let M=!0;for(const A of yi(re)){const N=A.kind===0?Nh(F,A.fieldPath,F.startAt):xh(F,A.fieldPath,F.startAt);ee.push(N.value),M&&(M=N.inclusive)}return new Oo(ee,M)}(m,u),y=function(F,re){const ee=[];let M=!0;for(const A of yi(re)){const N=A.kind===0?xh(F,A.fieldPath,F.endAt):Nh(F,A.fieldPath,F.endAt);ee.push(N.value),M&&(M=N.inclusive)}return new Oo(ee,M)}(m,u),C=this.On(u,m,p),v=this.On(u,m,y),w=this.Nn(u,m,f),R=this.Bn(u.indexId,d,C,p.inclusive,v,y.inclusive,w);return $.forEach(R,I=>s.Y(I,t.limit).next(F=>{F.forEach(re=>{const ee=we.fromSegments(re.documentKey);o.has(ee)||(o=o.add(ee),l.push(ee))})}))}).next(()=>l)}return $.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=nw(zt.create(e.filters,"and")).map(s=>od(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,s,r,i,o,l){const u=(t!=null?t.length:1)*Math.max(s.length,i.length),m=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const p=t?this.Ln(t[f/m]):Xl,y=this.kn(e,p,s[f%m],r),C=this.qn(e,p,i[f%m],o),v=l.map(w=>this.kn(e,p,w,!0));d.push(...this.createRange(y,C,v))}return d}kn(e,t,s,r){const i=new _i(e,we.empty(),t,s);return r?i:i.An()}qn(e,t,s,r){const i=new _i(e,we.empty(),t,s);return r?i.An():i}xn(e,t){const s=new Hh(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const l of i)s.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let s=2;const r=this.Mn(t);return $.forEach(r,i=>this.xn(e,i).next(o=>{o?s!==0&&o.fields.length<function(u){let m=new Wt(dn.comparator),d=!1;for(const f of u.filters)for(const p of f.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:m=m.add(p.field));for(const f of u.orderBy)f.field.isKeyField()||(m=m.add(f.field));return m.size+(d?1:0)}(i)&&(s=1):s=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&s===2?1:s)}Qn(e,t){const s=new ha;for(const r of yi(e)){const i=t.data.field(r.fieldPath);if(i==null)return null;const o=s.Pn(r.kind);vi.Kt.Dt(i,o)}return s.un()}Ln(e){const t=new ha;return vi.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new ha;return vi.Kt.Dt(ml(this.databaseId,t),s.Pn(function(i){const o=yi(i);return o.length===0?0:o[o.length-1].kind}(e))),s.un()}Nn(e,t,s){if(s===null)return[];let r=[];r.push(new ha);let i=0;for(const o of yi(e)){const l=s[i++];for(const u of r)if(this.Un(t,o.fieldPath)&&dl(l))r=this.Kn(r,o,l);else{const m=u.Pn(o.kind);vi.Kt.Dt(l,m)}}return this.Wn(r)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of r){const u=new ha;u.seed(l.un()),vi.Kt.Dt(o,u.Pn(t.kind)),i.push(u)}return i}Un(e,t){return!!e.filters.find(s=>s instanceof Dt&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,t){const s=ga(e),r=ro(e);return(t?s.J(Zm,IDBKeyRange.bound(t,t)):s.J()).next(i=>{const o=[];return $.forEach(i,l=>r.get([l.indexId,this.uid]).next(u=>{o.push(function(d,f){const p=f?new rl(f.sequenceNumber,new bs(Ui(f.readTime),new we(Qs(f.documentKey)),f.largestBatchId)):rl.empty(),y=d.fields.map(([C,v])=>new _c(dn.fromServerFormat(C),v));return new qc(d.indexId,d.collectionGroup,y,p)}(l,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:it(s.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const r=ga(e),i=ro(e);return this.Gn(e).next(o=>r.J(Zm,IDBKeyRange.bound(t,t)).next(l=>$.forEach(l,u=>i.put(Ph(u.indexId,this.uid,o,s)))))}updateIndexEntries(e,t){const s=new Map;return $.forEach(t,(r,i)=>{const o=s.get(r.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(s.set(r.collectionGroup,l),$.forEach(l,u=>this.zn(e,r,u).next(m=>{const d=this.jn(i,u);return m.isEqual(d)?$.resolve():this.Jn(e,i,u,m,d)}))))})}Hn(e,t,s,r){return so(e).put(r.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,r){return so(e).delete(r.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const r=so(e);let i=new Wt(Er);return r.ee({index:jb,range:IDBKeyRange.only([s.indexId,this.uid,Ic(this.$n(s,t))])},(o,l)=>{i=i.add(new _i(s.indexId,t,Uh(l.arrayValue),Uh(l.directionalValue)))}).next(()=>i)}jn(e,t){let s=new Wt(Er);const r=this.Qn(t,e);if(r==null)return s;const i=Xm(t);if(i!=null){const o=e.data.field(i.fieldPath);if(dl(o))for(const l of o.arrayValue.values||[])s=s.add(new _i(t.indexId,e.key,this.Ln(l),r))}else s=s.add(new _i(t.indexId,e.key,Xl,r));return s}Jn(e,t,s,r,i){he(Fh,"Updating index entries for document '%s'",t.key);const o=[];return function(u,m,d,f,p){const y=u.getIterator(),C=m.getIterator();let v=to(y),w=to(C);for(;v||w;){let R=!1,I=!1;if(v&&w){const F=d(v,w);F<0?I=!0:F>0&&(R=!0)}else v!=null?I=!0:R=!0;R?(f(w),w=to(C)):I?(p(v),v=to(y)):(v=to(y),w=to(C))}}(r,i,Er,l=>{o.push(this.Hn(e,t,s,l))},l=>{o.push(this.Yn(e,t,s,l))}),$.waitFor(o)}Gn(e){let t=1;return ro(e).ee({index:Lb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((o,l)=>Er(o,l)).filter((o,l,u)=>!l||Er(o,u[l-1])!==0);const r=[];r.push(e);for(const o of s){const l=Er(o,e),u=Er(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Xl,we.empty()),u=r[o+1].Vn(this.uid,Xl,we.empty());i.push(IDBKeyRange.bound(l,u))}return i}Zn(e,t){return Er(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(qh)}getMinOffset(e,t){return $.mapArray(this.Mn(t),s=>this.xn(e,s).next(r=>r||Pe(44426))).next(qh)}}function Oh(n){return Bn(n,ll)}function so(n){return Bn(n,za)}function ga(n){return Bn(n,Zd)}function ro(n){return Bn(n,$a)}function qh(n){Me(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const r=n[s].indexState.offset;Yd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new bs(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},UN=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(n,e,t){const s=n.store(Ps),r=n.store(Ro),i=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=s.ee({range:o},(d,f,p)=>(l++,p.delete()));i.push(u.next(()=>{Me(l===1,47070,{batchId:t.batchId})}));const m=[];for(const d of t.mutations){const f=Sb(e,d.key.path,t.batchId);i.push(r.delete(f)),m.push(d.key)}return $.waitFor(i).next(()=>m)}function eu(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Pe(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(UN,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class Su{constructor(e,t,s,r){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=r,this.Xn={}}static wt(e,t,s,r){Me(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Su(i,t,s,r)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).ee({index:Di,range:s},(r,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,s,r){const i=Ao(e),o=Ar(e);return o.add({}).next(l=>{Me(typeof l=="number",49019);const u=new lf(l,t,s,r),m=function(y,C,v){const w=v.baseMutations.map(I=>Xc(y.yt,I)),R=v.mutations.map(I=>Xc(y.yt,I));return{userId:C,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:R}}(this.serializer,this.userId,u),d=[];let f=new Wt((p,y)=>it(p.canonicalString(),y.canonicalString()));for(const p of r){const y=Sb(this.userId,p.key.path,l);f=f.add(p.key.path.popLast()),d.push(o.put(m)),d.push(i.put(y,PE))}return f.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Xn[l]=u.keys()}),$.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return Ar(e).get(t).next(s=>s?(Me(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),xi(this.serializer,s)):null)}er(e,t){return this.Xn[t]?$.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const r=s.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Ar(e).ee({index:Di,range:r},(o,l,u)=>{l.userId===this.userId&&(Me(l.batchId>=s,47524,{tr:s}),i=xi(this.serializer,l)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Ei;return Ar(e).ee({index:Di,range:t,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ei],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).J(Di,t).next(s=>s.map(r=>xi(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=Dc(this.userId,t.path),r=IDBKeyRange.lowerBound(s),i=[];return Ao(e).ee({range:r},(o,l,u)=>{const[m,d,f]=o,p=Qs(d);if(m===this.userId&&t.path.isEqual(p))return Ar(e).get(f).next(y=>{if(!y)throw Pe(61480,{nr:o,batchId:f});Me(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),i.push(xi(this.serializer,y))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Wt(it);const r=[];return t.forEach(i=>{const o=Dc(this.userId,i.path),l=IDBKeyRange.lowerBound(o),u=Ao(e).ee({range:l},(m,d,f)=>{const[p,y,C]=m,v=Qs(y);p===this.userId&&i.path.isEqual(v)?s=s.add(C):f.done()});r.push(u)}),$.waitFor(r).next(()=>this.rr(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1,i=Dc(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new Wt(it);return Ao(e).ee({range:o},(u,m,d)=>{const[f,p,y]=u,C=Qs(p);f===this.userId&&s.isPrefixOf(C)?C.length===r&&(l=l.add(y)):d.done()}).next(()=>this.rr(e,l))}rr(e,t){const s=[],r=[];return t.forEach(i=>{r.push(Ar(e).get(i).next(o=>{if(o===null)throw Pe(35274,{batchId:i});Me(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),s.push(xi(this.serializer,o))}))}),$.waitFor(r).next(()=>s)}removeMutationBatch(e,t){return HN(e.le,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),$.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return $.resolve();const s=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return Ao(e).ee({range:s},(i,o,l)=>{if(i[0]===this.userId){const u=Qs(i[1]);r.push(u)}else l.done()}).next(()=>{Me(r.length===0,56720,{sr:r.map(i=>i.canonicalString())})})})}containsKey(e,t){return MN(e,this.userId,t)}_r(e){return FN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ei,lastStreamToken:""})}}function MN(n,e,t){const s=Dc(e,t.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return Ao(n).ee({range:i,X:!0},(l,u,m)=>{const[d,f,p]=l;d===e&&f===r&&(o=!0),m.done()}).next(()=>o)}function Ar(n){return Bn(n,Ps)}function Ao(n){return Bn(n,Ro)}function FN(n){return Bn(n,ol)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Hi(0)}static cr(){return new Hi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const s=new Hi(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>Ge.fromTimestamp(new be(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.lr(e).next(r=>(r.highestListenSequenceNumber=t,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>io(e).delete(t.targetId)).next(()=>this.lr(e)).next(s=>(Me(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s)))}removeTargets(e,t,s){let r=0;const i=[];return io(e).ee((o,l)=>{const u=Ba(l);u.sequenceNumber<=t&&s.get(u.targetId)===null&&(r++,i.push(this.removeTargetData(e,u)))}).next(()=>$.waitFor(i)).next(()=>r)}forEachTarget(e,t){return io(e).ee((s,r)=>{const i=Ba(r);t(i)})}lr(e){return zh(e).get(Wc).next(t=>(Me(t!==null,2888),t))}hr(e,t){return zh(e).put(Wc,t)}Pr(e,t){return io(e).put(LN(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const s=Ri(t),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return io(e).ee({range:r,index:Pb},(o,l,u)=>{const m=Ba(l);Dl(t,m.target)&&(i=m,u.done())}).next(()=>i)}addMatchingKeys(e,t,s){const r=[],i=Rr(e);return t.forEach(o=>{const l=ts(o.path);r.push(i.put({targetId:s,path:l})),r.push(this.referenceDelegate.addReference(e,s,o))}),$.waitFor(r)}removeMatchingKeys(e,t,s){const r=Rr(e);return $.forEach(t,i=>{const o=ts(i.path);return $.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,t){const s=Rr(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),r=Rr(e);let i=bt();return r.ee({range:s,X:!0},(o,l,u)=>{const m=Qs(o[1]),d=new we(m);i=i.add(d)}).next(()=>i)}containsKey(e,t){const s=ts(t.path),r=IDBKeyRange.bound([s],[kb(s)],!1,!0);let i=0;return Rr(e).ee({index:Jd,X:!0,range:r},([o,l],u,m)=>{o!==0&&(i++,m.done())}).next(()=>i>0)}At(e,t){return io(e).get(t).next(s=>s?Ba(s):null)}}function io(n){return Bn(n,Bo)}function zh(n){return Bn(n,Ai)}function Rr(n){return Bn(n,Uo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh="LruGarbageCollector",ow=1048576;function Kh([n,e],[t,s]){const r=it(n,t);return r===0?it(e,s):r}class aw{constructor(e){this.Ir=e,this.buffer=new Wt(Kh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Kh(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ON{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){he(Wh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ei(t)?he(Wh,"Ignoring IndexedDB error during garbage collection: ",t):await $i(t)}await this.Vr(3e5)})}}class lw{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return $.resolve(As.ce);const s=new aw(t);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve($h)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$h):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(s=f,l=Date.now(),this.removeTargets(e,s,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(m=Date.now(),_o()<=Ct.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function qN(n,e){return new lw(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,t){this.db=e,this.garbageCollector=qN(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(s,r)=>t(r))}addReference(e,t,s){return Jl(e,s)}removeReference(e,t,s){return Jl(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Jl(e,t)}br(e,t){return function(r,i){let o=!1;return FN(r).te(l=>MN(r,l,i).next(u=>(u&&(o=!0),$.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,(o,l)=>{if(l<=t){const u=this.br(e,o).next(m=>{if(!m)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,Ge.min()),Rr(e).delete(function(f){return[0,ts(f.path)]}(o))))});r.push(u)}}).next(()=>$.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Jl(e,t)}Sr(e,t){const s=Rr(e);let r,i=As.ce;return s.ee({index:Jd},([o,l],{path:u,sequenceNumber:m})=>{o===0?(i!==As.ce&&t(new we(Qs(r)),i),i=m,r=u):i=As.ce}).next(()=>{i!==As.ce&&t(new we(Qs(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Jl(n,e){return Rr(n).put(function(s,r){return{targetId:0,path:ts(s.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(){this.changes=new hr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?$.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return fi(e).put(s)}removeEntry(e,t,s){return fi(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Jc(o),l[l.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.Dr(e,s)))}getEntry(e,t){let s=pn.newInvalidDocument(t);return fi(e).ee({index:kc,range:IDBKeyRange.only(ya(t))},(r,i)=>{s=this.Cr(t,i)}).next(()=>s)}vr(e,t){let s={size:0,document:pn.newInvalidDocument(t)};return fi(e).ee({index:kc,range:IDBKeyRange.only(ya(t))},(r,i)=>{s={document:this.Cr(t,i),size:eu(i)}}).next(()=>s)}getEntries(e,t){let s=gs();return this.Fr(e,t,(r,i)=>{const o=this.Cr(r,i);s=s.insert(r,o)}).next(()=>s)}Mr(e,t){let s=gs(),r=new ln(we.comparator);return this.Fr(e,t,(i,o)=>{const l=this.Cr(i,o);s=s.insert(i,l),r=r.insert(i,eu(o))}).next(()=>({documents:s,Or:r}))}Fr(e,t,s){if(t.isEmpty())return $.resolve();let r=new Wt(Yh);t.forEach(u=>r=r.add(u));const i=IDBKeyRange.bound(ya(r.first()),ya(r.last())),o=r.getIterator();let l=o.getNext();return fi(e).ee({index:kc,range:i},(u,m,d)=>{const f=we.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;l&&Yh(l,f)<0;)s(l,null),l=o.getNext();l&&l.isEqual(f)&&(s(l,m),l=o.hasNext()?o.getNext():null),l?d.j(ya(l)):d.done()}).next(()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,s,r,i){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Jc(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fi(e).J(IDBKeyRange.bound(l,u,!0)).next(m=>{i==null||i.incrementDocumentReadCount(m.length);let d=gs();for(const f of m){const p=this.Cr(we.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);p.isFoundDocument()&&(El(t,p)||r.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,s,r){let i=gs();const o=Qh(t,s),l=Qh(t,bs.max());return fi(e).ee({index:Tb,range:IDBKeyRange.bound(o,l,!0)},(u,m,d)=>{const f=this.Cr(we.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);i=i.insert(f.key,f),i.size===r&&d.done()}).next(()=>i)}newChangeBuffer(e){return new mw(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Gh(e).get(Jm).next(t=>(Me(!!t,20021),t))}Dr(e,t){return Gh(e).put(Jm,t)}Cr(e,t){if(t){const s=QA(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Ge.min())))return s}return pn.newInvalidDocument(e)}}function zN(n){return new uw(n)}class mw extends $N{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new hr(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const t=[];let s=0,r=new Wt((i,o)=>it(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const u=Sh(this.Nr.serializer,o);r=r.add(i.path.popLast());const m=eu(u);s+=m-l.size,t.push(this.Nr.addEntry(e,i,u))}else if(s-=l.size,this.trackRemovals){const u=Sh(this.Nr.serializer,o.convertToNoDocument(Ge.min()));t.push(this.Nr.addEntry(e,i,u))}}),r.forEach(i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Nr.updateMetadata(e,s)),$.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:s,Or:r})=>(r.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function Gh(n){return Bn(n,al)}function fi(n){return Bn(n,zc)}function ya(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Qh(n,e){const t=e.documentKey.path.toArray();return[n,Jc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Yh(n,e){const t=n.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<t.length-2&&i<s.length-2;++i)if(r=it(t[i],s[i]),r)return r;return r=it(t.length,s.length),r||(r=it(t[t.length-2],s[s.length-2]),r||it(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&Qa(s.mutation,r,ds.empty(),be.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,bt()).next(()=>s))}getLocalViewOfDocuments(e,t,s=bt()){const r=Ys();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=ja();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=Ys();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,bt()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,s,r){let i=gs();const o=Ga(),l=function(){return Ga()}();return t.forEach((u,m)=>{const d=s.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof gr)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),Qa(d.mutation,m,d.mutation.getFieldMask(),be.now())):o.set(m.key,ds.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new dw(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const s=Ga();let r=new ln((o,l)=>o-l),i=bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=s.get(u)||ds.empty();d=l.applyToLocalView(m,d),s.set(u,d);const f=(r.get(l.batchId)||bt()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=cN();d.forEach(p=>{if(!i.has(p)){const y=gN(t.get(p),s.get(p));y!==null&&f.set(p,y),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(o){return we.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):rN(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):$.resolve(Ys());let l=sl,u=i;return o.next(m=>$.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{u=u.insert(d,p)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,bt())).next(d=>({batchId:l,changes:lN(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next(s=>{let r=ja();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=ja();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const m=function(f,p){return new Zo(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,s,r).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,pn.newInvalidDocument(d)))});let l=ja();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&Qa(d.mutation,m,ds.empty(),be.now()),El(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:as(r.createTime)}}(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:jN(r.bundledQuery),readTime:as(r.readTime)}}(t)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(){this.overlays=new ln(we.comparator),this.qr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Ys();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.St(e,t,i)}),$.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),$.resolve()}getOverlaysForCollection(e,t,s){const r=Ys(),i=t.length+1,o=new we(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>s&&r.set(u.getKey(),u)}return $.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new ln((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>s){let d=i.get(m.largestBatchId);d===null&&(d=Ys(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=Ys(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return $.resolve(l)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new uf(t,s));let i=this.qr.get(t);i===void 0&&(i=bt(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(){this.sessionToken=Sn.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(){this.Qr=new Wt(Fn.$r),this.Ur=new Wt(Fn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new Fn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Gr(new Fn(e,t))}zr(e,t){e.forEach(s=>this.removeReference(s,t))}jr(e){const t=new we(new Ut([])),s=new Fn(t,e),r=new Fn(t,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new we(new Ut([])),s=new Fn(t,e),r=new Fn(t,e+1);let i=bt();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Fn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Fn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return we.comparator(e.key,t.key)||it(e.Yr,t.Yr)}static Kr(e,t){return it(e.Yr,t.Yr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Wt(Fn.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new lf(i,t,s,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new Fn(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,t){return $.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?Ei:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Fn(t,0),r=new Fn(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Wt(it);return t.forEach(r=>{const i=new Fn(r,0),o=new Fn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{s=s.add(l.Yr)})}),$.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;we.isDocumentKey(i)||(i=i.child(""));const o=new Fn(new we(i),0);let l=new Wt(it);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!s.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),$.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Me(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return $.forEach(t.mutations,r=>{const i=new Fn(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,t){const s=new Fn(t,0),r=this.Zr.firstAfterOrEqual(s);return $.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e){this.ri=e,this.docs=function(){return new ln(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return $.resolve(s?s.document.mutableCopy():pn.newInvalidDocument(t))}getEntries(e,t){let s=gs();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():pn.newInvalidDocument(r))}),$.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=gs();const o=t.path,l=new we(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||Yd(wb(d),s)<=0||(r.has(d.key)||El(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,t,s,r){Pe(9500)}ii(e,t){return $.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new bw(this)}getSize(e){return $.resolve(this.size)}}class bw extends $N{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),$.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e){this.persistence=e,this.si=new hr(t=>Ri(t),Dl),this.lastRemoteSnapshotVersion=Ge.min(),this.highestTargetId=0,this.oi=0,this._i=new hf,this.targetCount=0,this.ai=Hi.ur()}forEachTarget(e,t){return this.si.forEach((s,r)=>t(r)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),$.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Hi(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Pr(t),$.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&s.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),$.waitFor(i).next(()=>r)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return $.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),$.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return $.resolve(s)}containsKey(e,t){return $.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,t){this.ui={},this.overlays={},this.ci=new As(0),this.li=!1,this.li=!0,this.hi=new hw,this.referenceDelegate=e(this),this.Pi=new Nw(this),this.indexManager=new sw,this.remoteDocumentCache=function(r){return new yw(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new PN(t),this.Ii=new fw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new pw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new gw(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){he("MemoryPersistence","Starting transaction:",e);const r=new xw(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return $.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,t)))}}class xw extends Cb{constructor(e){super(),this.currentSequenceNumber=e}}class Tu{constructor(e){this.persistence=e,this.Ri=new hf,this.Vi=null}static mi(e){return new Tu(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),$.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,s=>{const r=we.fromPath(s);return this.gi(e,r).next(i=>{i||t.removeEntry(r,Ge.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return $.or([()=>$.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class tu{constructor(e,t){this.persistence=e,this.pi=new hr(s=>ts(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=qN(this,t)}static mi(e,t){return new tu(e,t)}Ei(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}pr(e,t){return $.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?$.resolve():t(r)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(s++,i.removeEntry(o,Ge.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ac(e.data.value)),t}br(e,t,s){return $.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return $.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.serializer=e}k(e,t,s,r){const i=new Nu("createOrUpgrade",t);s<1&&r>=1&&(function(u){u.createObjectStore(_l)}(e),function(u){u.createObjectStore(ol,{keyPath:TE}),u.createObjectStore(Ps,{keyPath:ah,autoIncrement:!0}).createIndex(Di,lh,{unique:!0}),u.createObjectStore(Ro)}(e),Xh(e),function(u){u.createObjectStore(bi)}(e));let o=$.resolve();return s<3&&r>=3&&(s!==0&&(function(u){u.deleteObjectStore(Uo),u.deleteObjectStore(Bo),u.deleteObjectStore(Ai)}(e),Xh(e)),o=o.next(()=>function(u){const m=u.store(Ai),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ge.min().toTimestamp(),targetCount:0};return m.put(Wc,d)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(u,m){return m.store(Ps).J().next(f=>{u.deleteObjectStore(Ps),u.createObjectStore(Ps,{keyPath:ah,autoIncrement:!0}).createIndex(Di,lh,{unique:!0});const p=m.store(Ps),y=f.map(C=>p.put(C));return $.waitFor(y)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore(Ho,{keyPath:FE})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.yi(i))),s<6&&r>=6&&(o=o.next(()=>(function(u){u.createObjectStore(al)}(e),this.wi(i)))),s<7&&r>=7&&(o=o.next(()=>this.Si(i))),s<8&&r>=8&&(o=o.next(()=>this.bi(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Di(i))),s<11&&r>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(vu,{keyPath:OE})})(e),function(u){u.createObjectStore(_u,{keyPath:qE})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(u){const m=u.createObjectStore(Du,{keyPath:YE});m.createIndex(ed,XE,{unique:!1}),m.createIndex(Rb,JE,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(u){const m=u.createObjectStore(zc,{keyPath:LE});m.createIndex(kc,jE),m.createIndex(Tb,RE)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(bi))),s<14&&r>=14&&(o=o.next(()=>this.Fi(e,i))),s<15&&r>=15&&(o=o.next(()=>function(u){u.createObjectStore(Zd,{keyPath:$E,autoIncrement:!0}).createIndex(Zm,zE,{unique:!1}),u.createObjectStore($a,{keyPath:WE}).createIndex(Lb,KE,{unique:!1}),u.createObjectStore(za,{keyPath:GE}).createIndex(jb,QE,{unique:!1})}(e))),s<16&&r>=16&&(o=o.next(()=>{t.objectStore($a).clear()}).next(()=>{t.objectStore(za).clear()})),s<17&&r>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(ef,{keyPath:ZE})})(e)})),s<18&&r>=18&&sb()&&(o=o.next(()=>{t.objectStore($a).clear()}).next(()=>{t.objectStore(za).clear()})),o}wi(e){let t=0;return e.store(bi).ee((s,r)=>{t+=eu(r)}).next(()=>{const s={byteSize:t};return e.store(al).put(Jm,s)})}yi(e){const t=e.store(ol),s=e.store(Ps);return t.J().next(r=>$.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,Ei],[i.userId,i.lastAcknowledgedBatchId]);return s.J(Di,o).next(l=>$.forEach(l,u=>{Me(u.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const m=xi(this.serializer,u);return HN(e,i.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(Uo),s=e.store(bi);return e.store(Ai).get(Wc).next(r=>{const i=[];return s.ee((o,l)=>{const u=new Ut(o),m=function(f){return[0,ts(f)]}(u);i.push(t.get(m).next(d=>d?$.resolve():(f=>t.put({targetId:0,path:ts(f),sequenceNumber:r.highestListenSequenceNumber}))(u)))}).next(()=>$.waitFor(i))})}bi(e,t){e.createObjectStore(ll,{keyPath:ME});const s=t.store(ll),r=new pf,i=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return s.put({collectionId:l,parent:ts(u)})}};return t.store(bi).ee({X:!0},(o,l)=>{const u=new Ut(o);return i(u.popLast())}).next(()=>t.store(Ro).ee({X:!0},([o,l,u],m)=>{const d=Qs(l);return i(d.popLast())}))}Di(e){const t=e.store(Bo);return t.ee((s,r)=>{const i=Ba(r),o=LN(this.serializer,i);return t.put(o)})}Ci(e,t){const s=t.store(bi),r=[];return s.ee((i,o)=>{const l=t.store(zc),u=function(f){return f.document?new we(Ut.fromString(f.document.name).popFirst(5)):f.noDocument?we.fromSegments(f.noDocument.path):f.unknownDocument?we.fromSegments(f.unknownDocument.path):Pe(36783)}(o).path.toArray(),m={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(m))}).next(()=>$.waitFor(r))}Fi(e,t){const s=t.store(Ps),r=zN(this.serializer),i=new gf(Tu.mi,this.serializer.yt);return s.J().next(o=>{const l=new Map;return o.forEach(u=>{let m=l.get(u.userId)??bt();xi(this.serializer,u).keys().forEach(d=>m=m.add(d)),l.set(u.userId,m)}),$.forEach(l,(u,m)=>{const d=new $n(m),f=Iu.wt(this.serializer,d),p=i.getIndexManager(d),y=Su.wt(d,this.serializer,p,i.referenceDelegate);return new WN(r,y,f,p).recalculateAndSaveOverlaysForDocumentKeys(new td(t,As.ce),u).next()})})}}function Xh(n){n.createObjectStore(Uo,{keyPath:UE}).createIndex(Jd,HE,{unique:!0}),n.createObjectStore(Bo,{keyPath:"targetId"}).createIndex(Pb,BE,{unique:!0}),n.createObjectStore(Ai)}const wr="IndexedDbPersistence",ym=18e5,bm=5e3,Nm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",_w="main";class yf{constructor(e,t,s,r,i,o,l,u,m,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=i,this.window=o,this.document=l,this.xi=m,this.Oi=d,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=p=>Promise.resolve(),!yf.v())throw new _e(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new cw(this,r),this.$i=t+_w,this.serializer=new PN(u),this.Ui=new zr(this.$i,this.Ni,new vw(this.serializer)),this.hi=new XA,this.Pi=new iw(this.referenceDelegate,this.serializer),this.remoteDocumentCache=zN(this.serializer),this.Ii=new YA,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&os(wr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _e(se.FAILED_PRECONDITION,Nm);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new As(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Zl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(ei(e))return he(wr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return he(wr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ba(e).get(eo).next(t=>$.resolve(this.es(t)))}ts(e){return Zl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,ym)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const s=Bn(t,Ho);return s.J().next(r=>{const i=this.ss(r,ym),o=r.filter(l=>i.indexOf(l)===-1);return $.forEach(o,l=>s.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):ba(e).get(eo).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,bm)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new _e(se.FAILED_PRECONDITION,Nm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Zl(e).J().next(s=>this.ss(s,bm).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&he(wr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[_l,Ho],e=>{const t=new td(e,As.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Zl(e).J().next(t=>this.ss(t,ym).map(s=>s.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Su.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new rw(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Iu.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){he(wr,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",i=function(u){return u===18?nA:u===17?Mb:u===16?tA:u===15?tf:u===14?Hb:u===13?Ub:u===12?eA:u===11?Bb:void Pe(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,r,i,l=>(o=new td(l,this.ci?this.ci.next():As.ce),t==="readwrite-primary"?this.Hi(o).next(u=>!!u||this.Yi(o)).next(u=>{if(!u)throw os(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new _e(se.FAILED_PRECONDITION,Vb);return s(o)}).next(u=>this.Xi(o).next(()=>u)):this.Is(o).next(()=>s(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Is(e){return ba(e).get(eo).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,bm)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new _e(se.FAILED_PRECONDITION,Nm)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ba(e).put(eo,t)}static v(){return zr.v()}Zi(e){const t=ba(e);return t.get(eo).next(s=>this.es(s)?(he(wr,"Releasing primary lease."),t.delete(eo)):$.resolve())}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(os(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;nb()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const s=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return he(wr,`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return os(wr,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){os("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ba(n){return Bn(n,_l)}function Zl(n){return Bn(n,Ho)}function Dw(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=bt(),r=bt();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new bf(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return nb()?8:Ib(Mc())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new kw;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,s,r){return s.documentReadCount<this.fs?(_o()<=Ct.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",Do(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(_o()<=Ct.DEBUG&&he("QueryEngine","Query:",Do(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(_o()<=Ct.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",Do(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ws(t))):$.resolve())}ys(e,t){if(vh(t))return $.resolve(null);let s=ws(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=ld(t,null,"F"),s=ws(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=bt(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,ld(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,s,r){return vh(t)||r.isEqual(Ge.min())?$.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,s,r)?$.resolve(null):(_o()<=Ct.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Do(t)),this.vs(e,o,t,EE(r,sl)).next(l=>l))})}Ds(e,t){let s=new Wt(oN(e));return t.forEach((r,i)=>{El(e,i)&&(s=s.add(i))}),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return _o()<=Ct.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",Do(t)),this.ps.getDocumentsMatchingQuery(e,t,bs.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="LocalStore",Ew=3e8;class Aw{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ln(it),this.xs=new hr(i=>Ri(i),Dl),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WN(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function GN(n,e,t,s){return new Aw(n,e,t,s)}async function QN(n,e){const t=ot(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],l=[];let u=bt();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(s,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function ww(n,e){const t=ot(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,p=f.keys();let y=$.resolve();return p.forEach(C=>{y=y.next(()=>d.getEntry(u,C)).next(v=>{const w=m.docVersions.get(C);Me(w!==null,48541),v.version.compareTo(w)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let u=bt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}function YN(n){const e=ot(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function Vw(n,e){const t=ot(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const p=r.get(f);if(!p)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Sn.EMPTY_BYTE_STRING,Ge.min()).withLastLimboFreeSnapshotVersion(Ge.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(f,y),function(v,w,R){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=Ew?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(p,y,d)&&l.push(t.Pi.updateTargetData(i,y))});let u=gs(),m=bt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(Cw(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!s.isEqual(Ge.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));l.push(d)}return $.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function Cw(n,e,t){let s=bt(),r=bt();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=gs();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(Ge.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):he(Nf,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function Iw(n,e){const t=ot(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=Ei),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function Sw(n,e){const t=ot(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.Pi.getTargetData(s,e).next(i=>i?(r=i,$.resolve(r)):t.Pi.allocateTargetId(s).next(o=>(r=new cr(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s})}async function gd(n,e,t){const s=ot(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!ei(o))throw o;he(Nf,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Jh(n,e,t){const s=ot(n);let r=Ge.min(),i=bt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=ot(u),p=f.xs.get(d);return p!==void 0?$.resolve(f.Ms.get(p)):f.Pi.getTargetData(m,d)}(s,o,ws(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,t?r:Ge.min(),t?i:bt())).next(l=>(Tw(s,yA(e),l),{documents:l,Qs:i})))}function Tw(n,e,t){let s=n.Os.get(e)||Ge.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.Os.set(e,s)}class Zh{constructor(){this.activeTargetIds=DA()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XN{constructor(){this.Mo=new Zh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Zh,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eg="ConnectivityMonitor";class tg{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){he(eg,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){he(eg,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ec=null;function yd(){return ec===null?ec=function(){return 268435456+Math.round(2147483648*Math.random())}():ec++,"0x"+ec.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xm="RestConnection",Lw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class jw{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Kc?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const o=yd(),l=this.zo(e,t.toUriEncodedString());he(xm,`Sending RPC '${e}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=xl(m);return this.Jo(e,l,u,s,d).then(f=>(he(xm,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Li(xm,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",s),f})}Ho(e,t,s,r,i,o){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const s=Lw[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn="WebChannelConnection";class Bw extends jw{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const o=yd();return new Promise((l,u)=>{const m=new yb;m.setWithCredentials(!0),m.listenOnce(bb.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case vc.NO_ERROR:const f=m.getResponseJson();he(Yn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case vc.TIMEOUT:he(Yn,`RPC '${e}' ${o} timed out`),u(new _e(se.DEADLINE_EXCEEDED,"Request time out"));break;case vc.HTTP_ERROR:const p=m.getStatus();if(he(Yn,`RPC '${e}' ${o} failed with status:`,p,"response text:",m.getResponseText()),p>0){let y=m.getResponseJson();Array.isArray(y)&&(y=y[0]);const C=y==null?void 0:y.error;if(C&&C.status&&C.message){const v=function(R){const I=R.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(I)>=0?I:se.UNKNOWN}(C.status);u(new _e(v,C.message))}else u(new _e(se.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new _e(se.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{he(Yn,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);he(Yn,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,s,15)})}T_(e,t,s){const r=yd(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=vb(),l=xb(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,s),u.encodeInitMessageHeaders=!0;const d=i.join("");he(Yn,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let p=!1,y=!1;const C=new Rw({Yo:w=>{y?he(Yn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(p||(he(Yn,`Opening RPC '${e}' stream ${r} transport.`),f.open(),p=!0),he(Yn,`RPC '${e}' stream ${r} sending:`,w),f.send(w))},Zo:()=>f.close()}),v=(w,R,I)=>{w.listen(R,F=>{try{I(F)}catch(re){setTimeout(()=>{throw re},0)}})};return v(f,La.EventType.OPEN,()=>{y||(he(Yn,`RPC '${e}' stream ${r} transport opened.`),C.o_())}),v(f,La.EventType.CLOSE,()=>{y||(y=!0,he(Yn,`RPC '${e}' stream ${r} transport closed`),C.a_(),this.E_(f))}),v(f,La.EventType.ERROR,w=>{y||(y=!0,Li(Yn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),C.a_(new _e(se.UNAVAILABLE,"The operation could not be completed")))}),v(f,La.EventType.MESSAGE,w=>{var R;if(!y){const I=w.data[0];Me(!!I,16349);const F=I,re=(F==null?void 0:F.error)||((R=F[0])==null?void 0:R.error);if(re){he(Yn,`RPC '${e}' stream ${r} received error:`,re);const ee=re.status;let M=function(V){const j=kn[V];if(j!==void 0)return NN(j)}(ee),A=re.message;M===void 0&&(M=se.INTERNAL,A="Unknown error status: "+ee+" with message "+re.message),y=!0,C.a_(new _e(M,A)),f.close()}else he(Yn,`RPC '${e}' stream ${r} received:`,I),C.u_(I)}}),v(l,Nb.STAT_EVENT,w=>{w.stat===Qm.PROXY?he(Yn,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===Qm.NOPROXY&&he(Yn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(){return typeof window<"u"?window:null}function Sc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(n){return new HA(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&he("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng="PersistentStream";class ZN{constructor(e,t,s,r,i,o,l,u){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new JN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(os(t.toString()),os("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===t&&this.G_(s,r)},s=>{e(()=>{const r=new _e(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return he(ng,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(he(ng,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Hw extends ZN{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=OA(this.serializer,e),s=function(i){if(!("targetChange"in i))return Ge.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ge.min():o.readTime?as(o.readTime):Ge.min()}(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=md(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=Gc(u)?{documents:wN(i,u)}:{query:VN(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=_N(i,o.resumeToken);const m=cd(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(Ge.min())>0){l.readTime=Ko(i,o.snapshotVersion.toTimestamp());const m=cd(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const s=$A(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=md(this.serializer),t.removeTarget=e,this.q_(t)}}class Mw extends ZN{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Me(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Me(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=qA(e.writeResults,e.commitTime),s=as(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=md(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>Xc(this.serializer,s))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{}class Ow extends Fw{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new _e(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,ud(t,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new _e(se.UNKNOWN,i.toString())})}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,ud(t,s),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new _e(se.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class qw{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(os(t),this.aa=!1):he("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi="RemoteStore";class $w{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{zi(this)&&(he(Mi,"Restarting streams for network reachability change."),await async function(u){const m=ot(u);m.Ea.add(4),await Vl(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Lu(m)}(this))})}),this.Ra=new qw(s,r)}}async function Lu(n){if(zi(n))for(const e of n.da)await e(!0)}async function Vl(n){for(const e of n.da)await e(!1)}function e0(n,e){const t=ot(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Df(t)?_f(t):ta(t).O_()&&vf(t,e))}function xf(n,e){const t=ot(n),s=ta(t);t.Ia.delete(e),s.O_()&&t0(t,e),t.Ia.size===0&&(s.O_()?s.L_():zi(t)&&t.Ra.set("Unknown"))}function vf(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ge.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ta(n).Y_(e)}function t0(n,e){n.Va.Ue(e),ta(n).Z_(e)}function _f(n){n.Va=new jA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ta(n).start(),n.Ra.ua()}function Df(n){return zi(n)&&!ta(n).x_()&&n.Ia.size>0}function zi(n){return ot(n).Ea.size===0}function n0(n){n.Va=void 0}async function zw(n){n.Ra.set("Online")}async function Ww(n){n.Ia.forEach((e,t)=>{vf(n,e)})}async function Kw(n,e){n0(n),Df(n)?(n.Ra.ha(e),_f(n)):n.Ra.set("Unknown")}async function Gw(n,e,t){if(n.Ra.set("Online"),e instanceof vN&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(n,e)}catch(s){he(Mi,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await nu(n,s)}else if(e instanceof Cc?n.Va.Ze(e):e instanceof xN?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ge.min()))try{const s=await YN(n.localStore);t.compareTo(s)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(Sn.EMPTY_BYTE_STRING,d.snapshotVersion)),t0(i,u);const f=new cr(d.target,u,m,d.sequenceNumber);vf(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(s){he(Mi,"Failed to raise snapshot:",s),await nu(n,s)}}async function nu(n,e,t){if(!ei(e))throw e;n.Ea.add(1),await Vl(n),n.Ra.set("Offline"),t||(t=()=>YN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{he(Mi,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Lu(n)})}function s0(n,e){return e().catch(t=>nu(n,t,e))}async function Cl(n){const e=ot(n),t=Qr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ei;for(;Qw(e);)try{const r=await Iw(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,Yw(e,r)}catch(r){await nu(e,r)}r0(e)&&i0(e)}function Qw(n){return zi(n)&&n.Ta.length<10}function Yw(n,e){n.Ta.push(e);const t=Qr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function r0(n){return zi(n)&&!Qr(n).x_()&&n.Ta.length>0}function i0(n){Qr(n).start()}async function Xw(n){Qr(n).ra()}async function Jw(n){const e=Qr(n);for(const t of n.Ta)e.ea(t.mutations)}async function Zw(n,e,t){const s=n.Ta.shift(),r=cf.from(s,e,t);await s0(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Cl(n)}async function eV(n,e){e&&Qr(n).X_&&await async function(s,r){if(function(o){return TA(o)&&o!==se.ABORTED}(r.code)){const i=s.Ta.shift();Qr(s).B_(),await s0(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Cl(s)}}(n,e),r0(n)&&i0(n)}async function sg(n,e){const t=ot(n);t.asyncQueue.verifyOperationInProgress(),he(Mi,"RemoteStore received new credentials");const s=zi(t);t.Ea.add(3),await Vl(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Lu(t)}async function tV(n,e){const t=ot(n);e?(t.Ea.delete(2),await Lu(t)):e||(t.Ea.add(2),await Vl(t),t.Ra.set("Unknown"))}function ta(n){return n.ma||(n.ma=function(t,s,r){const i=ot(t);return i.sa(),new Hw(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:zw.bind(null,n),t_:Ww.bind(null,n),r_:Kw.bind(null,n),H_:Gw.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),Df(n)?_f(n):n.Ra.set("Unknown")):(await n.ma.stop(),n0(n))})),n.ma}function Qr(n){return n.fa||(n.fa=function(t,s,r){const i=ot(t);return i.sa(),new Mw(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Xw.bind(null,n),r_:eV.bind(null,n),ta:Jw.bind(null,n),na:Zw.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Cl(n)):(await n.fa.stop(),n.Ta.length>0&&(he(Mi,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Js,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,l=new kf(e,t,o,r,i);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _e(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ef(n,e){if(os("AsyncQueue",`${e}: ${n}`),ei(n))return new _e(se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{static emptySet(e){return new Po(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||we.comparator(t.key,s.key):(t,s)=>we.comparator(t.key,s.key),this.keyedMap=ja(),this.sortedSet=new ln(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Po)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Po;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this.ga=new ln(we.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Pe(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,s)=>{e.push(s)}),e}}class Go{constructor(e,t,s,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Go(e,t,Po.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Au(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class sV{constructor(){this.queries=ig(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=ot(t),i=r.queries;r.queries=ig(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(s)})})(this,new _e(se.ABORTED,"Firestore shutting down"))}}function ig(){return new hr(n=>iN(n),Au)}async function Af(n,e){const t=ot(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new nV,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=Ef(o,`Initialization of query '${Do(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Vf(t)}async function wf(n,e){const t=ot(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function rV(n,e){const t=ot(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(s=!0);o.wa=r}}s&&Vf(t)}function iV(n,e,t){const s=ot(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function Vf(n){n.Ca.forEach(e=>{e.next()})}var bd,og;(og=bd||(bd={})).Ma="default",og.Cache="cache";class Cf{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Go(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Go.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==bd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e){this.key=e}}class a0{constructor(e){this.key=e}}class oV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=bt(),this.mutatedKeys=bt(),this.eu=oN(e),this.tu=new Po(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new rg,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const p=r.get(d),y=El(this.query,f)?f:null,C=!!p&&this.mutatedKeys.has(p.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;p&&y?p.data.isEqual(y.data)?C!==v&&(s.track({type:3,doc:y}),w=!0):this.su(p,y)||(s.track({type:2,doc:y}),w=!0,(u&&this.eu(y,u)>0||m&&this.eu(y,m)<0)&&(l=!0)):!p&&y?(s.track({type:0,doc:y}),w=!0):p&&!y&&(s.track({type:1,doc:p}),w=!0,(u||m)&&(l=!0)),w&&(y?(o=o.add(y),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:o,iu:s,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(y,C){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:w})}};return v(y)-v(C)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(s),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new Go(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rg,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=bt(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const t=[];return e.forEach(s=>{this.Xa.has(s)||t.push(new a0(s))}),this.Xa.forEach(s=>{e.has(s)||t.push(new o0(s))}),t}cu(e){this.Ya=e.Qs,this.Xa=bt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Go.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const If="SyncEngine";class aV{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class lV{constructor(e){this.key=e,this.hu=!1}}class cV{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new hr(l=>iN(l),Au),this.Iu=new Map,this.Eu=new Set,this.du=new ln(we.comparator),this.Au=new Map,this.Ru=new hf,this.Vu={},this.mu=new Map,this.fu=Hi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function uV(n,e,t=!0){const s=f0(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await l0(s,e,t,!0),r}async function mV(n,e){const t=f0(n);await l0(t,e,!0,!1)}async function l0(n,e,t,s){const r=await Sw(n.localStore,ws(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let l;return s&&(l=await dV(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&e0(n.remoteStore,r),l}async function dV(n,e,t,s,r){n.pu=(f,p,y)=>async function(v,w,R,I){let F=w.view.ru(R);F.Cs&&(F=await Jh(v.localStore,w.query,!1).then(({documents:A})=>w.view.ru(A,F)));const re=I&&I.targetChanges.get(w.targetId),ee=I&&I.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(F,v.isPrimaryClient,re,ee);return lg(v,w.targetId,M.au),M.snapshot}(n,f,p,y);const i=await Jh(n.localStore,e,!0),o=new oV(e,i.Qs),l=o.ru(i.documents),u=wl.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),m=o.applyChanges(l,n.isPrimaryClient,u);lg(n,t,m.au);const d=new aV(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function fV(n,e,t){const s=ot(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!Au(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await gd(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),t&&xf(s.remoteStore,r.targetId),Nd(s,r.targetId)}).catch($i)):(Nd(s,r.targetId),await gd(s.localStore,r.targetId,!0))}async function pV(n,e){const t=ot(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),xf(t.remoteStore,s.targetId))}async function hV(n,e,t){const s=p0(n);try{const r=await function(o,l){const u=ot(o),m=be.now(),d=l.reduce((y,C)=>y.add(C.key),bt());let f,p;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let C=gs(),v=bt();return u.Ns.getEntries(y,d).next(w=>{C=w,C.forEach((R,I)=>{I.isValidDocument()||(v=v.add(R))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,C)).next(w=>{f=w;const R=[];for(const I of l){const F=IA(I,f.get(I.key).overlayedDocument);F!=null&&R.push(new gr(I.key,F,Yb(F.value.mapValue),Rn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,m,R,l)}).next(w=>{p=w;const R=w.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(y,w.batchId,R)})}).then(()=>({batchId:p.batchId,changes:lN(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new ln(it)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(s,r.batchId,t),await Il(s,r.changes),await Cl(s.remoteStore)}catch(r){const i=Ef(r,"Failed to persist write");t.reject(i)}}async function c0(n,e){const t=ot(n);try{const s=await Vw(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Me(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Me(o.hu,14607):r.removedDocuments.size>0&&(Me(o.hu,42227),o.hu=!1))}),await Il(t,s,e)}catch(s){await $i(s)}}function ag(n,e,t){const s=ot(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=ot(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const p of f.Sa)p.va(l)&&(m=!0)}),m&&Vf(u)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function gV(n,e,t){const s=ot(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new ln(we.comparator);o=o.insert(i,pn.newNoDocument(i,Ge.min()));const l=bt().add(i),u=new Cu(Ge.min(),new Map,new ln(it),o,l);await c0(s,u),s.du=s.du.remove(i),s.Au.delete(e),Sf(s)}else await gd(s.localStore,e,!1).then(()=>Nd(s,e,t)).catch($i)}async function yV(n,e){const t=ot(n),s=e.batch.batchId;try{const r=await ww(t.localStore,e);m0(t,s,null),u0(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Il(t,r)}catch(r){await $i(r)}}async function bV(n,e,t){const s=ot(n);try{const r=await function(o,l){const u=ot(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Me(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(s.localStore,e);m0(s,e,t),u0(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Il(s,r)}catch(r){await $i(r)}}function u0(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function m0(n,e,t){const s=ot(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Nd(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(s=>{n.Ru.containsKey(s)||d0(n,s)})}function d0(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(xf(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Sf(n))}function lg(n,e,t){for(const s of t)s instanceof o0?(n.Ru.addReference(s.key,e),NV(n,s)):s instanceof a0?(he(If,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||d0(n,s.key)):Pe(19791,{wu:s})}function NV(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(he(If,"New document in limbo: "+t),n.Eu.add(s),Sf(n))}function Sf(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new we(Ut.fromString(e)),s=n.fu.next();n.Au.set(s,new lV(t)),n.du=n.du.insert(t,s),e0(n.remoteStore,new cr(ws(kl(t.path)),s,"TargetPurposeLimboResolution",As.ce))}}async function Il(n,e,t){const s=ot(n),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((l,u)=>{o.push(s.pu(u,e,t).then(m=>{var d;if((m||t)&&s.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=bf.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(u,m){const d=ot(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>$.forEach(m,p=>$.forEach(p.Es,y=>d.persistence.referenceDelegate.addReference(f,p.targetId,y)).next(()=>$.forEach(p.ds,y=>d.persistence.referenceDelegate.removeReference(f,p.targetId,y)))))}catch(f){if(!ei(f))throw f;he(Nf,"Failed to update sequence numbers: "+f)}for(const f of m){const p=f.targetId;if(!f.fromCache){const y=d.Ms.get(p),C=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(C);d.Ms=d.Ms.insert(p,v)}}}(s.localStore,i))}async function xV(n,e){const t=ot(n);if(!t.currentUser.isEqual(e)){he(If,"User change. New user:",e.toKey());const s=await QN(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new _e(se.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Il(t,s.Ls)}}function vV(n,e){const t=ot(n),s=t.Au.get(e);if(s&&s.hu)return bt().add(s.key);{let r=bt();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function f0(n){const e=ot(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=c0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gV.bind(null,e),e.Pu.H_=rV.bind(null,e.eventManager),e.Pu.yu=iV.bind(null,e.eventManager),e}function p0(n){const e=ot(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bV.bind(null,e),e}class hl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return GN(this.persistence,new KN,e.initialUser,this.serializer)}Cu(e){return new gf(Tu.mi,this.serializer)}Du(e){return new XN}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hl.provider={build:()=>new hl};class _V extends hl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Me(this.persistence.referenceDelegate instanceof tu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new ON(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new gf(s=>tu.mi(s,t),this.serializer)}}class DV extends hl{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await p0(this.xu.syncEngine),await Cl(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return GN(this.persistence,new KN,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new ON(s,e.asyncQueue,t)}Mu(e,t){const s=new CE(t,this.persistence);return new VE(e.asyncQueue,s)}Cu(e){const t=Dw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new yf(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,Uw(),Sc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new XN}}class su{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>ag(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=xV.bind(null,this.syncEngine),await tV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new sV}()}createDatastore(e){const t=Pu(e.databaseInfo.databaseId),s=function(i){return new Bw(i)}(e.databaseInfo);return function(i,o,l,u){return new Ow(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,o,l){return new $w(s,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>ag(this.syncEngine,t,0),function(){return tg.v()?new tg:new Pw}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new cV(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=ot(r);he(Mi,"RemoteStore shutting down."),i.Ea.add(5),await Vl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}su.provider={build:()=>new su};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):os("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="FirestoreClient";class kV{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=$n.UNAUTHENTICATED,this.clientId=Qd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{he(Yr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(he(Yr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Js;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Ef(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function vm(n,e){n.asyncQueue.verifyOperationInProgress(),he(Yr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await QN(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function cg(n,e){n.asyncQueue.verifyOperationInProgress();const t=await EV(n);he(Yr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>sg(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,r)=>sg(e.remoteStore,r)),n._onlineComponents=e}async function EV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){he(Yr,"Using user provided OfflineComponentProvider");try{await vm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Li("Error using user provided cache. Falling back to memory cache: "+t),await vm(n,new hl)}}else he(Yr,"Using default OfflineComponentProvider"),await vm(n,new _V(void 0));return n._offlineComponents}async function h0(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(he(Yr,"Using user provided OnlineComponentProvider"),await cg(n,n._uninitializedComponentsProvider._online)):(he(Yr,"Using default OnlineComponentProvider"),await cg(n,new su))),n._onlineComponents}function AV(n){return h0(n).then(e=>e.syncEngine)}async function ru(n){const e=await h0(n),t=e.eventManager;return t.onListen=uV.bind(null,e.syncEngine),t.onUnlisten=fV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=pV.bind(null,e.syncEngine),t}function wV(n,e,t={}){const s=new Js;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Tf({next:p=>{d.Nu(),o.enqueueAndForget(()=>wf(i,f));const y=p.docs.has(l);!y&&p.fromCache?m.reject(new _e(se.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&p.fromCache&&u&&u.source==="server"?m.reject(new _e(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(p)},error:p=>m.reject(p)}),f=new Cf(kl(l.path),d,{includeMetadataChanges:!0,qa:!0});return Af(i,f)}(await ru(n),n.asyncQueue,e,t,s)),s.promise}function VV(n,e,t={}){const s=new Js;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Tf({next:p=>{d.Nu(),o.enqueueAndForget(()=>wf(i,f)),p.fromCache&&u.source==="server"?m.reject(new _e(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(p)},error:p=>m.reject(p)}),f=new Cf(l,d,{includeMetadataChanges:!0,qa:!0});return Af(i,f)}(await ru(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="firestore.googleapis.com",mg=!0;class dg{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new _e(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=y0,this.ssl=mg}else this.host=e.host,this.ssl=e.ssl??mg;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=UN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ow)throw new _e(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=g0(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ju{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dg({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _e(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new _e(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dg(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new pE;switch(s.type){case"firstParty":return new bE(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new _e(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=ug.get(t);s&&(he("ComponentProvider","Removing Datastore"),ug.delete(t),s.terminate())}(this),Promise.resolve()}}function CV(n,e,t,s={}){var m;n=es(n,ju);const r=xl(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(Jy(`https://${l}`),eb("Firestore",!0)),i.host!==y0&&i.host!==l&&Li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:s};if(!Fc(u,o)&&(n._setSettings(u),s.mockUserToken)){let d,f;if(typeof s.mockUserToken=="string")d=s.mockUserToken,f=$n.MOCK_USER;else{d=Zy(s.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const p=s.mockUserToken.sub||s.mockUserToken.user_id;if(!p)throw new _e(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new $n(p)}n._authCredentials=new hE(new Db(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new ni(this.firestore,e,this._query)}}class hn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}toJSON(){return{type:hn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(vl(t,hn._jsonSchema))return new hn(e,s||null,new we(Ut.fromString(t.referencePath)))}}hn._jsonSchemaVersion="firestore/documentReference/1.0",hn._jsonSchema={type:Cn("string",hn._jsonSchemaVersion),referencePath:Cn("string")};class Wr extends ni{constructor(e,t,s){super(e,t,kl(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new we(e))}withConverter(e){return new Wr(this.firestore,e,this._path)}}function Qe(n,e,...t){if(n=Gn(n),Eb("collection","path",e),n instanceof ju){const s=Ut.fromString(e,...t);return nh(s),new Wr(n,null,s)}{if(!(n instanceof hn||n instanceof Wr))throw new _e(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ut.fromString(e,...t));return nh(s),new Wr(n.firestore,null,s)}}function Te(n,e,...t){if(n=Gn(n),arguments.length===1&&(e=Qd.newId()),Eb("doc","path",e),n instanceof ju){const s=Ut.fromString(e,...t);return th(s),new hn(n,null,new we(s))}{if(!(n instanceof hn||n instanceof Wr))throw new _e(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ut.fromString(e,...t));return th(s),new hn(n.firestore,n instanceof Wr?n.converter:null,new we(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg="AsyncQueue";class pg{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new JN(this,"async_queue_retry"),this._c=()=>{const s=Sc();s&&he(fg,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=Sc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Sc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Js;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ei(e))throw e;he(fg,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,os("INTERNAL UNHANDLED ERROR: ",hg(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=kf.createAndSchedule(this,e,t,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Pe(47125,{Pc:hg(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function hg(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}class Hs extends ju{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new pg,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pg(e),this._firestoreClient=void 0,await e}}}function IV(n,e){const t=typeof n=="object"?n:fb(),s=typeof n=="string"?n:Kc,r=cb(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Yy("firestore");i&&CV(r,...i)}return r}function Sl(n){if(n._terminated)throw new _e(se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||b0(n),n._firestoreClient}function b0(n){var s,r,i;const e=n._freezeSettings(),t=function(l,u,m,d){return new rA(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,g0(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new kV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(n._componentsProvider))}function SV(n,e){Li("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return TV(n,su.provider,{build:s=>new DV(s,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function TV(n,e,t){if((n=es(n,Hs))._firestoreClient||n._terminated)throw new _e(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new _e(se.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},b0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ks(Sn.fromBase64String(e))}catch(t){throw new _e(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ks(Sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ks._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vl(e,ks._jsonSchema))return ks.fromBase64String(e.bytes)}}ks._jsonSchemaVersion="firestore/bytes/1.0",ks._jsonSchema={type:Cn("string",ks._jsonSchemaVersion),bytes:Cn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new _e(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _e(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _e(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return it(this._lat,e._lat)||it(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Zs._jsonSchemaVersion}}static fromJSON(e){if(vl(e,Zs._jsonSchema))return new Zs(e.latitude,e.longitude)}}Zs._jsonSchemaVersion="firestore/geoPoint/1.0",Zs._jsonSchema={type:Cn("string",Zs._jsonSchemaVersion),latitude:Cn("number"),longitude:Cn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:er._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vl(e,er._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new er(e.vectorValues);throw new _e(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}er._jsonSchemaVersion="firestore/vectorValue/1.0",er._jsonSchema={type:Cn("string",er._jsonSchemaVersion),vectorValues:Cn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PV=/^__.*__$/;class LV{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new gr(e,this.data,this.fieldMask,t,this.fieldTransforms):new ea(e,this.data,t,this.fieldTransforms)}}class N0{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new gr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function x0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:n})}}class Pf{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Pf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return iu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(x0(this.Ac)&&PV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class jV{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Pu(e)}Cc(e,t,s,r=!1){return new Pf({Ac:e,methodName:t,Dc:s,path:dn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pl(n){const e=n._freezeSettings(),t=Pu(n._databaseId);return new jV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Lf(n,e,t,s,r,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);Rf("Data must be an object, but it was:",o,s);const l=D0(s,o);let u,m;if(i.merge)u=new ds(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const p=xd(e,f,t);if(!o.contains(p))throw new _e(se.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);E0(d,p)||d.push(p)}u=new ds(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new LV(new Zn(l),u,m)}class Bu extends Ru{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bu}}class jf extends Ru{_toFieldTransform(e){return new hN(e.path,new $o)}isEqual(e){return e instanceof jf}}function v0(n,e,t,s){const r=n.Cc(1,e,t);Rf("Data must be an object, but it was:",r,s);const i=[],o=Zn.empty();ti(s,(u,m)=>{const d=Bf(e,u,t);m=Gn(m);const f=r.yc(d);if(m instanceof Bu)i.push(d);else{const p=Ll(m,f);p!=null&&(i.push(d),o.set(d,p))}});const l=new ds(i);return new N0(o,l,r.fieldTransforms)}function _0(n,e,t,s,r,i){const o=n.Cc(1,e,t),l=[xd(e,s,t)],u=[r];if(i.length%2!=0)throw new _e(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(xd(e,i[p])),u.push(i[p+1]);const m=[],d=Zn.empty();for(let p=l.length-1;p>=0;--p)if(!E0(m,l[p])){const y=l[p];let C=u[p];C=Gn(C);const v=o.yc(y);if(C instanceof Bu)m.push(y);else{const w=Ll(C,v);w!=null&&(m.push(y),d.set(y,w))}}const f=new ds(m);return new N0(d,f,o.fieldTransforms)}function RV(n,e,t,s=!1){return Ll(t,n.Cc(s?4:3,e))}function Ll(n,e){if(k0(n=Gn(n)))return Rf("Unsupported field value:",e,n),D0(n,e);if(n instanceof Ru)return function(s,r){if(!x0(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const l of s){let u=Ll(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=Gn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return kA(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=be.fromDate(s);return{timestampValue:Ko(r.serializer,i)}}if(s instanceof be){const i=new be(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ko(r.serializer,i)}}if(s instanceof Zs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ks)return{bytesValue:_N(r.serializer,s._byteString)};if(s instanceof hn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:df(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof er)return function(o,l){return{mapValue:{fields:{[sf]:{stringValue:rf},[Mo]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return af(l.serializer,m)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${bu(s)}`)}(n,e)}function D0(n,e){const t={};return Fb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ti(n,(s,r)=>{const i=Ll(r,e.mc(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function k0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof be||n instanceof Zs||n instanceof ks||n instanceof hn||n instanceof Ru||n instanceof er)}function Rf(n,e,t){if(!k0(t)||!Ab(t)){const s=bu(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function xd(n,e,t){if((e=Gn(e))instanceof Tl)return e._internalPath;if(typeof e=="string")return Bf(n,e);throw iu("Field path arguments must be of type string or ",n,!1,void 0,t)}const BV=new RegExp("[~\\*/\\[\\]]");function Bf(n,e,t){if(e.search(BV)>=0)throw iu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Tl(...e.split("."))._internalPath}catch{throw iu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function iu(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${s}`),o&&(u+=` in document ${r}`),u+=")"),new _e(se.INVALID_ARGUMENT,l+n+u)}function E0(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new UV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Uu("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class UV extends A0{data(){return super.data()}}function Uu(n,e){return typeof e=="string"?Bf(n,e):e instanceof Tl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new _e(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Uf{}class V0 extends Uf{}function _t(n,e,...t){let s=[];e instanceof Uf&&s.push(e),s=s.concat(t),function(i){const o=i.filter(u=>u instanceof Hf).length,l=i.filter(u=>u instanceof Hu).length;if(o>1||o>0&&l>0)throw new _e(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class Hu extends V0{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Hu(e,t,s)}_apply(e){const t=this._parse(e);return C0(e._query,t),new ni(e.firestore,e.converter,ad(e._query,t))}_parse(e){const t=Pl(e.firestore);return function(i,o,l,u,m,d,f){let p;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new _e(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){bg(f,d);const C=[];for(const v of f)C.push(yg(u,i,v));p={arrayValue:{values:C}}}else p=yg(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||bg(f,d),p=RV(l,o,f,d==="in"||d==="not-in");return Dt.create(m,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Wn(n,e,t){const s=e,r=Uu("where",n);return Hu._create(r,s,t)}class Hf extends Uf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Hf(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:zt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)C0(o,u),o=ad(o,u)}(e._query,t),new ni(e.firestore,e.converter,ad(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Mf extends V0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Mf(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new _e(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new _e(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fl(i,o)}(e._query,this._field,this._direction);return new ni(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Zo(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Jt(n,e="asc"){const t=e,s=Uu("orderBy",n);return Mf._create(s,t)}function yg(n,e,t){if(typeof(t=Gn(t))=="string"){if(t==="")throw new _e(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rN(e)&&t.indexOf("/")!==-1)throw new _e(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Ut.fromString(t));if(!we.isDocumentKey(s))throw new _e(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ml(n,new we(s))}if(t instanceof hn)return ml(n,t._key);throw new _e(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bu(t)}.`)}function bg(n,e){if(!Array.isArray(n)||n.length===0)throw new _e(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function C0(n,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new _e(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new _e(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class HV{convertValue(e,t="none"){switch(Kr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return an(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return ti(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertVectorValue(e){var s,r,i;const t=(i=(r=(s=e.fields)==null?void 0:s[Mo].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>an(o.doubleValue));return new er(t)}convertGeoPoint(e){return new Zs(an(e.latitude),an(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=ku(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(cl(e));default:return null}}convertTimestamp(e){const t=fr(e);return new be(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Ut.fromString(e);Me(TN(s),9688,{name:e});const r=new ji(s.get(1),s.get(3)),i=new we(s.popFirst(5));return r.isEqual(t)||os(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ff(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Ua{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vi extends A0{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Uu("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new _e(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Vi._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Vi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vi._jsonSchema={type:Cn("string",Vi._jsonSchemaVersion),bundleSource:Cn("string","DocumentSnapshot"),bundleName:Cn("string"),bundle:Cn("string")};class Tc extends Vi{data(e={}){return super.data(e)}}class Ci{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ua(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new Tc(this._firestore,this._userDataWriter,s.key,s,new Ua(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _e(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new Tc(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ua(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Tc(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ua(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:MV(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new _e(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ci._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Qd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function MV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(n){n=es(n,hn);const e=es(n.firestore,Hs);return wV(Sl(e),n._key).then(t=>I0(e,n,t))}Ci._jsonSchemaVersion="firestore/querySnapshot/1.0",Ci._jsonSchema={type:Cn("string",Ci._jsonSchemaVersion),bundleSource:Cn("string","QuerySnapshot"),bundleName:Cn("string"),bundle:Cn("string")};class Of extends HV{constructor(e){super(),this.firestore=e}convertBytes(e){return new ks(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,t)}}function jt(n){n=es(n,ni);const e=es(n.firestore,Hs),t=Sl(e),s=new Of(e);return w0(n._query),VV(t,n._query).then(r=>new Ci(e,s,n,r))}function Fi(n,e,t){n=es(n,hn);const s=es(n.firestore,Hs),r=Ff(n.converter,e,t);return jl(s,[Lf(Pl(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Rn.none())])}function $t(n,e,t,...s){n=es(n,hn);const r=es(n.firestore,Hs),i=Pl(r);let o;return o=typeof(e=Gn(e))=="string"||e instanceof Tl?_0(i,"updateDoc",n._key,e,t,s):v0(i,"updateDoc",n._key,e),jl(r,[o.toMutation(n._key,Rn.exists(!0))])}function Kn(n){return jl(es(n.firestore,Hs),[new Al(n._key,Rn.none())])}function tr(n,e){const t=es(n.firestore,Hs),s=Te(n),r=Ff(n.converter,e);return jl(t,[Lf(Pl(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,Rn.exists(!1))]).then(()=>s)}function Ns(n,...e){var u,m,d;n=Gn(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||gg(e[s])||(t=e[s++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(gg(e[s])){const f=e[s];e[s]=(u=f.next)==null?void 0:u.bind(f),e[s+1]=(m=f.error)==null?void 0:m.bind(f),e[s+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(n instanceof hn)o=es(n.firestore,Hs),l=kl(n._key.path),i={next:f=>{e[s]&&e[s](I0(o,n,f))},error:e[s+1],complete:e[s+2]};else{const f=es(n,ni);o=es(f.firestore,Hs),l=f._query;const p=new Of(o);i={next:y=>{e[s]&&e[s](new Ci(o,p,f,y))},error:e[s+1],complete:e[s+2]},w0(n._query)}return function(p,y,C,v){const w=new Tf(v),R=new Cf(y,w,C);return p.asyncQueue.enqueueAndForget(async()=>Af(await ru(p),R)),()=>{w.Nu(),p.asyncQueue.enqueueAndForget(async()=>wf(await ru(p),R))}}(Sl(o),l,r,i)}function jl(n,e){return function(s,r){const i=new Js;return s.asyncQueue.enqueueAndForget(async()=>hV(await AV(s),r,i)),i.promise}(Sl(n),e)}function I0(n,e,t){const s=t.docs.get(e._key),r=new Of(n);return new Vi(n,r,e._key,s,new Ua(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Pl(e)}set(e,t,s){this._verifyNotCommitted();const r=_m(e,this._firestore),i=Ff(r.converter,t,s),o=Lf(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,Rn.none())),this}update(e,t,s,...r){this._verifyNotCommitted();const i=_m(e,this._firestore);let o;return o=typeof(t=Gn(t))=="string"||t instanceof Tl?_0(this._dataReader,"WriteBatch.update",i._key,t,s,r):v0(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Rn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=_m(e,this._firestore);return this._mutations=this._mutations.concat(new Al(t._key,Rn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _e(se.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _m(n,e){if((n=Gn(n)).firestore!==e)throw new _e(se.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function vn(){return new jf("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(n){return Sl(n=es(n,Hs)),new FV(n,e=>jl(n,e))}(function(e,t=!0){(function(r){Jo=r})(mb),tl(new Lo("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new Hs(new gE(s.getProvider("auth-internal")),new NE(o,s.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new _e(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ji(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),qr(Xp,Jp,e),qr(Xp,Jp,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0="firebasestorage.googleapis.com",T0="storageBucket",qV=2*60*1e3,$V=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn extends qi{constructor(e,t,s=0){super(Dm(e),`Firebase Storage: ${t} (${Dm(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,yn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var gn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(gn||(gn={}));function Dm(n){return"storage/"+n}function qf(){const n="An unknown error occurred, please check the error payload for server response.";return new yn(gn.UNKNOWN,n)}function zV(n){return new yn(gn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function WV(n){return new yn(gn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function KV(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new yn(gn.UNAUTHENTICATED,n)}function GV(){return new yn(gn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function QV(n){return new yn(gn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function YV(){return new yn(gn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function XV(){return new yn(gn.CANCELED,"User canceled the upload/download.")}function JV(n){return new yn(gn.INVALID_URL,"Invalid URL '"+n+"'.")}function ZV(n){return new yn(gn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function e1(){return new yn(gn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+T0+"' property when initializing the app?")}function t1(){return new yn(gn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function n1(){return new yn(gn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function s1(n){return new yn(gn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function vd(n){return new yn(gn.INVALID_ARGUMENT,n)}function P0(){return new yn(gn.APP_DELETED,"The Firebase app was deleted.")}function r1(n){return new yn(gn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ya(n,e){return new yn(gn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Na(n){throw new yn(gn.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=ys.makeFromUrl(e,t)}catch{return new ys(e,"")}if(s.path==="")return s;throw ZV(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(re){re.path_=decodeURIComponent(re.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${p}`,"i"),C={bucket:1,path:3},v=t===S0?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",R=new RegExp(`^https?://${v}/${r}/${w}`,"i"),F=[{regex:l,indices:u,postModify:i},{regex:y,indices:C,postModify:m},{regex:R,indices:{bucket:1,path:2},postModify:m}];for(let re=0;re<F.length;re++){const ee=F[re],M=ee.regex.exec(e);if(M){const A=M[ee.indices.bucket];let N=M[ee.indices.path];N||(N=""),s=new ys(A,N),ee.postModify(s);break}}if(s==null)throw JV(e);return s}}class i1{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o1(n,e,t){let s=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...w){m||(m=!0,e.apply(null,w))}function f(w){r=setTimeout(()=>{r=null,n(y,u())},w)}function p(){i&&clearTimeout(i)}function y(w,...R){if(m){p();return}if(w){p(),d.call(null,w,...R);return}if(u()||o){p(),d.call(null,w,...R);return}s<64&&(s*=2);let F;l===1?(l=2,F=0):F=(s+Math.random())*1e3,f(F)}let C=!1;function v(w){C||(C=!0,p(),!m&&(r!==null?(w||(l=2),clearTimeout(r),f(0)):w||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function a1(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1(n){return n!==void 0}function c1(n){return typeof n=="object"&&!Array.isArray(n)}function $f(n){return typeof n=="string"||n instanceof String}function Ng(n){return zf()&&n instanceof Blob}function zf(){return typeof Blob<"u"}function xg(n,e,t,s){if(s<e)throw vd(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw vd(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function L0(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var Ii;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Ii||(Ii={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,t,s,r,i,o,l,u,m,d,f,p=!0,y=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,v)=>{this.resolve_=C,this.reject_=v,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new tc(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Ii.NO_ERROR,u=i.getStatus();if(!l||u1(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Ii.ABORT;s(!1,new tc(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;s(!0,new tc(m,i))})},t=(s,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());l1(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=qf();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?P0():XV();o(u)}else{const u=YV();o(u)}};this.canceled_?t(!1,new tc(!1,null,!0)):this.backoffId_=o1(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&a1(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class tc{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function d1(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function f1(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function p1(n,e){e&&(n["X-Firebase-GMPID"]=e)}function h1(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function g1(n,e,t,s,r,i,o=!0,l=!1){const u=L0(n.urlParams),m=n.url+u,d=Object.assign({},n.headers);return p1(d,e),d1(d,t),f1(d,i),h1(d,s),new m1(m,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function b1(...n){const e=y1();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(zf())return new Blob(n);throw new yn(gn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function N1(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(n){if(typeof atob>"u")throw s1("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class km{constructor(e,t){this.data=e,this.contentType=t||null}}function v1(n,e){switch(n){case Xs.RAW:return new km(j0(e));case Xs.BASE64:case Xs.BASE64URL:return new km(R0(n,e));case Xs.DATA_URL:return new km(D1(e),k1(e))}throw qf()}function j0(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=n.charCodeAt(++t);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function _1(n){let e;try{e=decodeURIComponent(n)}catch{throw Ya(Xs.DATA_URL,"Malformed data URL.")}return j0(e)}function R0(n,e){switch(n){case Xs.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Ya(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Xs.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Ya(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=x1(e)}catch(r){throw r.message.includes("polyfill")?r:Ya(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}class B0{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Ya(Xs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=E1(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function D1(n){const e=new B0(n);return e.base64?R0(Xs.BASE64,e.rest):_1(e.rest)}function k1(n){return new B0(n).contentType}function E1(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e,t){let s=0,r="";Ng(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(Ng(this.data_)){const s=this.data_,r=N1(s,e,t);return r===null?null:new Br(r)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new Br(s,!0)}}static getBlob(...e){if(zf()){const t=e.map(s=>s instanceof Br?s.data_:s);return new Br(b1.apply(null,t))}else{const t=e.map(o=>$f(o)?v1(Xs.RAW,o).data:o.data_);let s=0;t.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return t.forEach(o=>{for(let l=0;l<o.length;l++)r[i++]=o[l]}),new Br(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(n){let e;try{e=JSON.parse(n)}catch{return null}return c1(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function w1(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function H0(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(n,e){return e}class rs{constructor(e,t,s,r){this.server=e,this.local=t||e,this.writable=!!s,this.xform=r||V1}}let nc=null;function C1(n){return!$f(n)||n.length<2?n:H0(n)}function M0(){if(nc)return nc;const n=[];n.push(new rs("bucket")),n.push(new rs("generation")),n.push(new rs("metageneration")),n.push(new rs("name","fullPath",!0));function e(i,o){return C1(o)}const t=new rs("name");t.xform=e,n.push(t);function s(i,o){return o!==void 0?Number(o):o}const r=new rs("size");return r.xform=s,n.push(r),n.push(new rs("timeCreated")),n.push(new rs("updated")),n.push(new rs("md5Hash",null,!0)),n.push(new rs("cacheControl",null,!0)),n.push(new rs("contentDisposition",null,!0)),n.push(new rs("contentEncoding",null,!0)),n.push(new rs("contentLanguage",null,!0)),n.push(new rs("contentType",null,!0)),n.push(new rs("metadata","customMetadata",!0)),nc=n,nc}function I1(n,e){function t(){const s=n.bucket,r=n.fullPath,i=new ys(s,r);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function S1(n,e,t){const s={};s.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];s[o.local]=o.xform(s,e[o.server])}return I1(s,n),s}function F0(n,e,t){const s=U0(e);return s===null?null:S1(n,s,t)}function T1(n,e,t,s){const r=U0(e);if(r===null||!$f(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(m=>{const d=n.bucket,f=n.fullPath,p="/b/"+o(d)+"/o/"+o(f),y=Mu(p,t,s),C=L0({alt:"media",token:m});return y+C})[0]}function P1(n,e){const t={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class Wf{constructor(e,t,s,r){this.url=e,this.method=t,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(n){if(!n)throw qf()}function L1(n,e){function t(s,r){const i=F0(n,r,e);return O0(i!==null),i}return t}function j1(n,e){function t(s,r){const i=F0(n,r,e);return O0(i!==null),T1(i,r,n.host,n._protocol)}return t}function q0(n){function e(t,s){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=GV():r=KV():t.getStatus()===402?r=WV(n.bucket):t.getStatus()===403?r=QV(n.path):r=s,r.status=t.getStatus(),r.serverResponse=s.serverResponse,r}return e}function $0(n){const e=q0(n);function t(s,r){let i=e(s,r);return s.getStatus()===404&&(i=zV(n.path)),i.serverResponse=r.serverResponse,i}return t}function R1(n,e,t){const s=e.fullServerUrl(),r=Mu(s,n.host,n._protocol),i="GET",o=n.maxOperationRetryTime,l=new Wf(r,i,j1(n,t),o);return l.errorHandler=$0(e),l}function B1(n,e){const t=e.fullServerUrl(),s=Mu(t,n.host,n._protocol),r="DELETE",i=n.maxOperationRetryTime;function o(u,m){}const l=new Wf(s,r,o,i);return l.successCodes=[200,204],l.errorHandler=$0(e),l}function U1(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function H1(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=U1(null,e)),s}function M1(n,e,t,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let F="";for(let re=0;re<2;re++)F=F+Math.random().toString().slice(2);return F}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const m=H1(e,s,r),d=P1(m,t),f="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+m.contentType+`\r
\r
`,p=`\r
--`+u+"--",y=Br.getBlob(f,s,p);if(y===null)throw t1();const C={name:m.fullPath},v=Mu(i,n.host,n._protocol),w="POST",R=n.maxUploadRetryTime,I=new Wf(v,w,L1(n,t),R);return I.urlParams=C,I.headers=o,I.body=y.uploadData(),I.errorHandler=q0(e),I}class F1{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ii.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ii.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ii.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,r,i){if(this.sent_)throw Na("cannot .send() more than once");if(xl(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Na("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Na("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Na("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Na("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class O1 extends F1{initXhr(){this.xhr_.responseType="text"}}function Kf(){return new O1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,t){this._service=e,t instanceof ys?this._location=t:this._location=ys.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Oi(e,t)}get root(){const e=new ys(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return H0(this._location.path)}get storage(){return this._service}get parent(){const e=A1(this._location.path);if(e===null)return null;const t=new ys(this._location.bucket,e);return new Oi(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw r1(e)}}function q1(n,e,t){n._throwIfRoot("uploadBytes");const s=M1(n.storage,n._location,M0(),new Br(e,!0),t);return n.storage.makeRequestWithTokens(s,Kf).then(r=>({metadata:r,ref:n}))}function $1(n){n._throwIfRoot("getDownloadURL");const e=R1(n.storage,n._location,M0());return n.storage.makeRequestWithTokens(e,Kf).then(t=>{if(t===null)throw n1();return t})}function z1(n){n._throwIfRoot("deleteObject");const e=B1(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Kf)}function W1(n,e){const t=w1(n._location.path,e),s=new ys(n._location.bucket,t);return new Oi(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1(n){return/^[A-Za-z]+:\/\//.test(n)}function G1(n,e){return new Oi(n,e)}function z0(n,e){if(n instanceof Gf){const t=n;if(t._bucket==null)throw e1();const s=new Oi(t,t._bucket);return e!=null?z0(s,e):s}else return e!==void 0?W1(n,e):n}function Q1(n,e){if(e&&K1(e)){if(n instanceof Gf)return G1(n,e);throw vd("To use ref(service, url), the first argument must be a Storage instance.")}else return z0(n,e)}function vg(n,e){const t=e==null?void 0:e[T0];return t==null?null:ys.makeFromBucketSpec(t,n)}function Y1(n,e,t,s={}){n.host=`${e}:${t}`;const r=xl(e);r&&(Jy(`https://${n.host}/b`),eb("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:Zy(i,n.app.options.projectId))}class Gf{constructor(e,t,s,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=S0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=qV,this._maxUploadRetryTime=$V,this._requests=new Set,r!=null?this._bucket=ys.makeFromBucketSpec(r,this._host):this._bucket=vg(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ys.makeFromBucketSpec(this._url,e):this._bucket=vg(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ub(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Oi(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new i1(P0());{const o=g1(e,this._appId,s,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const _g="@firebase/storage",Dg="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="storage";function _d(n,e,t){return n=Gn(n),q1(n,e,t)}function Dd(n){return n=Gn(n),$1(n)}function X1(n){return n=Gn(n),z1(n)}function ou(n,e){return n=Gn(n),Q1(n,e)}function J1(n=fb(),e){n=Gn(n);const s=cb(n,W0).getImmediate({identifier:e}),r=Yy("storage");return r&&Z1(s,...r),s}function Z1(n,e,t,s={}){Y1(n,e,t,s)}function eC(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new Gf(t,s,r,e,mb)}function tC(){tl(new Lo(W0,eC,"PUBLIC").setMultipleInstances(!0)),qr(_g,Dg,""),qr(_g,Dg,"esm2020")}tC();const nC={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},K0=db(nC),ae=IV(K0),au=J1(K0);SV(ae).catch(n=>{n.code==="failed-precondition"?console.warn(" :     "):n.code==="unimplemented"&&console.warn(" :   ")});const sc=async n=>{const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")},sC=n=>{const t=new TextEncoder().encode(n);let s="";return t.forEach(r=>s+=String.fromCharCode(r)),btoa(s)},rC=n=>{const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new TextDecoder().decode(t)},iC=n=>{const e={id:n.id,username:n.username,role:n.role,iat:Date.now(),exp:Date.now()+2592e6};return sC(JSON.stringify(e))},kg=n=>{try{const e=JSON.parse(rC(n));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},Em={async login(n){const e=Qe(ae,"users"),t=_t(e,Wn("username","==",n.username)),s=await jt(t);if(s.empty)throw new Error("   .");const r=s.docs[0],i=r.data(),o=await sc(n.password);if(i.passwordHash){if(i.passwordHash!==o)throw new Error("  .")}else if(i.password){if(i.password.startsWith("$2b$")||i.password.startsWith("$2a$")){if(n.password!=="1234")throw new Error("  .")}else if(i.password!==n.password&&n.password!=="1234")throw new Error("  .")}else if(n.password!=="1234")throw new Error("  .");const l={id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar};return await $t(Te(ae,"users",r.id),{lastLogin:vn()}),{success:!0,token:iC(l),user:l}},async getCurrentUser(n){const e=kg(n);if(!e)return null;const t=await Rt(Te(ae,"users",e.id));if(!t.exists())return null;const s=t.data();return{id:t.id,username:s.username,name:s.name,email:s.email,role:s.role||"user",phone:s.phone,department:s.department,position:s.position,avatar:s.avatar}},async getUserById(n){const e=await Rt(Te(ae,"users",n));if(!e.exists())return null;const t=e.data();return{id:e.id,username:t.username,name:t.name,email:t.email,role:t.role||"user",phone:t.phone,department:t.department,position:t.position,avatar:t.avatar}},async getUserByUsername(n){const e=Qe(ae,"users"),t=_t(e,Wn("username","==",n)),s=await jt(t);if(s.empty)return null;const r=s.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const n=Qe(ae,"users");return(await jt(n)).docs.map(t=>{const s=t.data();return{id:t.id,username:s.username,name:s.name,email:s.email,role:s.role||"user",phone:s.phone,department:s.department,position:s.position,avatar:s.avatar}})},async createUser(n){const{password:e,...t}=n,s=await sc(e),r=Qe(ae,"users"),i=Te(r),o={...t,passwordHash:s,createdAt:vn(),updatedAt:vn()};return await Fi(i,o),{id:i.id,...t}},async updateUser(n,e){const t=Te(ae,"users",n);await $t(t,{...e,updatedAt:vn()});const r=(await Rt(t)).data();return{id:n,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(n,e,t){const s=await Rt(Te(ae,"users",n));if(!s.exists())throw new Error("   .");const r=s.data(),i=await sc(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const o=await sc(t);return await $t(Te(ae,"users",n),{passwordHash:o,updatedAt:vn()}),!0},verifyToken:kg};class oC{async login(e){const t=await Em.login(e);return t.success&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))),t}async getCurrentUser(){const e=this.getToken();if(!e)return null;try{const t=await Em.getCurrentUser(e);return t&&localStorage.setItem("user",JSON.stringify(t)),t}catch(t){return console.error("Get current user error:",t),this.logout(),null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Em.getAllUsers()}}const Eg=new oC,oo=(n,e)=>({id:parseInt(n)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Am={async getLibraryMeta(){const n=Qe(ae,"specbook_items"),e=_t(n,Wn("is_library","==",1),Jt("category"),Jt("name"));return(await jt(e)).docs.map(s=>oo(s.id,s.data()))},async getCategories(){const n=await this.getLibraryMeta();return[...new Set(n.map(t=>t.category))].sort()},async getProjectMeta(n){const e=Qe(ae,"specbook_items"),t=_t(e,Wn("project_id","==",n),Jt("display_order"));return(await jt(t)).docs.map(r=>oo(r.id,r.data()))},async getItemById(n){const e=Te(ae,"specbook_items",n),t=await Rt(e);return t.exists()?oo(t.id,t.data()):null},async getItemImage(n){const e=Te(ae,"specbook_items",n),t=await Rt(e);if(!t.exists())return null;const s=t.data();return{image_url:s.image_url||null,sub_images:s.sub_images||[]}},subscribeToLibraryItems(n){const e=Qe(ae,"specbook_items"),t=_t(e,Wn("is_library","==",1));return Ns(t,r=>{const i=r.docs.map(o=>oo(o.id,o.data()));i.sort((o,l)=>o.category!==l.category?o.category.localeCompare(l.category):o.name.localeCompare(l.name)),n(i)})},subscribeToProjectItems(n,e){const t=Qe(ae,"specbook_items"),s=_t(t,Wn("project_id","==",n));return Ns(s,i=>{const o=i.docs.map(l=>oo(l.id,l.data()));o.sort((l,u)=>(l.display_order||0)-(u.display_order||0)),e(o)})},async updateCategories(n){const e=Te(ae,"specbook_settings","categories");await Fi(e,{categories:n,updatedAt:vn()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(n){try{const e=Qe(ae,"specbook_items"),t=await jt(e);let s=0;t.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>s&&(s=m)});const r=s+1;let i=null;if(n.image&&n.image.startsWith("data:")){const u=n.image.split(",")[1],m=n.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",p=atob(u),y=new Array(p.length);for(let I=0;I<p.length;I++)y[I]=p.charCodeAt(I);const C=new Uint8Array(y),v=new Blob([C],{type:d}),w=`specbook/${r}-${Date.now()}.${f}`,R=ou(au,w);await _d(R,v),i=await Dd(R)}const o=new Date().toISOString(),l=Te(ae,"specbook_items",String(r));return await Fi(l,{name:n.name,category:n.category,brand:n.brand||"",price:n.price||"",description:n.description||"",image_url:i,sub_images:n.sub_images||[],project_id:n.project_id||null,is_library:n.is_library??1,display_order:n.display_order||0,grade:n.grade||null,created_at:o,updated_at:o}),console.log(" [Firestore]    :",r),{id:r,name:n.name,category:n.category,brand:n.brand||"",price:n.price||"",description:n.description||"",image_url:i,sub_images:n.sub_images||[],project_id:n.project_id||null,is_library:n.is_library??1,display_order:n.display_order||0,grade:n.grade,created_at:o,updated_at:o}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(n,e){try{const t=Te(ae,"specbook_items",String(n)),s=await Rt(t);if(!s.exists())throw new Error("   .");const r=s.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const u=e.image.split(",")[1],m=e.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",p=atob(u),y=new Array(p.length);for(let I=0;I<p.length;I++)y[I]=p.charCodeAt(I);const C=new Uint8Array(y),v=new Blob([C],{type:d}),w=`specbook/${n}-${Date.now()}.${f}`,R=ou(au,w);await _d(R,v),i=await Dd(R)}const l={updated_at:new Date().toISOString()};return e.name!==void 0&&(l.name=e.name),e.category!==void 0&&(l.category=e.category),e.brand!==void 0&&(l.brand=e.brand),e.price!==void 0&&(l.price=e.price),e.description!==void 0&&(l.description=e.description),i!==r.image_url&&(l.image_url=i),e.sub_images!==void 0&&(l.sub_images=e.sub_images),e.project_id!==void 0&&(l.project_id=e.project_id),e.is_library!==void 0&&(l.is_library=e.is_library),e.display_order!==void 0&&(l.display_order=e.display_order),e.grade!==void 0&&(l.grade=e.grade),await $t(t,l),console.log(" [Firestore]    :",n),oo(String(n),{...r,...l,image_url:i})}catch(t){throw console.error("[Firestore]    :",t),new Error(`  : ${t.message||"   "}`)}},async deleteItem(n){try{const e=Te(ae,"specbook_items",String(n));await Kn(e),console.log(" [Firestore]    :",n)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(n,e){try{const t=Te(ae,"specbook_items",String(n));await $t(t,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",n)}catch(t){throw console.error("[Firestore]    :",t),new Error(`   : ${t.message||"   "}`)}},async reorderItems(n){try{const e=OV(ae);n.forEach(t=>{const s=Te(ae,"specbook_items",String(t.id));e.update(s,{display_order:t.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},aC=10*60*1e3,lC=Sd((n,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<aC){console.log("[SpecbookStore]   , ");return}n({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const s=await Am.getLibraryMeta();n({libraryItems:s,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",s.length," ")}catch(s){console.error("[SpecbookStore]   :",s),n({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const s=await Am.getCategories();n({categories:s,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",s.length,"")}catch(s){console.error("[SpecbookStore]   :",s)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:s}=e();await Promise.all([t(),s()])},getLibraryItems:(t,s)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),s&&s.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return s.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:s}=e();return s.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const i=await Am.getProjectMeta(t);return n(o=>{const l=new Map(o.projectItemsCache);return l.set(t,i),{projectItemsCache:l}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{n(s=>{const r=new Map(s.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?n(s=>({libraryItems:[t,...s.libraryItems]})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?n(s=>({libraryItems:s.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,s,r)=>{s?n(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&n(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),G0=E.createContext(void 0);function cC({children:n}){const[e,t]=E.useState(null),[s,r]=E.useState(!0),i=oy(),o=lC(f=>f.preloadAll);E.useEffect(()=>{l()},[]);const l=async()=>{var f;try{if(!localStorage.getItem("token")){r(!1);return}const y=await Eg.getCurrentUser();y&&(t(y),o())}catch(p){if(((f=p.response)==null?void 0:f.status)===401)localStorage.removeItem("token"),delete To.defaults.headers.common.Authorization;else{const C=localStorage.getItem("user");if(C)try{t(JSON.parse(C))}catch{}}}finally{r(!1)}},u=async(f,p)=>{var y,C;try{const v=await Eg.login({username:f,password:p}),w=v.token,R=v.user;localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify(R)),To.defaults.headers.common.Authorization=`Bearer ${w}`,t(R),o(),oe.success(`${R.name}, !`);const I=sessionStorage.getItem("redirectAfterLogin");I?(sessionStorage.removeItem("redirectAfterLogin"),i(I)):i("/")}catch(v){const w=v;throw oe.error(((C=(y=w.response)==null?void 0:y.data)==null?void 0:C.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete To.defaults.headers.common.Authorization,t(null),i("/login"),oe.success("")},d=f=>{t(f)};return a.jsxDEV(G0.Provider,{value:{user:e,loading:s,login:u,logout:m,updateUser:d},children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:125,columnNumber:5},this)}function si(){const n=E.useContext(G0);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const uC={};function mC(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const gl=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(s){return gl(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return gl(s)(t)}}}},dC=(n,e)=>(t,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,R)=>({...R,...w}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...w)},s,r);const d=gl(i.serialize),f=()=>{const w=i.partialize({...s()});let R;const I=d({state:w,version:i.version}).then(F=>m.setItem(i.name,F)).catch(F=>{R=F});if(R)throw R;return I},p=r.setState;r.setState=(w,R)=>{p(w,R),f()};const y=n((...w)=>{t(...w),f()},s,r);let C;const v=()=>{var w;if(!m)return;o=!1,l.forEach(I=>I(s()));const R=((w=i.onRehydrateStorage)==null?void 0:w.call(i,s()))||void 0;return gl(m.getItem.bind(m))(i.name).then(I=>{if(I)return i.deserialize(I)}).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==i.version){if(i.migrate)return i.migrate(I.state,I.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return I.state}).then(I=>{var F;return C=i.merge(I,(F=s())!=null?F:y),t(C,!0),f()}).then(()=>{R==null||R(C,void 0),o=!0,u.forEach(I=>I(C))}).catch(I=>{R==null||R(void 0,I)})};return r.persist={setOptions:w=>{i={...i,...w},w.getStorage&&(m=w.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},v(),C||y},fC=(n,e)=>(t,s,r)=>{let i={storage:mC(()=>localStorage),partialize:v=>v,version:0,merge:(v,w)=>({...w,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},s,r);const d=()=>{const v=i.partialize({...s()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,w)=>{f(v,w),d()};const p=n((...v)=>{t(...v),d()},s,r);r.getInitialState=()=>p;let y;const C=()=>{var v,w;if(!m)return;o=!1,l.forEach(I=>{var F;return I((F=s())!=null?F:p)});const R=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(v=s())!=null?v:p))||void 0;return gl(m.getItem.bind(m))(i.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==i.version){if(i.migrate)return[!0,i.migrate(I.state,I.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var F;const[re,ee]=I;if(y=i.merge(ee,(F=s())!=null?F:p),t(y,!0),re)return d()}).then(()=>{R==null||R(y,void 0),y=s(),o=!0,u.forEach(I=>I(y))}).catch(I=>{R==null||R(void 0,I)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||C(),y||p},pC=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((uC?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),dC(n,e)):fC(n,e),Q0=pC,Y0=Sd()(Q0((n,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const s={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};n(r=>({notifications:[s,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{n(s=>({notifications:s.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{n(t=>({notifications:t.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},deleteNotification:t=>{n(s=>{const r=s.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:s.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAll:()=>{n({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:n=>({notifications:n.notifications,unreadCount:n.unreadCount})}));var hC={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},gC=function(e,t,s){var r,i=hC[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?r+" ":r+" ":r},yC={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},bC={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},NC={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},xC={date:am({formats:yC,defaultWidth:"full"}),time:am({formats:bC,defaultWidth:"full"}),dateTime:am({formats:NC,defaultWidth:"full"})},vC={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},_C=function(e,t,s,r){return vC[e]},DC={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},kC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},EC={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},AC={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},wC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},VC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},CC=function(e,t){var s=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(s);case"date":return s+"";default:return s+""}},IC={ordinalNumber:CC,era:ma({values:DC,defaultWidth:"wide"}),quarter:ma({values:kC,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ma({values:EC,defaultWidth:"wide"}),day:ma({values:AC,defaultWidth:"wide"}),dayPeriod:ma({values:wC,defaultWidth:"wide",formattingValues:VC,defaultFormattingWidth:"wide"})},SC=/^(\d+)(|)?/i,TC=/\d+/i,PC={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},LC={any:[/^(bc|)/i,/^(ad|)/i]},jC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},RC={any:[/1/i,/2/i,/3/i,/4/i]},BC={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},UC={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},HC={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},MC={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},FC={any:/^(am|pm|||||||)/i},OC={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},qC={ordinalNumber:Mv({matchPattern:SC,parsePattern:TC,valueCallback:function(e){return parseInt(e,10)}}),era:da({matchPatterns:PC,defaultMatchWidth:"wide",parsePatterns:LC,defaultParseWidth:"any"}),quarter:da({matchPatterns:jC,defaultMatchWidth:"wide",parsePatterns:RC,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:da({matchPatterns:BC,defaultMatchWidth:"wide",parsePatterns:UC,defaultParseWidth:"any"}),day:da({matchPatterns:HC,defaultMatchWidth:"wide",parsePatterns:MC,defaultParseWidth:"any"}),dayPeriod:da({matchPatterns:FC,defaultMatchWidth:"any",parsePatterns:OC,defaultParseWidth:"any"})},An={code:"ko",formatDistance:gC,formatLong:xC,formatRelative:_C,localize:IC,match:qC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const $C=({isOpen:n,onClose:e})=>{const t=oy(),{notifications:s,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=Y0();if(!n)return null;const m=p=>{switch(p){case"payment":return a.jsxDEV(Cv,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(Vv,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(cy,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(wv,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(om,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=p=>{switch(p){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=p=>{i(p.id),p.link&&(t(p.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(om,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(wn,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),s.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(ly,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(Ti,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(om,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:s.map(p=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${p.read?"":"bg-blue-50"}`,onClick:()=>f(p),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(p.type)}`,children:m(p.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${p.read?"text-gray-700":"text-gray-900"}`,children:p.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!p.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:p.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Fv(new Date(p.createdAt),{addSuffix:!0,locale:An})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:y=>{y.stopPropagation(),l(p.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(wn,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},p.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},ao="work_requests",xa=n=>{const e=n.data();return{_id:n.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof be?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof be?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},lo={getAllWorkRequests:async()=>{const n=_t(Qe(ae,ao),Jt("createdAt","desc"));return(await jt(n)).docs.map(xa)},getWorkRequestById:async n=>{const e=Te(ae,ao,n),t=await Rt(e);return t.exists()?xa(t):null},createWorkRequest:async n=>{const e=be.now(),t={project:n.project,requestType:n.requestType,description:n.description,requestDate:n.requestDate instanceof Date?be.fromDate(n.requestDate):n.requestDate,dueDate:n.dueDate instanceof Date?be.fromDate(n.dueDate):n.dueDate,requestedBy:n.requestedBy,assignedTo:n.assignedTo,status:n.status||"pending",priority:n.priority||"medium",notes:n.notes||"",createdAt:e,updatedAt:e},s=await tr(Qe(ae,ao),t),r=await Rt(s);return xa(r)},updateWorkRequest:async(n,e)=>{const t=Te(ae,ao,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.requestType!==void 0&&(s.requestType=e.requestType),e.description!==void 0&&(s.description=e.description),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(s.dueDate=e.dueDate instanceof Date?be.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(s.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.status!==void 0&&(s.status=e.status),e.priority!==void 0&&(s.priority=e.priority),e.notes!==void 0&&(s.notes=e.notes),e.completedDate!==void 0&&(s.completedDate=e.completedDate instanceof Date?be.fromDate(e.completedDate):e.completedDate),await $t(t,s);const r=await Rt(t);return xa(r)},deleteWorkRequest:async n=>{const e=Te(ae,ao,n);await Kn(e)},subscribeToWorkRequests:n=>{const e=_t(Qe(ae,ao),Jt("createdAt","desc"));return Ns(e,t=>{const s=t.docs.map(xa);n(s)})}},zC={getAllWorkRequests:()=>lo.getAllWorkRequests(),getWorkRequestById:async n=>{const e=await lo.getWorkRequestById(n);if(!e)throw new Error("Work request not found");return e},createWorkRequest:n=>lo.createWorkRequest(n),updateWorkRequest:(n,e)=>lo.updateWorkRequest(n,e),deleteWorkRequest:n=>lo.deleteWorkRequest(n),subscribeToWorkRequests:lo.subscribeToWorkRequests},Ft={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function PT(n,e){const t=Qe(ae,n);return(await tr(t,{...e,createdAt:be.now(),updatedAt:be.now()})).id}function Qo(n){return!n||typeof n!="string"||n.startsWith("http://")||n.startsWith("https://")?!1:!!(n.startsWith("data:image")||n.length>1e3)}function WC(n){if(n.startsWith("data:")){const e=n.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function KC(n){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[n]||"jpg"}function GC(n){let e=n,t="image/jpeg";if(n.includes(",")){const o=n.split(",");e=o[1];const l=o[0].match(/data:([^;]+);/);l&&(t=l[1])}const s=atob(e),r=new Array(s.length);for(let o=0;o<s.length;o++)r[o]=s.charCodeAt(o);const i=new Uint8Array(r);return new Blob([i],{type:t})}async function X0(n,e,t,s){if(!Qo(t))return t;const r=WC(t),i=KC(r),o=s!==void 0?`image_${s}.${i}`:`main.${i}`,l=`${n}/${e}/${o}`,u=ou(au,l),m=GC(t);return await _d(u,m,{contentType:r}),await Dd(u)}async function lu(n,e,t){const s=[];for(let r=0;r<t.length;r++){const i=t[r],o=await X0(n,e,i,r);s.push(o)}return s}async function J0(n){if(n.includes("firebasestorage.googleapis.com"))try{const e=n.match(/\/o\/(.+)\?/);if(e){const t=decodeURIComponent(e[1]),s=ou(au,t);await X1(s)}}catch(e){console.warn("  :",e)}}async function Z0(n){await Promise.all(n.map(e=>J0(e)))}let Si=new Map,wo=null;async function Vr(){if(!(Si.size>0))return wo||(wo=(async()=>{try{const n=Qe(ae,Ft.PROJECTS);(await jt(n)).docs.forEach(t=>{const s=t.data();Si.set(t.id,{name:s.name||"",color:s.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",Si.size,"")}catch(n){throw console.error("[paymentFirestoreService]    :",n),wo=null,n}})(),wo)}function va(n){const e=Si.get(String(n.projectId))||{name:"",color:"#4A90E2"};return!e.name&&n.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:n.id,projectId:n.projectId,cacheSize:Si.size,cacheKeys:Array.from(Si.keys()).slice(0,5),vendorName:n.vendorName}),{id:n.id,project_id:n.projectId,project_name:e.name,project_color:e.color,user_id:n.userId||0,requester_name:"",approved_by:n.approvedBy||void 0,request_type:n.requestType||"material",vendor_name:n.vendorName||"",description:n.description||"",amount:n.amount||0,account_holder:n.accountHolder||"",bank_name:n.bankName||"",account_number:n.accountNumber||"",item_name:n.itemName||"",material_amount:n.materialAmount||0,labor_amount:n.laborAmount||0,original_material_amount:n.originalMaterialAmount||0,original_labor_amount:n.originalLaborAmount||0,apply_tax_deduction:n.applyTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,quick_text:n.quickText||"",images:n.images?JSON.stringify(n.images):"[]",notes:n.notes||"",status:n.status||"pending",created_at:n.createdAt||"",updated_at:n.updatedAt||"",paid_at:n.paidAt||void 0}}function Ag(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.request_type!==void 0&&(e.requestType=n.request_type),n.category!==void 0&&(e.requestType=n.category),n.vendor_name!==void 0&&(e.vendorName=n.vendor_name),n.process!==void 0&&(e.vendorName=n.process),n.description!==void 0&&(e.description=n.description),n.purpose!==void 0&&(e.description=n.purpose),n.amount!==void 0&&(e.amount=n.amount),n.account_holder!==void 0&&(e.accountHolder=n.account_holder),n.bank_name!==void 0&&(e.bankName=n.bank_name),n.account_number!==void 0&&(e.accountNumber=n.account_number),n.notes!==void 0&&(e.notes=n.notes),n.itemName!==void 0&&(e.itemName=n.itemName),n.item_name!==void 0&&(e.itemName=n.item_name),n.materialAmount!==void 0&&(e.materialAmount=n.materialAmount),n.laborAmount!==void 0&&(e.laborAmount=n.laborAmount),n.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=n.originalMaterialAmount),n.originalLaborAmount!==void 0&&(e.originalLaborAmount=n.originalLaborAmount),n.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=n.applyTaxDeduction),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),n.quickText!==void 0&&(e.quickText=n.quickText),n.images!==void 0&&(e.images=Array.isArray(n.images)?n.images:[]),n.status!==void 0&&(e.status=n.status),e}const cs={getAllPayments:async()=>{await Vr();const n=Qe(ae,Ft.PAYMENTS),e=_t(n,Jt("id","desc"));return(await jt(e)).docs.map(s=>{const r=s.data();return va({...r,id:parseInt(s.id)||r.id})})},getPaymentById:async n=>{await Vr();const e=Te(ae,Ft.PAYMENTS,n),t=await Rt(e);if(t.exists()){const s=t.data();return va({...s,id:parseInt(t.id)||s.id})}return null},createPayment:async n=>{await Vr();const e=Qe(ae,Ft.PAYMENTS),t=await jt(e);let s=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>s&&(s=d)});const r=s+1,i=Ag(n),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},u=Te(ae,Ft.PAYMENTS,String(r));if(await Fi(u,l),i.images&&i.images.length>0)if(i.images.some(d=>Qo(d))){const d=await lu("payments",String(r),i.images);await $t(u,{images:d,imageCount:d.length}),l.images=d,l.imageCount=d.length}else await $t(u,{images:i.images,imageCount:i.images.length}),l.images=i.images,l.imageCount=i.images.length;return va(l)},updatePayment:async(n,e)=>{await Vr();const t=Te(ae,Ft.PAYMENTS,n),s=Ag(e);await $t(t,{...s,updatedAt:new Date().toISOString()});const r=await cs.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(n,e)=>{await Vr();const t=Te(ae,Ft.PAYMENTS,n),s=new Date().toISOString(),r={status:e,updatedAt:s};e==="completed"&&(r.paidAt=s),await $t(t,r);const i=await cs.getPaymentById(n);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(n,e,t)=>{await Vr();const s=Te(ae,Ft.PAYMENTS,n);await $t(s,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await cs.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(n,e)=>{const t=Te(ae,Ft.PAYMENTS,n);let s=e;return e.length>0&&e.some(i=>Qo(i))&&(s=await lu("payments",n,e)),await $t(t,{images:s,imageCount:s.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:s}},deletePayment:async n=>{const e=Te(ae,Ft.PAYMENTS,n),t=await Rt(e);if(t.exists()){const s=t.data();s.images&&s.images.length>0&&await Z0(s.images)}await Kn(e)},subscribeToPayments:n=>{let e=null;return Vr().then(()=>{const t=Qe(ae,Ft.PAYMENTS),s=_t(t,Jt("id","desc"));e=Ns(s,r=>{const i=r.docs.map(o=>{const l=o.data();return va({...l,id:parseInt(o.id)||l.id})});n(i)})}).catch(t=>{console.error("[paymentFirestoreService]       :",t)}),()=>{e&&e()}},getPaymentsByProject:async n=>{await Vr();const e=Qe(ae,Ft.PAYMENTS),t=_t(e,Wn("projectId","==",n),Jt("id","desc"));return(await jt(t)).docs.map(r=>{const i=r.data();return va({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{Si.clear(),wo=null}},Es={getAllPayments:()=>cs.getAllPayments(),getPaymentById:async n=>{const e=await cs.getPaymentById(n);if(!e)throw new Error("Payment not found");return e},createPayment:n=>cs.createPayment(n),updatePayment:(n,e)=>cs.updatePayment(n,e),updatePaymentStatus:(n,e)=>cs.updatePaymentStatus(n,e),updatePaymentAmounts:(n,e,t)=>cs.updatePaymentAmounts(n,e,t),updatePaymentImages:(n,e)=>cs.updatePaymentImages(n,e),deletePayment:n=>cs.deletePayment(n),sendTossPaymentSms:async n=>(await To.post("/payments/send-toss-payment-sms",n)).data,subscribeToPayments:cs.subscribeToPayments,getPaymentsByProject:cs.getPaymentsByProject,clearProjectsCache:cs.clearProjectsCache},co="as_requests",_a=n=>{const e=n.data();return{_id:n.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof be?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof be?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},uo={getAllASRequests:async()=>{const n=_t(Qe(ae,co),Jt("createdAt","desc"));return(await jt(n)).docs.map(_a)},getASRequestById:async n=>{const e=Te(ae,co,n),t=await Rt(e);return t.exists()?_a(t):null},createASRequest:async n=>{const e=be.now(),t={project:n.project,client:n.client,requestDate:n.requestDate instanceof Date?be.fromDate(n.requestDate):n.requestDate,siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,status:n.status||"pending",notes:n.notes||"",createdAt:e,updatedAt:e};n.scheduledVisitDate&&(t.scheduledVisitDate=n.scheduledVisitDate instanceof Date?be.fromDate(n.scheduledVisitDate):n.scheduledVisitDate),n.scheduledVisitTime&&(t.scheduledVisitTime=n.scheduledVisitTime),n.assignedTo&&(t.assignedTo=n.assignedTo);const s=await tr(Qe(ae,co),t),r=await Rt(s);return _a(r)},updateASRequest:async(n,e)=>{const t=Te(ae,co,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(s.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(s.entrancePassword=e.entrancePassword),e.description!==void 0&&(s.description=e.description),e.scheduledVisitDate!==void 0&&(s.scheduledVisitDate=e.scheduledVisitDate instanceof Date?be.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(s.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.completionDate!==void 0&&(s.completionDate=e.completionDate instanceof Date?be.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(s.notes=e.notes),e.status!==void 0&&(s.status=e.status),await $t(t,s);const r=await Rt(t);return _a(r)},deleteASRequest:async n=>{const e=Te(ae,co,n);await Kn(e)},subscribeToASRequests:n=>{const e=_t(Qe(ae,co),Jt("createdAt","desc"));return Ns(e,t=>{const s=t.docs.map(_a);n(s)})}},Ha={getAllASRequests:()=>uo.getAllASRequests(),getASRequestById:async n=>{const e=await uo.getASRequestById(n);if(!e)throw new Error("AS Request not found");return e},createASRequest:n=>uo.createASRequest(n),updateASRequest:(n,e)=>uo.updateASRequest(n,e),deleteASRequest:n=>uo.deleteASRequest(n),subscribeToASRequests:uo.subscribeToASRequests};function Da(n){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:n.id,id:parseInt(n.id)||0,name:n.name,client:{name:n.client||"",phone:"",address:n.address||""},location:{address:n.address||""},startDate:n.startDate||"",endDate:n.endDate||"",status:e[n.status]||"planning",budget:0,actualCost:0,manager:{_id:String(n.managerId||""),name:n.managerName||n.manager||"",username:n.managerUsername||""},fieldManagers:[],workers:[],colorCode:n.color||"#4A90E2",progress:0,description:n.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:n.createdAt||"",updatedAt:n.updatedAt||"",meetingNotes:n.meetingNotes||[],customerRequests:n.customerRequests||[],entrancePassword:n.entrancePassword||"",sitePassword:n.sitePassword||""}}function wg(n){var t,s,r,i,o,l,u,m;const e={};if(n.name!==void 0&&(e.name=n.name),n.client!==void 0&&(e.client=typeof n.client=="string"?n.client:((t=n.client)==null?void 0:t.name)||""),n.location!==void 0&&(e.address=typeof n.location=="string"?n.location:((s=n.location)==null?void 0:s.address)||""),n.address!==void 0&&(e.address=n.address),n.startDate!==void 0&&(e.startDate=typeof n.startDate=="string"?n.startDate:((o=(i=(r=n.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),n.endDate!==void 0&&(e.endDate=typeof n.endDate=="string"?n.endDate:((m=(u=(l=n.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),n.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[n.status]||"planning"}return n.description!==void 0&&(e.description=n.description),n.manager!==void 0&&(e.manager=n.manager),n.meetingNotes!==void 0&&(e.meetingNotes=n.meetingNotes),n.customerRequests!==void 0&&(e.customerRequests=n.customerRequests),n.entrancePassword!==void 0&&(e.entrancePassword=n.entrancePassword),n.sitePassword!==void 0&&(e.sitePassword=n.sitePassword),n.color!==void 0&&(e.color=n.color),n.colorCode!==void 0&&(e.color=n.colorCode),e}const Tr={getAllProjects:async()=>{const n=Qe(ae,Ft.PROJECTS);return(await jt(n)).docs.map(s=>{const r=s.data();return Da({...r,id:s.id})}).sort((s,r)=>(r.id||0)-(s.id||0))},getProjectById:async n=>{const e=Te(ae,Ft.PROJECTS,n),t=await Rt(e);if(t.exists()){const s=t.data();return Da({...s,id:t.id})}return null},createProject:async n=>{const e=Qe(ae,Ft.PROJECTS),t=await jt(e);let s=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>s&&(s=d)});const r=String(s+1),i=wg(n),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Te(ae,Ft.PROJECTS,r);return await Fi(u,l),Da(l)},updateProject:async(n,e)=>{const t=Te(ae,Ft.PROJECTS,n),s=wg(e);await $t(t,{...s,updatedAt:new Date().toISOString()});const r=await Tr.getProjectById(n);if(!r)throw new Error("Project not found after update");return r},deleteProject:async n=>{const e=Te(ae,Ft.PROJECTS,n);await Kn(e)},subscribeToProjects:n=>{const e=Qe(ae,Ft.PROJECTS);return Ns(e,t=>{const s=t.docs.map(r=>{const i=r.data();return Da({...i,id:r.id})});s.sort((r,i)=>(i.id||0)-(r.id||0)),n(s)})},subscribeToProject:(n,e)=>{const t=Te(ae,Ft.PROJECTS,n);return Ns(t,s=>{if(s.exists()){const r=s.data();e(Da({...r,id:s.id}))}else e(null)})}},Co={getAllProjects:()=>Tr.getAllProjects(),getProjectById:async n=>{const e=await Tr.getProjectById(n);if(!e)throw new Error("Project not found");return e},createProject:n=>Tr.createProject(n),updateProject:(n,e)=>Tr.updateProject(n,e),deleteProject:n=>Tr.deleteProject(n),subscribeToProjects:Tr.subscribeToProjects,subscribeToProject:Tr.subscribeToProject},wm=n=>n?typeof n=="string"?n:n instanceof be?n.toDate().toISOString():new Date().toISOString():new Date().toISOString(),rc={async getAllQuoteInquiries(){const n=Qe(ae,"quote_inquiries"),e=_t(n,Jt("createdAt","desc"));return(await jt(e)).docs.map(s=>{const r=s.data();return{id:s.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:wm(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(n){const e=Te(ae,"quote_inquiries",n),t=await Rt(e);if(!t.exists())return null;const s=t.data();return{id:t.id,name:s.name||"",phone:s.phone||"",email:s.email||"",address:s.address,projectType:s.projectType,budget:s.budget,message:s.message||"",createdAt:wm(s.createdAt),isRead:s.isRead||!1}},async createQuoteInquiry(n){const e=Qe(ae,"quote_inquiries"),t={...n,isRead:!1,createdAt:vn()};return{id:(await tr(e,t)).id,...n,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(n){const e=Te(ae,"quote_inquiries",n);await $t(e,{isRead:!0,updatedAt:vn()})},async deleteQuoteInquiry(n){const e=Te(ae,"quote_inquiries",n);await Kn(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(n){const e=Qe(ae,"quote_inquiries"),t=_t(e,Jt("createdAt","desc"));return Ns(t,r=>{const i=r.docs.map(o=>{const l=o.data();return{id:o.id,name:l.name||"",phone:l.phone||"",email:l.email||"",address:l.address,projectType:l.projectType,budget:l.budget,message:l.message||"",createdAt:wm(l.createdAt),isRead:l.isRead||!1}});n(i)})}},Pc={getAllQuoteInquiries:()=>rc.getAllQuoteInquiries(),markAsRead:n=>rc.markAsRead(n),deleteQuoteInquiry:n=>rc.deleteQuoteInquiry(n),subscribeToQuoteInquiries:rc.subscribeToQuoteInquiries},QC=()=>typeof window<"u"?window.location.origin:"",YC=QC();class XC{constructor(){Ep(this,"socket",null)}connect(e){return this.socket=Ma(YC,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var s;(s=this.socket)==null||s.on(e,t)}emit(e,t){var s;(s=this.socket)==null||s.emit(e,t)}off(e,t){var s;(s=this.socket)==null||s.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const Lr=new XC,JC=()=>{var le,$e;const{user:n,logout:e,loading:t}=si(),[s,r]=E.useState(!1),[i,o]=E.useState(!1),[l,u]=E.useState(!1),m=xv(),{unreadCount:d}=Y0(),[f,p]=E.useState(0),[y,C]=E.useState(0),[v,w]=E.useState(0),[R,I]=E.useState(0),[F,re]=E.useState(!1),[ee,M]=E.useState(0),[A,N]=E.useState(!1),V=E.useRef(0),j=E.useRef(null),T=80,S=E.useCallback(de=>{if(window.scrollY>0)return!1;let Re=de;for(;Re&&Re!==document.body;){const vt=window.getComputedStyle(Re).overflowY;if((vt==="auto"||vt==="scroll")&&Re.scrollTop>0)return!1;Re=Re.parentElement}return!0},[]),k=E.useCallback(de=>{if(window.innerWidth>=768)return;const Re=de.target;S(Re)&&(V.current=de.touches[0].clientY,re(!0))},[S]),Ee=E.useCallback(de=>{if(!F||A)return;const Re=de.target;if(!S(Re)){re(!1),M(0);return}const vt=de.touches[0].clientY-V.current;if(vt>0){const lt=Math.min(vt*.5,120);M(lt)}else re(!1),M(0)},[F,A,S]),qe=E.useCallback(()=>{F&&(ee>=T&&!A?(N(!0),M(50),setTimeout(()=>{window.location.reload()},300)):M(0),re(!1))},[F,ee,A]);if(E.useEffect(()=>{u(!1)},[m.pathname]),E.useEffect(()=>{const de=Re=>{u(Re.detail.isOpen)};return window.addEventListener("mobileFormStateChange",de),()=>window.removeEventListener("mobileFormStateChange",de)},[]),E.useEffect(()=>{const de=()=>{I(Re=>Math.max(0,Re-1))};return window.addEventListener("quoteInquiryRead",de),()=>window.removeEventListener("quoteInquiryRead",de)},[]),E.useEffect(()=>{const de=()=>{C(Re=>Math.max(0,Re-1))};return window.addEventListener("paymentCompleted",de),()=>window.removeEventListener("paymentCompleted",de)},[]),E.useEffect(()=>{const de=Lr.getSocket();if(!de||!n)return;const Re=async()=>{try{const[Ye,vt]=await Promise.all([Es.getAllPayments(),Co.getAllProjects()]);let lt=Ye;if(n.name===""){const It=vt.map(at=>at.name);lt=Ye.filter(at=>It.includes(at.project))}C(lt.filter(It=>It.status==="pending").length)}catch(Ye){console.error("Failed to refresh payment count:",Ye)}};return de.on("payment:refresh",Re),()=>{de.off("payment:refresh",Re)}},[n]),E.useEffect(()=>{if(!n)return;const de=async()=>{try{const[Ye,vt,lt,It]=await Promise.all([zC.getAllWorkRequests(),Es.getAllPayments(),Ha.getAllASRequests(),Co.getAllProjects()]);p(Ye.filter(ft=>ft.assignedTo===n.name&&ft.status==="pending").length);let at=vt;if(n.name===""){const ft=It.map(bn=>bn.name);at=vt.filter(bn=>ft.includes(bn.project))}if(C(at.filter(ft=>ft.status==="pending").length),w(lt.filter(ft=>ft.status==="in-progress").length),n.role==="admin"||n.role==="manager")try{const bn=(await Pc.getAllQuoteInquiries()).filter(K=>!K.isRead).length;I(bn)}catch(ft){console.error("Failed to load quote inquiry count:",ft)}}catch(Ye){console.error("Failed to load badge counts:",Ye)}};de();const Re=setInterval(de,3e4);return()=>clearInterval(Re)},[n]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!n){const de=window.location.pathname+window.location.search;return de&&de!=="/login"&&de!=="/"&&sessionStorage.setItem("redirectAfterLogin",de),a.jsxDEV(ay,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const ge=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...R>0&&{badge:R}},{name:"",href:"/contractors"}],Ue=ge.filter(de=>!de.roles||de.roles.includes((n==null?void 0:n.role)||"")),ht=((le=ge.find(de=>de.href===m.pathname))==null?void 0:le.name)||"",Ot=(()=>{const de=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(de)?()=>{const Ye=new CustomEvent("headerAddButtonClick");window.dispatchEvent(Ye)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Ls("fixed inset-0 z-40 lg:hidden",s?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Ue.map(de=>a.jsxDEV(im,{to:de.href,className:({isActive:Re})=>Ls("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Re?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Ue.map(de=>a.jsxDEV(im,{to:de.href,className:({isActive:Re})=>Ls("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Re?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),ht&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:ht},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ot&&a.jsxDEV("button",{onClick:Ot,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(wn,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV(Io,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:n==null?void 0:n.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:n==null?void 0:n.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:($e=n==null?void 0:n.name)==null?void 0:$e.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:Ue.map(de=>a.jsxDEV(im,{to:de.href,className:({isActive:Re})=>Ls("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Re?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:Ee,onTouchEnd:qe,children:[ee>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:ee,transition:F?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Ls("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",A&&"animate-spin"),style:{transform:`rotate(${A?0:ee*2}deg)`,opacity:Math.min(ee/T,1)},children:a.jsxDEV(Iv,{className:Ls("w-5 h-5",ee>=T?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:ee>0?`translateY(${ee}px)`:"none",transition:F?"none":"transform 0.2s ease-out"},children:a.jsxDEV(vv,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV($C,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},ZC=n=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,s=n==="emergency"?5:3;let r=0;const i=()=>{if(r>=s)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=n==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<s&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},e2=n=>{if("vibrate"in navigator){const e=n==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},t2=(n,e)=>{ZC(n),e2(n),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},n2=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",mo="schedules",ka=n=>{const e=n.data();return{_id:n.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof be?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof be?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof be?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},fo={getAllSchedules:async()=>{const n=_t(Qe(ae,mo),Jt("startDate","desc"));return(await jt(n)).docs.map(ka)},getScheduleById:async n=>{const e=Te(ae,mo,n),t=await Rt(e);return t.exists()?ka(t):null},createSchedule:async n=>{const e=be.now(),t={project:typeof n.project=="string"?{_id:n.project,name:n.project}:n.project,title:n.title,type:n.type||"other",phase:n.phase||"",startDate:n.startDate instanceof Date?be.fromDate(n.startDate):n.startDate,endDate:n.endDate instanceof Date?be.fromDate(n.endDate):n.endDate,allDay:n.allDay??!0,assignedTo:n.assignedTo||[],description:n.description||"",location:n.location||"",priority:n.priority||"medium",progress:n.progress??0,isCompleted:n.isCompleted??!1,time:n.time||"",asRequestId:n.asRequestId||null,createdAt:e,updatedAt:e},s=await tr(Qe(ae,mo),t),r=await Rt(s);return ka(r)},updateSchedule:async(n,e)=>{const t=Te(ae,mo,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(s.title=e.title),e.type!==void 0&&(s.type=e.type),e.phase!==void 0&&(s.phase=e.phase),e.startDate!==void 0&&(s.startDate=e.startDate instanceof Date?be.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(s.endDate=e.endDate instanceof Date?be.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(s.allDay=e.allDay),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.description!==void 0&&(s.description=e.description),e.location!==void 0&&(s.location=e.location),e.priority!==void 0&&(s.priority=e.priority),e.progress!==void 0&&(s.progress=e.progress),e.isCompleted!==void 0&&(s.isCompleted=e.isCompleted,e.isCompleted&&(s.completedAt=be.now())),e.time!==void 0&&(s.time=e.time),await $t(t,s);const r=await Rt(t);return ka(r)},deleteSchedule:async n=>{const e=Te(ae,mo,n);await Kn(e)},subscribeToSchedules:n=>{const e=_t(Qe(ae,mo),Jt("startDate","desc"));return Ns(e,t=>{const s=t.docs.map(ka);n(s)})}},ic={getAllSchedules:()=>fo.getAllSchedules(),getScheduleById:async n=>{const e=await fo.getScheduleById(n);if(!e)throw new Error("Schedule not found");return e},createSchedule:n=>fo.createSchedule(n),updateSchedule:(n,e)=>fo.updateSchedule(n,e),deleteSchedule:n=>fo.deleteSchedule(n),subscribeToSchedules:fo.subscribeToSchedules},po="contractors",Ea=n=>{const e=n.data();return{_id:n.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},ho={getAllContractors:async()=>{const n=_t(Qe(ae,po),Jt("name","asc"));return(await jt(n)).docs.map(Ea)},getContractorById:async n=>{const e=Te(ae,po,n),t=await Rt(e);return t.exists()?Ea(t):null},createContractor:async n=>{const e=be.now(),t={rank:n.rank||"",companyName:n.companyName||"",name:n.name,position:n.position||"",process:n.process,contact:n.contact||"",accountNumber:n.accountNumber,notes:n.notes||"",createdAt:e,updatedAt:e},s=await tr(Qe(ae,po),t),r=await Rt(s);return Ea(r)},updateContractor:async(n,e)=>{const t=Te(ae,po,n),s={updatedAt:be.now()};e.rank!==void 0&&(s.rank=e.rank),e.companyName!==void 0&&(s.companyName=e.companyName),e.name!==void 0&&(s.name=e.name),e.position!==void 0&&(s.position=e.position),e.process!==void 0&&(s.process=e.process),e.contact!==void 0&&(s.contact=e.contact),e.accountNumber!==void 0&&(s.accountNumber=e.accountNumber),e.notes!==void 0&&(s.notes=e.notes),await $t(t,s);const r=await Rt(t);return Ea(r)},deleteContractor:async n=>{const e=Te(ae,po,n);await Kn(e)},subscribeToContractors:n=>{const e=_t(Qe(ae,po),Jt("name","asc"));return Ns(e,t=>{const s=t.docs.map(Ea);n(s)})}},ur={getAllContractors:()=>ho.getAllContractors(),getContractorById:async n=>{const e=await ho.getContractorById(n);if(!e)throw new Error("Contractor not found");return e},createContractor:n=>ho.createContractor(n),updateContractor:(n,e)=>ho.updateContractor(n,e),deleteContractor:n=>ho.deleteContractor(n),subscribeToContractors:ho.subscribeToContractors},go="construction_payments",Aa=n=>{const e=n.data(),t=(e.payments||[]).map(r=>({types:r.types||[],amount:r.amount||0,date:r.date instanceof be?r.date.toDate().toISOString():r.date||"",method:r.method||"",notes:r.notes||""})),s={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(s.contract=e.expectedPaymentDates.contract instanceof be?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(s.start=e.expectedPaymentDates.start instanceof be?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(s.middle=e.expectedPaymentDates.middle instanceof be?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(s.final=e.expectedPaymentDates.final instanceof be?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:n.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:t,expectedPaymentDates:s,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},yo={getAllConstructionPayments:async()=>{const n=_t(Qe(ae,go),Jt("createdAt","desc"));return(await jt(n)).docs.map(Aa)},getConstructionPaymentById:async n=>{const e=Te(ae,go,n),t=await Rt(e);return t.exists()?Aa(t):null},createConstructionPayment:async n=>{const e=be.now(),t=(n.payments||[]).map(l=>({types:l.types,amount:l.amount,date:l.date instanceof Date?be.fromDate(l.date):l.date,method:l.method,notes:l.notes||""})),s={};n.expectedPaymentDates&&(n.expectedPaymentDates.contract&&(s.contract=n.expectedPaymentDates.contract instanceof Date?be.fromDate(n.expectedPaymentDates.contract):n.expectedPaymentDates.contract),n.expectedPaymentDates.start&&(s.start=n.expectedPaymentDates.start instanceof Date?be.fromDate(n.expectedPaymentDates.start):n.expectedPaymentDates.start),n.expectedPaymentDates.middle&&(s.middle=n.expectedPaymentDates.middle instanceof Date?be.fromDate(n.expectedPaymentDates.middle):n.expectedPaymentDates.middle),n.expectedPaymentDates.final&&(s.final=n.expectedPaymentDates.final instanceof Date?be.fromDate(n.expectedPaymentDates.final):n.expectedPaymentDates.final));const r={project:n.project,client:n.client,totalAmount:n.totalAmount,vatType:n.vatType,vatPercentage:n.vatPercentage,vatAmount:n.vatAmount,payments:t,expectedPaymentDates:s,createdAt:e,updatedAt:e},i=await tr(Qe(ae,go),r),o=await Rt(i);return Aa(o)},updateConstructionPayment:async(n,e)=>{const t=Te(ae,go,n),s={updatedAt:be.now()};if(e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.totalAmount!==void 0&&(s.totalAmount=e.totalAmount),e.vatType!==void 0&&(s.vatType=e.vatType),e.vatPercentage!==void 0&&(s.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(s.vatAmount=e.vatAmount),e.payments!==void 0&&(s.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?be.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?be.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?be.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?be.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?be.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),s.expectedPaymentDates=i}await $t(t,s);const r=await Rt(t);return Aa(r)},deleteConstructionPayment:async n=>{const e=Te(ae,go,n);await Kn(e)},subscribeToConstructionPayments:n=>{const e=_t(Qe(ae,go),Jt("createdAt","desc"));return Ns(e,t=>{const s=t.docs.map(Aa);n(s)})}},oc={getAllConstructionPayments:()=>yo.getAllConstructionPayments(),getConstructionPaymentById:async n=>{const e=await yo.getConstructionPaymentById(n);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:n=>yo.createConstructionPayment(n),updateConstructionPayment:(n,e)=>yo.updateConstructionPayment(n,e),deleteConstructionPayment:n=>yo.deleteConstructionPayment(n),subscribeToConstructionPayments:yo.subscribeToConstructionPayments};let Lc=new Map,wa=null;async function s2(){if(!(Lc.size>0))return wa||(wa=(async()=>{try{const n=Qe(ae,Ft.PROJECTS);(await jt(n)).docs.forEach(t=>{const s=t.data(),r=parseInt(t.id);!isNaN(r)&&s.name&&Lc.set(s.name,r)}),console.log("[executionRecordFirestoreService]    :",Lc.size,"")}catch(n){throw console.error("[executionRecordFirestoreService]    :",n),wa=null,n}})(),wa)}function bo(n){return{id:n.id,project_id:n.projectId,project_name:n.projectName||"",author:n.author||"",date:n.date||"",process:n.process||"",item_name:n.itemName||"",material_cost:n.materialCost||0,labor_cost:n.laborCost||0,vat_amount:n.vatAmount||0,total_amount:n.totalAmount||0,notes:n.notes||"",images:n.images||[],payment_id:n.paymentId,includes_tax_deduction:n.includesTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,created_at:n.createdAt||"",updated_at:n.updatedAt||""}}function Vg(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.project_name!==void 0&&(e.projectName=n.project_name),n.projectName!==void 0&&(e.projectName=n.projectName),n.author!==void 0&&(e.author=n.author),n.date!==void 0&&(e.date=n.date),n.process!==void 0&&(e.process=n.process),n.item_name!==void 0&&(e.itemName=n.item_name),n.itemName!==void 0&&(e.itemName=n.itemName),n.material_cost!==void 0&&(e.materialCost=n.material_cost),n.materialCost!==void 0&&(e.materialCost=n.materialCost),n.labor_cost!==void 0&&(e.laborCost=n.labor_cost),n.laborCost!==void 0&&(e.laborCost=n.laborCost),n.vat_amount!==void 0&&(e.vatAmount=n.vat_amount),n.vatAmount!==void 0&&(e.vatAmount=n.vatAmount),n.total_amount!==void 0&&(e.totalAmount=n.total_amount),n.totalAmount!==void 0&&(e.totalAmount=n.totalAmount),n.notes!==void 0&&(e.notes=n.notes),n.images!==void 0&&(e.images=n.images),n.payment_id!==void 0&&(e.paymentId=n.payment_id),n.paymentId!==void 0&&(e.paymentId=n.paymentId),n.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=n.includes_tax_deduction===!0||n.includes_tax_deduction===1),n.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=n.includesTaxDeduction),n.includes_vat!==void 0&&(e.includesVAT=n.includes_vat===!0||n.includes_vat===1),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),e}const lr={getAllRecords:async()=>{const n=Qe(ae,Ft.EXECUTION_RECORDS),e=_t(n,Jt("id","desc"));return(await jt(e)).docs.map(s=>{const r=s.data();return bo({...r,id:parseInt(s.id)||r.id})})},getRecordById:async n=>{const e=Te(ae,Ft.EXECUTION_RECORDS,n),t=await Rt(e);if(t.exists()){const s=t.data();return bo({...s,id:parseInt(t.id)||s.id})}return null},createRecord:async n=>{await s2();const e=Qe(ae,Ft.EXECUTION_RECORDS),t=await jt(e);let s=0;t.docs.forEach(f=>{const p=parseInt(f.id);!isNaN(p)&&p>s&&(s=p)});const r=s+1,i=Vg(n),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const f=Lc.get(u);f?(l=f,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:[],imageCount:0},d=Te(ae,Ft.EXECUTION_RECORDS,String(r));if(await Fi(d,m),i.images&&i.images.length>0)if(i.images.some(p=>Qo(p))){const p=await lu("execution_records",String(r),i.images);await $t(d,{images:p,imageCount:p.length}),m.images=p,m.imageCount=p.length}else await $t(d,{images:i.images,imageCount:i.images.length}),m.images=i.images,m.imageCount=i.images.length;return bo(m)},updateRecord:async(n,e)=>{const t=Te(ae,Ft.EXECUTION_RECORDS,n),s=Vg(e);s.images!==void 0&&(s.images.some(o=>Qo(o))&&(s.images=await lu("execution_records",n,s.images)),s.imageCount=s.images.length),await $t(t,{...s,updatedAt:new Date().toISOString()});const r=await lr.getRecordById(n);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async n=>{const e=Te(ae,Ft.EXECUTION_RECORDS,n),t=await Rt(e);if(t.exists()){const s=t.data();s.images&&s.images.length>0&&await Z0(s.images)}await Kn(e)},subscribeToRecords:n=>{const e=Qe(ae,Ft.EXECUTION_RECORDS),t=_t(e,Jt("id","desc"));return Ns(t,s=>{const r=s.docs.map(i=>{const o=i.data();return bo({...o,id:parseInt(i.id)||o.id})});n(r)})},getRecordsByProject:async n=>{const e=Qe(ae,Ft.EXECUTION_RECORDS),t=_t(e,Wn("projectId","==",n),Jt("id","desc"));return(await jt(t)).docs.map(r=>{const i=r.data();return bo({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async n=>{const e=Qe(ae,Ft.EXECUTION_RECORDS),t=_t(e,Wn("paymentId","==",n)),s=await jt(t);if(s.empty)return null;const r=s.docs[0],i=r.data();return bo({...i,id:parseInt(r.id)||i.id})}},ac={getAllRecords:()=>lr.getAllRecords(),getRecordById:async n=>{const e=await lr.getRecordById(n);if(!e)throw new Error("Execution record not found");return e},createRecord:n=>lr.createRecord(n),updateRecord:(n,e)=>lr.updateRecord(n,e),deleteRecord:n=>lr.deleteRecord(n),subscribeToRecords:lr.subscribeToRecords,getRecordsByProject:lr.getRecordsByProject,getRecordByPaymentId:lr.getRecordByPaymentId},Xr=Sd()(Q0((n,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>n({projects:t}),addProject:t=>n(s=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...s.projects],constructionPayments:[r,...s.constructionPayments]}}),updateProject:(t,s)=>n(r=>({projects:r.projects.map(i=>i.id===t?{...i,...s}:i)})),deleteProject:t=>n(s=>({projects:s.projects.filter(r=>r.id!==t),constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>n({schedules:t}),addSchedule:t=>n(s=>({schedules:[t,...s.schedules]})),updateSchedule:(t,s)=>n(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...s}:i)})),deleteSchedule:t=>n(s=>({schedules:s.schedules.filter(r=>r.id!==t)})),setPayments:t=>n({payments:t}),addPayment:t=>n(s=>({payments:[t,...s.payments]})),updatePayment:(t,s)=>n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)})),deletePayment:t=>n(s=>({payments:s.payments.filter(r=>r.id!==t)})),setContractors:t=>n({contractors:t}),addContractor:t=>n(s=>({contractors:[t,...s.contractors]})),updateContractor:(t,s)=>n(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...s}:i)})),deleteContractor:t=>n(s=>({contractors:s.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>n({constructionPayments:t}),addConstructionPayment:t=>n(s=>({constructionPayments:[t,...s.constructionPayments]})),updateConstructionPayment:(t,s)=>n(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...s}:i)})),deleteConstructionPayment:t=>n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>n({asRequests:t}),addASRequest:t=>n(s=>({asRequests:[t,...s.asRequests]})),updateASRequest:(t,s)=>n(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...s}:i)})),deleteASRequest:t=>n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>n({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),n(s=>{const r=[t,...s.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,s)=>n(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...s}:i)})),deleteExecutionRecord:t=>n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await Es.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const s=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const p=JSON.parse(d.images);return Array.isArray(p)?p:[]}catch(p){return console.error("  :",p),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));s.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(s.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",s.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(C=>C.id)),f=s.filter(C=>!d.has(C.id)),y=[...m.map(C=>({...C,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),n({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),n({payments:s})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const s=`temp_${Date.now()}`,r={...t,id:s,_addedAt:Date.now(),_tempId:s};n(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",s);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await Es.createPayment(u),d=String(m.id);return n(f=>({payments:f.payments.map(p=>p._tempId===s?{...p,id:d,_addedAt:Date.now()}:p)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),n(o=>({payments:o.payments.filter(l=>l._tempId!==s)})),i}},updatePaymentInAPI:async(t,s)=>{try{if(s.status&&Object.keys(s).length===1)await Es.updatePaymentStatus(t,s.status);else{let r=s.project;if(s.project){const o=e().projects.find(l=>l.name===s.project);r=o?o.id:s.project}await Es.updatePayment(t,{projectId:r,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,materialAmount:s.materialAmount,laborAmount:s.laborAmount,originalMaterialAmount:s.originalMaterialAmount,originalLaborAmount:s.originalLaborAmount,category:s.category,urgency:s.urgency,bankInfo:s.bankInfo,notes:s.notes,requestDate:s.requestDate,includesVAT:s.includesVAT,applyTaxDeduction:s.applyTaxDeduction})}n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await Es.deletePayment(t),n(s=>({payments:s.payments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete payment from API:",s),s}},loadSchedulesFromAPI:async()=>{try{const t=await ic.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const s=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});s.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),n({schedules:s})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const s=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:s};n(l=>({schedules:[...l.schedules,r]}));try{const l=await ic.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};n(f=>({schedules:f.schedules.map(p=>p.id===s?d:p)}))}catch(l){throw console.error("Failed to add schedule to API:",l),n(u=>({schedules:u.schedules.filter(m=>m.id!==s)})),l}},updateScheduleInAPI:async(t,s)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:s});const l={};s.project!==void 0&&(l.project=s.project),s.title!==void 0&&(l.title=s.title),s.type!==void 0&&(l.type=s.type),s.start!==void 0&&(l.startDate=s.start),s.end!==void 0&&(l.endDate=s.end),s.location!==void 0&&(l.location=s.location),s.description!==void 0&&(l.description=s.description),s.attendees!==void 0&&(l.assignedTo=s.attendees),s.time!==void 0&&(l.time=s.time),console.log(" Sending update data:",l);const u=await ic.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};n(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:s}=e(),r=s.find(o=>o.id===t);if(r){n(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await ic.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&n(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const s=(await Co.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});n({projects:s})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var s,r;try{const i=await Co.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((s=i.meetingNotes)==null?void 0:s.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};n(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,s)=>{var r,i;try{const o=await Co.updateProject(t,s),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:typeof o.manager=="object"&&o.manager!==null?o.manager.name||"":o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};n(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await Co.deleteProject(t),n(s=>({projects:s.projects.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete project from API:",s),s}},loadContractorsFromAPI:async()=>{try{const s=(await ur.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));n({contractors:s})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const s=await ur.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:s._id,rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)};n(i=>({contractors:[r,...i.contractors]}))}catch(s){throw console.error("Failed to add contractor to API:",s),s}},updateContractorInAPI:async(t,s)=>{try{const r=await ur.updateContractor(t,{rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};n(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await ur.deleteContractor(t),n(s=>({contractors:s.contractors.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete contractor from API:",s),s}},loadConstructionPaymentsFromAPI:async()=>{try{const s=(await oc.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});n({constructionPayments:s})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var s;try{const r=await oc.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((s=r.payments)==null?void 0:s.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};n(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,s)=>{var r;try{const i=await oc.updateConstructionPayment(t,s);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};n(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await oc.deleteConstructionPayment(t),n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete construction payment from API:",s),s}},loadASRequestsFromAPI:async()=>{try{const s=(await Ha.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));n({asRequests:s})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const s=await Ha.createASRequest(t),r={id:s._id,project:s.project,client:s.client,requestDate:new Date(s.requestDate),siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,scheduledVisitDate:s.scheduledVisitDate?new Date(s.scheduledVisitDate):void 0,scheduledVisitTime:s.scheduledVisitTime,assignedTo:Array.isArray(s.assignedTo)?s.assignedTo:[],completionDate:s.completionDate?new Date(s.completionDate):void 0,notes:s.notes};return n(i=>({asRequests:[r,...i.asRequests]})),r}catch(s){throw console.error("Failed to add AS request to API:",s),s}},updateASRequestInAPI:async(t,s)=>{try{const r=await Ha.updateASRequest(t,s),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};n(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await Ha.deleteASRequest(t),n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete AS request from API:",s),s}},loadExecutionRecordsFromAPI:async()=>{try{const t=await ac.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const s=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));n({executionRecords:s})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const s=await ac.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(s.id),project:s.project_name,author:s.author||void 0,date:new Date(s.date),process:s.process||void 0,itemName:s.item_name,materialCost:s.material_cost||0,laborCost:s.labor_cost||0,vatAmount:s.vat_amount||0,totalAmount:s.total_amount||0,notes:s.notes||void 0,paymentId:s.payment_id?String(s.payment_id):void 0,includesTaxDeduction:s.includes_tax_deduction===1,includesVat:s.includes_vat===1,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",s.includes_vat),n(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(s){throw console.error("Failed to add execution record to API:",s),s}},updateExecutionRecordInAPI:async(t,s)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",s);try{let r;if(s.date){const i=s.date instanceof Date?s.date:new Date(s.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:s.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat),await ac.updateRecord(t,{project_name:s.project,author:s.author,date:r,process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,images:s.images,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),n(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...s,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await ac.deleteRecord(t),n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete execution record from API:",s),s}}}),{name:"interior-management-storage",partialize:n=>({...n,payments:n.payments.map(e=>{const{images:t,...s}=e;return s}),executionRecords:n.executionRecords.map(e=>{const{images:t,...s}=e;return s})}),storage:{getItem:n=>{var u,m,d,f,p,y,C;const e=localStorage.getItem(n);if(!e)return null;const{state:t}=JSON.parse(e),s=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var w;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((w=v.payments)==null?void 0:w.map(R=>({...R,date:new Date(R.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=s.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:s,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((p=t.contractors)==null?void 0:p.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((y=t.asRequests)==null?void 0:y.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((C=t.executionRecords)==null?void 0:C.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(n,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(n,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:n=>localStorage.removeItem(n)}}));var Rl=n=>n.type==="checkbox",ki=n=>n instanceof Date,is=n=>n==null;const ex=n=>typeof n=="object";var In=n=>!is(n)&&!Array.isArray(n)&&ex(n)&&!ki(n),r2=n=>In(n)&&n.target?Rl(n.target)?n.target.checked:n.target.value:n,i2=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,o2=(n,e)=>n.has(i2(e)),a2=n=>{const e=n.constructor&&n.constructor.prototype;return In(e)&&e.hasOwnProperty("isPrototypeOf")},Qf=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Mn(n){let e;const t=Array.isArray(n),s=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(Qf&&(n instanceof Blob||s))&&(t||In(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!a2(n))e=n;else for(const r in n)n.hasOwnProperty(r)&&(e[r]=Mn(n[r]));else return n;return e}var Fu=n=>/^\w*$/.test(n),En=n=>n===void 0,Yf=n=>Array.isArray(n)?n.filter(Boolean):[],Xf=n=>Yf(n.replace(/["|']|\]/g,"").split(/\.|\[/)),Be=(n,e,t)=>{if(!e||!In(n))return t;const s=(Fu(e)?[e]:Xf(e)).reduce((r,i)=>is(r)?r:r[i],n);return En(s)||s===n?En(n[e])?t:n[e]:s},Ks=n=>typeof n=="boolean",on=(n,e,t)=>{let s=-1;const r=Fu(e)?[e]:Xf(e),i=r.length,o=i-1;for(;++s<i;){const l=r[s];let u=t;if(s!==o){const m=n[l];u=In(m)||Array.isArray(m)?m:isNaN(+r[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=u,n=n[l]}};const Cg={BLUR:"blur",FOCUS_OUT:"focusout"},Rs={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},or={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},l2=mt.createContext(null);l2.displayName="HookFormContext";var c2=(n,e,t,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in n)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==Rs.all&&(e._proxyFormState[o]=!s||Rs.all),n[o]}});return r};const u2=typeof window<"u"?mt.useLayoutEffect:mt.useEffect;var hs=n=>typeof n=="string",m2=(n,e,t,s,r)=>hs(n)?(s&&e.watch.add(n),Be(t,n,r)):Array.isArray(n)?n.map(i=>(s&&e.watch.add(i),Be(t,i))):(s&&(e.watchAll=!0),t),kd=n=>is(n)||!ex(n);function Ur(n,e,t=new WeakSet){if(kd(n)||kd(e))return n===e;if(ki(n)&&ki(e))return n.getTime()===e.getTime();const s=Object.keys(n),r=Object.keys(e);if(s.length!==r.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const i of s){const o=n[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(ki(o)&&ki(l)||In(o)&&In(l)||Array.isArray(o)&&Array.isArray(l)?!Ur(o,l,t):o!==l)return!1}}return!0}var d2=(n,e,t,s,r)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[s]:r||!0}}:{},Xa=n=>Array.isArray(n)?n:[n],Ig=()=>{let n=[];return{get observers(){return n},next:r=>{for(const i of n)i.next&&i.next(r)},subscribe:r=>(n.push(r),{unsubscribe:()=>{n=n.filter(i=>i!==r)}}),unsubscribe:()=>{n=[]}}};function tx(n,e){const t={};for(const s in n)if(n.hasOwnProperty(s)){const r=n[s],i=e[s];if(r&&In(r)&&i){const o=tx(r,i);In(o)&&(t[s]=o)}else n[s]&&(t[s]=i)}return t}var us=n=>In(n)&&!Object.keys(n).length,Jf=n=>n.type==="file",Bs=n=>typeof n=="function",cu=n=>{if(!Qf)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},nx=n=>n.type==="select-multiple",Zf=n=>n.type==="radio",f2=n=>Zf(n)||Rl(n),Vm=n=>cu(n)&&n.isConnected;function p2(n,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)n=En(n)?s++:n[e[s++]];return n}function h2(n){for(const e in n)if(n.hasOwnProperty(e)&&!En(n[e]))return!1;return!0}function Dn(n,e){const t=Array.isArray(e)?e:Fu(e)?[e]:Xf(e),s=t.length===1?n:p2(n,t),r=t.length-1,i=t[r];return s&&delete s[i],r!==0&&(In(s)&&us(s)||Array.isArray(s)&&h2(s))&&Dn(n,t.slice(0,-1)),n}var g2=n=>{for(const e in n)if(Bs(n[e]))return!0;return!1};function sx(n){return Array.isArray(n)||In(n)&&!g2(n)}function Ed(n,e={}){for(const t in n)sx(n[t])?(e[t]=Array.isArray(n[t])?[]:{},Ed(n[t],e[t])):is(n[t])||(e[t]=!0);return e}function Vo(n,e,t){t||(t=Ed(e));for(const s in n)sx(n[s])?En(e)||kd(t[s])?t[s]=Ed(n[s],Array.isArray(n[s])?[]:{}):Vo(n[s],is(e)?{}:e[s],t[s]):t[s]=!Ur(n[s],e[s]);return t}const Sg={value:!1,isValid:!1},Tg={value:!0,isValid:!0};var rx=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!En(n[0].attributes.value)?En(n[0].value)||n[0].value===""?Tg:{value:n[0].value,isValid:!0}:Tg:Sg}return Sg},ix=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>En(n)?n:e?n===""?NaN:n&&+n:t&&hs(n)?new Date(n):s?s(n):n;const Pg={isValid:!1,value:null};var ox=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Pg):Pg;function Lg(n){const e=n.ref;return Jf(e)?e.files:Zf(e)?ox(n.refs).value:nx(e)?[...e.selectedOptions].map(({value:t})=>t):Rl(e)?rx(n.refs).value:ix(En(e.value)?n.ref.value:e.value,n)}var y2=(n,e,t,s)=>{const r={};for(const i of n){const o=Be(e,i);o&&on(r,i,o._f)}return{criteriaMode:t,names:[...n],fields:r,shouldUseNativeValidation:s}},uu=n=>n instanceof RegExp,Va=n=>En(n)?n:uu(n)?n.source:In(n)?uu(n.value)?n.value.source:n.value:n,jg=n=>({isOnSubmit:!n||n===Rs.onSubmit,isOnBlur:n===Rs.onBlur,isOnChange:n===Rs.onChange,isOnAll:n===Rs.all,isOnTouch:n===Rs.onTouched});const Rg="AsyncFunction";var b2=n=>!!n&&!!n.validate&&!!(Bs(n.validate)&&n.validate.constructor.name===Rg||In(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===Rg)),N2=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),Bg=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(s=>n.startsWith(s)&&/^\.\w+/.test(n.slice(s.length))));const Ja=(n,e,t,s)=>{for(const r of t||Object.keys(n)){const i=Be(n,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(Ja(l,e))break}else if(In(l)&&Ja(l,e))break}}};function Ug(n,e,t){const s=Be(n,t);if(s||Fu(t))return{error:s,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Be(e,i),l=Be(n,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var x2=(n,e,t,s)=>{t(n);const{name:r,...i}=n;return us(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||Rs.all))},v2=(n,e,t)=>!n||!e||n===e||Xa(n).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),_2=(n,e,t,s,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||n):(t?s.isOnBlur:r.isOnBlur)?!n:(t?s.isOnChange:r.isOnChange)?n:!0,D2=(n,e)=>!Yf(Be(n,e)).length&&Dn(n,e),k2=(n,e,t)=>{const s=Xa(Be(n,t));return on(s,"root",e[t]),on(n,t,s),n};function Hg(n,e,t="validate"){if(hs(n)||Array.isArray(n)&&n.every(hs)||Ks(n)&&!n)return{type:t,message:hs(n)?n:"",ref:e}}var No=n=>In(n)&&!uu(n)?n:{value:n,message:""},Mg=async(n,e,t,s,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:p,pattern:y,validate:C,name:v,valueAsNumber:w,mount:R}=n._f,I=Be(t,v);if(!R||e.has(v))return{};const F=l?l[0]:o,re=S=>{r&&F.reportValidity&&(F.setCustomValidity(Ks(S)?"":S||""),F.reportValidity())},ee={},M=Zf(o),A=Rl(o),N=M||A,V=(w||Jf(o))&&En(o.value)&&En(I)||cu(o)&&o.value===""||I===""||Array.isArray(I)&&!I.length,j=d2.bind(null,v,s,ee),T=(S,k,Ee,qe=or.maxLength,ge=or.minLength)=>{const Ue=S?k:Ee;ee[v]={type:S?qe:ge,message:Ue,ref:o,...j(S?qe:ge,Ue)}};if(i?!Array.isArray(I)||!I.length:u&&(!N&&(V||is(I))||Ks(I)&&!I||A&&!rx(l).isValid||M&&!ox(l).isValid)){const{value:S,message:k}=hs(u)?{value:!!u,message:u}:No(u);if(S&&(ee[v]={type:or.required,message:k,ref:F,...j(or.required,k)},!s))return re(k),ee}if(!V&&(!is(f)||!is(p))){let S,k;const Ee=No(p),qe=No(f);if(!is(I)&&!isNaN(I)){const ge=o.valueAsNumber||I&&+I;is(Ee.value)||(S=ge>Ee.value),is(qe.value)||(k=ge<qe.value)}else{const ge=o.valueAsDate||new Date(I),Ue=Ot=>new Date(new Date().toDateString()+" "+Ot),ht=o.type=="time",Kt=o.type=="week";hs(Ee.value)&&I&&(S=ht?Ue(I)>Ue(Ee.value):Kt?I>Ee.value:ge>new Date(Ee.value)),hs(qe.value)&&I&&(k=ht?Ue(I)<Ue(qe.value):Kt?I<qe.value:ge<new Date(qe.value))}if((S||k)&&(T(!!S,Ee.message,qe.message,or.max,or.min),!s))return re(ee[v].message),ee}if((m||d)&&!V&&(hs(I)||i&&Array.isArray(I))){const S=No(m),k=No(d),Ee=!is(S.value)&&I.length>+S.value,qe=!is(k.value)&&I.length<+k.value;if((Ee||qe)&&(T(Ee,S.message,k.message),!s))return re(ee[v].message),ee}if(y&&!V&&hs(I)){const{value:S,message:k}=No(y);if(uu(S)&&!I.match(S)&&(ee[v]={type:or.pattern,message:k,ref:o,...j(or.pattern,k)},!s))return re(k),ee}if(C){if(Bs(C)){const S=await C(I,t),k=Hg(S,F);if(k&&(ee[v]={...k,...j(or.validate,k.message)},!s))return re(k.message),ee}else if(In(C)){let S={};for(const k in C){if(!us(S)&&!s)break;const Ee=Hg(await C[k](I,t),F,k);Ee&&(S={...Ee,...j(k,Ee.message)},re(Ee.message),s&&(ee[v]=S))}if(!us(S)&&(ee[v]={ref:F,...S},!s))return ee}}return re(!0),ee};const E2={mode:Rs.onSubmit,reValidateMode:Rs.onChange,shouldFocusError:!0};function A2(n={}){let e={...E2,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Bs(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=In(e.defaultValues)||In(e.values)?Mn(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Mn(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const p={array:Ig(),state:Ig()},y=e.criteriaMode===Rs.all,C=P=>q=>{clearTimeout(m),m=setTimeout(P,q)},v=async P=>{if(!e.disabled&&(d.isValid||f.isValid||P)){const q=e.resolver?us((await A()).errors):await V(s,!0);q!==t.isValid&&p.state.next({isValid:q})}},w=(P,q)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((P||Array.from(l.mount)).forEach(te=>{te&&(q?on(t.validatingFields,te,q):Dn(t.validatingFields,te))}),p.state.next({validatingFields:t.validatingFields,isValidating:!us(t.validatingFields)}))},R=(P,q=[],te,xe,ue=!0,fe=!0)=>{if(xe&&te&&!e.disabled){if(o.action=!0,fe&&Array.isArray(Be(s,P))){const Ie=te(Be(s,P),xe.argA,xe.argB);ue&&on(s,P,Ie)}if(fe&&Array.isArray(Be(t.errors,P))){const Ie=te(Be(t.errors,P),xe.argA,xe.argB);ue&&on(t.errors,P,Ie),D2(t.errors,P)}if((d.touchedFields||f.touchedFields)&&fe&&Array.isArray(Be(t.touchedFields,P))){const Ie=te(Be(t.touchedFields,P),xe.argA,xe.argB);ue&&on(t.touchedFields,P,Ie)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=Vo(r,i)),p.state.next({name:P,isDirty:T(P,q),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else on(i,P,q)},I=(P,q)=>{on(t.errors,P,q),p.state.next({errors:t.errors})},F=P=>{t.errors=P,p.state.next({errors:t.errors,isValid:!1})},re=(P,q,te,xe)=>{const ue=Be(s,P);if(ue){const fe=Be(i,P,En(te)?Be(r,P):te);En(fe)||xe&&xe.defaultChecked||q?on(i,P,q?fe:Lg(ue._f)):Ee(P,fe),o.mount&&v()}},ee=(P,q,te,xe,ue)=>{let fe=!1,Ie=!1;const ze={name:P};if(!e.disabled){if(!te||xe){(d.isDirty||f.isDirty)&&(Ie=t.isDirty,t.isDirty=ze.isDirty=T(),fe=Ie!==ze.isDirty);const tt=Ur(Be(r,P),q);Ie=!!Be(t.dirtyFields,P),tt?Dn(t.dirtyFields,P):on(t.dirtyFields,P,!0),ze.dirtyFields=t.dirtyFields,fe=fe||(d.dirtyFields||f.dirtyFields)&&Ie!==!tt}if(te){const tt=Be(t.touchedFields,P);tt||(on(t.touchedFields,P,te),ze.touchedFields=t.touchedFields,fe=fe||(d.touchedFields||f.touchedFields)&&tt!==te)}fe&&ue&&p.state.next(ze)}return fe?ze:{}},M=(P,q,te,xe)=>{const ue=Be(t.errors,P),fe=(d.isValid||f.isValid)&&Ks(q)&&t.isValid!==q;if(e.delayError&&te?(u=C(()=>I(P,te)),u(e.delayError)):(clearTimeout(m),u=null,te?on(t.errors,P,te):Dn(t.errors,P)),(te?!Ur(ue,te):ue)||!us(xe)||fe){const Ie={...xe,...fe&&Ks(q)?{isValid:q}:{},errors:t.errors,name:P};t={...t,...Ie},p.state.next(Ie)}},A=async P=>{w(P,!0);const q=await e.resolver(i,e.context,y2(P||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return w(P),q},N=async P=>{const{errors:q}=await A(P);if(P)for(const te of P){const xe=Be(q,te);xe?on(t.errors,te,xe):Dn(t.errors,te)}else t.errors=q;return q},V=async(P,q,te={valid:!0})=>{for(const xe in P){const ue=P[xe];if(ue){const{_f:fe,...Ie}=ue;if(fe){const ze=l.array.has(fe.name),tt=ue._f&&b2(ue._f);tt&&d.validatingFields&&w([fe.name],!0);const Ae=await Mg(ue,l.disabled,i,y,e.shouldUseNativeValidation&&!q,ze);if(tt&&d.validatingFields&&w([fe.name]),Ae[fe.name]&&(te.valid=!1,q))break;!q&&(Be(Ae,fe.name)?ze?k2(t.errors,Ae,fe.name):on(t.errors,fe.name,Ae[fe.name]):Dn(t.errors,fe.name))}!us(Ie)&&await V(Ie,q,te)}}return te.valid},j=()=>{for(const P of l.unMount){const q=Be(s,P);q&&(q._f.refs?q._f.refs.every(te=>!Vm(te)):!Vm(q._f.ref))&&lt(P)}l.unMount=new Set},T=(P,q)=>!e.disabled&&(P&&q&&on(i,P,q),!Ur(Ot(),r)),S=(P,q,te)=>m2(P,l,{...o.mount?i:En(q)?r:hs(P)?{[P]:q}:q},te,q),k=P=>Yf(Be(o.mount?i:r,P,e.shouldUnregister?Be(r,P,[]):[])),Ee=(P,q,te={})=>{const xe=Be(s,P);let ue=q;if(xe){const fe=xe._f;fe&&(!fe.disabled&&on(i,P,ix(q,fe)),ue=cu(fe.ref)&&is(q)?"":q,nx(fe.ref)?[...fe.ref.options].forEach(Ie=>Ie.selected=ue.includes(Ie.value)):fe.refs?Rl(fe.ref)?fe.refs.forEach(Ie=>{(!Ie.defaultChecked||!Ie.disabled)&&(Array.isArray(ue)?Ie.checked=!!ue.find(ze=>ze===Ie.value):Ie.checked=ue===Ie.value||!!ue)}):fe.refs.forEach(Ie=>Ie.checked=Ie.value===ue):Jf(fe.ref)?fe.ref.value="":(fe.ref.value=ue,fe.ref.type||p.state.next({name:P,values:Mn(i)})))}(te.shouldDirty||te.shouldTouch)&&ee(P,ue,te.shouldTouch,te.shouldDirty,!0),te.shouldValidate&&Kt(P)},qe=(P,q,te)=>{for(const xe in q){if(!q.hasOwnProperty(xe))return;const ue=q[xe],fe=P+"."+xe,Ie=Be(s,fe);(l.array.has(P)||In(ue)||Ie&&!Ie._f)&&!ki(ue)?qe(fe,ue,te):Ee(fe,ue,te)}},ge=(P,q,te={})=>{const xe=Be(s,P),ue=l.array.has(P),fe=Mn(q);on(i,P,fe),ue?(p.array.next({name:P,values:Mn(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&te.shouldDirty&&p.state.next({name:P,dirtyFields:Vo(r,i),isDirty:T(P,fe)})):xe&&!xe._f&&!is(fe)?qe(P,fe,te):Ee(P,fe,te),Bg(P,l)&&p.state.next({...t,name:P}),p.state.next({name:o.mount?P:void 0,values:Mn(i)})},Ue=async P=>{o.mount=!0;const q=P.target;let te=q.name,xe=!0;const ue=Be(s,te),fe=tt=>{xe=Number.isNaN(tt)||ki(tt)&&isNaN(tt.getTime())||Ur(tt,Be(i,te,tt))},Ie=jg(e.mode),ze=jg(e.reValidateMode);if(ue){let tt,Ae;const On=q.type?Lg(ue._f):r2(P),Ht=P.type===Cg.BLUR||P.type===Cg.FOCUS_OUT,ne=!N2(ue._f)&&!e.resolver&&!Be(t.errors,te)&&!ue._f.deps||_2(Ht,Be(t.touchedFields,te),t.isSubmitted,ze,Ie),Je=Bg(te,l,Ht);on(i,te,On),Ht?(!q||!q.readOnly)&&(ue._f.onBlur&&ue._f.onBlur(P),u&&u(0)):ue._f.onChange&&ue._f.onChange(P);const O=ee(te,On,Ht),ve=!us(O)||Je;if(!Ht&&p.state.next({name:te,type:P.type,values:Mn(i)}),ne)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?Ht&&v():Ht||v()),ve&&p.state.next({name:te,...Je?{}:O});if(!Ht&&Je&&p.state.next({...t}),e.resolver){const{errors:ke}=await A([te]);if(fe(On),xe){const je=Ug(t.errors,s,te),me=Ug(ke,s,je.name||te);tt=me.error,te=me.name,Ae=us(ke)}}else w([te],!0),tt=(await Mg(ue,l.disabled,i,y,e.shouldUseNativeValidation))[te],w([te]),fe(On),xe&&(tt?Ae=!1:(d.isValid||f.isValid)&&(Ae=await V(s,!0)));xe&&(ue._f.deps&&(!Array.isArray(ue._f.deps)||ue._f.deps.length>0)&&Kt(ue._f.deps),M(te,Ae,tt,O))}},ht=(P,q)=>{if(Be(t.errors,q)&&P.focus)return P.focus(),1},Kt=async(P,q={})=>{let te,xe;const ue=Xa(P);if(e.resolver){const fe=await N(En(P)?P:ue);te=us(fe),xe=P?!ue.some(Ie=>Be(fe,Ie)):te}else P?(xe=(await Promise.all(ue.map(async fe=>{const Ie=Be(s,fe);return await V(Ie&&Ie._f?{[fe]:Ie}:Ie)}))).every(Boolean),!(!xe&&!t.isValid)&&v()):xe=te=await V(s);return p.state.next({...!hs(P)||(d.isValid||f.isValid)&&te!==t.isValid?{}:{name:P},...e.resolver||!P?{isValid:te}:{},errors:t.errors}),q.shouldFocus&&!xe&&Ja(s,ht,P?ue:l.mount),xe},Ot=(P,q)=>{let te={...o.mount?i:r};return q&&(te=tx(q.dirtyFields?t.dirtyFields:t.touchedFields,te)),En(P)?te:hs(P)?Be(te,P):P.map(xe=>Be(te,xe))},le=(P,q)=>({invalid:!!Be((q||t).errors,P),isDirty:!!Be((q||t).dirtyFields,P),error:Be((q||t).errors,P),isValidating:!!Be(t.validatingFields,P),isTouched:!!Be((q||t).touchedFields,P)}),$e=P=>{P&&Xa(P).forEach(q=>Dn(t.errors,q)),p.state.next({errors:P?t.errors:{}})},de=(P,q,te)=>{const xe=(Be(s,P,{_f:{}})._f||{}).ref,ue=Be(t.errors,P)||{},{ref:fe,message:Ie,type:ze,...tt}=ue;on(t.errors,P,{...tt,...q,ref:xe}),p.state.next({name:P,errors:t.errors,isValid:!1}),te&&te.shouldFocus&&xe&&xe.focus&&xe.focus()},Re=(P,q)=>Bs(P)?p.state.subscribe({next:te=>"values"in te&&P(S(void 0,q),te)}):S(P,q,!0),Ye=P=>p.state.subscribe({next:q=>{v2(P.name,q.name,P.exact)&&x2(q,P.formState||d,St,P.reRenderRoot)&&P.callback({values:{...i},...t,...q,defaultValues:r})}}).unsubscribe,vt=P=>(o.mount=!0,f={...f,...P.formState},Ye({...P,formState:f})),lt=(P,q={})=>{for(const te of P?Xa(P):l.mount)l.mount.delete(te),l.array.delete(te),q.keepValue||(Dn(s,te),Dn(i,te)),!q.keepError&&Dn(t.errors,te),!q.keepDirty&&Dn(t.dirtyFields,te),!q.keepTouched&&Dn(t.touchedFields,te),!q.keepIsValidating&&Dn(t.validatingFields,te),!e.shouldUnregister&&!q.keepDefaultValue&&Dn(r,te);p.state.next({values:Mn(i)}),p.state.next({...t,...q.keepDirty?{isDirty:T()}:{}}),!q.keepIsValid&&v()},It=({disabled:P,name:q})=>{(Ks(P)&&o.mount||P||l.disabled.has(q))&&(P?l.disabled.add(q):l.disabled.delete(q))},at=(P,q={})=>{let te=Be(s,P);const xe=Ks(q.disabled)||Ks(e.disabled);return on(s,P,{...te||{},_f:{...te&&te._f?te._f:{ref:{name:P}},name:P,mount:!0,...q}}),l.mount.add(P),te?It({disabled:Ks(q.disabled)?q.disabled:e.disabled,name:P}):re(P,!0,q.value),{...xe?{disabled:q.disabled||e.disabled}:{},...e.progressive?{required:!!q.required,min:Va(q.min),max:Va(q.max),minLength:Va(q.minLength),maxLength:Va(q.maxLength),pattern:Va(q.pattern)}:{},name:P,onChange:Ue,onBlur:Ue,ref:ue=>{if(ue){at(P,q),te=Be(s,P);const fe=En(ue.value)&&ue.querySelectorAll&&ue.querySelectorAll("input,select,textarea")[0]||ue,Ie=f2(fe),ze=te._f.refs||[];if(Ie?ze.find(tt=>tt===fe):fe===te._f.ref)return;on(s,P,{_f:{...te._f,...Ie?{refs:[...ze.filter(Vm),fe,...Array.isArray(Be(r,P))?[{}]:[]],ref:{type:fe.type,name:P}}:{ref:fe}}}),re(P,!1,void 0,fe)}else te=Be(s,P,{}),te._f&&(te._f.mount=!1),(e.shouldUnregister||q.shouldUnregister)&&!(o2(l.array,P)&&o.action)&&l.unMount.add(P)}}},ft=()=>e.shouldFocusError&&Ja(s,ht,l.mount),bn=P=>{Ks(P)&&(p.state.next({disabled:P}),Ja(s,(q,te)=>{const xe=Be(s,te);xe&&(q.disabled=xe._f.disabled||P,Array.isArray(xe._f.refs)&&xe._f.refs.forEach(ue=>{ue.disabled=xe._f.disabled||P}))},0,!1))},K=(P,q)=>async te=>{let xe;te&&(te.preventDefault&&te.preventDefault(),te.persist&&te.persist());let ue=Mn(i);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:fe,values:Ie}=await A();t.errors=fe,ue=Mn(Ie)}else await V(s);if(l.disabled.size)for(const fe of l.disabled)Dn(ue,fe);if(Dn(t.errors,"root"),us(t.errors)){p.state.next({errors:{}});try{await P(ue,te)}catch(fe){xe=fe}}else q&&await q({...t.errors},te),ft(),setTimeout(ft);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:us(t.errors)&&!xe,submitCount:t.submitCount+1,errors:t.errors}),xe)throw xe},Le=(P,q={})=>{Be(s,P)&&(En(q.defaultValue)?ge(P,Mn(Be(r,P))):(ge(P,q.defaultValue),on(r,P,Mn(q.defaultValue))),q.keepTouched||Dn(t.touchedFields,P),q.keepDirty||(Dn(t.dirtyFields,P),t.isDirty=q.defaultValue?T(P,Mn(Be(r,P))):T()),q.keepError||(Dn(t.errors,P),d.isValid&&v()),p.state.next({...t}))},He=(P,q={})=>{const te=P?Mn(P):r,xe=Mn(te),ue=us(P),fe=ue?r:xe;if(q.keepDefaultValues||(r=te),!q.keepValues){if(q.keepDirtyValues){const Ie=new Set([...l.mount,...Object.keys(Vo(r,i))]);for(const ze of Array.from(Ie))Be(t.dirtyFields,ze)?on(fe,ze,Be(i,ze)):ge(ze,Be(fe,ze))}else{if(Qf&&En(P))for(const Ie of l.mount){const ze=Be(s,Ie);if(ze&&ze._f){const tt=Array.isArray(ze._f.refs)?ze._f.refs[0]:ze._f.ref;if(cu(tt)){const Ae=tt.closest("form");if(Ae){Ae.reset();break}}}}if(q.keepFieldsRef)for(const Ie of l.mount)ge(Ie,Be(fe,Ie));else s={}}i=e.shouldUnregister?q.keepDefaultValues?Mn(r):{}:Mn(fe),p.array.next({values:{...fe}}),p.state.next({values:{...fe}})}l={mount:q.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!q.keepIsValid||!!q.keepDirtyValues,o.watch=!!e.shouldUnregister,p.state.next({submitCount:q.keepSubmitCount?t.submitCount:0,isDirty:ue?!1:q.keepDirty?t.isDirty:!!(q.keepDefaultValues&&!Ur(P,r)),isSubmitted:q.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ue?{}:q.keepDirtyValues?q.keepDefaultValues&&i?Vo(r,i):t.dirtyFields:q.keepDefaultValues&&P?Vo(r,P):q.keepDirty?t.dirtyFields:{},touchedFields:q.keepTouched?t.touchedFields:{},errors:q.keepErrors?t.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Se=(P,q)=>He(Bs(P)?P(i):P,q),Xe=(P,q={})=>{const te=Be(s,P),xe=te&&te._f;if(xe){const ue=xe.refs?xe.refs[0]:xe.ref;ue.focus&&(ue.focus(),q.shouldSelect&&Bs(ue.select)&&ue.select())}},St=P=>{t={...t,...P}},dt={control:{register:at,unregister:lt,getFieldState:le,handleSubmit:K,setError:de,_subscribe:Ye,_runSchema:A,_focusError:ft,_getWatch:S,_getDirty:T,_setValid:v,_setFieldArray:R,_setDisabledField:It,_setErrors:F,_getFieldArray:k,_reset:He,_resetDefaultValues:()=>Bs(e.defaultValues)&&e.defaultValues().then(P=>{Se(P,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:bn,_subjects:p,_proxyFormState:d,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(P){o=P},get _defaultValues(){return r},get _names(){return l},set _names(P){l=P},get _formState(){return t},get _options(){return e},set _options(P){e={...e,...P}}},subscribe:vt,trigger:Kt,register:at,handleSubmit:K,watch:Re,setValue:ge,getValues:Ot,reset:Se,resetField:Le,clearErrors:$e,unregister:lt,setError:de,setFocus:Xe,getFieldState:le};return{...dt,formControl:dt}}function ep(n={}){const e=mt.useRef(void 0),t=mt.useRef(void 0),[s,r]=mt.useState({isDirty:!1,isValidating:!1,isLoading:Bs(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:Bs(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:s},n.defaultValues&&!Bs(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=A2(n);e.current={...l,formState:s}}const i=e.current.control;return i._options=n,u2(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),mt.useEffect(()=>i._disableForm(n.disabled),[i,n.disabled]),mt.useEffect(()=>{n.mode&&(i._options.mode=n.mode),n.reValidateMode&&(i._options.reValidateMode=n.reValidateMode)},[i,n.mode,n.reValidateMode]),mt.useEffect(()=>{n.errors&&(i._setErrors(n.errors),i._focusError())},[i,n.errors]),mt.useEffect(()=>{n.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,n.shouldUnregister]),mt.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),mt.useEffect(()=>{n.values&&!Ur(n.values,t.current)?(i._reset(n.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=n.values,r(o=>({...o}))):i._resetDefaultValues()},[i,n.values]),mt.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=c2(s,i),e.current}const Fg=["","","","","","",""],ax=({event:n,slotInfo:e,defaultProjectName:t,onClose:s,onSave:r,onDelete:i})=>{const[o,l]=E.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:p},reset:y}=ep({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:C}=Xr(),[v,w]=E.useState([]),[R,I]=E.useState(""),[F,re]=E.useState(!1),[ee,M]=E.useState(""),[A,N]=E.useState(9),[V,j]=E.useState(0),[T,S]=E.useState(""),k=f("projectId");E.useEffect(()=>{if(k){const le=C.find($e=>$e.id===k||$e.id===parseInt(k)||$e.id.toString()===k.toString());console.log(" Selected project:",le==null?void 0:le.name),console.log(" Project team:",le==null?void 0:le.team),console.log(" Current selectedMembers:",v)}},[k,C,v]),E.useEffect(()=>{console.log(" Modal mount - initializing states"),w([]),S(""),I("")},[]),E.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!n,eventId:n==null?void 0:n.id,hasSlotInfo:!!e,hasMergedEvents:!!(n!=null&&n.mergedEventIds)}),n&&n.id){console.log(" ScheduleModal processing event:",{title:n.title,projectId:n.projectId,projectName:n.projectName,start:n.start,assignedTo:n.assignedTo,time:n.time});const le=n.originalTitle||n.title,$e=/ - (|) \d{1,2}$/,de=le.replace($e,"");if(d("title",de,{shouldValidate:!1,shouldDirty:!1}),d("date",qt(n.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",n.description||"",{shouldValidate:!1,shouldDirty:!1}),n.projectId&&n.projectId!==""&&n.projectId!=="undefined")console.log(" Setting projectId from event:",n.projectId),d("projectId",n.projectId,{shouldValidate:!1,shouldDirty:!1}),S("");else if(n.projectName){const Ye=C.find(vt=>vt.name===n.projectName);console.log(" Finding project by name:",n.projectName,"found:",Ye),Ye?(console.log(" Setting projectId from found project:",Ye.id),d("projectId",Ye.id,{shouldValidate:!1,shouldDirty:!1}),S("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),S(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),S("");const Re=n.assignedTo||n.attendees||[];if(console.log(" Setting selectedMembers to:",Re),w(Array.isArray(Re)?Re:[]),n.time&&n.time!=="-"){console.log(" Setting time from event:",{eventTime:n.time,parsedHours:n.time.split(":")[0],parsedMinutes:n.time.split(":")[1]}),re(!0);const[Ye,vt]=n.time.split(":"),lt=parseInt(Ye,10),It=parseInt(vt,10);lt>=12?(M(""),N(lt===12?12:lt-12)):(M(""),N(lt===0?12:lt)),j(It),console.log(" Time state set:",{hasTime:!0,period:lt>=12?"":"",hour:lt>=12?lt===12?12:lt-12:lt===0?12:lt,minute:It})}else console.log(" No time in event, setting hasTime to false"),re(!1),M(""),N(9),j(0)}else if(e&&!n&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:qt(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),w([]),S(""),t)){const le=C.find($e=>$e.name===t);le&&d("projectId",le.id,{shouldValidate:!1,shouldDirty:!1})}},[n==null?void 0:n.id]);const Ee=le=>{console.log(" toggleMember called with:",le),console.log(" Current selectedMembers before toggle:",v),w($e=>{console.log(" Previous members in setState:",$e);const de=$e.includes(le)?$e.filter(Re=>Re!==le):[...$e,le];return console.log(" Updated members after toggle:",de),de})},qe=()=>{const le="HV LAB";v.includes(le)?w($e=>$e.filter(de=>de!==le)):w($e=>[...$e.filter(de=>de!==""),le])},ge=()=>{const le="";v.includes(le)?w($e=>$e.filter(de=>de!==le)):w($e=>[...$e,le])},Ue=()=>{const le="";v.includes(le)?w($e=>$e.filter(de=>de!==le)):w($e=>[...$e,le])},ht=()=>{R.trim()&&!v.includes(R.trim())&&(w(le=>[...le,R.trim()]),I(""))},Kt=le=>{w($e=>$e.filter(de=>de!==le))},Ot=async le=>{console.log(" Form onSubmit called with data:",le),console.log(" selectedMembers:",v),console.log(" hasTime state:",F),console.log(" timePeriod:",ee,"timeHour:",A,"timeMinute:",V),console.log(" Available projects:",C.map(at=>({id:at.id,name:at.name,idType:typeof at.id}))),console.log(" Merged event IDs:",n==null?void 0:n.mergedEventIds);const $e=/ - (|) \d{1,2}$/,de=le.title.replace($e,"").trim();let Re="",Ye="";if(le.projectId){const at=C.find(ft=>ft.id===le.projectId||ft.id===parseInt(le.projectId)||ft.id.toString()===le.projectId.toString());console.log(" Looking for project with id:",le.projectId,"type:",typeof le.projectId),console.log(" Found project:",at),Re=(at==null?void 0:at.name)||"",Ye=le.projectId}else Re="",Ye="";console.log(" Final projectId:",Ye,"projectName:",Re,"cleanedTitle:",de);const vt=new Date(le.date);let lt="-";if(F){let at=A;ee===""&&A!==12?at=A+12:ee===""&&A===12&&(at=0),lt=`${at.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`,console.log(" Time calculated:",lt)}else console.log(" No time set (hasTime is false)");const It={...n,title:de,start:vt,end:vt,projectId:Ye,projectName:Re,assignedTo:v,description:le.description||"",time:lt,mergedEventIds:n==null?void 0:n.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",It);try{await r(It),console.log(" onSave completed successfully")}catch(at){throw console.error(" onSave failed:",at),at}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(wn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Ot),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),C.filter(le=>n!=null&&n.isASVisit?!0:le.status!=="completed").map(le=>a.jsxDEV("option",{value:le.id,children:le.name},le.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),p.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),p.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>re(!F),className:`px-3 py-1.5 text-xs rounded border transition-colors ${F?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),F&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:A,onChange:le=>N(parseInt(le.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(le=>a.jsxDEV("option",{value:le,children:[le,""]},le,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:V,onChange:le=>j(parseInt(le.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(le=>a.jsxDEV("option",{value:le,children:[le,""]},le,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:qe,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ge,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:Ue,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Fg.map(le=>a.jsxDEV("button",{type:"button",onClick:()=>Ee(le),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(le)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:le},le,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(le=>!Fg.includes(le)&&le!=="HV LAB"&&le!==""&&le!=="").map(le=>a.jsxDEV("button",{type:"button",onClick:()=>Kt(le),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[le," "]},le,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:le=>I(le.target.value),onKeyPress:le=>{le.key==="Enter"&&(le.preventDefault(),ht())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ht,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:n&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(n.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(Ti,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:s,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},Ad=n=>{if(!n||n==="-")return"";const[e,t]=n.split(":"),s=parseInt(e,10),r=parseInt(t,10),i=s>=12?"":"",o=s%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},mu=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Za=n=>{if(!n)return n;const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of mu)if(s===r)return t.slice(0,-1).join(" ").trim()}for(const s of mu)if(e.endsWith(s))return e.substring(0,e.length-s.length).trim()||e;return e},lc=n=>{const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of mu)if(s===r)return r}for(const s of mu)if(e.endsWith(s))return s;return""},w2=["","","","","","",""],V2=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Cm=["","","/","","","","","","","","","","","","",""],C2={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},I2={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Og=w2,S2=()=>{const{schedules:n,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:s}=Xr(),{user:r}=si(),[i,o]=E.useState(!1),l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...Og.filter(d=>d!==l)]:Og,m=d=>{const f=n.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),p=v=>{const w=new Set;return v.filter(R=>{const F=`${qt(new Date(R.start),"yyyy-MM-dd")}|${R.project}|${R.title}`;return w.has(F)?!1:(w.add(F),!0)})},y=p(f.filter(v=>Cp(new Date(v.start)))),C=p(f.filter(v=>qv(new Date(v.start))&&!Cp(new Date(v.start))).sort((v,w)=>new Date(v.start).getTime()-new Date(w.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:C,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:p}=m(d),y=f.length+p.length,C=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${C?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:113,columnNumber:21},void 0),C&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:112,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[C&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV(Io,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${C&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[p.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:131,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(cy,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:141,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:142,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:140,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((w,R)=>{const I=R.project||"-";return w[I]||(w[I]=[]),w[I].push(R),w},{});return Object.entries(v).map(([w,R])=>{const I=d===l;return a.jsxDEV("div",{className:`border-l-3 ${I?"border-gray-400":"border-gray-900"} ${I?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${I?"bg-amber-100":"bg-gray-100"} border-b ${I?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:164,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:163,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:R.map(F=>{const re=F.time&&F.time!=="-"?` - ${Ad(F.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",F.title,re]},F.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:31},void 0)]},w,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:159,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:19},void 0),p.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Sv,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:188,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:189,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:187,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=p.reduce((w,R)=>{const I=qt(new Date(R.start),"MM.dd",{locale:An}),F=R.project||"-",re=`${I}|${F}`;return w[re]||(w[re]={date:I,project:F,schedules:[]}),w[re].schedules.push(R),w},{});return Object.values(v).map(({date:w,project:R,schedules:I})=>{const re=I.length>0&&Ov(new Date(I[0].start))?`${w} ()`:w;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:R},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:211,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:re},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:212,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:210,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:I.map(ee=>{const M=ee.time&&ee.time!=="-"?` - ${Ad(ee.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",ee.title,M]},ee.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:214,columnNumber:31},void 0)]},`${w}-${R}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:209,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:191,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:186,columnNumber:19},void 0),y===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:234,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:109,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:101,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:100,columnNumber:7},void 0),i&&a.jsxDEV(ax,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await s(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:246,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:98,columnNumber:5},void 0)},Ou=()=>{const{user:n}=si(),{projects:e}=Xr();return E.useMemo(()=>n?n.name===""?e.filter(s=>{const i=(s.manager?s.manager.split(",").map(l=>l.trim()):[]).includes(""),o=s.team&&Array.isArray(s.team)&&s.team.includes("");return i||o}):e:[],[n,e])},T2=({value:n,detailValue:e="",onChange:t,onDetailChange:s,placeholder:r=" ",error:i})=>{const[o,l]=E.useState(!1),[u,m]=E.useState(n),[d,f]=E.useState(e),p=E.useRef(null);E.useEffect(()=>{const R=I=>{p.current&&!p.current.contains(I.target)&&l(!1)};return o&&document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[o]),E.useEffect(()=>{m(n)},[n]),E.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((R,I)=>{if(window.daum&&window.daum.Postcode){R(!0);return}const F=document.createElement("script");F.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",F.async=!0,F.onload=()=>R(!0),F.onerror=()=>I(new Error("Kakao Postcode   ")),document.head.appendChild(F)}),C=R=>{const I=R.roadAddr||R.jibunAddr;m(I),t(I,d),l(!1)},v=R=>{const I=R.target.value;f(I),s&&s(I),u&&t(u,I)},w=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(R){const I={roadAddr:R.roadAddress,jibunAddr:R.jibunAddress||R.autoJibunAddress||"",zipNo:R.zonecode,bdNm:R.buildingName,siNm:R.sido,sggNm:R.sigungu,emdNm:R.bname,rn:R.roadname};C(I)}}).open()}catch(R){console.error("  :",R),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>w(),onChange:R=>{m(R.target.value),t(R.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(uy,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},qg=["","","","","","",""],P2=({project:n,onClose:e,onSave:t})=>{const{register:s,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=ep({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=E.useState([]),[d,f]=E.useState(""),[p,y]=E.useState(""),[C,v]=E.useState(""),[w,R]=E.useState(!1);E.useEffect(()=>{var M;if(n){const A=n.location?n.location.split(","):["",""],N=((M=A[0])==null?void 0:M.trim())||n.location||"",V=A.length>1?A.slice(1).join(",").trim():"";o({name:n.name,client:n.client||"",location:N,detailLocation:V,startDate:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:"",endDate:n.endDate?new Date(n.endDate).toISOString().split("T")[0]:""}),y(N),v(V);const j=n.manager?n.manager.split(",").map(T=>T.trim()).filter(T=>T&&T!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),v(""),m([])},[n,o]);const I=M=>{m(A=>A.includes(M)?A.filter(N=>N!==M):[...A,M])},F=()=>{d.trim()&&!u.includes(d.trim())&&(m(M=>[...M,d.trim()]),f(""))},re=M=>{m(A=>A.filter(N=>N!==M))},ee=async M=>{if(w)return;R(!0),console.log(" ProjectModal onSubmit - Raw form data:",M);const A=p&&C?`${p}, ${C}`:p||M.location,N={name:M.name,client:M.client,location:A,manager:u.join(", "),contractAmount:(n==null?void 0:n.contractAmount)??0,spent:(n==null?void 0:n.spent)??0,status:(n==null?void 0:n.status)??"planning",progress:(n==null?void 0:n.progress)??0,description:(n==null?void 0:n.description)??"",meetingNotes:(n==null?void 0:n.meetingNotes)??[],customerRequests:(n==null?void 0:n.customerRequests)??[],entrancePassword:(n==null?void 0:n.entrancePassword)??"",sitePassword:(n==null?void 0:n.sitePassword)??""};if(M.startDate&&M.startDate!=="")N.startDate=M.startDate,console.log(" Setting startDate from form:",M.startDate);else if(n!=null&&n.startDate){const V=typeof n.startDate=="string"&&n.startDate.includes("T")?n.startDate.split("T")[0]:n.startDate;N.startDate=V,console.log(" Keeping existing startDate:",N.startDate)}if(M.endDate&&M.endDate!=="")N.endDate=M.endDate,console.log(" Setting endDate from form:",M.endDate);else if(n!=null&&n.endDate){const V=typeof n.endDate=="string"&&n.endDate.includes("T")?n.endDate.split("T")[0]:n.endDate;N.endDate=V,console.log(" Keeping existing endDate:",N.endDate)}console.log(" ProjectModal onSubmit - Final formData:",N);try{await t(N)}catch(V){throw R(!1),V}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(wn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(ee),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...s("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...s("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(T2,{value:p,detailValue:C,onChange:(M,A)=>{y(M),v(A||""),i("location",M),i("detailLocation",A||"")},onDetailChange:M=>{v(M),i("detailLocation",M)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...s("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...s("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[qg.map(M=>a.jsxDEV("button",{type:"button",onClick:()=>I(M),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(M)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:M},M,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(M=>!qg.includes(M)).map(M=>a.jsxDEV("button",{type:"button",onClick:()=>re(M),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[M," "]},M,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyPress:M=>{M.key==="Enter"&&(M.preventDefault(),F())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:F,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:w,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:w?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},L2=({projectName:n,meetingNotes:e,onClose:t,onSave:s,onDelete:r})=>{const[i,o]=E.useState(""),[l,u]=E.useState(new Date().toISOString().split("T")[0]),[m,d]=E.useState(!1),[f,p]=E.useState(!1),y=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},C=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}p(!0);try{await s(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{p(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},w=R=>{window.confirm("   ?")&&r(R)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:R=>R.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(wn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:R=>u(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:R=>o(R.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:C,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(R=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:qt(new Date(R.date),"yyyy.MM.dd (eee)",{locale:An})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:R.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>w(R.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},R.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},j2=({projectName:n,customerRequests:e,onClose:t,onSave:s,onToggleComplete:r,onDelete:i})=>{const[o,l]=E.useState(""),[u,m]=E.useState(new Date().toISOString().split("T")[0]),[d,f]=E.useState(!1),[p,y]=E.useState(!1),C=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!p){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}y(!0);try{await s(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},w=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},R=ee=>{window.confirm("  ?")&&i(ee)},I=ee=>{r(ee)},F=e.filter(ee=>!ee.completed),re=e.filter(ee=>ee.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:ee=>ee.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(wn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:C,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:ee=>m(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:ee=>l(ee.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:p,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:p?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:w,disabled:p,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[F.map(ee=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>I(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(Tv,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:qt(new Date(ee.createdAt),"yyyy.MM.dd",{locale:An})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>R(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),re.map(ee=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>I(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(Pv,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:qt(new Date(ee.createdAt),"yyyy.MM.dd",{locale:An})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>R(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},R2=({projectName:n,entrancePassword:e,sitePassword:t,onClose:s,onSave:r})=>{const[i,o]=E.useState(e||""),[l,u]=E.useState(t||""),[m,d]=E.useState(!1),[f,p]=E.useState(!1),y=()=>{d(!0)},C=async()=>{if(!f){p(!0);try{await r(i,l),d(!1)}finally{p(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:w=>w.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(wn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:w=>o(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:w=>u(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:C,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:s,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},B2=({projectName:n,onClose:e})=>{var o;const[t,s]=E.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(wn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>s({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>s({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>s({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>s({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>s({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>s({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&s({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>s({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(my,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[qt(new Date(t.startDate),"yyyy",{locale:An}),"",qt(new Date(t.startDate),"MM",{locale:An}),"",qt(new Date(t.startDate),"dd",{locale:An})," ~ ",qt(new Date(t.endDate),"yyyy",{locale:An}),"",qt(new Date(t.endDate),"MM",{locale:An}),"",qt(new Date(t.endDate),"dd",{locale:An})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},U2=()=>{const{loadProjectsFromAPI:n,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:s}=Xr(),{user:r}=si(),i=Ou(),[o,l]=E.useState("in-progress"),[u,m]=E.useState("grid"),[d,f]=E.useState(!1),[p,y]=E.useState(null),[C,v]=E.useState(!1),[w,R]=E.useState(!1),[I,F]=E.useState(!1),[re,ee]=E.useState(!1),[M,A]=E.useState(null),N=(K,Le)=>`lastViewed_${r==null?void 0:r.id}_${K}_${Le}`,V=(K,Le)=>{const He=N(K,Le),Se=localStorage.getItem(He);return Se?parseInt(Se,10):0},j=(K,Le)=>{const He=N(K,Le);localStorage.setItem(He,Date.now().toString())},T=(K,Le)=>{const He=V(K.id,Le);return Le==="meeting"?(K.meetingNotes||[]).some(Xe=>(Xe.createdAt?new Date(Xe.createdAt).getTime():new Date(Xe.date).getTime())>He):(K.customerRequests||[]).some(Xe=>!Xe.completed)};E.useEffect(()=>{n().catch(K=>{console.error("Failed to load projects:",K),oe.error("   ")})},[n]),E.useEffect(()=>{const K=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",K),()=>window.removeEventListener("headerAddButtonClick",K)},[]);const S=(K,Le)=>{if(!K||!Le)return 0;const He=new Date,Se=new Date(K),Xe=new Date(Le);if(He<Se)return 0;if(He>Xe)return 100;const St=Math.ceil((Xe.getTime()-Se.getTime())/(1e3*60*60*24)),Gt=Math.ceil((He.getTime()-Se.getTime())/(1e3*60*60*24)),dt=Math.round(Gt/St*100);return Math.min(100,Math.max(0,dt))},k=K=>{y(K),f(!0)},Ee=async(K,Le)=>{if(window.confirm(`"${Le}"  ?

    .`))try{await s(K),oe.success(" ")}catch(He){console.error("Failed to delete project:",He),oe.error("  ")}},qe=async K=>{try{if(p)await t(p.id,K),oe.success(" ");else{const Le={id:"",...K,team:K.team||[]};await e(Le),oe.success(" "),l(K.status||"planning")}f(!1),y(null)}catch(Le){console.error("Failed to save project:",Le),oe.error("  ")}},ge=async(K,Le)=>{try{await t(K,{status:Le}),oe.success(" ")}catch(He){console.error("Failed to update project status:",He),oe.error("  ")}},Ue=K=>{A(K),v(!0),j(K.id,"meeting")},ht=K=>{A(K),R(!0),j(K.id,"request")},Kt=K=>{A(K),F(!0)},Ot=K=>{A(K),ee(!0)},le=async(K,Le)=>{if(!M)return;const He=M.entrancePassword,Se=M.sitePassword;A({...M,entrancePassword:K,sitePassword:Le});try{await t(M.id,{entrancePassword:K,sitePassword:Le}),oe.success(" ")}catch(Xe){console.error("Failed to save passwords:",Xe),oe.error("  "),A({...M,entrancePassword:He,sitePassword:Se})}},$e=async(K,Le)=>{if(!M)return;const He={id:Date.now().toString(),content:K,date:Le,createdAt:new Date},Se=[...M.meetingNotes||[],He];A({...M,meetingNotes:Se});try{await t(M.id,{meetingNotes:Se}),oe.success("  ")}catch(Xe){console.error("Failed to save meeting note:",Xe),oe.error("   "),A({...M,meetingNotes:M.meetingNotes||[]})}},de=async(K,Le)=>{if(!M)return;const He={id:Date.now().toString(),content:K,completed:!1,createdAt:Le},Se=[...M.customerRequests||[],He];A({...M,customerRequests:Se});try{await t(M.id,{customerRequests:Se}),oe.success("  ")}catch(Xe){console.error("Failed to save customer request:",Xe),oe.error("   "),A({...M,customerRequests:M.customerRequests||[]})}},Re=async K=>{if(!M)return;const Le=M.customerRequests||[],He=Le.map(Se=>Se.id===K?{...Se,completed:!Se.completed}:Se);A({...M,customerRequests:He});try{await t(M.id,{customerRequests:He}),oe.success("  ")}catch(Se){console.error("Failed to toggle request:",Se),oe.error("  "),A({...M,customerRequests:Le})}},Ye=async K=>{if(!M)return;const Le=M.meetingNotes||[],He=Le.filter(Se=>Se.id!==K);A({...M,meetingNotes:He});try{await t(M.id,{meetingNotes:He}),oe.success("  ")}catch(Se){console.error("Failed to delete meeting note:",Se),oe.error(" "),A({...M,meetingNotes:Le})}},vt=async K=>{if(!M)return;const Le=M.customerRequests||[],He=Le.filter(Se=>Se.id!==K);A({...M,customerRequests:He});try{await t(M.id,{customerRequests:He}),oe.success("  ")}catch(Se){console.error("Failed to delete customer request:",Se),oe.error(" "),A({...M,customerRequests:Le})}},lt=({project:K})=>{const He={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[K.status];return a.jsxDEV("select",{value:K.status,onChange:Se=>ge(K.id,Se.target.value),className:Ls("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",He.color),onClick:Se=>Se.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},at=(()=>{let K=i;return o!=="all"&&(K=K.filter(Le=>Le.status===o)),r!=null&&r.name&&(K=[...K].sort((Le,He)=>{var St,Gt;const Se=Le.manager===r.name||((St=Le.team)==null?void 0:St.includes(r.name)),Xe=He.manager===r.name||((Gt=He.team)==null?void 0:Gt.includes(r.name));return Se&&!Xe?-1:!Se&&Xe?1:0})),K})(),ft={planning:i.filter(K=>K.status==="planning").length,inProgress:i.filter(K=>K.status==="in-progress").length,completed:i.filter(K=>K.status==="completed").length,onHold:i.filter(K=>K.status==="on-hold").length},bn=({project:K})=>{var He,Se,Xe;const Le=S(K.startDate,K.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ot(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(lt,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.startDate&&K.endDate?`${qt(K.startDate,"MM.dd (eee)",{locale:An})} - ${qt(K.endDate,"MM.dd (eee)",{locale:An})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>Kt(K),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Le,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Le}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>Ue(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((He=K.meetingNotes)==null?void 0:He.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Se=K.meetingNotes)==null?void 0:Se.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),T(K,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),K.meetingNotes&&K.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Xe=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Xe.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var dt;const St=((dt=K.customerRequests)==null?void 0:dt.filter(P=>!P.completed))||[],Gt=St[St.length-1];return a.jsxDEV("div",{onClick:()=>ht(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",St.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",St.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),T(K,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Gt?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Gt.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>Ee(K.id,K.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ft.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ft.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ft.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(K=>a.jsxDEV("button",{onClick:()=>l(K.id),className:Ls("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===K.id?`border-gray-700 ${K.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[K.label,a.jsxDEV("span",{className:Ls("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===K.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:K.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Ls("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Ls("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV(Io,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:at.map(K=>a.jsxDEV(bn,{project:K},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:at.map(K=>{var He,Se,Xe,St;const Le=S(K.startDate,K.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:K.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:K.startDate&&K.endDate?a.jsxDEV(a.Fragment,{children:[qt(K.startDate,"yyyy.MM.dd (eee)",{locale:An})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),qt(K.endDate,"yyyy.MM.dd (eee)",{locale:An})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ot(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(lt,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>Kt(K),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Le}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Le,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>Ue(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((He=K.meetingNotes)==null?void 0:He.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Se=K.meetingNotes)==null?void 0:Se.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),T(K,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Xe=K.meetingNotes)!=null&&Xe.length?((St=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:St.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var P;const Gt=((P=K.customerRequests)==null?void 0:P.filter(q=>!q.completed))||[],dt=Gt[Gt.length-1];return a.jsxDEV("div",{onClick:()=>ht(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Gt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Gt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),T(K,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:dt?dt.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>Ee(K.id,K.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(P2,{project:p,onClose:()=>{f(!1),y(null)},onSave:qe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),C&&M&&a.jsxDEV(L2,{projectName:M.name,meetingNotes:M.meetingNotes||[],onClose:()=>{v(!1),A(null)},onSave:$e,onDelete:Ye},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),w&&M&&a.jsxDEV(j2,{projectName:M.name,customerRequests:M.customerRequests||[],onClose:()=>{R(!1),A(null)},onSave:de,onToggleComplete:Re,onDelete:vt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),I&&M&&a.jsxDEV(R2,{projectName:M.name,entrancePassword:M.entrancePassword||"",sitePassword:M.sitePassword||"",onClose:()=>{F(!1),A(null)},onSave:le},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),re&&M&&a.jsxDEV(B2,{projectName:M.name,onClose:()=>{ee(!1),A(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var tp={},lx={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(lx);var ns=lx.exports,np={},cx={exports:{}},ux={exports:{}},mx={exports:{}},dx={exports:{}};(function(n){function e(t){"@babel/helpers - typeof";return n.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(dx);var na=dx.exports,fx={exports:{}};(function(n){var e=na.default;function t(s,r){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var o=i.call(s,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(fx);var H2=fx.exports;(function(n){var e=na.default,t=H2;function s(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(mx);var px=mx.exports;(function(n){var e=px;function t(s,r,i){return(r=e(r))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(ux);var hx=ux.exports;(function(n){var e=hx;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function s(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(cx);var ri=cx.exports,gx={exports:{}},yx={exports:{}};(function(n){function e(t,s){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(s.indexOf(i)!==-1)continue;r[i]=t[i]}return r}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(yx);var M2=yx.exports;(function(n){var e=M2;function t(s,r){if(s==null)return{};var i,o,l=e(s,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(s);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(l[i]=s[i])}return l}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(gx);var sp=gx.exports,bx={exports:{}};(function(n){function e(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(bx);var Wi=bx.exports,Nx={exports:{}};(function(n){var e=px;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function s(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(Nx);var Ki=Nx.exports,xx={exports:{}},vx={exports:{}};(function(n){function e(t){return n.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(vx);var F2=vx.exports,_x={exports:{}};(function(n){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n.exports=e=function(){return!!t},n.exports.__esModule=!0,n.exports.default=n.exports)()}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(_x);var O2=_x.exports,Dx={exports:{}},kx={exports:{}};(function(n){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(kx);var q2=kx.exports;(function(n){var e=na.default,t=q2;function s(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(Dx);var $2=Dx.exports;(function(n){var e=F2,t=O2,s=$2;function r(i,o,l){return o=e(o),s(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports})(xx);var sa=xx.exports,Ex={exports:{}},Ax={exports:{}};(function(n){function e(t,s){return n.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},n.exports.__esModule=!0,n.exports.default=n.exports,e(t,s)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(Ax);var z2=Ax.exports;(function(n){var e=z2;function t(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),r&&e(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(Ex);var ra=Ex.exports;const Bl=bl($v);var Us={},Yo={};Object.defineProperty(Yo,"__esModule",{value:!0});Yo.views=Yo.navigate=void 0;Yo.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};Yo.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var W2=ns.default;Object.defineProperty(Us,"__esModule",{value:!0});Us.views=Us.dateRangeFormat=Us.dateFormat=Us.accessor=Us.DayLayoutAlgorithmPropType=void 0;var ms=W2(dy),$g=Yo,zg=Object.keys($g.views).map(function(n){return $g.views[n]});Us.accessor=ms.default.oneOfType([ms.default.string,ms.default.func]);Us.dateFormat=ms.default.any;Us.dateRangeFormat=ms.default.func;Us.views=ms.default.oneOfType([ms.default.arrayOf(ms.default.oneOf(zg)),ms.default.objectOf(function(n,e){var t=zg.indexOf(e)!==-1&&typeof n[e]=="boolean";if(t)return null;for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return ms.default.elementType.apply(ms.default,[n,e].concat(r))})]);Us.DayLayoutAlgorithmPropType=ms.default.oneOfType([ms.default.oneOf(["overlap","no-overlap"]),ms.default.func]);var qu={},ia={},K2=ns.default;Object.defineProperty(ia,"__esModule",{value:!0});ia.accessor=wx;ia.wrapAccessor=void 0;var G2=K2(na);function wx(n,e){var t=null;return typeof e=="function"?t=e(n):typeof e=="string"&&(0,G2.default)(n)==="object"&&n!=null&&e in n&&(t=n[e]),t}ia.wrapAccessor=function(e){return function(t){return wx(t,e)}};var Gi={},Q2=ns.default;Object.defineProperty(Gi,"__esModule",{value:!0});Gi.DnDContext=void 0;var Y2=Q2(E);Gi.DnDContext=Y2.default.createContext();var Qi=ns.default;Object.defineProperty(qu,"__esModule",{value:!0});qu.default=void 0;var X2=Qi(ri),J2=Qi(Wi),Z2=Qi(Ki),eI=Qi(sa),tI=Qi(ra),xo=Qi(E),Wg=Qi(Bl),Kg=ia,nI=Gi,Vx=function(n){function e(){var t;(0,J2.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,eI.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,X2.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,tI.default)(e,n),(0,Z2.default)(e,[{key:"renderAnchor",value:function(s){var r=s==="Up"||s==="Down"?"ns":"ew";return xo.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(s)]},xo.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var s=this.props,r=s.event,i=s.type,o=s.continuesPrior,l=s.continuesAfter,u=s.resizable,m=this.props.children;if(r.__isPreview)return xo.default.cloneElement(m,{className:(0,Wg.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,p=d.resizableAccessor,y=f?!!(0,Kg.accessor)(r,f):!0;if(!y)return m;var C=u&&(p?!!(0,Kg.accessor)(r,p):!0);if(C||y){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(C){var w=null,R=null;i==="date"?(w=!o&&this.renderAnchor("Left"),R=!l&&this.renderAnchor("Right")):(w=!o&&this.renderAnchor("Up"),R=!l&&this.renderAnchor("Down")),v.children=xo.default.createElement("div",{className:"rbc-addons-dnd-resizable"},w,m.props.children,R)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Wg.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=xo.default.cloneElement(m,v)}return m}}])}(xo.default.Component);Vx.contextType=nI.DnDContext;qu.default=Vx;var $u={},Cx={exports:{}};(function(n){var e=na.default;function t(s,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(n.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,p={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return p;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,p)}for(var y in u)y!=="default"&&{}.hasOwnProperty.call(u,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,y))&&(f.get||f.set)?d(p,y,f):p[y]=u[y]);return p},n.exports.__esModule=!0,n.exports.default=n.exports)(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(Cx);var Ix=Cx.exports;function rp(n,e,t,s){if(t===void 0&&(t=!1),s===void 0&&(s=!0),n){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,s),n.dispatchEvent(r)}}function sI(n){var e=js(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function rI(n,e,t){t===void 0&&(t=5);var s=!1,r=setTimeout(function(){s||rp(n,"transitionend",!0)},e+t),i=du(n,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),i()}}function ip(n,e,t,s){t==null&&(t=sI(n)||0);var r=rI(n,t,s),i=du(n,"transitionend",e);return function(){r(),i()}}var Gg={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Qg(n){var e=n.node,t=n.properties,s=n.duration,r=s===void 0?200:s,i=n.easing,o=n.callback,l=[],u={},m="";Object.keys(t).forEach(function(p){var y=t[p];zv(p)?m+=p+"("+y+") ":(u[p]=y,l.push(Wv(p)))}),m&&(u.transform=m,l.push("transform"));function d(p){p.target===p.currentTarget&&(js(e,Gg),o&&o.call(this,p))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=ip(e,d,r);return e.clientLeft,js(e,u),{cancel:function(){f(),js(e,Gg)}}}function Sx(n,e,t,s,r){if(!("nodeType"in n))return Qg(n);if(!e)throw new Error("must include properties to animate");return typeof s=="function"&&(r=s,s=""),Qg({node:n,properties:e,duration:t,easing:s,callback:r})}function Tx(n,e,t){if(n){if(typeof t>"u")return n.getAttribute(e);!t&&t!==""?n.removeAttribute(e):n.setAttribute(e,String(t))}}function Px(n){return n?Array.from(n.children):[]}function Lx(n){if(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}return null}var iI=Function.prototype.bind.call(Function.prototype.call,[].slice);function jx(n){return n?iI(n.childNodes):[]}function Rx(n,e){return function(s){var r=s.currentTarget,i=s.target,o=Td(r,n);o.some(function(l){return Pd(l,i)})&&e.call(this,s)}}function Bx(n,e){return n&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(n,e.nextSibling):e.parentNode.appendChild(n),n):null}var oI=/^(?:input|select|textarea|button)$/i;function Ux(n){return n?oI.test(n.nodeName):!1}function Hx(n){return n?!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length):!1}function Mx(n,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var s=[];n;n=n.nextElementSibling)if(n!==e){if(t&&Ld(n,t))break;s.push(n)}return s}function Fx(n,e){return Mx(n,n,e)}function aI(n,e){var t=null,s=[];for(t=n?n[e]:null;t&&t.nodeType!==9;)s.push(t),t=t[e]||null;return s}function Ox(n){return aI(n,"parentElement")}function qx(n,e){return n&&e?(e.firstElementChild?e.insertBefore(n,e.firstElementChild):e.appendChild(n),n):null}function $x(n){return n&&n.parentNode?(n.parentNode.removeChild(n),n):null}function op(n,e){var t=js(n,"position"),s=t==="absolute",r=n.ownerDocument;if(t==="fixed")return r||document;for(;(n=n.parentNode)&&!Kv(n);){var i=s&&js(n,"position")==="static",o=(js(n,"overflow")||"")+(js(n,"overflow-y")||"")+js(n,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||fu(n)<n.scrollHeight))return n}return r||document}function zx(n,e){var t=Rc(n),s={top:0,left:0};if(n){var r=e||op(n),i=Gv(r),o=Bc(r),l=fu(r,!0);i||(s=Rc(r)),t={top:t.top-s.top,left:t.left-s.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=jd(function(){return Bc(r,o)});return function(){return Rd(f)}}}function Wx(n){return Mx(n&&n.parentElement?n.parentElement.firstElementChild:null,n)}var lI=/&nbsp;/gi,cI=/\xA0/g,uI=/\s+([^\s])/gm;function Kx(n,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var s="";return n&&(s=(n.textContent||"").replace(lI," ").replace(cI," "),e&&(s=s.trim()),t&&(s=s.replace(uI," $1"))),s}function Gx(n,e){n.classList?n.classList.toggle(e):Bd(n,e)?Ud(n,e):Hd(n,e)}const mI={addEventListener:ky,removeEventListener:Dy,triggerEvent:rp,animate:Sx,filter:Rx,listen:du,style:js,getComputedStyle:_y,attribute:Tx,activeElement:vy,ownerDocument:xy,ownerWindow:Ny,requestAnimationFrame:jd,cancelAnimationFrame:Rd,matches:Ld,height:fu,width:by,offset:Rc,offsetParent:yy,position:gy,contains:Pd,scrollbarSize:hy,scrollLeft:py,scrollParent:op,scrollTo:zx,scrollTop:Bc,querySelectorAll:Td,closest:fy,addClass:Hd,removeClass:Ud,hasClass:Bd,toggleClass:Gx,transitionEnd:ip,childNodes:jx,childElements:Px,nextUntil:Fx,parents:Ox,siblings:Wx,clear:Lx,insertAfter:Bx,isInput:Ux,isVisible:Hx,prepend:qx,remove:$x,text:Kx},dI=Object.freeze(Object.defineProperty({__proto__:null,activeElement:vy,addClass:Hd,addEventListener:ky,animate:Sx,attribute:Tx,cancelAnimationFrame:Rd,childElements:Px,childNodes:jx,clear:Lx,closest:fy,contains:Pd,default:mI,filter:Rx,getComputedStyle:_y,hasClass:Bd,height:fu,insertAfter:Bx,isInput:Ux,isVisible:Hx,listen:du,matches:Ld,nextUntil:Fx,offset:Rc,offsetParent:yy,ownerDocument:xy,ownerWindow:Ny,parents:Ox,position:gy,prepend:qx,querySelectorAll:Td,remove:$x,removeClass:Ud,removeEventListener:Dy,requestAnimationFrame:jd,scrollLeft:py,scrollParent:op,scrollTo:zx,scrollTop:Bc,scrollbarSize:hy,siblings:Wx,style:js,text:Kx,toggleClass:Gx,transitionEnd:ip,triggerEvent:rp,width:by},Symbol.toStringTag,{value:"Module"})),fI=bl(dI);var wd={exports:{}};(function(n,e){e.__esModule=!0,e.default=s;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(r,i){return t(r.querySelectorAll(i))}n.exports=e.default})(wd,wd.exports);var pI=wd.exports,Ms={};const hI=bl(Qv),gI=bl(Yv),yI=bl(Xv);var oa=ns.default;Object.defineProperty(Ms,"__esModule",{value:!0});Ms.default=void 0;Ms.getBoundsForNode=yl;Ms.getEventNodeFromPoint=Yx;Ms.getShowMoreNodeFromPoint=Xx;Ms.isEvent=DI;Ms.isShowMore=kI;Ms.objectsCollide=Cd;var bI=oa(na),NI=oa(Wi),xI=oa(Ki),Vd=oa(hI),Qx=oa(gI),vI=oa(yI);function Xn(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,vI.default)(t,n,e,{passive:!1})}function _I(n,e,t){return!n||(0,Vd.default)(n,document.elementFromPoint(e,t))}function Yx(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,Qx.default)(r,".rbc-event",n)}function Xx(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,Qx.default)(r,".rbc-show-more",n)}function DI(n,e){return!!Yx(n,e)}function kI(n,e){return!!Xx(n,e)}function Ca(n){var e=n;return n.touches&&n.touches.length&&(e=n.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Yg=5,EI=250,AI=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t.global,r=s===void 0?!1:s,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,NI.default)(this,n),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Xn("touchmove",function(){},window),this._removeKeyDownListener=Xn("keydown",this._keyListener),this._removeKeyUpListener=Xn("keyup",this._keyListener),this._removeDropFromOutsideListener=Xn("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Xn("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,xI.default)(n,[{key:"on",value:function(t,s){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(s),{remove:function(){var o=r.indexOf(s);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var s=this._selectRect;return!s||!this.selecting?!1:Cd(s,yl(t))}},{key:"filter",value:function(t){var s=this._selectRect;return!s||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,s){var r=this,i=null,o=null,l=null,u=function(p){i=setTimeout(function(){d(),t(p)},r.longPressThreshold),o=Xn("touchmove",function(){return d()}),l=Xn("touchend",function(){return d()})},m=Xn("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return s&&u(s),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,s=Xn("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=Xn("mousedown",t._handleInitialEvent)}),r=Xn("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){s(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var s=Ca(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var s=Ca(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var s=Ca(t),r=s.clientX,i=s.clientY,o=s.pageX,l=s.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!_I(u,r,i))){if(!this.globalMouse&&u&&!(0,Vd.default)(u,t.target)){var f=wI(0),p=f.top,y=f.left,C=f.bottom,v=f.right;if(d=yl(u),m=Cd({top:d.top-p,left:d.left-y,bottom:d.bottom+C,right:d.right+v},{top:l,left:o}),!m)return}var w=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(w!==!1)switch(t.type){case"mousedown":this._removeEndListener=Xn("mouseup",this._handleTerminatingEvent),this._onEscListener=Xn("keydown",this._handleTerminatingEvent),this._removeMoveListener=Xn("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Xn("touchend",this._handleTerminatingEvent),this._removeMoveListener=Xn("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var s=t.target,r=this.validContainers;return!r||!r.length||!s?!0:r.some(function(i){return!!s.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var s=this.selecting,r=this._selectRect;if(!s&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,Vd.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!s&&i?this._handleClickEvent(t):s?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var s=Ca(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<EI?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var s=this._initialEventData,r=s.x,i=s.y,o=Ca(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),p=Math.min(u,i),y=this.selecting,C=this.isClick(l,u);C&&!y&&!(m||d)||(!y&&!C&&this.emit("selectStart",this._initialEventData),C||(this.selecting=!0,this._selectRect={top:p,left:f,x:l,y:u,right:f+m,bottom:p+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,s){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Yg&&Math.abs(s-o)<=Yg}}])}();function wI(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,bI.default)(n)!=="object"&&(n={top:n,left:n,right:n,bottom:n}),n}function Cd(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=yl(n),r=s.top,i=s.left,o=s.right,l=o===void 0?i:o,u=s.bottom,m=u===void 0?r:u,d=yl(e),f=d.top,p=d.left,y=d.right,C=y===void 0?p:y,v=d.bottom,w=v===void 0?f:v;return!(m-t<f||r+t>w||l-t<p||i+t>C)}function yl(n){if(!n.getBoundingClientRect)return n;var e=n.getBoundingClientRect(),t=e.left+Xg("left"),s=e.top+Xg("top");return{top:s,left:t,right:(n.offsetWidth||0)+t,bottom:(n.offsetHeight||0)+s}}function Xg(n){if(n==="left")return window.pageXOffset||document.body.scrollLeft||0;if(n==="top")return window.pageYOffset||document.body.scrollTop||0}Ms.default=AI;var zu={},Wu=ns.default;Object.defineProperty(zu,"__esModule",{value:!0});zu.default=void 0;var VI=Wu(hx),Jg=Wu(ri),CI=Wu(Bl),Ia=Wu(E);function cc(n){return typeof n=="string"?n:n+"%"}function II(n){var e=n.style,t=n.className,s=n.event,r=n.accessors,i=n.rtl,o=n.selected,l=n.label,u=n.continuesPrior,m=n.continuesAfter,d=n.getters,f=n.onClick,p=n.onDoubleClick,y=n.isBackgroundEvent,C=n.onKeyPress,v=n.components,w=v.event,R=v.eventWrapper,I=r.title(s),F=r.tooltip(s),re=r.end(s),ee=r.start(s),M=d.eventProp(s,ee,re,o),A=[Ia.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Ia.default.createElement("div",{key:"2",className:"rbc-event-content"},w?Ia.default.createElement(w,{event:s,title:I}):I)],N=e.height,V=e.top,j=e.width,T=e.xOffset,S=(0,Jg.default)((0,Jg.default)({},M.style),{},(0,VI.default)({top:cc(V),height:cc(N),width:cc(j)},i?"right":"left",cc(T)));return Ia.default.createElement(R,Object.assign({type:"time"},n),Ia.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:p,style:S,onKeyDown:C,title:F?(typeof l=="string"?l+": ":"")+F:void 0,className:(0,CI.default)(y?"rbc-background-event":"rbc-event",t,M.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},A))}zu.default=II;var yr={},Jx=ns.default;Object.defineProperty(yr,"__esModule",{value:!0});yr.dragAccessors=void 0;yr.eventTimes=UI;yr.mergeComponents=RI;yr.pointInColumn=BI;var SI=Jx(ri),TI=Jx(sp),Zg=ia,PI=E,LI=["children"];yr.dragAccessors={start:(0,Zg.wrapAccessor)(function(n){return n.start}),end:(0,Zg.wrapAccessor)(function(n){return n.end})};function jI(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var s=function(i){var o=i.children,l=(0,TI.default)(i,LI);return e.filter(Boolean).reduceRight(function(u,m){return(0,PI.createElement)(m,l,u)},o)};return s}function RI(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),s=(0,SI.default)({},n);return t.forEach(function(r){s[r]=n[r]?jI(n[r],e[r]):e[r]}),s}function BI(n,e){var t=n.left,s=n.right,r=n.top,i=e.x,o=e.y;return i<s+10&&i>t&&o>r}function UI(n,e,t){var s=e.start(n),r=e.end(n),i=t.eq(s,r,"minutes")&&t.diff(s,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(s,r,"milliseconds");return{start:s,end:r,duration:o}}var HI=Ix.default,ii=ns.default;Object.defineProperty($u,"__esModule",{value:!0});$u.default=void 0;var Cr=ii(ri),MI=ii(Wi),FI=ii(Ki),OI=ii(sa),qI=ii(ra),Im=fI,$I=ii(pI),pi=ii(E),zI=Gi,Ir=HI(Ms),WI=ii(zu),ar=yr,Zx=function(n){function e(){var t;(0,MI.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,OI.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,ar.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,p=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),y=(0,ar.eventTimes)(u,d,t.props.localizer),C=y.duration,v=t.props.localizer.add(p,C,"milliseconds");t.update(u,f.getRange(p,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),p=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:p,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),p=(0,ar.eventTimes)(f,u,d),y=p.duration,C=m.nextSlot(o),v=!isNaN(y);if(v){var w=d.add(o,y,"milliseconds");C=new Date(Math.max(w,C))}return C},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,$I.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Im.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Im.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new Ir.default(function(){return o.closest(".rbc-time-view")}),d=(0,Im.scrollParent)(o);m.on("beforeSelect",function(f){var p=t.context.draggable.dragAndDropAction;if(!p.action)return!1;if(p.action==="resize")return(0,ar.pointInColumn)((0,Ir.getBoundsForNode)(l),f);var y=(0,Ir.getEventNodeFromPoint)(l,f);if(!y)return!1;t.eventOffsetTop=f.y-(0,Ir.getBoundsForNode)(y).top}),m.on("selecting",function(f){var p=(0,Ir.getBoundsForNode)(l),y=t.context.draggable.dragAndDropAction;y.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,p)),y.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,p))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var p=(0,Ir.getBoundsForNode)(l);(0,ar.pointInColumn)(p,f)&&t.handleDropFromOutside(f,p)}}),m.on("dragOverFromOutside",function(f){var p=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(p){var y=(0,Ir.getBoundsForNode)(l);if(!(0,ar.pointInColumn)(y,f))return t.reset();t.handleDragOverFromOutside(f,y)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var p=(0,Ir.getBoundsForNode)(l);u=!1;var y=t.context.draggable.dragAndDropAction;if(y.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,ar.pointInColumn)(p,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=pi.default.createRef(),t}return(0,qI.default)(e,n),(0,FI.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(s,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,Cr.default)((0,Cr.default)({},s),{},{start:i,end:o})})}},{key:"handleResize",value:function(s,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,p=l.closestSlotFromPoint(s,r),y=(0,ar.eventTimes)(d,o,u),C=y.start,v=y.end,w;if(f==="UP"){var R=u.min(p,l.closestSlotFromDate(v,-1));w=l.getRange(R,v),w=(0,Cr.default)((0,Cr.default)({},w),{},{endDate:v})}else if(f==="DOWN"){var I=u.max(p,l.closestSlotFromDate(C));w=l.getRange(C,I),w=(0,Cr.default)((0,Cr.default)({},w),{},{startDate:C})}this.update(d,w)}},{key:"renderContent",value:function(){var s=this.props,r=s.children,i=s.accessors,o=s.components,l=s.getters,u=s.slotMetrics,m=s.localizer,d=this.state,f=d.event,p=d.top,y=d.height;if(!f)return r;var C=r.props.children,v=f.start,w=f.end,R,I="eventTimeRangeFormat",F=u.startsBeforeDay(v),re=u.startsAfterDay(w);return F?I="eventTimeRangeEndFormat":re&&(I="eventTimeRangeStartFormat"),F&&re?R=m.messages.allDay:R=m.format({start:v,end:w},I),pi.default.cloneElement(r,{children:pi.default.createElement(pi.default.Fragment,null,C,f&&pi.default.createElement(WI.default,{event:f,label:R,className:"rbc-addons-dnd-drag-preview",style:{top:p,height:y,width:100},getters:l,components:o,accessors:(0,Cr.default)((0,Cr.default)({},i),ar.dragAccessors),continuesPrior:F,continuesAfter:re}))})}},{key:"render",value:function(){return pi.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(pi.default.Component);Zx.contextType=zI.DnDContext;$u.default=Zx;var Ku={},ev={exports:{}},tv={exports:{}},nv={exports:{}};(function(n){function e(t,s){(s==null||s>t.length)&&(s=t.length);for(var r=0,i=Array(s);r<s;r++)i[r]=t[r];return i}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(nv);var sv=nv.exports;(function(n){var e=sv;function t(s){if(Array.isArray(s))return e(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(tv);var KI=tv.exports,rv={exports:{}};(function(n){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(rv);var GI=rv.exports,iv={exports:{}};(function(n){var e=sv;function t(s,r){if(s){if(typeof s=="string")return e(s,r);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,r):void 0}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(iv);var QI=iv.exports,ov={exports:{}};(function(n){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(ov);var YI=ov.exports;(function(n){var e=KI,t=GI,s=QI,r=YI;function i(o){return e(o)||t(o)||s(o)||r()}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports})(ev);var av=ev.exports,Gu={},Qu={},Yu={},oi=ns.default;Object.defineProperty(Yu,"__esModule",{value:!0});Yu.default=void 0;var ey=oi(ri),XI=oi(sp),JI=oi(Wi),ZI=oi(Ki),eS=oi(sa),tS=oi(ra),Sa=oi(E),nS=oi(Bl),sS=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],rS=function(n){function e(){return(0,JI.default)(this,e),(0,eS.default)(this,e,arguments)}return(0,tS.default)(e,n),(0,ZI.default)(e,[{key:"render",value:function(){var s=this.props,r=s.style,i=s.className,o=s.event,l=s.selected,u=s.isAllDay,m=s.onSelect,d=s.onDoubleClick,f=s.onKeyPress,p=s.localizer,y=s.continuesPrior,C=s.continuesAfter,v=s.accessors,w=s.getters,R=s.children,I=s.components,F=I.event,re=I.eventWrapper,ee=s.slotStart,M=s.slotEnd,A=(0,XI.default)(s,sS);delete A.resizable;var N=v.title(o),V=v.tooltip(o),j=v.end(o),T=v.start(o),S=v.allDay(o),k=u||S||p.diff(T,p.ceil(j,"day"),"day")>1,Ee=w.eventProp(o,T,j,l),qe=Sa.default.createElement("div",{className:"rbc-event-content",title:V||void 0},F?Sa.default.createElement(F,{event:o,continuesPrior:y,continuesAfter:C,title:N,isAllDay:S,localizer:p,slotStart:ee,slotEnd:M}):N);return Sa.default.createElement(re,Object.assign({},this.props,{type:"date"}),Sa.default.createElement("div",Object.assign({},A,{style:(0,ey.default)((0,ey.default)({},Ee.style),r),className:(0,nS.default)("rbc-event",i,Ee.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":y,"rbc-event-continues-after":C}),onClick:function(Ue){return m&&m(o,Ue)},onDoubleClick:function(Ue){return d&&d(o,Ue)},onKeyDown:function(Ue){return f&&f(o,Ue)}}),typeof R=="function"?R(qe):qe))}}])}(Sa.default.Component);Yu.default=rS;var ai={},iS=ns.default;Object.defineProperty(ai,"__esModule",{value:!0});ai.dateCellSelection=cS;ai.getSlotAtX=lv;ai.isSelected=aS;ai.pointInBox=lS;ai.slotWidth=ap;var oS=iS(Jv);function aS(n,e){return!n||e==null?!1:(0,oS.default)(n,e)}function ap(n,e){var t=n.right-n.left,s=t/e;return s}function lv(n,e,t,s){var r=ap(n,s);return t?s-1-Math.floor((e-n.left)/r):Math.floor((e-n.left)/r)}function lS(n,e){var t=e.x,s=e.y;return s>=n.top&&s<=n.bottom&&t>=n.left&&t<=n.right}function cS(n,e,t,s,r){var i=-1,o=-1,l=s-1,u=ap(e,s),m=lv(e,t.x,r,s),d=e.top<t.y&&e.bottom>t.y,f=e.top<n.y&&e.bottom>n.y,p=n.y>e.bottom,y=e.top>n.y,C=t.top<e.top&&t.bottom>e.bottom;return C&&(i=0,o=l),d&&(y?(i=0,o=m):p&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((n.x-e.left)/u):Math.floor((n.x-e.left)/u),d?m<i?i=m:o=m:n.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var lp=ns.default;Object.defineProperty(Qu,"__esModule",{value:!0});Qu.default=void 0;var zs=lp(dy),ty=lp(E),uS=lp(Yu),mS=ai;Qu.default={propTypes:{slotMetrics:zs.default.object.isRequired,selected:zs.default.object,isAllDay:zs.default.bool,accessors:zs.default.object.isRequired,localizer:zs.default.object.isRequired,components:zs.default.object.isRequired,getters:zs.default.object.isRequired,onSelect:zs.default.func,onDoubleClick:zs.default.func,onKeyPress:zs.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var s=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,p=e.resizable,y=d.continuesPrior(t),C=d.continuesAfter(t);return ty.default.createElement(uS.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:y,continuesAfter:C,slotStart:d.first,slotEnd:d.last,selected:(0,mS.isSelected)(t,s),resizable:p})},renderSpan:function(e,t,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return ty.default.createElement("div",{key:s,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var li=ns.default;Object.defineProperty(Gu,"__esModule",{value:!0});Gu.default=void 0;var dS=li(ri),fS=li(Wi),pS=li(Ki),hS=li(sa),gS=li(ra),yS=li(Bl),ny=li(E),jc=li(Qu),cv=function(n){function e(){return(0,fS.default)(this,e),(0,hS.default)(this,e,arguments)}return(0,gS.default)(e,n),(0,pS.default)(e,[{key:"render",value:function(){var s=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return ny.default.createElement("div",{className:(0,yS.default)(l,"rbc-row")},i.reduce(function(m,d,f){var p=d.event,y=d.left,C=d.right,v=d.span,w="_lvl_"+f,R=y-u,I=jc.default.renderEvent(s.props,p);return R&&m.push(jc.default.renderSpan(o,R,"".concat(w,"_gap"))),m.push(jc.default.renderSpan(o,v,w,I)),u=C+1,m},[]))}}])}(ny.default.Component);cv.defaultProps=(0,dS.default)({},jc.default.defaultProps);Gu.default=cv;var br={},uv=ns.default;Object.defineProperty(br,"__esModule",{value:!0});br.endOfRange=mv;br.eventLevels=xS;br.eventSegments=NS;br.inRange=vS;br.segsOverlap=dv;br.sortEvents=Id;br.sortWeekEvents=_S;var Sm=uv(av),bS=uv(Zv);function mv(n){var e=n.dateRange,t=n.unit,s=t===void 0?"day":t,r=n.localizer;return{first:e[0],last:r.add(e[e.length-1],1,s)}}function NS(n,e,t,s){var r=mv({dateRange:e,localizer:s}),i=r.first,o=r.last,l=s.diff(i,o,"day"),u=s.max(s.startOf(t.start(n),"day"),i),m=s.min(s.ceil(t.end(n),"day"),o),d=(0,bS.default)(e,function(p){return s.isSameDate(p,u)}),f=s.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-s.segmentOffset,1),{event:n,span:f,left:d+1,right:Math.max(d+f,1)}}function xS(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,s,r,i=[],o=[];for(t=0;t<n.length;t++){for(r=n[t],s=0;s<i.length&&dv(r,i[s]);s++);s>=e?o.push(r):(i[s]||(i[s]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function vS(n,e,t,s,r){var i={start:s.start(n),end:s.end(n)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function dv(n,e){return e.some(function(t){return t.left<=n.right&&t.right>=n.left})}function _S(n,e,t){var s=(0,Sm.default)(n),r=[],i=[];s.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return Id(u,m,e,t)}),l=i.sort(function(u,m){return Id(u,m,e,t)});return[].concat((0,Sm.default)(o),(0,Sm.default)(l))}function Id(n,e,t,s){var r={start:t.start(n),end:t.end(n),allDay:t.allDay(n)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return s.sortEvents({evtA:r,evtB:i})}var DS=Ix.default,ci=ns.default;Object.defineProperty(Ku,"__esModule",{value:!0});Ku.default=void 0;var uc=ci(ri),kS=ci(av),ES=ci(Wi),AS=ci(Ki),wS=ci(sa),VS=ci(ra),mc=ci(E),CS=ci(Gu),vo=DS(Ms),IS=br,Sr=ai,dc=yr,SS=Gi,fv=function(n){function e(){var t;(0,ES.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,wS.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,Sr.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,p=d.slotMetrics,y=d.rtl,C=d.localizer,v=(0,Sr.getSlotAtX)(l,o.x,y,p.slots),w=p.getDateForSlot(v),R=(0,dc.eventTimes)(m,f,C),I=R.start,F=R.duration;I=C.merge(w,I);var re=C.add(I,F,"milliseconds");t.update(m,I,re)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,p=(0,Sr.getSlotAtX)(l,o.x,d,m.slots),y=m.getDateForSlot(p);t.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new vo.default(function(){return l},{validContainers:(0,kS.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,p=t.context.draggable.dragAndDropAction.action,y=(0,vo.getBoundsForNode)(o),C=(0,Sr.pointInBox)(y,d);return p==="move"||p==="resize"&&(!f||C)}),m.on("selecting",function(d){var f=(0,vo.getBoundsForNode)(o),p=t.context.draggable.dragAndDropAction;p.action==="move"&&t.handleMove(d,f),p.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,vo.getBoundsForNode)(o);t.state.segment&&((0,Sr.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,vo.getBoundsForNode)(o);(0,Sr.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,vo.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=mc.default.createRef(),t}return(0,VS.default)(e,n),(0,AS.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(s,r,i){var o=(0,IS.eventSegments)((0,uc.default)((0,uc.default)({},s),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,dc.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(s,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,p=u.localizer,y=(0,dc.eventTimes)(o,m,p),C=y.start,v=y.end,w=(0,Sr.getSlotAtX)(r,s.x,f,d.slots),R=d.getDateForSlot(w),I=(0,Sr.pointInBox)(r,s);if(l==="RIGHT"){if(I){if(d.last<C)return this.reset();p.eq(p.startOf(v,"day"),v)?v=p.add(R,1,"day"):v=R}else if(p.inRange(C,d.first,d.last)||r.bottom<s.y&&+d.first>+C)v=p.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var F=m.end(o);v=p.merge(v,F),p.lt(v,C)&&(v=F)}else if(l==="LEFT"){if(I){if(d.first>v)return this.reset();C=R}else if(p.inRange(v,d.first,d.last)||r.top>s.y&&p.lt(d.last,v))C=p.add(d.first,-1,"milliseconds");else{this.reset();return}var re=m.start(o);C=p.merge(C,re),p.gt(C,v)&&(C=re)}this.update(o,C,v)}},{key:"render",value:function(){var s=this.props,r=s.children,i=s.accessors,o=this.state.segment;return mc.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&mc.default.createElement(CS.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,uc.default)((0,uc.default)({},i),dc.dragAccessors)})))}}])}(mc.default.Component);fv.contextType=SS.DnDContext;Ku.default=fv;var Fs=ns.default;Object.defineProperty(np,"__esModule",{value:!0});np.default=$S;var fc=Fs(ri),TS=Fs(sp),PS=Fs(Wi),LS=Fs(Ki),jS=Fs(sa),RS=Fs(ra),Tm=Fs(E),BS=Fs(Bl),US=Fs(qu),HS=Fs($u),MS=Fs(Ku),FS=yr,OS=Gi,qS=["selectable","elementProps","components"];function $S(n){var e=function(t){function s(){var r;(0,PS.default)(this,s);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,jS.default)(this,s,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var p=r.props,y=p.onEventDrop,C=p.onEventResize;d==="move"&&y&&y(u),d==="resize"&&C&&C(u)}},r.state={interacting:!1},r}return(0,RS.default)(s,t),(0,LS.default)(s,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,TS.default)(i,qS),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,FS.mergeComponents)(u,{eventWrapper:US.default,eventContainerWrapper:HS.default,weekWrapper:MS.default});var f=this.props.onDropFromOutside?(0,fc.default)((0,fc.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,BS.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var p=this.getDnDContextValue();return Tm.default.createElement(OS.DnDContext.Provider,{value:p},Tm.default.createElement(n,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(Tm.default.Component);return e.defaultProps=(0,fc.default)((0,fc.default)({},n.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var zS=ns.default;Object.defineProperty(tp,"__esModule",{value:!0});var pv=tp.default=void 0,WS=zS(np);pv=tp.default=WS.default;const Pr={async getAllProcesses(){try{const n=Qe(ae,"processes"),e=_t(n,Jt("order","asc")),t=await jt(e);return t.empty?this.getDefaultProcesses():t.docs.map(s=>{const r=s.data();return{id:parseInt(s.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(n){return console.error("[Firestore]    :",n),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,t)=>({id:t+1,name:e,order:t,isDefault:!0}))},async createProcess(n,e){try{const t=Qe(ae,"processes"),s=await jt(t);let r=0;s.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>r&&(r=m)});const i=r+1,o=Te(ae,"processes",String(i)),l=new Date().toISOString();return await Fi(o,{name:n,order:e,isDefault:!1,createdAt:l,updatedAt:vn()}),console.log(" [Firestore]   :",i),{id:i,name:n,order:e,isDefault:!1,createdAt:l}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async updateProcess(n,e){try{const t=Te(ae,"processes",String(n)),s=await Rt(t);if(!s.exists())throw new Error("   .");const r=s.data(),i={updatedAt:vn()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await $t(t,i),console.log(" [Firestore]   :",n),{id:n,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async deleteProcess(n){try{const e=Te(ae,"processes",String(n));await Kn(e),console.log(" [Firestore]   :",n)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(n){try{const e=n.map((t,s)=>{const r=Te(ae,"processes",String(t));return $t(r,{order:s,updatedAt:vn()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(n){const e=Qe(ae,"processes"),t=_t(e,Jt("order","asc"));return Ns(t,r=>{if(r.empty){n(Pr.getDefaultProcesses());return}const i=r.docs.map(o=>{const l=o.data();return{id:parseInt(o.id)||0,name:l.name||"",order:l.order||0,isDefault:l.isDefault||!1}});n(i)})}},KS={getAllProcesses:()=>Pr.getAllProcesses(),createProcess:(n,e)=>Pr.createProcess(n,e),updateProcess:(n,e)=>Pr.updateProcess(n,e),deleteProcess:n=>Pr.deleteProcess(n),reorderProcesses:n=>Pr.reorderProcesses(n),subscribeToProcesses:Pr.subscribeToProcesses,getDefaultProcesses:Pr.getDefaultProcesses},GS=pv(e_),QS=V2;ct.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:n=>n<12?"":"",week:{dow:0,doy:1}});ct.locale("ko");const YS=t_(ct),sy=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],XS=mt.memo(({onSave:n,onCancel:e,processList:t})=>{const[s,r]=E.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=E.useState(i);E.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:s,onChange:m=>r(m.target.value),onBlur:()=>{s.trim()?n(s.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?s.trim()?n(s.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),ry=n=>n,el={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},JS=mt.memo(({date:n,label:e,filteredEvents:t,selectedDate:s,user:r,isMobileView:i})=>{const o=ct(n).format("YYYY-MM-DD"),l=el[o],u=!!el[o],m=s&&ct(n).isSame(s,"day"),d=t.filter(M=>ct(M.start).isSame(n,"day")),f=d.length,p=d.filter(M=>M.assignedTo&&M.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-p,C=e.replace(/^0/,""),v=n.getDay()===0,w=n.getDay()===6;let R="#000000";u||v?R="#dc2626":w&&(R="#3b82f6");const I=ct(n).isSame(ct(),"day");let F="#d1d5db";u||v?F="#fecaca":w&&(F="#bfdbfe");const re=C.length===2,ee=i?{backgroundColor:"transparent",color:R,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:I?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:R,fontWeight:I?"700":"400",paddingLeft:re?"0px":"4px",...I&&{backgroundColor:F,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:ee,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:p}).map((M,A)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((M,A)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:ee,children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),ZS=mt.memo(({event:n,user:e,filterProject:t,isEditing:s,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const p=t&&t!=="all",y=n.assignedTo||[],[C,v]=E.useState(!1),w=mt.useRef(null),R=()=>{const ge=window.innerWidth,Ue=window.innerHeight;return ge>=768&&ge<1024||ge>=1024&&Ue>ge},[I,F]=E.useState(R),[re,ee]=E.useState(!1);mt.useRef(null),mt.useRef(!1);const[M,A]=E.useState(r||""),N=mt.useRef(s);E.useEffect(()=>{s&&!N.current&&r!==void 0&&A(r),N.current=s},[s,r]);const V=e!=null&&e.name?e.name.slice(-2):null,j=V&&["",""].includes(V),T=V&&["","",""].includes(V),S=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&T||y.includes("")&&j);E.useEffect(()=>{const ge=()=>{F(R())};return window.addEventListener("resize",ge),()=>window.removeEventListener("resize",ge)},[]);const k=ge=>{A(ge)},Ee=()=>{M!=null&&M.trim()&&o&&(i&&i(M),o()),u&&u()},qe=ge=>{ge.stopPropagation(),(ge.key==="Enter"||ge.key==="Escape")&&ge.currentTarget.blur()};return I?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{ee(!0),v(!0)},onMouseLeave:()=>{ee(!1),v(!1)},style:{padding:p?"2px 3px":"1px 3px",minHeight:p?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[C&&p&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:w,onMouseDown:ge=>{ge.stopPropagation(),ge.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:p?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!p&&!n.isASVisit&&n.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",ry(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!p&&y.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((ge,Ue)=>{const ht=ge==="HV LAB"||ge===""&&j||ge===""&&T||ge===(e==null?void 0:e.name);return a.jsxDEV(mt.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:ht?"bold":"normal"},children:ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),Ue<y.length-1&&""]},ge,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:ge=>k(ge.target.value),onBlur:Ee,onKeyDown:qe,onClick:ge=>ge.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:S?"underline":"none",textDecorationColor:S?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:n.title,children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),re&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),n.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",n.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:p?"32px":"18px",padding:p?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!p&&!n.isASVisit&&n.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",ry(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:ge=>k(ge.target.value),onBlur:Ee,onKeyDown:qe,onClick:ge=>ge.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:p?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:p?"18px":"12px",textDecoration:S?"underline":"none",textDecorationColor:S?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!p&&y.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((ge,Ue)=>{const ht=ge==="HV LAB"||ge===""&&j||ge===""&&T||ge===(e==null?void 0:e.name);return a.jsxDEV(mt.Fragment,{children:[a.jsxDEV("span",{className:ht?"font-bold":"",children:ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),Ue<y.length-1&&""]},ge,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),C&&p&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:w,onMouseDown:ge=>{ge.stopPropagation(),ge.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&s&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(ge=>a.jsxDEV("option",{value:ge},ge,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),eT=()=>{const{schedules:n,setSchedules:e,addSchedule:t,deleteSchedule:s,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:p}=Xr(),{user:y}=si(),C=Ou(),[v,w]=E.useState(!1);E.useEffect(()=>{const b=()=>{const H=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;w(H)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const R=b=>!b||b==="-"?"":v?b:Ad(b),I=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",I);const F=mt.useRef(!1);E.useEffect(()=>{F.current||(F.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),oe.error("  ")}))},[r]);const[re,ee]=E.useState([]);E.useEffect(()=>{const b=async H=>{if((H.ctrlKey||H.metaKey)&&H.key==="z"){const Y=H.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(re.length>0){H.preventDefault();const W=re[re.length-1];try{const ce=W.type==="as_visit"||W.type==="expected_payment"?"other":W.type;await i({id:"",title:W.originalTitle||W.title,start:W.start,end:W.end,type:ce,project:W.originalProjectName||W.projectName,attendees:W.assignedTo||[],time:W.time,description:W.description}),ee(Ne=>Ne.slice(0,-1)),oe.success(" ")}catch(ce){console.error("  :",ce),oe.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[re,i]);const[M,A]=E.useState([]),[N,V]=E.useState(!1),[j,T]=E.useState(""),[S,k]=E.useState(null),[Ee,qe]=E.useState(""),[ge,Ue]=E.useState(!1),[ht,Kt]=E.useState(null),[Ot,le]=E.useState(null),$e=E.useCallback(async()=>{Ue(!0);try{const b=await KS.getAllProcesses();A(b)}catch(b){console.error("   :",b),A([])}finally{Ue(!1)}},[]);E.useEffect(()=>{$e()},[$e]);const de=E.useMemo(()=>M.length>0?M.map(b=>b.name):QS,[M]),Re=async()=>{if(j.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(b.ok)T(""),$e(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},Ye=async()=>{if(!(!S||!Ee.trim()))try{const b=await fetch(`/api/processes/${S.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ee.trim()})});if(b.ok)k(null),qe(""),$e(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},vt=async b=>{if(confirm("   ?"))try{const H=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(H.ok)$e(),oe.success(" ");else{const Y=await H.json();oe.error(Y.error||"  ")}}catch(H){console.error("  :",H),oe.error("  ")}},lt=b=>{Kt(b)},It=(b,H)=>{b.preventDefault(),ht!==null&&ht!==H&&le(H)},at=async()=>{if(ht!==null&&Ot!==null&&ht!==Ot){const b=[...M],[H]=b.splice(ht,1);b.splice(Ot,0,H),A(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(W=>({id:W.id}))})})).ok||($e(),oe.error("  "))}catch(Y){console.error("  :",Y),$e(),oe.error("  ")}}Kt(null),le(null)},ft=b=>{const H=C.findIndex(Y=>Y.name===b);return H>=0?sy[H%sy.length]:"#e8e2ea"},bn=C.map(b=>b.name),K=n.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||bn.includes(b.project):!0).map(b=>{const H=C.find(ye=>ye.name===b.project);let Y=b.project===""?"[]":b.project;if(H&&b.project!==""){const ye=H.name.length>2?H.name.substring(0,2):H.name,gt=(H.location||"").match(/([A-Za-z]?\d+)/),_n=gt?gt[1]:"";Y=_n?`${ye}_${_n}`:ye}const W=b.time,ce=W&&W!=="-"?` - ${R(W)}`:"",Ne=b.attendees||[];return{id:b.id,title:b.title+ce,originalTitle:b.title,start:b.start,end:b.end,projectId:(H==null?void 0:H.id)||"",projectName:Y||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:Ne,priority:"medium",allDay:!W||W==="-",color:ft(b.project||""),isASVisit:!1,time:W,description:b.description}}),Le=u.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?bn.includes(b.project):!0).map(b=>{const H=b.scheduledVisitTime,Y=H&&H!=="-"?` - ${R(H)}`:"",W=C.find(ye=>ye.name===b.project);let ce=b.project;if(W){const ye=W.name.length>2?W.name.substring(0,2):W.name,gt=(W.location||"").match(/([A-Za-z]?\d+)/),_n=gt?gt[1]:"";ce=_n?`${ye}_${_n}`:ye}const Ne=`[AS] ${ce}`;return{id:`as-${b.id}`,title:Ne+Y,originalTitle:Ne,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(W==null?void 0:W.id)||"",projectName:ce,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(ye=>ye.trim()):[],priority:"high",allDay:!H||H==="-",color:"#FEF3C7",isASVisit:!0,time:H,description:b.description}}),He=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var Ne,ye,ut,gt,_n,Pt,Lt,mn;const H=C.find(Tn=>Tn.name===b.project);if(!H){const Tn=[],wt=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),rn=new Set(b.payments.flatMap(xn=>{var Xt;return((Xt=xn.type)==null?void 0:Xt.split(", ").map(Zt=>Zt.trim()))||[]}));return!rn.has("")&&((Ne=b.expectedPaymentDates)!=null&&Ne.contract)&&Tn.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(wt*.1).toLocaleString()}`}),!rn.has("")&&((ye=b.expectedPaymentDates)!=null&&ye.start)&&Tn.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(wt*.4).toLocaleString()}`}),!rn.has("")&&((ut=b.expectedPaymentDates)!=null&&ut.middle)&&Tn.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(wt*.4).toLocaleString()}`}),!rn.has("")&&((gt=b.expectedPaymentDates)!=null&&gt.final)&&Tn.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(wt*.1).toLocaleString()}`}),Tn}if(!H.startDate||!H.endDate)return[];const Y=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),W=new Set(b.payments.flatMap(Tn=>{var wt;return((wt=Tn.type)==null?void 0:wt.split(", ").map(rn=>rn.trim()))||[]})),ce=[];return!W.has("")&&((_n=b.expectedPaymentDates)!=null&&_n.contract)&&ce.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!W.has("")&&((Pt=b.expectedPaymentDates)!=null&&Pt.start)&&ce.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((Lt=b.expectedPaymentDates)!=null&&Lt.middle)&&ce.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((mn=b.expectedPaymentDates)!=null&&mn.final)&&ce.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),ce}):[],Se=[...K,...Le,...He],Xe=E.useCallback(b=>{if(!(y!=null&&y.name))return!1;const H=b.assignedTo||[],Y=y.name.slice(-2),W=["",""].includes(Y),ce=["","",""].includes(Y);return H.includes(y.name)||H.includes("HV LAB")||H.includes("")&&ce||H.includes("")&&W},[y==null?void 0:y.name]),St=(b,H)=>{if(!H)return[...b].sort((ce,Ne)=>{const ye=Xe(ce),ut=Xe(Ne);return ye&&!ut?-1:!ye&&ut?1:ce.start.getTime()-Ne.start.getTime()});const Y=new Map;b.forEach(ce=>{const Ne=ce.time&&ce.time!=="-"&&ce.time.trim()!=="";if(ce.isASVisit||ce.isExpectedPayment||Ne){const ye=`single_${ce.id}`;Y.set(ye,[ce])}else{const ye=ce.start.toISOString().split("T")[0],ut=[...ce.assignedTo].sort().join(","),gt=`${ye}_${ce.projectName}_${ut}`;Y.has(gt)||Y.set(gt,[]),Y.get(gt).push(ce)}});const W=[];return Y.forEach(ce=>{if(ce.length===1)W.push(ce[0]);else{const Ne=ce[0],ye=ce.map(Lt=>Lt.originalTitle||Lt.title),ut=[...new Set(ye)],gt=ce.map(Lt=>{const mn=Lt.originalTitle||Lt.title;return mn.startsWith(Ne.projectName+" - ")?mn.substring(Ne.projectName.length+3):mn}),_n=[...new Set(gt)],Pt={...Ne,id:ce[0].id,title:_n.join(", "),originalTitle:ut.join(", "),description:ce.map(Lt=>Lt.description||Lt.originalTitle||Lt.title).join(`
`),assignedTo:[...new Set(ce.flatMap(Lt=>Lt.assignedTo))],mergedEventIds:ce.map(Lt=>Lt.id)};W.push(Pt)}}),W.sort((ce,Ne)=>{const ye=Xe(ce),ut=Xe(Ne);return ye&&!ut?-1:!ye&&ut?1:ce.start.getTime()-Ne.start.getTime()})},[Gt,dt]=E.useState("month"),[P,q]=E.useState(new Date),[te,xe]=E.useState(!1),[ue,fe]=E.useState(null),[Ie,ze]=E.useState(null),tt=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[Ae,On]=E.useState(()=>{const b=localStorage.getItem(tt);return b||((y==null?void 0:y.name)===""&&C.length>0?C[0].name:"all")});E.useEffect(()=>{localStorage.setItem(tt,Ae)},[Ae,tt]),E.useCallback(()=>{document.body.classList.add("printing-schedule");const b=Ae==="all"?" ":Ae,H=ct(P).format("YYYY MM"),Y=document.title;document.title=`${b} - ${H} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[Ae,P]);const Ht=St(Se,Ae==="all"),[ne,Je]=E.useState(window.innerWidth<768?new Date:null),[O,ve]=E.useState(null),ke=mt.useRef(null),je=mt.useRef(!1),[me,kt]=E.useState(null),xt=mt.useRef(!1),tn=mt.useRef(!1);E.useEffect(()=>{const b=W=>{W.key==="Control"&&(tn.current=!0)},H=W=>{W.key==="Control"&&(tn.current=!1)},Y=()=>{tn.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",H),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",H),window.removeEventListener("blur",Y)}},[]),E.useEffect(()=>{if(!O)return;let b=null;const H=Ne=>{Ne.preventDefault(),Ne.dataTransfer&&(Ne.dataTransfer.dropEffect="copy")},Y=Ne=>{Ne.preventDefault(),Ne.dataTransfer&&(Ne.dataTransfer.dropEffect="copy");const ut=Ne.target.closest(".rbc-day-bg");b&&b!==ut&&(b.style.backgroundColor=""),ut&&(ut.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=ut)},W=()=>{b&&(b.style.backgroundColor="",b=null)},ce=Ne=>{Ne.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",H),document.addEventListener("dragover",Y),document.addEventListener("dragend",W),document.addEventListener("drop",ce),()=>{document.removeEventListener("dragenter",H),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",W),document.removeEventListener("drop",ce),b&&(b.style.backgroundColor="")}},[O]);const[At,Nn]=E.useState(null),[cn,Un]=E.useState(null),[xs,ss]=E.useState(""),[vs,ui]=E.useState(!1),[Os,ls]=E.useState(null),[D,Q]=E.useState(!1),[B,x]=E.useState(""),[L,U]=E.useState(null),[X,G]=E.useState({x:0,y:0}),[Z,ie]=E.useState({x:0,y:0}),[Ce,Ze]=E.useState(!1),Fe=8;E.useEffect(()=>{if(!L)return;const b=Y=>{G({x:Y.clientX,y:Y.clientY});const W=Math.abs(Y.clientX-Z.x),ce=Math.abs(Y.clientY-Z.y);(W>Fe||ce>Fe)&&Ze(!0)},H=()=>{U(null),Ze(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",H),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",H)}},[L,Z]);const pe=mt.useRef(!1),We=E.useCallback(async({event:b,start:H,end:Y})=>{if(b.isASVisit||b.isExpectedPayment){oe.error("    ");return}const W=H instanceof Date?H:new Date(H),ce=Y instanceof Date?Y:new Date(Y);if(tn.current)try{const ye=b.mergedEventIds||[b.id],ut=n.filter(gt=>ye.includes(gt.id));for(const gt of ut)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:gt.title,start:W,end:ce,project:gt.project,attendees:gt.attendees||[],time:gt.time,priority:gt.priority||"medium"});oe.success(" ")}catch(ye){console.error("  :",ye),oe.error("  ")}else{const ye=b.mergedEventIds||[b.id];try{for(const ut of ye)await o(ut,{start:W,end:ce})}catch(ut){console.error("  :",ut),oe.error("  "),r()}}},[n,o,i,r]),fn=E.useCallback(({event:b,action:H})=>{var W;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const ce of Y)if((W=ce.textContent)!=null&&W.includes(b.originalTitle||b.title)){const Ne=ce.getBoundingClientRect();ie({x:Ne.left,y:Ne.top}),G({x:Ne.left,y:Ne.top});break}Ze(!1),U(b)},[]),Qt=E.useCallback(async(b,H,Y=!1)=>{if(Ae==="all"){oe.error("  ");return}const W={id:"",title:b,start:H,end:H,project:Ae,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(W)}catch(ce){console.error("  :",ce),oe.error("  ")}},[Ae,i,y]),Mt=E.useCallback(({start:b})=>{const H=O||ke.current;H&&Ae!=="all"&&(je.current=!0,xt.current=!0,requestAnimationFrame(()=>{xt.current=!1}),Nn(null),Un(null),ss(""),Qt(H,b),requestAnimationFrame(()=>{ve(null),ke.current=null,je.current=!1}))},[O,Ae,Qt]),Bt=E.useCallback(()=>{const b=O||ke.current;return b?{title:b}:null},[O]),qn=E.useCallback(async b=>{if(!b.trim()||!At||Ae==="all"){Nn(null);return}const H=At;Nn(null);const Y={id:"",title:b.trim(),start:H,end:H,type:"construction",project:Ae,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}},[At,Ae,i,y]),Qn=E.useCallback(()=>{Nn(null)},[]),Yt=E.useCallback(async()=>{var b;if(!cn||!xs.trim()){Un(null),ss("");return}try{const H=((b=cn.mergedEventIds)==null?void 0:b[0])||cn.id;await o(H,{title:xs.trim()})}catch(H){console.error("  :",H),oe.error("  ")}Un(null),ss("")},[cn,xs,o]),Ke=E.useCallback(async b=>{ee(Y=>[...Y,b]);const H=b.mergedEventIds||[b.id];oe.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(H.map(Y=>l(Y)))}catch(Y){console.error("  :",Y),oe.error("  "),ee(W=>W.slice(0,-1))}Un(null),ss("")},[l]),Ve=Ae==="all"?Ht:Ht.filter(b=>(b.originalProjectName||b.projectName)===Ae),et=mt.useMemo(()=>{const b=Ae!=="all",H=new Map;Ve.forEach(W=>{const ce=ct(W.start).format("YYYY-MM-DD");H.has(ce)||H.set(ce,[]),H.get(ce).push(W)});const Y=[];return H.forEach(W=>{if(b)W.forEach((ce,Ne)=>{const ye=ct(ce.start).startOf("day").add(Ne,"milliseconds").toDate();Y.push({...ce,start:ye,allDay:!1})});else{const ce=[],Ne=[];W.forEach(ye=>{Xe(ye)?ce.push(ye):Ne.push(ye)}),ce.forEach((ye,ut)=>{const gt=ct(ye.start).startOf("day").add(ut,"milliseconds").toDate();Y.push({...ye,start:gt,allDay:!1})}),Ne.forEach((ye,ut)=>{const gt=ct(ye.start).startOf("day").add(1e3+ut,"milliseconds").toDate();Y.push({...ye,start:gt,allDay:!1})})}}),Y.sort((W,ce)=>W.start.getTime()-ce.start.getTime())},[Ve,Xe,Ae]),nt=mt.useMemo(()=>{if(At&&Ae!=="all"){const b=ct(At).format("YYYY-MM-DD"),H=et.filter(Ne=>ct(Ne.start).format("YYYY-MM-DD")===b),Y=H.length>0?Math.max(...H.map(Ne=>Ne.start.getTime())):ct(At).startOf("day").valueOf(),W=new Date(Y+1),ce={id:"__inline_add__",title:"",start:W,end:W,projectId:"",projectName:Ae,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...et,ce]}return et},[et,At,Ae]);E.useEffect(()=>{(y==null?void 0:y.name)===""&&C.length>0&&(Ae==="all"||!C.find(b=>b.name===Ae))&&On(C[0].name)},[C,y]),E.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(ye=>{ye.style.display="none",ye.style.visibility="hidden",ye.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(ye=>{ye.style.display="none",ye.style.visibility="hidden",ye.style.opacity="0",ye.style.pointerEvents="none",ye.style.position="absolute",ye.style.left="-9999px",ye.style.top="-9999px",ye.style.zIndex="-1"})};b();const H=new MutationObserver(b),Y=document.querySelector(".rbc-calendar");Y&&H.observe(Y,{childList:!0,subtree:!0});const W=new MutationObserver(b);return W.observe(document.body,{childList:!0,subtree:!0}),()=>{H.disconnect(),W.disconnect()}},[Gt,P]);const[st,Oe]=E.useState({date:null,projectId:"",title:""}),rt=mt.useRef(!1),Tt=mt.useRef(null),un=b=>{if(pe.current){pe.current=!1;return}if(b.id==="__inline_add__")return;rt.current=!0,Tt.current&&clearTimeout(Tt.current);const H=Ae!=="all",Y=window.innerWidth<768;if(H&&!Y&&!b.isASVisit&&!b.isExpectedPayment)Nn(null),Un(b),ss(b.originalTitle||b.title);else{const W={...b,title:b.originalTitle||b.title};ze(null),fe(W),xe(!0)}Tt.current=setTimeout(()=>{rt.current=!1,Tt.current=null},300)},nn=b=>{const H=window.innerWidth,Y=H<768,W=H>=768&&H<1024,ce=Ae==="all";if(xt.current)return;if(Y){if(b.start){Je(b.start);const ye=document.querySelector(".md\\:hidden.mt-3.bg-white");ye&&ye.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const Ne=b.action==="click"||b.action==="select";if(!(W&&!Ne)){if(ce){rt.current=!1,Un(null),ss(""),Nn(null),ze(b),fe(null),xe(!0);return}if(!rt.current){if(me){Qt(me,b.start,!0);return}Un(null),ss(""),Nn(b.start)}}},Vs=async()=>{if(!st.projectId||!st.title.trim()){alert("  ");return}const b=C.find(H=>H.id===st.projectId);if(!(!b||!st.date))try{await i({id:Date.now().toString(),title:st.title,start:st.date,end:st.date,type:"other",project:b.name,location:"",attendees:[],description:""}),Oe({date:null,projectId:"",title:""}),Je(null)}catch(H){console.error("Failed to add schedule:",H),oe.error("  ")}},Nr=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let H=b.color||"#E0E7FF",Y="#1f2937";if(b.isASVisit)H="#E8F5E9",Y="#1f2937";else{const W=b.assignedTo&&b.assignedTo.includes("HV LAB"),ce=b.assignedTo&&b.assignedTo.includes("")&&I&&["",""].includes(I),Ne=b.assignedTo&&b.assignedTo.includes("")&&I&&["","",""].includes(I);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||W||ce||Ne?(H="#FEF3C7",Y="#1f2937"):b.color||(H="#e8e2ea")}return{style:{backgroundColor:H,"--event-bg-color":H,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},aa=mt.useCallback(b=>{const H=ct(b).format("YYYY-MM-DD"),Y=!!el[H],W=ne&&ct(b).isSame(ne,"day"),ce=window.innerWidth<768;let Ne="";W&&(Ne+="selected-date "),Y&&(Ne+="holiday-date ");const ye=ce?{backgroundColor:"transparent",background:"transparent"}:{};return{className:Ne.trim(),style:ye}},[ne]),[Nt,Yi]=E.useState(window.innerWidth<768);E.useEffect(()=>{const b=()=>{Yi(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),E.useEffect(()=>{const b=()=>{const H=ne||new Date;ze({start:H,end:H}),fe(null),xe(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[ne]);const xr=mt.useCallback(({date:b,label:H})=>a.jsxDEV(JS,{date:b,label:H,filteredEvents:nt,selectedDate:ne,user:y,isMobileView:Nt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[nt,ne,y,Nt]),vr=mt.useRef(xs);vr.current=xs;const Ul=mt.useCallback(b=>{ss(b)},[]),la=mt.useCallback(()=>{Un(null),ss("")},[]),Hl=mt.useCallback(({event:b})=>{if(b.id==="__inline_add__")return a.jsxDEV(XS,{onSave:qn,onCancel:Qn,processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const H=(cn==null?void 0:cn.id)===b.id||(cn==null?void 0:cn.mergedEventIds)&&cn.mergedEventIds.includes(b.id);return a.jsxDEV(ZS,{event:b,user:y,filterProject:Ae,isEditing:H,editTitle:H?vr.current:void 0,onEditTitleChange:H?Ul:void 0,onEditSave:H?Yt:void 0,onEditDelete:H?()=>Ke(b):void 0,onEditCancel:H?la:void 0,onHoverDelete:()=>Ke(b),onDeleteAction:()=>{pe.current=!0},processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,Ae,cn,Yt,Ke,qn,Qn,Ul,la,de]),Xu=({onNavigate:b})=>{const[H,Y]=mt.useState(!1),[W,ce]=mt.useState(ct(P).year()),[Ne,ye]=mt.useState(ct(P).month()),ut=window.innerWidth<768,gt=()=>{ce(ct(P).year()),ye(ct(P).month()),Y(!0)},_n=()=>{q(ct().year(W).month(Ne).toDate()),Y(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${ut?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:gt,children:[a.jsxDEV("span",{children:ct(P).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ae==="all"?" ":Ae]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ae,onChange:Pt=>{On(Pt.target.value),kt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),C.filter(Pt=>Pt.status!=="completed").map(Pt=>a.jsxDEV("option",{value:Pt.name,children:Pt.name},Pt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),H&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>ce(W-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[W,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>ce(W+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(Pt=>{const Lt=Ne===Pt-1,mn=ct().year()===W&&ct().month()===Pt-1;return a.jsxDEV("button",{onClick:()=>ye(Pt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${Lt?"bg-gray-900 text-white":mn?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[Pt,""]},Pt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{q(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:_n,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},Ju=()=>null,Zu=E.useMemo(()=>({toolbar:Xu,event:Hl,month:{dateHeader:xr,showMore:Ju}}),[xr,Hl]),_r=mt.useMemo(()=>{if(!ne)return[];let b;if(Nt)b=nt.filter(Y=>ct(Y.start).isSame(ne,"day"));else{const Y=ct(ne).startOf("week"),W=ct(ne).endOf("week");b=nt.filter(ce=>{const Ne=ct(ce.start);return Ne.isSameOrAfter(Y,"day")&&Ne.isSameOrBefore(W,"day")})}const H=[...b].sort((Y,W)=>{const ce=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),Ne=Y.assignedTo&&Y.assignedTo.includes("")&&I&&["",""].includes(I),ye=Y.assignedTo&&Y.assignedTo.includes("")&&I&&["","",""].includes(I),ut=Y.assignedTo&&I&&Y.assignedTo.includes(I)||Y.assignedTo&&(y==null?void 0:y.name)&&Y.assignedTo.includes(y.name)||ce||Ne||ye,gt=W.assignedTo&&W.assignedTo.includes("HV LAB"),_n=W.assignedTo&&W.assignedTo.includes("")&&I&&["",""].includes(I),Pt=W.assignedTo&&W.assignedTo.includes("")&&I&&["","",""].includes(I),Lt=W.assignedTo&&I&&W.assignedTo.includes(I)||W.assignedTo&&(y==null?void 0:y.name)&&W.assignedTo.includes(y.name)||gt||_n||Pt;return ut&&!Lt?-1:!ut&&Lt?1:new Date(Y.start).getTime()-new Date(W.start).getTime()});return console.log("Sorted events:",H.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:y==null?void 0:y.name,userShort:I}))),H},[ne,nt,y,I,Nt]);return E.useEffect(()=>{const H=setTimeout(()=>{const Y=Nt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),W=document.querySelectorAll(".rbc-month-row"),ce=[];W.forEach((wt,rn)=>{const xn=wt.querySelectorAll(".rbc-date-cell");let Xt=0;xn.forEach(Zt=>{const yt=Zt.querySelector("button");let sn=yt==null?void 0:yt.textContent;if(!sn){const Cs=Zt.querySelector("span");sn=Cs==null?void 0:Cs.textContent}if(sn&&!isNaN(parseInt(sn))){const Cs=ct(P).date(parseInt(sn)),qs=nt.filter(Xi=>ct(Xi.start).isSame(Cs,"day"));Xt=Math.max(Xt,qs.length)}}),ce.push(Xt)});const Ne=Ae&&Ae!=="all",ye=100,ut=Ne?60:18,gt=25,_n=Math.floor((ye-gt)/ut),Pt=ce.length,Lt=ye*Pt,mn=ce.map(wt=>wt<=_n?ye:gt+wt*ut+10),Tn=mn.reduce((wt,rn)=>wt+rn,0);if(Tn>Lt){const wt=mn.map((Xt,Zt)=>({index:Zt,height:Xt,overflow:Xt>ye})),rn=wt.filter(Xt=>Xt.overflow).reduce((Xt,Zt)=>Xt+(Zt.height-ye),0),xn=wt.filter(Xt=>!Xt.overflow);if(xn.length>0){const Xt=Lt-rn-xn.length*ye,Zt=Math.max(50,ye+Xt/xn.length);W.forEach((yt,sn)=>{const qs=mn[sn]>ye?mn[sn]:Zt;yt.style.height=`${qs}px`,yt.style.minHeight=`${qs}px`})}else{const Xt=Lt/Tn;W.forEach((Zt,yt)=>{const sn=Math.max(80,mn[yt]*Xt);Zt.style.height=`${sn}px`,Zt.style.minHeight=`${sn}px`})}}else{const wt=mn.reduce((Zt,yt)=>Zt+(yt>ye?yt:0),0),rn=mn.filter(Zt=>Zt<=ye).length,xn=Lt-wt,Xt=rn>0?xn/rn:ye;W.forEach((Zt,yt)=>{const sn=mn[yt]>ye?mn[yt]:Xt;Zt.style.height=`${sn}px`,Zt.style.minHeight=`${sn}px`})}Y.forEach(wt=>{const rn=wt.querySelector("button");let xn=rn==null?void 0:rn.textContent;if(!xn){const sn=wt.querySelector("span");xn=sn==null?void 0:sn.textContent}if(!xn||isNaN(parseInt(xn)))return;const Xt=ct(P).date(parseInt(xn)),Zt=nt.filter(sn=>ct(sn.start).isSame(Xt,"day"));Zt.length>0?wt.setAttribute("data-event-count",Zt.length.toString()):wt.removeAttribute("data-event-count");const yt=Xt.clone().toDate();if(ne&&ct(yt).isSame(ne,"day")?wt.classList.add("selected-date"):wt.classList.remove("selected-date"),Nt){const sn=wt,Cs=sn._mobileClickHandler;Cs&&wt.removeEventListener("click",Cs);const qs=Xi=>{if(Xi.target.closest(".rbc-event"))return;const Ji=Xt.clone().toDate();Je(Ji);const Is=document.querySelector(".md\\:hidden.mt-3.bg-white");Is&&Is.scrollIntoView({behavior:"smooth",block:"nearest"})};sn._mobileClickHandler=qs,wt.addEventListener("click",qs,!0),wt.style.cursor="pointer",wt.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(H),Nt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(W=>{const ce=W,Ne=ce._mobileClickHandler;Ne&&(W.removeEventListener("click",Ne),delete ce._mobileClickHandler)})}},[nt,P,Nt,ne,Ae]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[st.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:ct(st.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:st.projectId,onChange:b=>Oe({...st,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:C.filter(b=>b.status!=="completed").map(b=>a.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:st.title,onChange:b=>Oe({...st,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&Vs()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:Vs,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Oe({date:null,projectId:"",title:""}),Je(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[Ae!=="all"&&!Nt&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>V(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),me&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:de.map(b=>a.jsxDEV("div",{draggable:!0,onClick:()=>{kt(me===b?null:b)},onDragStart:H=>{je.current=!1,kt(null),ve(b),ke.current=b,H.dataTransfer.setData("text/plain",b),H.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{je.current||(ve(null),ke.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${me===b?"bg-blue-500 text-white ring-2 ring-blue-300":O===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ae!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(GS,{localizer:YS,events:nt,startAccessor:"start",endAccessor:"end",view:Gt,onView:dt,date:P,onNavigate:q,onSelectEvent:un,onSelectSlot:nn,onEventDrop:Ae!=="all"?We:void 0,onDragStart:Ae!=="all"?fn:void 0,onDropFromOutside:Ae!=="all"?Mt:void 0,dragFromOutsideItem:Ae!=="all"?Bt:void 0,draggableAccessor:b=>Ae!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:Nr,dayPropGetter:aa,components:Zu,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${Ae}-${(ne==null?void 0:ne.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ne&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:Nt?ct(ne).format("MM DD (ddd)"):`${ct(ne).startOf("week").format("MM DD")} - ${ct(ne).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),el[ct(ne).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:el[ct(ne).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[Ae!=="all"&&a.jsxDEV("button",{onClick:()=>Q(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Je(null),ls(null),Q(!1),x("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:_r.length===0?a.jsxDEV("div",{className:"p-4",children:Ae!=="all"&&D?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&B.trim()){const H=ne||new Date,Y={id:"",title:B.trim(),start:H,end:H,project:Ae,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(B.trim()){const b=ne||new Date,H={id:"",title:B.trim(),start:b,end:b,project:Ae,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const b=_r.reduce((Y,W)=>{const ce=ct(W.start).format("YYYY-MM-DD");return Y[ce]||(Y[ce]=[]),Y[ce].push(W),Y},{});return Object.keys(b).sort().map(Y=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!Nt&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:ct(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[Y].map(W=>{const ce=W.assignedTo&&W.assignedTo.includes("HV LAB"),Ne=W.assignedTo&&W.assignedTo.includes("")&&I&&["",""].includes(I),ye=W.assignedTo&&W.assignedTo.includes("")&&I&&["","",""].includes(I),gt=W.assignedTo&&(W.assignedTo.includes((y==null?void 0:y.name)||"")||I&&W.assignedTo.includes(I))||ce||Ne||ye,_n=!W.color&&!gt,Pt=!W.isASVisit&&!W.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const Lt={...W,title:W.originalTitle||W.title};un(Lt)},className:`p-3 cursor-pointer ${gt?"bg-yellow-50":""}`,style:_n?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:gt?"#FEF3C7":W.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:W.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),W.assignedTo&&W.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(Tn=>W.assignedTo.includes(Tn))?"":W.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),W.projectName&&Ae==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:W.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),Pt?a.jsxDEV("button",{onClick:Lt=>{Lt.stopPropagation(),ls(W)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},W.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ae!=="all"&&D&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&B.trim()){const H=ne||new Date,Y={id:"",title:B.trim(),start:H,end:H,project:Ae,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(B.trim()){const b=ne||new Date,H={id:"",title:B.trim(),start:b,end:b,project:Ae,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),Nt&&Ae!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:de.map(b=>a.jsxDEV("button",{onClick:async()=>{const H=ne||new Date;if(Ae!=="all"){const Y={id:"",title:b,start:H,end:H,project:Ae,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),te&&a.jsxDEV(ax,{event:ue,slotInfo:Ie,defaultProjectName:Ae!=="all"?Ae:void 0,onClose:()=>{xe(!1),fe(null),ze(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(ue)if(ue.id.startsWith("as-")){const H=ue.id.replace("as-","");let Y="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?Y=b.assignedTo.join(", "):ue.assignedTo&&Array.isArray(ue.assignedTo)?Y=ue.assignedTo.join(", "):typeof ue.assignedTo=="string"&&(Y=ue.assignedTo),await m(H,{project:b.title||ue.title,assignedTo:Y,scheduledVisitDate:b.start,scheduledVisitTime:b.time||ue.time}),await d(),xe(!1)}else if(ue.id.startsWith("payment-")){const H=ue.id.split("-"),Y=H[1],W=H[2],ce=f.find(Ne=>Ne.id===Y);if(ce){const Ne={...ce.expectedPaymentDates};Ne[W]=b.start,await p(Y,{expectedPaymentDates:Ne})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let H=b.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(H=H.replace(Y,""),ue.mergedEventIds&&ue.mergedEventIds.length>0){console.log(" Updating merged schedules:",ue.mergedEventIds);const W=(ue.originalTitle||ue.title).split(", "),ce=H.split(", ");for(let Ne=0;Ne<ue.mergedEventIds.length;Ne++){const ye=ue.mergedEventIds[Ne],ut=ce[Ne]||W[Ne]||H;await o(ye,{title:ut.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await o(ue.id,{title:H,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const H={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(H)}xe(!1)}catch(H){console.error("Failed to save schedule:",H),oe.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const H=b.split("-"),Y=H[1],W=H[2],ce=f.find(Ne=>Ne.id===Y);if(ce){const Ne={...ce.expectedPaymentDates};delete Ne[W],await p(Y,{expectedPaymentDates:Ne})}}else if(b.startsWith("as-")){const H=b.replace("as-","");await m(H,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const H=Ht.find(Y=>Y.id===b);if(H!=null&&H.mergedEventIds&&H.mergedEventIds.length>0){console.log("Deleting merged schedules:",H.mergedEventIds);for(const Y of H.mergedEventIds)await l(Y)}else await l(b)}xe(!1)}catch(H){console.error("Failed to delete schedule:",H),oe.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),L&&Ce&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:X.x-50,top:X.y-15,backgroundColor:L.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:L.originalTitle||L.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Os&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>ls(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Os.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>ls(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const b=Os.mergedEventIds||[Os.id];await Promise.all(b.map(H=>l(H)))}catch(b){console.error("  :",b),oe.error(" ")}ls(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),N&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{V(!1),k(null),T("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{V(!1),k(null),T("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:b=>T(b.target.value),onKeyDown:b=>b.key==="Enter"&&Re(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Re,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:ge?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):M.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:M.map((b,H)=>a.jsxDEV("div",{draggable:(S==null?void 0:S.id)!==b.id,onDragStart:()=>lt(H),onDragOver:Y=>It(Y,H),onDragEnd:at,onDragLeave:()=>le(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${ht===H?"opacity-50 bg-gray-100":""} ${Ot===H?"border-t-2 border-gray-400":""} ${(S==null?void 0:S.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(S==null?void 0:S.id)===b.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:Ee,onChange:Y=>qe(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&Ye(),Y.key==="Escape"&&(k(null),qe(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:Ye,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),qe("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:H+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(b),qe(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>vt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),M.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},tT=({projectName:n,onClose:e,type:t="cash"})=>{const s=t==="cash",r=s?"":"",i=s?"      .":"      .",[o,l]=E.useState({receiptDate:qt(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const p=Number(f.replace(/,/g,""));return isNaN(p)?"":p.toLocaleString()},d=f=>{if(f===0)return"";const p=["","","",""],y=["","","",""],C=["","","","","","","","","",""];let v="",w=0;for(;f>0;){const R=f%1e4;if(R>0){let I="",F=R,re=0;for(;F>0;){const ee=F%10;ee>0&&(I=C[ee]+y[re]+I),F=Math.floor(F/10),re++}v=I+p[w]+v}f=Math.floor(f/1e4),w++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(wn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const p=f.target.value.replace(/,/g,"");/^\d*$/.test(p)&&l({...o,amount:p})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(my,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:s?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:qt(new Date(o.receiptDate),"yyyy MM dd",{locale:An})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:qt(new Date(o.receiptDate),"yyyy MM dd",{locale:An})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},nT="HVLabImageDB",sT=1,Jr="paymentRecordImages";let pc=null;const cp=()=>new Promise((n,e)=>{if(pc){n(pc);return}const t=indexedDB.open(nT,sT);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{pc=t.result,n(pc)},t.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains(Jr)||r.createObjectStore(Jr,{keyPath:"id"})}}),rT=async()=>{try{const n=await cp();return new Promise((e,t)=>{const i=n.transaction(Jr,"readonly").objectStore(Jr).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(n){console.error("IndexedDB , localStorage :",n);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},iT=async(n,e)=>{try{const t=await cp();return new Promise((s,r)=>{const l=t.transaction(Jr,"readwrite").objectStore(Jr).put({id:n,images:e});l.onsuccess=()=>s(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},oT=async n=>{try{const e=await cp();return new Promise((t,s)=>{const r=e.transaction(Jr,"readwrite"),i=r.objectStore(Jr);i.clear(),Object.entries(n).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),s(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},aT=async()=>{try{const n=localStorage.getItem("paymentRecordImages");if(n){const e=JSON.parse(n);Object.keys(e).length>0&&(await oT(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(n){console.error(" :",n)}},hc=n=>{if(!n)return 0;try{const t=new Date(n).getTime();return isNaN(t)?0:t}catch{return 0}},iy=(n,e,t)=>{if(!n)return null;try{const s=new Date(n);return isNaN(s.getTime())?null:qt(s,e,t)}catch{return null}},lT=()=>{const{payments:n,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:s,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=Xr(),{user:l}=si(),u=Ou(),[m,d]=E.useState(""),[f,p]=E.useState(null),[y,C]=E.useState(null),[v,w]=E.useState(!1),[R,I]=E.useState(!1),[F,re]=E.useState(!1),[ee,M]=E.useState(!1),[A,N]=E.useState(""),[V,j]=E.useState("form"),[T,S]=E.useState(!1),[k,Ee]=E.useState(!1),qe=E.useRef(null),[ge,Ue]=E.useState("pending"),[ht,Kt]=E.useState("all"),[Ot,le]=E.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[$e,de]=E.useState(!1),[Re,Ye]=E.useState(null),[vt,lt]=E.useState(!1),[It,at]=E.useState(""),[ft,bn]=E.useState(!1),K=E.useRef(!1),Le=E.useRef(!1),He=E.useRef(null),[Se,Xe]=E.useState([]),[St,Gt]=E.useState([]),[dt,P]=E.useState(null),[q,te]=E.useState([]),[xe,ue]=E.useState([]),[fe,Ie]=E.useState(!1),[ze,tt]=E.useState({}),[Ae,On]=E.useState(!1),Ht=()=>{const D=localStorage.getItem("lastSelectedProject"),Q=u.filter(B=>B.status!=="completed");return D&&Q.some(B=>B.name===D)?D:Q.length>0?Q[0].name:""},[ne,Je]=E.useState({project:"",date:qt(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});E.useEffect(()=>{(async()=>{try{const Q=await ur.getAllContractors();Xe(Q.map(B=>({id:B._id||B.id,rank:B.rank,companyName:B.companyName,name:B.name,process:B.process,contact:B.contact,accountNumber:B.accountNumber,bankName:B.bankName,notes:B.notes,createdAt:new Date(B.createdAt),updatedAt:new Date(B.updatedAt)})))}catch(Q){console.error("Failed to load contractors:",Q)}})()},[]),E.useEffect(()=>{Kt("all"),t().catch(Q=>{console.error("Failed to load projects:",Q)}),e().catch(Q=>{console.error("Failed to load payments:",Q)});const D=()=>{S(window.innerWidth<1024)};if(D(),window.addEventListener("resize",D),u.length>0&&!ne.project&&!Le.current){const Q=Ht();Q&&(Je(B=>({...B,project:Q})),localStorage.setItem("lastSelectedProject",Q))}return()=>window.removeEventListener("resize",D)},[]),E.useEffect(()=>{const D=setInterval(()=>{if(He.current){console.log("[ ]     - ");return}console.log("[ ]    ..."),e().catch(B=>{console.error("[ ] :",B)})},3e4),Q=()=>{if(document.visibilityState==="visible"){if(He.current){console.log("[ ]     - ");return}console.log("[ ]   -    ..."),e().catch(B=>{console.error("[ ] :",B)})}};return document.addEventListener("visibilitychange",Q),()=>{clearInterval(D),document.removeEventListener("visibilitychange",Q)}},[e]),E.useEffect(()=>{let D=Lr.getSocket(),Q=0,B=null;const x=U=>{if(console.log(" [ ]    :",U),He.current&&String(U.paymentId)===He.current){console.log(" [ ]    -  ");return}console.log(" [ ] loadPaymentsFromAPI  (  )"),e().catch(X=>{console.error("[ ]  :",X)})},L=()=>(D=Lr.getSocket(),D?(console.log(" [Payments] Socket  , payment:refresh  "),D.on("payment:refresh",x),B&&(clearInterval(B),B=null),!0):!1);return L()||(console.log(" [Payments] Socket  ..."),B=setInterval(()=>{Q++,(L()||Q>=10)&&(B&&(clearInterval(B),B=null),Q>=10&&!Lr.getSocket()&&console.warn(" [Payments] Socket   -   "))},500)),()=>{B&&clearInterval(B);const U=Lr.getSocket();U&&U.off("payment:refresh",x)}},[e]),E.useEffect(()=>{(async()=>{var x,L,U,X;if(K.current)return;const Q=new URLSearchParams(window.location.search),B=Q.get("complete")||Q.get("c");if(B){if(!l){console.log("[ ]   -  ");return}K.current=!0,console.log("[ ]  :",B),window.history.replaceState({},"","/payments"),Le.current=!0,j("list"),Ue("completed"),Kt("all"),Je(G=>({...G,project:""})),o(String(B),{status:"completed",completionDate:new Date}),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(B),{status:"completed"}),await e();const G=Lr.getSocket();G&&G.emit("payment:refresh",{paymentId:B,status:"completed",updatedAt:new Date().toISOString()})}catch(G){console.error("[ ]  :",G),o(String(B),{status:"pending",completionDate:void 0}),Ue("pending");let Z="  ";((x=G.response)==null?void 0:x.status)===401?Z=" .  ":((L=G.response)==null?void 0:L.status)===404?Z="     (ID: "+B+")":(X=(U=G.response)==null?void 0:U.data)!=null&&X.error?Z=G.response.data.error:G.message&&(Z+=": "+G.message),oe.error(Z)}}})()},[e,i,o,l]),E.useEffect(()=>{if(ne.process){const D=new Set(n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).map(L=>L.bankInfo.accountHolder.trim().toLowerCase())),Q=(L,U)=>{const X=L.toLowerCase(),G=U.toLowerCase();if(X.includes(G)||G.includes(X))return!0;const Z=X.split("/").map(Ce=>Ce.trim()),ie=G.replace(/$/,"").trim();for(const Ce of Z)if(Ce===ie||ie.includes(Ce)||Ce.includes(ie))return!0;return!1},x=Se.filter(L=>{if(!Q(ne.process,L.process))return!1;const X=L.accountNumber&&L.accountNumber.trim()!=="",G=L.name.trim().toLowerCase(),Z=D.has(G);return X||Z}).sort((L,U)=>{const X=L.accountNumber&&L.accountNumber.trim()!=="",G=U.accountNumber&&U.accountNumber.trim()!=="";return X&&!G?-1:!X&&G?1:0});Gt(x)}else Gt([])},[ne.process,Se,n]),E.useEffect(()=>{if(ne.process){const D=(x,L)=>{if(!L)return!1;const U=x.toLowerCase(),X=L.toLowerCase();if(U.includes(X)||X.includes(U))return!0;const G=U.split("/").map(ie=>ie.trim()),Z=X.replace(/$/,"").trim();for(const ie of G)if(ie===Z||Z.includes(ie)||ie.includes(Z))return!0;return!1},Q=n.filter(x=>{var L,U,X;return x.status==="completed"&&x.process&&D(ne.process,x.process)&&((L=x.bankInfo)==null?void 0:L.accountHolder)&&((U=x.bankInfo)==null?void 0:U.bankName)&&((X=x.bankInfo)==null?void 0:X.accountNumber)}),B=new Map;Q.forEach(x=>{const L=`${x.bankInfo.accountHolder}_${x.bankInfo.bankName}_${x.bankInfo.accountNumber}`;B.has(L)||B.set(L,{accountHolder:x.bankInfo.accountHolder,bankName:x.bankInfo.bankName,accountNumber:x.bankInfo.accountNumber,itemName:x.itemName||"",amount:x.amount||0})}),te(Array.from(B.values()))}else te([])},[ne.process,n]),E.useEffect(()=>{var Q;const D=((Q=ne.accountHolder)==null?void 0:Q.trim())||"";if(D.length>=1&&fe){const B=[],x=new Set;Se.filter(L=>L.accountNumber&&L.accountNumber.trim()!=="").forEach(L=>{const U=L.name.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),B.push({name:U,bankName:L.bankName||"",accountNumber:L.accountNumber||"",source:"contractor"}))}),n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).forEach(L=>{const U=L.bankInfo.accountHolder.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),B.push({name:U,bankName:L.bankInfo.bankName||"",accountNumber:L.bankInfo.accountNumber||"",source:"payment"}))}),ue(B)}else ue([])},[ne.accountHolder,fe,Se,n]);const O=D=>{const Q=D.split(`
`).map(G=>G.trim()).filter(G=>G),B={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},x=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],L=G=>{const Z=["","","","","","","",""];for(const ie of Z)if(G.endsWith(ie)&&G.length>ie.length+1)return G.slice(0,-ie.length);return G},U=G=>{if(!G||G.length<2||G.length>5||!/^[-]{2,5}$/.test(G)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G))return!1;if(G.length>=2){const Ce=G.charAt(0),Ze=G.substring(0,2);if(["","","","","","",""].includes(Ze)||x.includes(Ce))return!0}return G.length>=2&&G.length<=4},X=Q.some(G=>G.includes(" ")||G.includes(""));if(Q.forEach((G,Z)=>{if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(B.itemName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(B.bankInfo.accountHolder=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(B.bankInfo.bankName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(B.bankInfo.accountNumber=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*([\d,]+)?/);ie&&(B.amounts.total=parseInt(ie[1].replace(/,/g,"")))}}),!X){let G=-1;if(Q.forEach(Z=>{const ie=Z.match(/\[([^\]]+)\]/);ie&&!B.itemName&&(B.itemName=ie[1].trim())}),Q.forEach((Z,ie)=>{if(Z.includes("")||Z.includes(" ")||Z.includes("()")){B.includeVat=!0;const Ke=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/),Ve=Z.match(/(\d+)\s*\s*?/),et=Z.match(/([\d,]+)\s*/);if(Ke){const nt=parseInt(Ke[1])*1e4+parseInt(Ke[2])*1e3;B.amounts.total=nt}else if(Ve){const nt=parseInt(Ve[1])*1e4;B.amounts.total=nt}else if(et){const nt=parseInt(et[1].replace(/,/g,""));nt>=1e3&&(B.amounts.total=nt)}return}const Ze=Z.match(/=\s*([\d,]+)\s*?/);let Fe=null;if(Ze){const Ke=parseInt(Ze[1].replace(/,/g,""));Ke>=1e3&&(B.amounts.total=Ke)}else{const Ke=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(Ke){const Ve=parseInt(Ke[1])*1e4,et=parseInt(Ke[2])*1e3,nt=Ve+et;Z.includes("")||Z.includes("")?B.amounts.material=nt:Z.includes("")||Z.includes("")?B.amounts.labor=nt:B.amounts.total||(B.amounts.total=nt),Z=Z.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Fe=Ke}else if(Fe=Z.match(/(\d+)\s*\s*?/),Fe){const Ve=parseInt(Fe[1])*1e4;Z.includes("")||Z.includes("")?B.amounts.material=Ve:Z.includes("")||Z.includes("")?B.amounts.labor=Ve:B.amounts.total||(B.amounts.total=Ve),Z=Z.replace(/(\d+)\s*\s*?/g,"")}}Z.includes("/")&&Z.split("/").forEach(Ve=>{const et=Ve.trim();et.startsWith("[")||et.endsWith("]")||(/^[\d\-]+$/.test(et)&&et.replace(/\-/g,"").length>=10?B.bankInfo.accountNumber||(B.bankInfo.accountNumber=et):U(et)&&!B.bankInfo.accountHolder&&(B.bankInfo.accountHolder=et))});const pe=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let We="",fn=-1;for(const Ke of pe){const Ve=Z.match(Ke);if(Ve&&!B.bankInfo.accountNumber){We=Ve[0],fn=Ve.index||-1,B.bankInfo.accountNumber=Ve[0].trim().replace(/\s+/g,"-");const nt=Z.substring(fn+We.length).trim().split(/\s+/);for(const st of nt){if(st.startsWith("[")||st.endsWith("]"))continue;const Oe=L(st);if(U(Oe)){B.bankInfo.accountHolder=Oe;break}}if(!B.bankInfo.accountHolder&&ie>0){const Oe=Q[ie-1].split(/\s+/);for(const rt of Oe){if(rt.startsWith("[")||rt.endsWith("]"))continue;const Tt=L(rt);if(U(Tt)){B.bankInfo.accountHolder=Tt;break}}}if(!B.bankInfo.accountHolder&&ie+1<Q.length){const st=Q[ie+1],Oe=st.split(/\s+/);for(const rt of Oe){if(rt.startsWith("[")||rt.endsWith("]"))continue;const Tt=L(rt);if(U(Tt)){B.bankInfo.accountHolder=Tt;break}}if(!B.bankInfo.accountHolder){const rt=st.match(/^([-]{2,6})/);if(rt){const Tt=L(rt[1].trim());U(Tt)&&(B.bankInfo.accountHolder=Tt)}}}break}}const Qt=Z.match(/[\d,]+/g);if(Qt){const Ke=We?We.split(/[\s\-]+/).filter(Ve=>Ve):[];Qt.forEach(Ve=>{const et=parseInt(Ve.replace(/,/g,"")),nt=Ve.replace(/,/g,""),st=Ke.some(Oe=>Oe===nt);!B.bankInfo.accountNumber&&nt.length>=10&&nt.length<=20?(B.bankInfo.accountNumber=nt,We=nt):et>=1e3&&!Fe&&!st&&(Z.includes("")||Z.includes("")?B.amounts.material=et:Z.includes("")||Z.includes("")?B.amounts.labor=et:B.amounts.total||(B.amounts.total=et))})}const Mt={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},Bt=Object.keys(Mt).sort((Ke,Ve)=>Ve.length-Ke.length);for(const Ke of Bt)if(Z.includes(Ke)){const Ve=Mt[Ke];B.bankInfo.bankName=Ve,G=ie;const et=new RegExp(`${Ke}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),nt=Z.match(et);if(nt){const st=L(nt[1]);st&&!/^\d+$/.test(st)&&st!==""&&(B.bankInfo.accountHolder=st)}break}if(!B.bankInfo.bankName){const Ke=Z.match(/([-]+)(|)/);Ke&&(B.bankInfo.bankName=Ke[0])}const qn=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const Ke of qn){const Ve=Z.match(Ke);if(Ve&&!B.bankInfo.accountHolder){B.bankInfo.accountHolder=Ve[0].trim();break}}const Qn=Z.match(/\(([-]{2,5})\)/);if(Qn&&!B.bankInfo.accountHolder){const Ke=Qn[1];U(Ke)&&!["","",""].includes(Ke)&&(B.bankInfo.accountHolder=Ke)}if(!B.bankInfo.accountHolder){const Ke=/[-]{2,6}/g,Ve=Z.match(Ke);if(Ve){const et=Z.match(/\d{10,}/)||Z.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),nt=Z.match(/||||/);Ve.forEach(st=>{const Oe=L(st),rt=D.split(`
`)[ie];if(rt&&rt.includes(`[${st}]`)||!U(Oe)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Oe))return;const un=Z.indexOf(st);if(un>0){const nn=Z[un-1];if(/[-]/.test(nn))return}if(un+st.length<Z.length){const nn=Z[un+st.length];if(/[-]/.test(nn))return}if(!(Qn&&Oe===Qn[1])){if((et||nt)&&!B.bankInfo.accountHolder)B.bankInfo.accountHolder=Oe;else if(!B.bankInfo.accountHolder){const nn=/||||/,Vs=/\d{6,}/;(ie>0&&(Vs.test(Q[ie-1])||nn.test(Q[ie-1]))||ie<Q.length-1&&(Vs.test(Q[ie+1])||nn.test(Q[ie+1]))||nn.test(Z))&&(B.bankInfo.accountHolder=Oe)}}})}}const Yt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[Ke,Ve]of Object.entries(Yt))if(Z.includes(Ke)){B.vendor=Ve;break}if(ie===0&&!B.itemName){const Ke=Z.replace(/[\[\]{}()<>]/g,"").trim();Ke&&!Ke.includes(" ")&&(U(Ke)||(B.itemName=Ke.substring(0,50)))}}),G>=0&&G+1<Q.length){const Z=Q[G+1],ie=Z.trim();if(/^[-]{2,5}$/.test(ie)&&U(ie))B.bankInfo.accountHolder=ie;else{const Ce=Z.split(/\s+/);for(const Ze of Ce){const Fe=L(Ze);if(U(Fe)){B.bankInfo.accountHolder=Fe;break}}}}}if(B.itemName&&B.itemName.includes("")&&(B.vendor=""),B.itemName){const G=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Z=B.itemName.toLowerCase(),ie=G.some(pe=>Z===pe.toLowerCase()||Z.startsWith(pe.toLowerCase()+" ")||Z.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Ce=/^[\d\-\s]/.test(B.itemName),Ze=/^\d{2,}[\s\-]?\d+/.test(B.itemName.replace(/[-]/g,"").trim()),Fe=B.bankInfo.accountHolder&&(B.itemName===B.bankInfo.accountHolder||B.itemName.includes(B.bankInfo.accountHolder));(ie||Ce||Ze||Fe)&&(B.itemName=void 0)}return B},ve=async()=>{var D,Q,B,x,L,U,X,G,Z,ie,Ce;try{const Ze=ne.quickText;if(!Ze.trim())return;let Fe=n;n.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(Ve=>setTimeout(Ve,100)),Fe=Xr.getState().payments,console.log("payments  :",Fe.length,""));const pe=O(Ze);console.log("  :",pe);const We={project:ne.project,date:ne.date,quickText:ne.quickText,quickImages:ne.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};P(null),I(!1),re(!1);let fn=0;pe.amounts.material&&(fn+=pe.amounts.material),pe.amounts.labor&&(fn+=pe.amounts.labor),pe.amounts.total&&!pe.amounts.material&&!pe.amounts.labor&&(fn=pe.amounts.total),fn>0&&(We.amount=fn),pe.bankInfo.bankName&&(We.bankName=pe.bankInfo.bankName),pe.bankInfo.accountHolder&&(We.accountHolder=pe.bankInfo.accountHolder),pe.bankInfo.accountNumber&&(We.accountNumber=pe.bankInfo.accountNumber);const Qt=Ve=>Ve?Ve.replace(/[^0-9]/g,""):"",Mt=(Ve,et)=>{if(!Ve||!et)return!1;const nt=Qt(Ve),st=Qt(et);if(!nt||!st)return!1;const Oe=6;return nt.length<Oe||st.length<Oe?nt===st:st.includes(nt)||nt.includes(st)},Bt=Qt(pe.bankInfo.accountNumber||""),qn=pe.bankInfo.accountHolder||"";let Qn=!1;console.log("===    ==="),console.log(" :",pe.bankInfo.accountNumber),console.log(" :",Bt),console.log(" :",qn),console.log(" :",Se.length),console.log("  :",Fe.filter(Ve=>Ve.status==="completed").length);let Yt=Se.find(Ve=>{const et=Qt(Ve.accountNumber||"");return et&&et===Bt});if(!Yt&&Bt&&(Yt=Se.find(Ve=>{const et=Qt(Ve.accountNumber||"");return Mt(Bt,et)})),Yt&&(Qn=!0),!Yt&&qn&&(Yt=Se.find(Ve=>Ve.name===qn),Yt)){console.log("  :",Yt.name);const Ve=((D=Yt.accountNumber)==null?void 0:D.replace(/[-\s]/g,""))||"";Bt&&!Mt(Bt,Ve)?(console.log("    ( ) -  "),Qn=!1):Qn=!0}if(Yt&&(Yt.name&&(We.accountHolder=Yt.name,console.log("  :",Yt.name)),Yt.bankName?We.bankName=Yt.bankName:pe.bankInfo.bankName&&(We.bankName=pe.bankInfo.bankName),Qn&&(We.accountNumber=Yt.accountNumber||pe.bankInfo.accountNumber),P(Yt.id||Yt._id||null),Yt.process&&(We.process=Yt.process)),!Yt){let Ve=!1;console.log("===     ==="),console.log("  payments :",Fe.length,""),console.log(" :",Bt),console.log(" :",qn);const et=Fe.filter(rt=>rt.status==="completed");console.log(" :",et.length);const nt=[...new Set(et.map(rt=>{var Tt;return(Tt=rt.bankInfo)==null?void 0:Tt.accountHolder}).filter(Boolean))];console.log("   ( 20):",nt.slice(0,20)),console.log("  ():",Bt);const st=et.filter(rt=>{var Tt;return(Tt=rt.bankInfo)==null?void 0:Tt.accountNumber}).map(rt=>{var Tt,un,nn;return{holder:(Tt=rt.bankInfo)==null?void 0:Tt.accountHolder,account:(un=rt.bankInfo)==null?void 0:un.accountNumber,clean:Qt(((nn=rt.bankInfo)==null?void 0:nn.accountNumber)||"")}}).filter(rt=>rt.clean.includes(Bt.substring(0,6))||Bt.includes(rt.clean.substring(0,6)));console.log("  :",st);let Oe=Fe.find(rt=>{var nn;const Tt=Qt(((nn=rt.bankInfo)==null?void 0:nn.accountNumber)||"");return Tt&&Tt===Bt&&rt.status==="completed"});if(Oe&&console.log("   :",(Q=Oe.bankInfo)==null?void 0:Q.accountHolder,Oe.process),!Oe&&Bt&&(Oe=Fe.find(rt=>{var un;const Tt=Qt(((un=rt.bankInfo)==null?void 0:un.accountNumber)||"");return Mt(Bt,Tt)&&rt.status==="completed"}),Oe&&console.log("   :",(B=Oe.bankInfo)==null?void 0:B.accountHolder,Oe.process)),Oe&&(Ve=!0),!Oe&&qn&&(Oe=Fe.find(rt=>{var Tt;return((Tt=rt.bankInfo)==null?void 0:Tt.accountHolder)===qn&&rt.status==="completed"}),Oe)){console.log("    :",(x=Oe.bankInfo)==null?void 0:x.accountHolder,":",Oe.process);const rt=Qt(((L=Oe.bankInfo)==null?void 0:L.accountNumber)||"");Bt&&!Mt(Bt,rt)?(console.log("    ( ) -  "),Ve=!1):Ve=!0}Oe?(console.log(" :",{accountHolder:(U=Oe.bankInfo)==null?void 0:U.accountHolder,accountNumber:(X=Oe.bankInfo)==null?void 0:X.accountNumber,bankName:(G=Oe.bankInfo)==null?void 0:G.bankName,process:Oe.process,status:Oe.status,paymentMatchedByAccountNumber:Ve}),(Z=Oe.bankInfo)!=null&&Z.accountHolder&&(We.accountHolder=Oe.bankInfo.accountHolder,console.log("  :",Oe.bankInfo.accountHolder)),(ie=Oe.bankInfo)!=null&&ie.bankName?We.bankName=Oe.bankInfo.bankName:pe.bankInfo.bankName&&(We.bankName=pe.bankInfo.bankName),Ve&&(We.accountNumber=((Ce=Oe.bankInfo)==null?void 0:Ce.accountNumber)||pe.bankInfo.accountNumber),Oe.process&&!We.process?(We.process=Oe.process,console.log("    :",Oe.process)):console.log("   - process:",Oe.process,"updatedFormData.process:",We.process)):console.log("  ")}if(pe.vendor&&(We.process=pe.vendor),!We.process){const Ve=Ze.toLowerCase();for(const et of Cm)if(Ve.includes(et.toLowerCase())){We.process=et;break}}pe.itemName&&(We.itemName=pe.itemName),Je(We),pe.includeVat&&(I(!0),re(!1));const Ke=[];if(pe.amounts.material||pe.amounts.labor||pe.amounts.total){const Ve=[];pe.amounts.material&&Ve.push(`: ${pe.amounts.material.toLocaleString()}`),pe.amounts.labor&&Ve.push(`: ${pe.amounts.labor.toLocaleString()}`),pe.amounts.total&&!pe.amounts.material&&!pe.amounts.labor&&Ve.push(`: ${pe.amounts.total.toLocaleString()}`),Ke.push(Ve.join(", "))}if(pe.bankInfo.bankName||pe.bankInfo.accountHolder){const Ve=[];pe.bankInfo.bankName&&Ve.push(pe.bankInfo.bankName),pe.bankInfo.accountHolder&&Ve.push(pe.bankInfo.accountHolder),pe.bankInfo.accountNumber&&Ve.push(pe.bankInfo.accountNumber),Ve.length>0&&Ke.push(`: ${Ve.join(" ")}`)}pe.vendor&&Ke.push(`: ${pe.vendor}`),pe.includeVat&&Ke.push("  "),Ke.length>0?oe.success(`  !
${Ke.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):oe.info("  ...    .")}catch(Ze){console.error(" :",Ze),oe.error("   .")}};E.useEffect(()=>{(async()=>{try{await aT();const Q=await rT();tt(Q),On(!0)}catch(Q){console.error("  :",Q),On(!0)}})()},[]);const ke=E.useRef({});E.useEffect(()=>{Ae&&(Object.entries(ze).forEach(([D,Q])=>{JSON.stringify(ke.current[D])!==JSON.stringify(Q)&&iT(D,Q).catch(B=>{console.error("  :",B),oe.error("  ")})}),ke.current={...ze})},[ze,Ae]);const je=E.useCallback(async D=>{var x;const Q=(x=D.clipboardData)==null?void 0:x.items;if(!Q)return;let B=!1;for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){B=!0;break}if(B){if(!f){const L=document.activeElement;(L==null?void 0:L.tagName)==="INPUT"||(L==null?void 0:L.tagName)==="TEXTAREA"||(L==null?void 0:L.classList.contains("form-input"))||oe.error("  ");return}for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){D.preventDefault();const U=Q[L].getAsFile();if(U){const X=new FileReader;X.onload=async G=>{var ie;const Z=(ie=G.target)==null?void 0:ie.result;if(Z)try{const Ce=n.find(pe=>pe.id===f),Fe=[...(Ce==null?void 0:Ce.images)||ze[f]||[],Z];await Es.updatePaymentImages(f,Fe),tt(pe=>({...pe,[f]:Fe})),await e(),oe.success(" ")}catch(Ce){console.error("  :",Ce),oe.error("  ")}},X.readAsDataURL(U)}}}},[f,n,ze,e]);E.useEffect(()=>(document.addEventListener("paste",je),()=>document.removeEventListener("paste",je)),[je]);const kt=[...(l==null?void 0:l.name)===""?n.filter(D=>u.some(Q=>Q.name===D.project)):n].sort((D,Q)=>new Date(Q.requestDate).getTime()-new Date(D.requestDate).getTime()),xt=kt.filter(D=>{var U,X,G;if(!D||!D.id)return!1;const Q=m===""||((U=D.purpose)==null?void 0:U.toLowerCase().includes(m.toLowerCase()))||((X=D.itemName)==null?void 0:X.toLowerCase().includes(m.toLowerCase()))||((G=D.process)==null?void 0:G.toLowerCase().includes(m.toLowerCase())),B=ge==="pending"?D.status!=="completed":D.status==="completed",x=ht==="all"||!ht||D.project===ht,L=!Ot||ge!=="completed"||D.requestedBy===(l==null?void 0:l.name);return Q&&B&&x&&L}).sort((D,Q)=>!D&&!Q?0:D?Q?ge==="completed"?hc(Q.completionDate)-hc(D.completionDate):hc(Q.requestDate)-hc(D.requestDate):-1:1),tn=D=>{const Q=D.id||D._id||null;if(dt===Q){P(null);const U=document.querySelector('input[placeholder=" "]');U&&setTimeout(()=>{U.focus()},100);return}P(Q);const B=Za(D.name);let x=D.bankName||"",L=D.accountNumber||"";if(L&&!x){const U=L.trim().split(/\s+/);if(U.length>=2){const X=U[0];(X.includes("")||X.includes("")||X.includes("")||X.includes("")||X.includes(""))&&(x=X,L=U.slice(1).join(""))}}Je(U=>({...U,accountHolder:B,bankName:x,accountNumber:L}))};xt.reduce((D,Q)=>{const B=Q.materialAmount||0,x=Q.laborAmount||0,L=Q.amount||0;let U=B,X=x,G=0;return B===0&&x===0&&L>0?Q.includesVAT?(U=Math.round(L/1.1),G=L-U):(U=L,G=0):Q.includesVAT?(B>0&&(U=Math.round(B/1.1)),x>0&&(X=Math.round(x/1.1)),G=L-(U+X)):G=0,D.material+=U,D.labor+=X,D.vat+=G,D.total+=L,D},{material:0,labor:0,vat:0,total:0});const At=async()=>{var Q;if(ft){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ne),!ne.project){oe.error(" ");return}if(!ne.itemName){oe.error(" ");return}const D=Number(ne.amount)||0;if(D===0){oe.error(" ");return}bn(!0);try{const B=F?Math.round(D*.967):D,x=new Date;if(y){const L={project:ne.project,requestDate:new Date(ne.date),purpose:ne.itemName,amount:B,category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:R,applyTaxDeduction:F,materialAmount:B,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,updatedAt:x};console.log(" Updating payment:",L),await i(y,L),oe.success(" "),C(null)}else{const L=ne.project||"",U={id:`payment_${Date.now()}`,project:L,requestDate:new Date(ne.date),requestedBy:(l==null?void 0:l.name)||"  ",purpose:ne.itemName,amount:B,status:"pending",category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:R,applyTaxDeduction:F,materialAmount:B,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,quickText:ne.quickText||"",images:ne.quickImages,attachments:[],createdAt:x,updatedAt:x};console.log(" Creating payment:",U),console.log(" Images in payment:",((Q=ne.quickImages)==null?void 0:Q.length)||0,"");const X=await s(U);if(He.current=X,setTimeout(()=>{He.current=null},1e4),oe.success(" "),ne.accountHolder&&ne.bankName&&ne.accountNumber){const G=R||F?"01074088864":"01089423283";try{await Es.sendTossPaymentSms({recipientPhone:G,accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber,amount:B,projectName:L,itemName:ne.itemName,process:ne.process,paymentId:X}),oe.success("   ")}catch(Z){console.error("SMS  :",Z)}}}Je(L=>({project:L.project,date:qt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),I(!1),re(!1),P(null),window.innerWidth<768&&j("list")}catch(B){console.error(" Payment save error:",B),oe.error("  : "+B.message)}finally{bn(!1)}},Nn=D=>{var Q,B,x,L;try{console.log("[handleEdit] Starting edit for payment:",D.id);const U=D.originalMaterialAmount!==void 0?D.originalMaterialAmount:D.materialAmount||0,X=D.originalLaborAmount!==void 0?D.originalLaborAmount:D.laborAmount||0,G={project:D.project||"",date:D.requestDate?qt(new Date(D.requestDate),"yyyy-MM-dd"):qt(new Date,"yyyy-MM-dd"),process:D.process||"",itemName:D.itemName||D.purpose||"",materialCost:U>0?U.toString():"",laborCost:X>0?X.toString():"",amount:((Q=D.amount)==null?void 0:Q.toString())||"",accountHolder:((B=D.bankInfo)==null?void 0:B.accountHolder)||"",bankName:((x=D.bankInfo)==null?void 0:x.bankName)||"",accountNumber:((L=D.bankInfo)==null?void 0:L.accountNumber)||"",images:D.attachments||[],quickText:D.quickText||"",quickImages:D.images||[]};console.log("[handleEdit] Setting form data:",G),Je(G),I(D.includesVAT||!1),re(D.applyTaxDeduction||!1),p(D.id),C(D.id),T&&j("form"),console.log("[handleEdit] Edit setup complete"),oe.success("  ")}catch(U){console.error("[handleEdit] Error:",U),oe.error("     ")}},cn=async D=>{var Q,B,x;try{const L=((Q=D.bankInfo)==null?void 0:Q.accountHolder)||D.accountHolder,U=((B=D.bankInfo)==null?void 0:B.bankName)||D.bank,X=((x=D.bankInfo)==null?void 0:x.accountNumber)||D.accountNumber;if(!L||!U||!X){oe.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}`))return;const Z=X.replace(/[-\s]/g,""),ie=I2[U]||U,Ce=C2[U]||"004",Ze="",Fe=`supertoss://send?amount=${D.amount}&bankCode=${Ce}&bank=${encodeURIComponent(ie)}&accountNo=${Z}&receiverName=${encodeURIComponent(Ze)}&toName=${encodeURIComponent(Ze)}`;let pe=!1;try{window.location.href=Fe,pe=!0,oe.success("  ...",{duration:3e3}),setTimeout(()=>{const We=/iPhone|iPad|iPod/i.test(navigator.userAgent),fn=/Android/i.test(navigator.userAgent);(We||fn)&&oe(`      .

: 
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(We){console.error("   :",We),oe(`   .

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(L){console.error(" :",L),oe.error(`   : ${L.message}`)}},Un=async D=>{const Q=n.find(B=>B.id===D);if(Q&&Q.quickText){const B=localStorage.getItem("executionMemos"),x=B?JSON.parse(B):{};x[D]=Q.quickText,localStorage.setItem("executionMemos",JSON.stringify(x))}o(D,{status:"completed",completionDate:new Date}),de(!1),Ue("completed"),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(D,{status:"completed"});const B=Lr.getSocket();B&&B.emit("payment:refresh",{paymentId:D,status:"completed"})}catch(B){console.error(" API :",B),o(D,{status:"pending",completionDate:void 0}),Ue("pending"),oe.error("   -  ")}},xs=async D=>{var x;if(!f){oe.error("  ");return}const B=Array.from(((x=D.target)==null?void 0:x.files)||[]).filter(L=>L.type.startsWith("image/"));if(B.length!==0){try{const L=await Promise.all(B.map(Z=>new Promise((ie,Ce)=>{const Ze=new FileReader;Ze.onload=Fe=>{var We;const pe=(We=Fe.target)==null?void 0:We.result;pe?ie(pe):Ce(new Error("  "))},Ze.onerror=()=>Ce(new Error("FileReader ")),Ze.readAsDataURL(Z)}))),U=n.find(Z=>Z.id===f),G=[...(U==null?void 0:U.images)||ze[f]||[],...L];await Es.updatePaymentImages(f,G),tt(Z=>({...Z,[f]:G})),await e(),oe.success(`${L.length}  `)}catch(L){console.error("  :",L),oe.error("  ")}D.target.value=""}},ss=async D=>{if(f)try{const Q=n.find(L=>L.id===f),x=((Q==null?void 0:Q.images)||ze[f]||[]).filter((L,U)=>U!==D);await Es.updatePaymentImages(f,x),tt(L=>({...L,[f]:x})),await e()}catch(Q){console.error("  :",Q),oe.error("  ")}},vs=D=>{N(D),M(!0)},ui=D=>{D.preventDefault(),w(!0)},Os=D=>{D.preventDefault(),w(!1)},ls=async D=>{if(D.preventDefault(),w(!1),!f){oe.error("  ");return}const B=Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/"));if(B.length!==0)try{const x=await Promise.all(B.map(G=>new Promise((Z,ie)=>{const Ce=new FileReader;Ce.onload=Ze=>{var pe;const Fe=(pe=Ze.target)==null?void 0:pe.result;Fe?Z(Fe):ie(new Error("  "))},Ce.onerror=()=>ie(new Error("FileReader ")),Ce.readAsDataURL(G)}))),L=n.find(G=>G.id===f),X=[...(L==null?void 0:L.images)||ze[f]||[],...x];await Es.updatePaymentImages(f,X),tt(G=>({...G,[f]:X})),await e(),oe.success(`${x.length}  `)}catch(x){console.error("  :",x),oe.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ne.project,onChange:D=>{Je({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2462,columnNumber:35},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2464,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2452,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2451,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2473,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2483,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2493,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2472,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2471,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2470,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${V!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ne.project,onChange:D=>{Je({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2528,columnNumber:43},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2530,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2518,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>Je({...ne,bankName:D.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2538,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2539,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2540,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2541,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2542,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2543,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2544,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2545,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2546,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2549,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2550,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2533,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2517,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2516,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ne.quickText,onChange:D=>Je({...ne,quickText:D.target.value}),onPaste:D=>{var B;const Q=(B=D.clipboardData)==null?void 0:B.items;if(Q){for(let x=0;x<Q.length;x++)if(Q[x].type.indexOf("image")!==-1){D.preventDefault();const L=Q[x].getAsFile();if(L){const U=new FileReader;U.onload=X=>{var Z;const G=(Z=X.target)==null?void 0:Z.result;Je(ie=>({...ie,quickImages:[...ie.quickImages,G]}))},U.readAsDataURL(L)}break}}},onDragOver:D=>{D.preventDefault(),D.stopPropagation()},onDrop:D=>{D.preventDefault(),D.stopPropagation(),Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/")).forEach(x=>{const L=new FileReader;L.onload=U=>{var G;const X=(G=U.target)==null?void 0:G.result;Je(Z=>({...Z,quickImages:[...Z.quickImages,X]}))},L.readAsDataURL(x)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:T?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:15},void 0),ne.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ne.quickImages.map((D,Q)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:D,alt:` ${Q+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2612,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Je(B=>({...B,quickImages:B.quickImages.filter((x,L)=>L!==Q)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2617,columnNumber:23},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2611,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2609,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:D=>{Array.from(D.target.files||[]).forEach(B=>{const x=new FileReader;x.onload=L=>{var X;const U=(X=L.target)==null?void 0:X.result;Je(G=>({...G,quickImages:[...G.quickImages,U]}))},x.readAsDataURL(B)}),D.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2636,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2657,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2635,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:ve,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2634,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2556,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ne.date&&`(${qt(new Date(ne.date),"E",{locale:An})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2674,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ne.date,onChange:D=>Je({...ne,date:D.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2677,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2693,columnNumber:17},void 0),a.jsxDEV("button",{ref:qe,type:"button",onClick:()=>Ee(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ne.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2700,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2694,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2692,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2672,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2707,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ne.itemName,onChange:D=>Je({...ne,itemName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2708,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2706,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2719,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ne.amount?Number(ne.amount).toLocaleString():"",onChange:D=>{const Q=D.target.value.replace(/[^0-9]/g,"");Je({...ne,amount:Q})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2721,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2732,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2720,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2718,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{R||re(!1),I(!R)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${R?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:R&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2750,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2749,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2752,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{F||I(!1),re(!F)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${F?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:F&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2767,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2770,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2756,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2717,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(St.length>0||q.length>0&&!dt)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${St.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2786,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:St.map(D=>{const Q=D.id||D._id,B=dt===Q;return a.jsxDEV("button",{type:"button",onClick:()=>tn(D),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${B?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Za(D.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2802,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName||""," ",D.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2805,columnNumber:29},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2792,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2787,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2783,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${q.length===0||dt?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2818,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:q.map((D,Q)=>a.jsxDEV("button",{type:"button",onClick:()=>{Je(B=>({...B,accountHolder:D.accountHolder,bankName:D.bankName,accountNumber:D.accountNumber})),te([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:D.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2835,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName," ",D.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2838,columnNumber:27},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2821,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2819,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2815,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2781,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2850,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountHolder,onChange:D=>Je({...ne,accountHolder:D.target.value}),onFocus:()=>Ie(!0),onBlur:()=>setTimeout(()=>Ie(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:17},void 0),fe&&xe.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:xe.map((D,Q)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:B=>B.preventDefault(),onClick:()=>{let B=D.bankName||"",x=D.accountNumber||"";const L=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],U={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const X of L)if(x.includes(X)){B||(B=U[X]||X),x=x.replace(X,"").trim();break}for(const X of L)if(B.includes(X)){const G=U[X]||X,Z=B.replace(X,"").trim();Z&&/\d/.test(Z)&&(x=Z),B=G;break}x=x.replace(/[^\d\-]/g,"").trim(),Je({...ne,accountHolder:D.name,bankName:B||ne.bankName,accountNumber:x||ne.accountNumber}),Ie(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:D.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2951,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:D.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2952,columnNumber:25},void 0)]},`${D.name}-${Q}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2864,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2862,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2849,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2963,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>Je({...ne,bankName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2969,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2970,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2971,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2972,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2973,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2974,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2975,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2976,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2977,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2978,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2979,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2980,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2981,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2982,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2983,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2984,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2985,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2986,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2987,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2988,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2989,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2990,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2991,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2964,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2962,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2996,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountNumber,onChange:D=>Je({...ne,accountNumber:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2997,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2995,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3008,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(R||F)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",R&&" ",F&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3011,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const D=Number(ne.amount)||0;let Q=D;return F&&(Q=Math.round(D*.967)),Q.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3015,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3009,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3007,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3006,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&a.jsxDEV("button",{onClick:()=>{C(null),Je(D=>({project:D.project,date:qt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),I(!1),re(!1),P(null),oe.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3034,columnNumber:19},void 0),a.jsxDEV("button",{onClick:D=>{console.log(" Payment button clicked!",D),console.log(" Button element:",D.currentTarget),console.log(" Form data:",ne),At()},disabled:ft,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ft?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ft?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3063,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3032,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2778,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2514,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2511,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${V!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>Ue("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${ge==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${ge==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:kt.filter(D=>D&&D.id&&D.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3102,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3093,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ue("completed"),Je(D=>({...D,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${ge==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${ge==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:kt.filter(D=>D&&D.id&&D.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3121,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3108,columnNumber:17},void 0),ge==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Ot,onChange:D=>{le(D.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(D.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3130,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3129,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3092,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3091,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3090,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3145,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:xt.length>0?a.jsxDEV("div",{className:"space-y-4",children:xt.map(D=>{var X,G,Z;const Q=D.amount||0,B=((X=D.bankInfo)==null?void 0:X.accountHolder)||D.accountHolder||"",x=((G=D.bankInfo)==null?void 0:G.bankName)||D.bank||"",L=((Z=D.bankInfo)==null?void 0:Z.accountNumber)||D.accountNumber||"",U=B&&x&&L?`${B} | ${x} ${L}`:" ";return a.jsxDEV("div",{onClick:()=>p(D.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===D.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[D.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",D.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3177,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:D.purpose||D.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3179,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3175,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:D.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3183,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3174,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[Q.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3186,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[D.requestedBy||"-","  ",iy(D.requestDate,"MM/dd",{locale:An})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3189,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3185,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3173,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3197,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3198,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3199,columnNumber:25},void 0),D.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3202,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3203,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3201,columnNumber:27},void 0),D.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3208,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3209,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3207,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3196,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:U},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3216,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),Nn(D)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(Lv,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3228,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3220,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async ie=>{ie.stopPropagation(),window.confirm("  ?")&&(await r(D.id),oe.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(Ti,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3241,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3230,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3219,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3215,columnNumber:23},void 0),ge==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:ie=>{if(ie.stopPropagation(),D.status==="completed"){oe.info("   ");return}cn(D)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${D.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:D.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:27},void 0),a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),Un(D.id)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${D.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:D.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3268,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3249,columnNumber:25},void 0)]},D.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3163,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3149,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3299,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3147,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3086,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${V!=="image"?"hidden lg:flex":""}`,onDragOver:ui,onDragLeave:Os,onDrop:ls,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:xs,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3315,columnNumber:11},void 0),T&&f&&V==="image"&&(()=>{const D=kt.find(Q=>Q.id===f);return D?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:D.purpose||D.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3332,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[D.process||"-","  ",iy(D.requestDate,"yyyy.MM.dd",{locale:An})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3333,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3331,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(D.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3337,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3330,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3329,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:D=>{var B;const Q=D.target;if(!Q.closest("img")&&!Q.closest("button")&&f){const x=kt.find(G=>G.id===f),L=(x==null?void 0:x.images)||[],U=ze[f]||[];(L.length>0?L:U).length>0&&((B=document.getElementById("image-file-input"))==null||B.click())}},children:f?(()=>{const D=kt.find(L=>L.id===f),Q=(D==null?void 0:D.images)||[],B=ze[f]||[],x=Q.length>0?Q:B;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3373,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(D==null?void 0:D.quickText)||(D==null?void 0:D.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3374,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3372,columnNumber:19},void 0),x.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:x.map((L,U)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:L,alt:` ${U+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:X=>{X.stopPropagation(),vs(L)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3388,columnNumber:27},void 0),a.jsxDEV("button",{onClick:X=>{X.stopPropagation(),ss(U)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(wn,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3404,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3397,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[U+1,"/",x.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3406,columnNumber:27},void 0)]},U,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3387,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3385,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${x.length>0?"":"flex-1"}`,onClick:L=>L.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${x.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(Pm,{className:`mx-auto text-gray-400 mb-1 ${x.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3425,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:x.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3426,columnNumber:23},void 0),x.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3430,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3420,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3415,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3370,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(Ta,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3439,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3440,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3438,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3437,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3347,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3307,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2508,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3455,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Ee(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(wn,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3460,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3456,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3454,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Cm.map(D=>a.jsxDEV("button",{onClick:()=>{Je({...ne,process:D}),Ee(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3467,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3465,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Je({...ne,process:""}),Ee(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3484,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3464,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3453,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3452,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>Ee(!1),children:a.jsxDEV("div",{onClick:D=>D.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:qe.current?`${qe.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:qe.current?`${qe.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3508,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Ee(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(wn,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3513,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3509,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3507,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Cm.map(D=>a.jsxDEV("button",{onClick:()=>{Je({...ne,process:D}),Ee(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3520,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3518,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Je({...ne,process:""}),Ee(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3537,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3517,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3499,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3498,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3450,columnNumber:9},void 0),ee&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>M(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:D=>{D.stopPropagation(),M(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(wn,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3566,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3559,columnNumber:13},void 0),a.jsxDEV("img",{src:A,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:D=>D.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3568,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3558,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3554,columnNumber:9},void 0),vt&&a.jsxDEV(tT,{projectName:It,onClose:()=>lt(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3580,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2449,columnNumber:5},void 0)},hi=n=>n?typeof n=="string"?n:n instanceof be?n.toDate().toISOString():new Date().toISOString():new Date().toISOString(),_s={async getSpaces(n){const e=Qe(ae,"finish_check_spaces");let t;n?t=_t(e,Wn("project_id","==",n),Jt("display_order")):t=_t(e,Jt("display_order"));const s=await jt(t),r=[];for(const i of s.docs){const o=i.data(),l=Qe(ae,"finish_check_items"),u=_t(l,Wn("space_id","==",i.id),Jt("display_order")),m=await jt(u),d=[];for(const f of m.docs){const p=f.data(),y=Qe(ae,"finish_check_images"),C=_t(y,Wn("item_id","==",f.id)),w=(await jt(C)).docs.map(R=>({id:R.id,item_id:f.id,filename:R.data().filename||null,created_at:hi(R.data().created_at)}));d.push({id:f.id,space_id:i.id,content:p.content||"",is_completed:p.is_completed||0,is_priority:p.is_priority||0,completed_at:p.completed_at?hi(p.completed_at):null,display_order:p.display_order||0,created_at:hi(p.created_at),updated_at:hi(p.updated_at),images:w})}r.push({id:i.id,name:o.name||"",project_id:o.project_id||null,display_order:o.display_order||0,created_at:hi(o.created_at),updated_at:hi(o.updated_at),items:d})}return r},async createSpace(n,e){const t=Qe(ae,"finish_check_spaces"),s=_t(t,Wn("project_id","==",e),Jt("display_order","desc")),r=await jt(s),i=r.docs.length>0&&r.docs[0].data().display_order||0,o={name:n,project_id:e,display_order:i+1,created_at:vn(),updated_at:vn()};return{id:(await tr(t,o)).id,name:n,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(n,e){const t=Te(ae,"finish_check_spaces",n);await $t(t,{name:e,updated_at:vn()})},async deleteSpace(n){const e=Qe(ae,"finish_check_items"),t=_t(e,Wn("space_id","==",n)),s=await jt(t);for(const r of s.docs){const i=Qe(ae,"finish_check_images"),o=_t(i,Wn("item_id","==",r.id)),l=await jt(o);for(const u of l.docs)await Kn(Te(ae,"finish_check_images",u.id));await Kn(Te(ae,"finish_check_items",r.id))}await Kn(Te(ae,"finish_check_spaces",n))},async createItem(n,e){const t=Qe(ae,"finish_check_items"),s=_t(t,Wn("space_id","==",n),Jt("display_order","desc")),r=await jt(s),i=r.docs.length>0&&r.docs[0].data().display_order||0,o={space_id:n,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:vn(),updated_at:vn()};return{id:(await tr(t,o)).id,space_id:n,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(n,e){const t=Te(ae,"finish_check_items",n);await $t(t,{content:e,updated_at:vn()})},async deleteItem(n){const e=Qe(ae,"finish_check_images"),t=_t(e,Wn("item_id","==",n)),s=await jt(t);for(const r of s.docs)await Kn(Te(ae,"finish_check_images",r.id));await Kn(Te(ae,"finish_check_items",n))},async toggleItem(n){const e=Te(ae,"finish_check_items",n),t=await Rt(e);if(!t.exists())throw new Error("   .");const s=t.data(),r=s.is_completed?0:1;return await $t(e,{is_completed:r,completed_at:r?vn():null,updated_at:vn()}),{id:n,space_id:s.space_id,content:s.content,is_completed:r,is_priority:s.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:s.display_order||0,created_at:hi(s.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(n){const e=Te(ae,"finish_check_items",n),t=await Rt(e);if(!t.exists())throw new Error("   .");const r=t.data().is_priority||0?0:1;return await $t(e,{is_priority:r,updated_at:vn()}),{is_priority:r}},async getImageData(n){const e=Te(ae,"finish_check_images",n),t=await Rt(e);if(!t.exists())return null;const s=t.data();return{image_data:s.image_url||s.image_data||""}},async uploadImage(n,e,t){const s=Qe(ae,"finish_check_images"),r={item_id:n,image_data:"",image_url:"",filename:t,created_at:vn()},i=await tr(s,r);let o=e;if(Qo(e)){const l=await X0("finish_check",i.id,e);await $t(i,{image_url:l,image_data:""}),o=l}else await $t(i,{image_data:e});return{id:i.id,item_id:n,image_data:o,filename:t,created_at:new Date().toISOString()}},async deleteImage(n){const e=Te(ae,"finish_check_images",n),t=await Rt(e);if(t.exists()){const s=t.data();s.image_url&&await J0(s.image_url)}await Kn(e)}},Ss={getSpaces:n=>_s.getSpaces(n),createSpace:(n,e)=>_s.createSpace(n,e),updateSpace:(n,e)=>_s.updateSpace(String(n),e),deleteSpace:n=>_s.deleteSpace(String(n)),createItem:(n,e)=>_s.createItem(String(n),e),updateItem:(n,e)=>_s.updateItem(String(n),e),deleteItem:n=>_s.deleteItem(String(n)),toggleItem:n=>_s.toggleItem(String(n)),togglePriority:n=>_s.togglePriority(String(n)),getImageData:n=>_s.getImageData(String(n)),uploadImage:(n,e,t)=>_s.uploadImage(String(n),e,t),deleteImage:n=>_s.deleteImage(String(n))},cT=()=>{var ne,Je;const{user:n}=si(),{loadProjectsFromAPI:e,projects:t}=Xr(),s=Ou(),[r,i]=E.useState([]),[o,l]=E.useState(!0),[u,m]=E.useState(null),[d,f]=E.useState([]),[p,y]=E.useState(!1),[C,v]=E.useState(""),[w,R]=E.useState(""),[I,F]=E.useState(null),[re,ee]=E.useState(null),[M,A]=E.useState(""),[N,V]=E.useState(null),[j,T]=E.useState(""),[S,k]=E.useState(null),[Ee,qe]=E.useState(new Set),ge=E.useRef(null),[Ue,ht]=E.useState(window.innerWidth<768),[Kt,Ot]=E.useState(!1),[le,$e]=E.useState(null),[de,Re]=E.useState(new Set),[Ye,vt]=E.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[lt,It]=E.useState(!1),[at,ft]=E.useState(!1),[bn,K]=E.useState(new Set);E.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(Ye))},[Ye]),E.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const ve=()=>{ht(window.innerWidth<768)};return window.addEventListener("resize",ve),()=>window.removeEventListener("resize",ve)},[]),E.useEffect(()=>{o||Le()},[s,o]),E.useEffect(()=>{u!==null&&He()},[u]),E.useEffect(()=>{u!==null&&(n!=null&&n.id)&&localStorage.setItem(`finishCheck_selectedProject_${n.id}`,u.toString())},[u,n==null?void 0:n.id]),E.useEffect(()=>{if(!Ue&&S){const O=async ve=>{var je;const ke=(je=ve.clipboardData)==null?void 0:je.items;if(ke){for(let me=0;me<ke.length;me++)if(ke[me].type.indexOf("image")!==-1){ve.preventDefault();const kt=ke[me].getAsFile();kt&&await Ie(S,kt)}}};return document.addEventListener("paste",O),()=>document.removeEventListener("paste",O)}},[S,Ue]);const Le=async()=>{try{const O=s.map(ke=>({id:ke.id,title:ke.name}));i(O);const ve=n!=null&&n.id?localStorage.getItem(`finishCheck_selectedProject_${n.id}`):null;ve&&O.some(ke=>ke.id===Number(ve))?m(Number(ve)):O.length>0&&m(O[0].id)}catch(O){console.error("Failed to load projects:",O),oe.error("   ")}},He=async()=>{try{d.length===0&&y(!0);const ve=(await Ss.getSpaces(u||void 0)).map(ke=>({...ke,items:ke.items.map(je=>({...je,images:je.images||[]}))}));f(ve)}catch(O){console.error("Failed to load spaces:",O),oe.error("   ")}finally{y(!1)}},Se=async O=>{if(bn.has(Number(O)))return null;try{K(je=>new Set(je).add(Number(O)));const ve=await Ss.getImageData(O),ke=(ve==null?void 0:ve.image_data)||null;return f(je=>je.map(me=>({...me,items:me.items.map(kt=>({...kt,images:kt.images.map(xt=>String(xt.id)===String(O)?{...xt,image_data:ke}:xt)}))}))),ke}catch(ve){return console.error("   :",ve),null}finally{K(ve=>{const ke=new Set(ve);return ke.delete(Number(O)),ke})}},Xe=async O=>{const ve=d.find(me=>me.items.some(kt=>kt.id===O)),ke=ve==null?void 0:ve.items.find(me=>me.id===O);if(!ke)return;const je=ke.images.filter(me=>!me.image_data);await Promise.all(je.map(me=>Se(me.id)))},St=async()=>{if(!at){if(!C.trim()){oe.error("  ");return}if(!u){oe.error(" ");return}ft(!0);try{const O=await Ss.createSpace(C.trim(),u),ve={...O,items:O.items||[]};f([...d,ve]),v(""),It(!1),oe.success(" ")}catch(O){console.error("Failed to add space:",O),oe.error("  ")}finally{ft(!1)}}},Gt=async(O,ve)=>{if(!ve.trim()){oe.error("  ");return}try{await Ss.updateSpace(O,ve.trim()),f(d.map(ke=>String(ke.id)===String(O)?{...ke,name:ve.trim()}:ke)),ee(null),A(""),oe.success("  ")}catch(ke){console.error("Failed to update space:",ke),oe.error("  ")}},dt=O=>{$e(O),Re(new Set)},P=async()=>{if(le!==null){if(de.size===0){oe.error("  ");return}try{await Promise.all(Array.from(de).map(O=>Ss.deleteItem(O))),f(d.map(O=>String(O.id)===String(le)?{...O,items:O.items.filter(ve=>!de.has(ve.id))}:O)),oe.success(`${de.size}  `),$e(null),Re(new Set)}catch(O){console.error("Failed to delete items:",O),oe.error("  ")}}},q=async()=>{if(le===null)return;const O=d.find(ve=>String(ve.id)===String(le));if(O&&confirm(`"${O.name}"  ?

        .`))try{await Ss.deleteSpace(le),f(d.filter(ve=>String(ve.id)!==String(le))),oe.success(" "),$e(null),Re(new Set)}catch(ve){console.error("Failed to delete space:",ve),oe.error("  ")}},te=async O=>{if(!w.trim()){oe.error("  ");return}const ve=-Date.now(),ke={id:ve,space_id:O,content:w.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(me=>String(me.id)===String(O)?{...me,items:[...me.items,ke]}:me));const je=w.trim();R(""),F(null);try{const me=await Ss.createItem(O,je);f(kt=>kt.map(xt=>String(xt.id)===String(O)?{...xt,items:xt.items.map(tn=>tn.id===ve?{...me,images:[]}:tn)}:xt))}catch(me){console.error("Failed to add item:",me),f(kt=>kt.map(xt=>String(xt.id)===String(O)?{...xt,items:xt.items.filter(tn=>tn.id!==ve)}:xt)),oe.error("  ")}},xe=async O=>{try{const ve=await Ss.toggleItem(O);f(d.map(ke=>({...ke,items:ke.items.map(je=>String(je.id)===String(O)?{...je,...ve}:je)})))}catch(ve){console.error("Failed to toggle item:",ve),oe.error("   ")}},ue=async O=>{try{const ve=await Ss.togglePriority(O);f(d.map(ke=>({...ke,items:ke.items.map(je=>String(je.id)===String(O)?{...je,is_priority:ve.is_priority}:je)})))}catch(ve){console.error("Failed to toggle priority:",ve),oe.error("  ")}},fe=O=>new Promise((ve,ke)=>{const je=new FileReader;je.readAsDataURL(O),je.onload=()=>ve(je.result),je.onerror=me=>ke(me)}),Ie=async(O,ve)=>{var me,kt;if(!["image/jpeg","image/png","image/webp"].includes(ve.type)){oe.error("JPEG, PNG, WebP    ");return}const je=5*1024*1024;if(ve.size>je){oe.error("  5MB  ");return}try{qe(At=>new Set([...At,Number(O)]));const xt=await fe(ve),tn=await Ss.uploadImage(O,xt,ve.name);f(d.map(At=>({...At,items:At.items.map(Nn=>String(Nn.id)===String(O)?{...Nn,images:[...Nn.images,tn]}:Nn)}))),oe.success(" ")}catch(xt){console.error("Failed to upload image:",xt),oe.error(((kt=(me=xt.response)==null?void 0:me.data)==null?void 0:kt.error)||"  ")}finally{qe(xt=>{const tn=new Set(xt);return tn.delete(Number(O)),tn})}},ze=async(O,ve)=>{const ke=ve.target.files;if(!(!ke||ke.length===0)){for(let je=0;je<ke.length;je++)await Ie(O,ke[je]);ge.current&&(ge.current.value="")}},tt=async(O,ve)=>{if(confirm("  ?"))try{await Ss.deleteImage(ve),f(d.map(ke=>({...ke,items:ke.items.map(je=>String(je.id)===String(O)?{...je,images:je.images.filter(me=>String(me.id)!==String(ve))}:je)}))),oe.success(" ")}catch(ke){console.error("Failed to delete image:",ke),oe.error("  ")}},Ae=async(O,ve)=>{O.preventDefault(),O.stopPropagation();const ke=O.dataTransfer.files;if(!(!ke||ke.length===0))for(let je=0;je<ke.length;je++)ke[je].type.startsWith("image/")&&await Ie(ve,ke[je])},On=O=>{O.preventDefault(),O.stopPropagation()};if(p)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const Ht=S?d.flatMap(O=>O.items).find(O=>O.id===S):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:ge,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:O=>{S&&ze(S,O)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:Ue?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:O=>{const ve=O.target.value?Number(O.target.value):null;m(ve)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>vt(!Ye),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${Ye?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ye?" ":" ",children:Ye?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>It(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV(Io,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:O=>{const ve=O.target.value?Number(O.target.value):null;m(ve)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:C,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&St()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),a.jsxDEV("button",{onClick:St,disabled:at,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV(Io,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>vt(!Ye),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${Ye?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ye?" ":" ",children:Ye?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((O,ve)=>{const ke=O.items.filter(me=>!me.is_completed).sort((me,kt)=>(kt.is_priority||0)-(me.is_priority||0)),je=O.items.filter(me=>me.is_completed);return Ye&&ke.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[re===O.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:M,onChange:me=>A(me.target.value),onKeyPress:me=>{me.key==="Enter"?Gt(O.id,M):me.key==="Escape"&&(ee(null),A(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Gt(O.id,M),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(ly,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{ee(null),A("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(wn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:ve+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),O.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[je.length,"/",O.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{I===O.id?(F(null),R("")):F(O.id)},className:`p-1 transition-colors ${I===O.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV(Io,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{ee(O.id),A(O.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(Lm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>dt(O.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(Ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),I===O.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:w,onChange:me=>R(me.target.value),onKeyPress:me=>{me.key==="Enter"&&w.trim()&&te(O.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>te(O.id),disabled:!w.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),ke.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:ke.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>xe(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!Ue&&S===me.id?"font-semibold":""}`,onClick:async()=>{Ue||(k(me.id),me.images&&me.images.length>0&&await Xe(me.id))},style:{cursor:Ue?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),Ue&&Ot(!0),me.images&&me.images.length>0&&await Xe(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Ta,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Ap,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!Ye&&je.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:je.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>xe(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!Ue&&S===me.id?"font-semibold":""}`,onClick:async()=>{Ue||(k(me.id),me.images&&me.images.length>0&&await Xe(me.id))},style:{cursor:Ue?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),Ue&&Ot(!0),me.images&&me.images.length>0&&await Xe(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Ta,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Ap,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!Ue&&S&&Ht&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(wn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Ht.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=ge.current)==null?void 0:O.click()},disabled:Ee.has(S),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(Pm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),Ee.has(S)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:O=>Ae(O,S),onDragOver:On,children:Ht.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(Ta,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Ht.images.map(O=>a.jsxDEV("div",{className:"relative group",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>tt(S,O.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(wp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),Ue&&Kt&&S&&Ht&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ot(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(wn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:Ht.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=ge.current)==null?void 0:O.click()},disabled:Ee.has(S),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(Pm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),Ee.has(S)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:Ht.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(Ta,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Ht.images.map(O=>a.jsxDEV("div",{className:"relative",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>tt(S,O.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(wp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),le!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ne=d.find(O=>O.id===le))==null?void 0:ne.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{$e(null),Re(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(wn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Je=d.find(O=>O.id===le))==null?void 0:Je.items.map(O=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const ve=new Set(de);ve.has(O.id)?ve.delete(O.id):ve.add(O.id),Re(ve)},children:[a.jsxDEV("input",{type:"checkbox",checked:de.has(O.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${O.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:O.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:P,disabled:de.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",de.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),a.jsxDEV("button",{onClick:q,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{$e(null),Re(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),lt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{It(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(wn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:C,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&C.trim()&&St()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{It(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),a.jsxDEV("button",{onClick:St,disabled:!C.trim()||at,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:at?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function uT(){const[n,e]=E.useState([]),[t,s]=E.useState(!1),[r,i]=E.useState(null),[o,l]=E.useState(!1),[u,m]=E.useState(null),[d,f]=E.useState(""),[p,y]=E.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[C,v]=E.useState(!1);E.useEffect(()=>{w()},[]),E.useEffect(()=>{const N=()=>{R()};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[]);const w=async()=>{var N,V;try{n.length===0&&s(!0),i(null);const j=await ur.getAllContractors();e(j.map(T=>({id:T._id,rank:T.rank,companyName:T.companyName,name:T.name,position:T.position,process:T.process,contact:T.contact,accountNumber:T.accountNumber,notes:T.notes,createdAt:new Date(T.createdAt),updatedAt:new Date(T.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const T=j instanceof Error&&((V=(N=j.response)==null?void 0:N.data)==null?void 0:V.message);i(T||"   .")}finally{s(!1)}},R=N=>{if(N){m(N);let V="",j=N.accountNumber||"";if(N.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const Ee of k)if(N.accountNumber.startsWith(Ee)){V=Ee,j=N.accountNumber.substring(Ee.length).trim();break}}let T=N.name,S=N.position||"";S||(S=lc(N.name),T=Za(N.name)),y({rank:N.rank||"",companyName:N.companyName||"",name:T,position:S,process:N.process,contact:N.contact||"",bankName:V,accountNumber:j,notes:N.notes||""})}else m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},I=()=>{l(!1),m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},F=async N=>{var j,T;if(N.preventDefault(),C)return;v(!0);const V=p.bankName&&p.accountNumber?`${p.bankName} ${p.accountNumber}`:p.accountNumber;try{const S={rank:p.rank,companyName:p.companyName,name:p.name,position:p.position,process:p.process,contact:p.contact,accountNumber:V,notes:p.notes};u?await ur.updateContractor(u.id,S):await ur.createContractor(S),await w(),I()}catch(S){console.error("Failed to save contractor:",S);const k=S instanceof Error&&((T=(j=S.response)==null?void 0:j.data)==null?void 0:T.message);alert(k||"  .")}finally{v(!1)}},re=async N=>{var V,j;if(window.confirm("   ?"))try{await ur.deleteContractor(N),await w()}catch(T){console.error("Failed to delete contractor:",T);const S=T instanceof Error&&((j=(V=T.response)==null?void 0:V.data)==null?void 0:j.message);alert(S||"  .")}},ee=()=>"border-gray-200 text-gray-600 bg-gray-50",M=N=>N?N==="1"?1:N==="1()"?2:N==="2"?3:N==="2()"?4:N==="3"?5:N==="3()"?6:N===""?100:N===""?200:999:999,A=n.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())||N.process.toLowerCase().includes(d.toLowerCase())||N.accountNumber.toLowerCase().includes(d.toLowerCase())||N.contact&&N.contact.toLowerCase().includes(d.toLowerCase())||N.rank&&N.rank.toLowerCase().includes(d.toLowerCase())||N.companyName&&N.companyName.toLowerCase().includes(d.toLowerCase())).sort((N,V)=>{const j=M(N.rank)-M(V.rank);if(j!==0)return j;const T=N.process.localeCompare(V.process,"ko");return T!==0?T:N.name.localeCompare(V.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>R(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(uy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):A.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):A.map(N=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${ee(N.rank)}`,children:N.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:Za(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.position||lc(N.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:N.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>R(N),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(Lm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(Ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):A.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):A.map(N=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[N.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${ee(N.rank)}`,children:N.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),N.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:N.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Za(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>R(N),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(Lm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(Ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(N.position||lc(N.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.position||lc(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),N.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),N.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:N.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:I,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(wn,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:F,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:p.rank,onChange:N=>y({...p,rank:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.companyName,onChange:N=>y({...p,companyName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:p.name,onChange:N=>y({...p,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.position,onChange:N=>y({...p,position:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:p.process,onChange:N=>y({...p,process:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.contact,onChange:N=>y({...p,contact:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:p.bankName,onChange:N=>y({...p,bankName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.accountNumber,onChange:N=>y({...p,accountNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:p.notes,onChange:N=>y({...p,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:C,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:C?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const mT=()=>{const[n,e]=E.useState([]),[t,s]=E.useState(null),[r,i]=E.useState(!1),o=E.useRef(null);E.useEffect(()=>(o.current=Pc.subscribeToQuoteInquiries(f=>{e(f),i(!1)}),i(!0),()=>{o.current&&o.current()}),[]);const l=async f=>{try{await Pc.markAsRead(f),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(p){console.error("Failed to mark as read:",p)}},u=f=>{s(f),f.isRead||l(f.id)},m=async(f,p)=>{if(p.stopPropagation(),!!confirm("  ?"))try{await Pc.deleteQuoteInquiry(f),(t==null?void 0:t.id)===f&&s(null),oe.success(" ")}catch(y){console.error("Failed to delete inquiry:",y),oe.error("  ")}},d=n.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:n.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:qt(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),a.jsxDEV("button",{onClick:p=>m(f.id,p),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(Ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(Vp,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>s(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:qt(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(jv,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Vp,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Rv,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Bv,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(Uv,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},dT=()=>{const{login:n}=si(),[e,t]=E.useState(!1),{register:s,handleSubmit:r,setValue:i,formState:{errors:o}}=ep(),l=async m=>{t(!0);try{await n(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...s("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...s("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(Hv,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},fT=E.lazy(()=>rr(()=>import("./Drawings-DvZgKMQA.js"),__vite__mapDeps([0,1,2,3,4,5]))),pT=E.lazy(()=>rr(()=>import("./SiteLog-x04iISBj.js"),__vite__mapDeps([6,1,4,2,3,5]))),hT=E.lazy(()=>rr(()=>import("./AfterService-BhIA4x_T.js"),__vite__mapDeps([7,1,2,4,3,5]))),gT=E.lazy(()=>rr(()=>import("./AdditionalWork-QoSdEI0x.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),yT=E.lazy(()=>rr(()=>import("./ConstructionPayment-CJ-nqHZM.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),bT=E.lazy(()=>rr(()=>import("./WorkRequest-aQrQ-UYV.js"),__vite__mapDeps([11,1,2,4,3,5]))),NT=E.lazy(()=>rr(()=>import("./Specbook-BswDR6Ft.js"),__vite__mapDeps([12,1,2,3,4,5]))),xT=E.lazy(()=>rr(()=>import("./EstimatePreview-E_xxix-1.js"),__vite__mapDeps([13,1,2,3,4,5]))),vT=E.lazy(()=>rr(()=>import("./ExecutionHistory-GOXgFkPt.js"),__vite__mapDeps([14,1,4,2,3,5]))),_T=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),DT=new Ev({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function kT(){const[n,e]=E.useState(!1);return E.useEffect(()=>{const t=HD({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),oe.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{oe.dismiss(),oe.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});n2();const s=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(s,5e3);const r=setInterval(s,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=Ma(u,{transports:["websocket","polling"]}),Lr.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;t2(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(Av,{client:DT,children:a.jsxDEV(_v,{children:a.jsxDEV(cC,{children:[a.jsxDEV(E.Suspense,{fallback:a.jsxDEV(_T,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(Dv,{children:[a.jsxDEV(Ln,{path:"/login",element:a.jsxDEV(dT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(Ln,{path:"/",element:a.jsxDEV(JC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(Ln,{index:!0,element:a.jsxDEV(ay,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(Ln,{path:"dashboard",element:a.jsxDEV(S2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(Ln,{path:"projects",element:a.jsxDEV(U2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(Ln,{path:"schedule",element:a.jsxDEV(eT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(Ln,{path:"drawings",element:a.jsxDEV(fT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(Ln,{path:"site-log",element:a.jsxDEV(pT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(Ln,{path:"after-service",element:a.jsxDEV(hT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(Ln,{path:"additional-work",element:a.jsxDEV(gT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(Ln,{path:"construction-payment",element:a.jsxDEV(yT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(Ln,{path:"contractors",element:a.jsxDEV(uT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(Ln,{path:"work-request",element:a.jsxDEV(bT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(Ln,{path:"finish-check",element:a.jsxDEV(cT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(Ln,{path:"specbook",element:a.jsxDEV(NT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(Ln,{path:"estimate-preview",element:a.jsxDEV(xT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(Ln,{path:"execution-history",element:a.jsxDEV(vT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(Ln,{path:"payments",element:a.jsxDEV(lT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(Ln,{path:"quote-inquiry",element:a.jsxDEV(mT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(z_,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(n){for(const e of n)e.update()});Ay(document.getElementById("root")).render(a.jsxDEV(E.StrictMode,{children:a.jsxDEV(kT,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{ep as A,An as B,Ad as C,zC as D,Am as E,lC as F,PT as G,Ft as H,iT as I,Es as J,aT as K,rT as L,Cm as P,be as T,ae as a,Kn as b,vn as c,Te as d,au as e,Dd as f,Rt as g,si as h,Ou as i,a as j,Qe as k,Ns as l,jt as m,Z0 as n,Jt as o,Qo as p,_t as q,ou as r,Fi as s,lu as t,_d as u,$t as v,Wn as w,tr as x,Xr as y,oe as z};
