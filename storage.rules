rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // 앱에서 사용하는 모든 이미지 폴더 - 읽기/쓰기 허용
    // (커스텀 인증 사용으로 Firebase Auth 토큰 없음)

    // specbook images
    match /specbook/{allPaths=**} {
      allow read, write: if true;
    }
    // site_logs images
    match /site_logs/{allPaths=**} {
      allow read, write: if true;
    }
    // additional_works images
    match /additional_works/{allPaths=**} {
      allow read, write: if true;
    }
    // execution_records images
    match /execution_records/{allPaths=**} {
      allow read, write: if true;
    }
    // finish_check images
    match /finish_check/{allPaths=**} {
      allow read, write: if true;
    }
    // payments images
    match /payments/{allPaths=**} {
      allow read, write: if true;
    }
    // drawings images
    match /drawings/{allPaths=**} {
      allow read, write: if true;
    }
    // backups - Cloud Functions에서만 접근 (admin SDK 사용)
    // 클라이언트 직접 접근 차단, signed URL 통해서만 다운로드
    match /backups/{allPaths=**} {
      allow read, write: if false;
    }

    // 기타 경로는 차단
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
